     1                                  ;---------------------------------------------------
     2                                  ; \file  kernel.asm
     3                                  ; \note  (c) 2025 by Jens Kallup - paule32
     4                                  ;        all rights reserved.
     5                                  ;
     6                                  ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                                  ;---------------------------------------------------
     8                                  bits 16
     9                                  org 0
    10                                  %include 'macros.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  macros.inc
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> ; -----------------------------------------------------------------------------
    10                              <1> ; \brief some pre-defines, to make maintain easier ...
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> %define ERROR_Win32API 'this macro can only be use with win32api (Windows).'
    13                              <1> 
    14                              <1> ; -----------------------------------------------------------------------------
    15                              <1> ; \brief DOS error codes for int 0x21 - 3Dh
    16                              <1> ; -----------------------------------------------------------------------------
    17                              <1> %define ERROR_INVALID_FUNCTION      0x01
    18                              <1> %define ERROR_FILE_NOT_FOUND        0x02
    19                              <1> %define ERROR_PATH_NOT_FOUND        0x03
    20                              <1> %define ERROR_TOO_MANY_OPEN_FILES   0x04
    21                              <1> %define ERROR_ACCESS_DENIED         0x05
    22                              <1> %define ERROR_INVALID_HANDLE        0x06
    23                              <1> %define ERROR_ARENA_TRASHED         0x07
    24                              <1> %define ERROR_NOT_ENOUGH_MEMORY     0x08
    25                              <1> %define ERROR_INVALID_ACCESS        0x0C
    26                              <1> %define ERROR_INVALID_DRIVE         0x0F
    27                              <1> %define ERROR_CURRENT_DIRECTORY     0x10
    28                              <1> %define ERROR_NOT_SAME_DEVICE       0x11
    29                              <1> %define ERROR_NO_MORE_FILES         0x12
    30                              <1> %define ERROR_SEEK                  0x1D
    31                              <1> %define ERROR_NOT_DOS_DISK          0x1E
    32                              <1> 
    33                              <1> ; -----------------------------------------------------------------------------
    34                              <1> ; \brief DOS file open modes ...
    35                              <1> ; -----------------------------------------------------------------------------
    36                              <1> %define DOS_READ_ONLY   0x00    ; read  only
    37                              <1> %define DOS_WRITE_ONLY  0x01    ; write only
    38                              <1> %define DOS_READWRITE   0x02    ; read/write
    39                              <1> 
    40                              <1> ; -----------------------------------------------------------------------------
    41                              <1> ; \brief DOS file seek constants ...
    42                              <1> ; -----------------------------------------------------------------------------
    43                              <1> %define SEEK_BEGIN      0x00    ; begin of file
    44                              <1> %define SEEK_SET        0x01    ; current position
    45                              <1> %define SEEK_END        0x02    ; file end
    46                              <1> 
    47                              <1> ; -----------------------------------------------------------------------------
    48                              <1> ; \brief DOS console settings ...
    49                              <1> ; -----------------------------------------------------------------------------
    50                              <1> %define ATTR_DOS_ERROR              0x0E | 0x10     ; yeloow on blue bakcground
    51                              <1> 
    52                              <1> %define MAX_ARGV        32      ; maximum count of command line arguments
    53                              <1> 
    54                              <1> ; -----------------------------------------------------------------------------
    55                              <1> ; \brief DOS 16-Bit applications handles the offsets of symbols otherwise as
    56                              <1> ;        Windows 32 or 64-Bit.
    57                              <1> ; -----------------------------------------------------------------------------
    58                              <1> %ifndef PTR16
    59                              <1> %define PTR16(sym) (sym-code16_start+0x100)
    60                              <1> %endif
    61                              <1> 
    62                              <1> ; -----------------------------------------------------------------------------
    63                              <1> ; \brief Windows 32 or 64-Bit applications handles the offsets of symbols other
    64                              <1> ;        wise as DOS 16-Bit programs.
    65                              <1> ; -----------------------------------------------------------------------------
    66                              <1> %ifndef PTR64
    67                              <1> %define PTR64(sym) (IMAGE_BASE + RVA_DATA(sym))
    68                              <1> %endif
    69                              <1> 
    70                              <1> ; -----------------------------------------------------------------------------
    71                              <1> ; \brief pre-processor variables and constants ...
    72                              <1> ; \note  __pre_stop -> nasm does not have a return or exit directive to stop
    73                              <1> ;                      the pre-processing. But, we can tell nasm, to use a var
    74                              <1> ;                      to sign: "stop pre-processing, and handle all following
    75                              <1> ;                      directives as rejected."
    76                              <1> ; -----------------------------------------------------------------------------
    77                              <1> %assign __pre_stop 0        ; only display one error, if __pre_stop == 1 !
    78                              <1> %assign __vargs    0        ; number of command line arguments
    79                              <1> 
    80                              <1> ; -----------------------------------------------------------------------------
    81                              <1> ; \brief  get the positional argument of a command line parameter in console.
    82                              <1> ; \param  1. <id> -> ARGV_n where n can be 1..32 (MAX_ARGV == 32).
    83                              <1> ; \return __vargs <imm> -> the number of the parameter > 0
    84                              <1> ; -----------------------------------------------------------------------------
    85                              <1> %macro GET_VARGS 2
    86                              <1>     %if __pre_stop == 0
    87                              <1>         %assign __count 0
    88                              <1>         %assign __vargs 0
    89                              <1>         %assign __stop  0
    90                              <1>         %rep MAX_ARGV
    91                              <1>             %if __stop == 0
    92                              <1>                 %assign __count (__count + 1)
    93                              <1>                 %ifidni %1,  ARGV_%+__count
    94                              <1>                     %assign __vargs __count
    95                              <1>                     %assign __stop 1
    96                              <1>                     %assign _%2 __count  ; the _%2 there is a pitfail: todo!
    97                              <1>                 %endif
    98                              <1>             %endif
    99                              <1>         %endrep
   100                              <1>         %undef __count
   101                              <1>         %undef __stop
   102                              <1>     %endif
   103                              <1> %endmacro
   104                              <1> 
   105                              <1> ; -----------------------------------------------------------------------------
   106                              <1> ; \brief display a nasm error message with macro argument %1. Then the
   107                              <1> ;        __pre_stop pre-processor variable will set to 1.
   108                              <1> ;        (1 -> ignore all next macros)
   109                              <1> ; -----------------------------------------------------------------------------
   110                              <1> %macro EMIT_ERROR 1
   111                              <1>     %if __pre_stop == 0
   112                              <1>         EMIT_ERROR 1
   113                              <1>         %assign __pre_stop 1
   114                              <1>     %endif
   115                              <1> %endmacro
   116                              <1> 
   117                              <1> ; -----------------------------------------------------------------------------
   118                              <1> ; \brief display a nasm warning message with macro argument %1. Then the
   119                              <1> ;        __pre_stop pre-processor variable will set to 1.
   120                              <1> ;        (1 -> ignore all next macros)
   121                              <1> ; -----------------------------------------------------------------------------
   122                              <1> %macro EMIT_WARN 1
   123                              <1>     %if __pre_stop == 0
   124                              <1>         EMIT_ERROR 1
   125                              <1>         %assign __pre_stop 1
   126                              <1>     %endif
   127                              <1> %endmacro
   128                              <1> 
   129                              <1> ; -----------------------------------------------------------------------------
   130                              <1> ; \brief perform a system call (in this case a DOS int 0x21 call)
   131                              <1> ; -----------------------------------------------------------------------------
   132                              <1> %macro SysCall 0
   133                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134                              <1>     int 0x21        ; DOS interrupt 0x21
   135                              <1> %else
   136                              <1>     EMIT_ERROR 'todo: windows'
   137                              <1> %endif
   138                              <1> %endmacro
   139                              <1> 
   140                              <1> ; -----------------------------------------------------------------------------
   141                              <1> ; \brief perform a video call. It is only used in DOS 16-Bit applications.
   142                              <1> ; -----------------------------------------------------------------------------
   143                              <1> %macro VideoCall 0
   144                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145                              <1>     int 0x10
   146                              <1> %else
   147                              <1>     EMIT_ERROR 'only DOS supports interrupts.'
   148                              <1> %endif
   149                              <1> %endmacro
   150                              <1> 
   151                              <1> ; -----------------------------------------------------------------------------
   152                              <1> ; add win64 abi shadow ...
   153                              <1> ; -----------------------------------------------------------------------------
   154                              <1> %macro AddShadow 0-1
   155                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   156                              <1>     EMIT_ERROR 'AddShadow is only used for Windows 10+ 64-Bit development.'
   157                              <1> %else
   158                              <1>     %if __pre_stop == 0
   159                              <1>         %if %0 == 1
   160                              <1>             sub rsp, %1
   161                              <1>         %else
   162                              <1>             sub rsp, SW_SHADOW
   163                              <1>         %endif
   164                              <1>     %endif
   165                              <1> %endif
   166                              <1> %endmacro
   167                              <1> 
   168                              <1> ; -----------------------------------------------------------------------------
   169                              <1> ; delete added win64 abi shadow ...
   170                              <1> ; -----------------------------------------------------------------------------
   171                              <1> %macro DelShadow 0-1
   172                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   173                              <1>     EMIT_ERROR 'DelShadow is only used for Windows 10+ 64-Bit development.'
   174                              <1> %else
   175                              <1>     %if __pre_stop == 0
   176                              <1>         %if %0 == 1
   177                              <1>             add rsp, %1
   178                              <1>         %else
   179                              <1>             add rsp, SW_SHADOW
   180                              <1>         %endif
   181                              <1>     %endif
   182                              <1> %endif
   183                              <1> %endmacro
   184                              <1> 
   185                              <1> ; -----------------------------------------------------------------------------
   186                              <1> ; MAKE_INT <Label>, <Func1>, <Func2>, ...
   187                              <1> ; -----------------------------------------------------------------------------
   188                              <1> %macro MAKE_INT 2-*
   189                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   190                              <1>     EMIT_ERROR 'MAKE_INT is only used for Windows 10+ 64-Bit development.'
   191                              <1> %else
   192                              <1>     %if __pre_stop == 0
   193                              <1>     %1:
   194                              <1>         %assign __n %0-1
   195                              <1>         %rep __n
   196                              <1>             dq RVA_IDATA(HN_win32_%2)
   197                              <1>             %rotate 1
   198                              <1>         %endrep
   199                              <1>         dq 0
   200                              <1>     %endif
   201                              <1> %endif
   202                              <1> %endmacro
   203                              <1> 
   204                              <1> ; -----------------------------------------------------------------------------
   205                              <1> ; MAKE_IAT <Label>, <Func1>, <Func2>, ...
   206                              <1> ; -----------------------------------------------------------------------------
   207                              <1> %macro MAKE_IAT 2-*
   208                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   209                              <1>     EMIT_ERROR 'MAKE_IAT is only used for Windows 10+ 64-Bit development.'
   210                              <1> %else
   211                              <1>     %if __pre_stop == 0
   212                              <1>         iat_win32_%1:
   213                              <1>         %assign __n %0-1
   214                              <1>         %rep __n
   215                              <1>             IAT_win32_%2: dq RVA_IDATA(HN_win32_%2)
   216                              <1>             %rotate 1
   217                              <1>         %endrep
   218                              <1>         dq 0
   219                              <1>     %endif
   220                              <1> %endif
   221                              <1> %endmacro
   222                              <1> 
   223                              <1> ; -----------------------------------------------------------------------------
   224                              <1> ; HNSTR <Func1>, <Func2>, ...
   225                              <1> ; -----------------------------------------------------------------------------
   226                              <1> %macro HNSTR 1-*
   227                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   228                              <1>     EMIT_ERROR 'HNSTR is only used for Windows 10+ 64-Bit development.'
   229                              <1> %else
   230                              <1>     %if __pre_stop == 0
   231                              <1>         %assign __n %0
   232                              <1>         %rep __n
   233                              <1>             HN_win32_%1: dw 0
   234                              <1>             db %str(%1), 0
   235                              <1>             %rotate 1
   236                              <1>         %endrep
   237                              <1>     %endif
   238                              <1> %endif
   239                              <1> %endmacro
   240                              <1> 
   241                              <1> ; -----------------------------------------------------------------------------
   242                              <1> ; MAKE_IMPORT <dir_label>, <mod1>, <mod2>, ...
   243                              <1> ; erzeugt:
   244                              <1> ; dir_label:
   245                              <1> ;   dd RVA_IDATA(INT_<mod>), 0,0, RVA_IDATA(dll_<mod>), RVA_IDATA(iat_<mod>) ...
   246                              <1> ;   dd 0,0,0,0,0
   247                              <1> ; dir_label_end:
   248                              <1> ; -----------------------------------------------------------------------------
   249                              <1> %macro MAKE_IMPORT 1-*
   250                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   251                              <1>     EMIT_ERROR 'MAKE_IMPORT is only used for Windows 10+ 64-Bit development.'
   252                              <1> %else
   253                              <1>     %if __pre_stop == 0
   254                              <1>         %define __DIR %1
   255                              <1>         %1:
   256                              <1>         %assign __n %0-1
   257                              <1>         %rep __n
   258                              <1>             dd RVA_IDATA(INT_win32_%2)
   259                              <1>             dd 0,0
   260                              <1>             dd RVA_IDATA(dll_win32_%2)
   261                              <1>             dd RVA_IDATA(iat_win32_%2)
   262                              <1>             %rotate 1
   263                              <1>         %endrep
   264                              <1>             dd 0,0,0,0,0
   265                              <1>         __DIR %+ _end:
   266                              <1>         %undef __DIR
   267                              <1>     %endif
   268                              <1> %endif
   269                              <1> %endmacro
   270                              <1> 
   271                              <1> ; -----------------------------------------------------------------------------
   272                              <1> ; mini helper ...
   273                              <1> ; -----------------------------------------------------------------------------
   274                              <1> %macro WIN64_PROLOG 0
   275                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   276                              <1>     EMIT_ERROR 'This macro is only used for Windows 10+ 64-Bit development.'
   277                              <1> %else
   278                              <1>     %if __pre_stop == 0
   279                              <1>         mov rbp, rsp
   280                              <1>         and rsp, -16
   281                              <1>         AddShadow 32         ; Shadow Space
   282                              <1>     %endif
   283                              <1> %endif
   284                              <1> %endmacro
   285                              <1> 
   286                              <1> %macro CALL_IAT 1        ; CALL_IAT ExitProcess / RegisterClassExW / ...
   287                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   288                              <1>     EMIT_ERROR 'MAKE_IMPORT is only used for Windows 10+ 64-Bit development.'
   289                              <1> %else
   290                              <1>     %if __pre_stop == 0
   291                              <1>         AddShadow
   292                              <1>         mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_%1)
   293                              <1>         call    [rax]
   294                              <1>         DelShadow
   295                              <1>     %endif
   296                              <1> %endif
   297                              <1> %endmacro
   298                              <1> 
   299                              <1> ; -----------------------------------------------------------------------------
   300                              <1> ; zero register's
   301                              <1> ; -----------------------------------------------------------------------------
   302                              <1> %macro Zero 1
   303                              <1>     %if __pre_stop == 0
   304                              <1>         xor %1, %1
   305                              <1>     %endif
   306                              <1> %endmacro
   307                              <1> 
   308                              <1> ; -----------------------------------------------------------------------------
   309                              <1> ; UTF-16LE aus ASCII (<=0x7F) schnell schreiben
   310                              <1> ; -----------------------------------------------------------------------------
   311                              <1> %ifndef WSTR_DEBUG
   312                              <1>     %if __pre_stop == 0
   313                              <1>         %define WSTR_DEBUG 0
   314                              <1>     %endif
   315                              <1> %endif
   316                              <1> 
   317                              <1> ; -----------------------------------------------------------------------------
   318                              <1> ; WSTR <name>, <items...>
   319                              <1> ; items: Strings ("..."), Zahlen (123, 0x41) oder Ausdrücke/Labels
   320                              <1> ; erzeugt:
   321                              <1> ;   _cW_<name>:              dw ... , 0
   322                              <1> ;   _cW_<name>_end:
   323                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   324                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   325                              <1> ; -----------------------------------------------------------------------------
   326                              <1> %macro WSTR 2+
   327                              <1>     %if __pre_stop == 0
   328                              <1>     %push WSTR
   329                              <1> 
   330                              <1>     ; Namen sichern, damit %rotate keine Probleme macht
   331                              <1>     %define _WSTR_LBL   _cW_%1
   332                              <1>     %define _WSTR_END   _cW_%1_end
   333                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   334                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   335                              <1> 
   336                              <1> _WSTR_LBL:
   337                              <1>     ; restliche Argumente abarbeiten
   338                              <1>     %assign %$nargs %0-1
   339                              <1>     %rotate 1
   340                              <1> 
   341                              <1>     %rep %$nargs
   342                              <1>         %ifstr %1
   343                              <1>             %strlen %$n %1
   344                              <1>             %assign %$i 0
   345                              <1>             %rep %$n
   346                              <1>                 %substr %$c %1 %$i+1,1
   347                              <1>                 dw %$c                      ; eine 16-bit Code Unit 0x00xx
   348                              <1>                 %assign %$i %$i+1
   349                              <1>             %endrep
   350                              <1>         %elifnum %1
   351                              <1>             dw %1                           ; Zahl/Konstante
   352                              <1>         %else
   353                              <1>             dw %1                           ; Label/Equate/Expression
   354                              <1>         %endif
   355                              <1>         %rotate 1
   356                              <1>     %endrep
   357                              <1> 
   358                              <1>     dw 0                                    ; Null-Terminator (1 Word)
   359                              <1> 
   360                              <1> _WSTR_END:
   361                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2) ; Länge in BYTES (ohne Terminator)
   362                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)              ; Länge in WORDS
   363                              <1> 
   364                              <1>     ; Aufräumen
   365                              <1>     %undef _WSTR_LBL
   366                              <1>     %undef _WSTR_END
   367                              <1>     %undef _WSTR_LENB
   368                              <1>     %undef _WSTR_LENW
   369                              <1>     %pop
   370                              <1>     %endif      ; __pre_stop
   371                              <1> %endmacro
   372                              <1> ; -----------------------------------------------------------------------------
   373                              <1> ; WSTRU <name>, <items...>
   374                              <1> ; items:
   375                              <1> ;   - "ASCII/Latin-1-Strings"  -> jedes Zeichen als 16-bit Code Unit 0x00xx
   376                              <1> ;   - Zahlen/Expressions        -> als Unicode-Codepoint interpretiert:
   377                              <1> ;                                 <=0xFFFF (außer Surrogatbereich) -> 1 Word
   378                              <1> ;                                 >0xFFFF -> Surrogatpaar (2 Words)
   379                              <1> ; erzeugt:
   380                              <1> ;   _cW_<name>:              dw ..., 0
   381                              <1> ;   _cW_<name>_end:
   382                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   383                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   384                              <1> ; -----------------------------------------------------------------------------
   385                              <1> ; --- Helper: einen Unicode-Codepoint als UTF-16 ausgeben ---
   386                              <1> ; -----------------------------------------------------------------------------
   387                              <1> %macro __WSTR_EMIT_CP 1
   388                              <1>     %if __pre_stop == 0
   389                              <1>         %assign __cp (%1)
   390                              <1> 
   391                              <1>         %if __cp < 0
   392                              <1>             EMIT_ERROR "WSTR: negativer Codepoint"
   393                              <1>         %elif __cp <= 0xFFFF
   394                              <1>             ; verbiete explizite Surrogat-Codepoints
   395                              <1>             %if __cp >= 0xD800 && __cp <= 0xDFFF
   396                              <1>                 EMIT_ERROR "WSTR: Codepoint im Surrogatbereich ist ungueltig"
   397                              <1>             %else
   398                              <1>                 dw __cp
   399                              <1>             %endif
   400                              <1>         %elif __cp <= 0x10FFFF
   401                              <1>             %assign __tmp (__cp - 0x10000)
   402                              <1>             %assign __hi  (0xD800 + (__tmp >> 10))
   403                              <1>             %assign __lo  (0xDC00 + (__tmp & 0x3FF))
   404                              <1>             dw __hi, __lo
   405                              <1>         %else
   406                              <1>             EMIT_ERROR "WSTR: Codepoint > U+10FFFF"
   407                              <1>         %endif
   408                              <1>     %endif
   409                              <1> %endmacro
   410                              <1> 
   411                              <1> ; --- Hauptmakro ---
   412                              <1> %macro WSTRU 2+
   413                              <1>     %if __pre_stop == 0
   414                              <1>     %push WSTRU
   415                              <1> 
   416                              <1>     %define _WSTR_LBL   _cW_%1
   417                              <1>     %define _WSTR_END   _cW_%1_end
   418                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   419                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   420                              <1> 
   421                              <1> _WSTR_LBL:
   422                              <1>     %assign %$nargs %0-1
   423                              <1>     %rotate 1
   424                              <1> 
   425                              <1>     %rep %$nargs
   426                              <1>         %ifstr %1
   427                              <1>             ; String: byteweise -> 0x00xx
   428                              <1>             %strlen %$n %1
   429                              <1>             %assign %$i 0
   430                              <1>             %rep %$n
   431                              <1>                 %substr %$c %1 %$i+1,1
   432                              <1>                 dw %$c
   433                              <1>                 %assign %$i %$i+1
   434                              <1>             %endrep
   435                              <1>         %elifnum %1
   436                              <1>             ; Zahl/Expression als Unicode-Scalar
   437                              <1>             __WSTR_EMIT_CP %1
   438                              <1>         %else
   439                              <1>             ; Label/Expression, zur Sicherheit ebenfalls als Codepoint behandeln
   440                              <1>             __WSTR_EMIT_CP %1
   441                              <1>         %endif
   442                              <1>         %rotate 1
   443                              <1>     %endrep
   444                              <1> 
   445                              <1>     dw 0
   446                              <1> 
   447                              <1> _WSTR_END:
   448                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2)
   449                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)
   450                              <1> 
   451                              <1>     %undef _WSTR_LBL
   452                              <1>     %undef _WSTR_END
   453                              <1>     %undef _WSTR_LENB
   454                              <1>     %undef _WSTR_LENW
   455                              <1>     %pop
   456                              <1>     %endif      ; __pre_stop
   457                              <1> %endmacro
   458                              <1> 
   459                              <1> ; -----------------------------------------------------------------------------
   460                              <1> ; WSTRUL  <name>, <args...>   -> definiert <name> und <name>_len
   461                              <1> ; (in Codeunits, ohne Null)
   462                              <1> ; -----------------------------------------------------------------------------
   463                              <1> %macro WSTR_AND_LEN 2-*
   464                              <1>     %if __pre_stop == 0
   465                              <1>     %push WSTRUL
   466                              <1>     %define %$name %1
   467                              <1> %1:
   468                              <1>     WSTRU %2
   469                              <1> %$name %+ _end:
   470                              <1>     %xdefine %$name %+ _len ( ((%$name %+ _end) - (%$name))/2 - 1 )
   471                              <1>     %pop
   472                              <1>     %endif
   473                              <1> %endmacro
   474                              <1> 
   475                              <1> ; -----------------------------------------------------------------------------
   476                              <1> ; Nach JEDEM vorhandenen Stringlabel einfach:
   477                              <1> ;   <label>_end:   (direkt nach dem String)
   478                              <1> ; und dann:
   479                              <1> ; -----------------------------------------------------------------------------
   480                              <1> %macro WSTR_LENGTH 1
   481                              <1>     %if __pre_stop == 0
   482                              <1>         %xdefine %1_len ( ((%1_end) - (%1))/2 - 1 )
   483                              <1>     %endif
   484                              <1> %endmacro
   485                              <1> 
   486                              <1> %macro AWSTR 1
   487                              <1> %if __pre_stop == 0
   488                              <1>     %push
   489                              <1>     %strlen __n %1
   490                              <1>     %assign __i 0
   491                              <1>     %rep __n
   492                              <1>         %substr __c %1 __i+1,1
   493                              <1>         dw __c
   494                              <1>         %assign __i __i+1
   495                              <1>     %endrep
   496                              <1>         dw 0
   497                              <1>     %pop
   498                              <1> %endif
   499                              <1> %endmacro
   500                              <1> 
   501                              <1> ; -----------------------------------------------------------------------------
   502                              <1> ; \brief String-Definition mit auto *_length (ohne 0-Byte)
   503                              <1> ; \desc  section .data
   504                              <1> ;        ZSTR cap2A, "Hallo", 13, 10
   505                              <1> ;
   506                              <1> ;        ergibt automatisch:
   507                              <1> ;        cap2A          db "Hallo",13,10,0
   508                              <1> ;        cap2A_end:
   509                              <1> ;        %define cap2A_length (cap2A_end - cap2A - 1)
   510                              <1> ; -----------------------------------------------------------------------------
   511                              <1> %macro ASTR 2+                    ; ASTR <name>, <bytes...>
   512                              <1> %if __pre_stop == 0
   513                              <1>     _cA_%1:       db %2, 0
   514                              <1>     _cA_%1_end:
   515                              <1>     _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <1> %endif
   517                              <1> %endmacro
   518                              <1> 
   519                              <1> ; -----------------------------------------------------------------------------
   520                              <1> ; \brief set the string label from %2 to register %1 ...
   521                              <1> ; -----------------------------------------------------------------------------
   522                              <1> %macro GETEXT 2
   523                              <1> %if __pre_stop == 0
   524                              <1>     mov     %1, IMAGE_BASE
   525                              <1>     add     %1, RVA_DATA(_cW_%2)
   526                              <1> %endif
   527                              <1> %endmacro
   528                              <1> 
   529                              <1> ; ------------------------------------------------------------
   530                              <1> ; ---- RVA-Helfer: bleibt wie bei dir ----
   531                              <1> ; %define RVA_DATA(L)   (DATA_VA  + ((L) - data_start))
   532                              <1> ; ------------------------------------------------------------
   533                              <1> ; Optional: einfacher Alias ohne Klammern/EXPR:
   534                              <1> ; ------------------------------------------------------------
   535                              <1> %imacro DATA_ABS 1
   536                              <1> %if __pre_stop == 0
   537                              <1>     IMAGE_BASE + RVA_DATA(%1)
   538                              <1> %endif
   539                              <1> %endmacro
   540                              <1> ; ------------------------------------------------------------
   541                              <1> ; Helfer: absolute VA einer Data-Variable bauen
   542                              <1> ; ------------------------------------------------------------
   543                              <1> %macro DATA_PTR 1
   544                              <1> %if __pre_stop == 0
   545                              <1>     (IMAGE_BASE + RVA_DATA(%1))
   546                              <1> %endif
   547                              <1> %endmacro
   548                              <1> ; ---------------------------------------------------------------------------
   549                              <1> ;; SETDATA <name>, <src> [, <size>]
   550                              <1> ;  - Schreibt <src> an Datenlabel <name>
   551                              <1> ;  - Wenn <size> fehlt, wird die Größe aus <src>-Register abgeleitet
   552                              <1> ;    (al/ax/eax/rax → 8/16/32/64 Bit). Bei Immediate bitte <size> angeben.
   553                              <1> ;  - <size> darf BYTE/WORD/DWORD/QWORD oder 8/16/32/64 sein.
   554                              <1> ; ---------------------------------------------------------------------------
   555                              <1> ;; Beispiele:
   556                              <1> ; last_error: dd 0
   557                              <1> ; orig_attr:  dw 0
   558                              <1> ; flag8:      db 0
   559                              <1> ; ---------------------------------------------------------------------------
   560                              <1> ;; schreiben (Registergröße bestimmt Breite)
   561                              <1> ; mov   eax, 0xDEADBEEF
   562                              <1> ; SETDATA last_error, eax          ; dword write
   563                              <1> ; ---------------------------------------------------------------------------
   564                              <1> ;; schreiben (Immediate -> Größe angeben)
   565                              <1> ; SETDATA orig_attr, 0x000F, WORD  ; word write
   566                              <1> ; SETDATA flag8,     1,      BYTE  ; byte write
   567                              <1> ; ---------------------------------------------------------------------------
   568                              <1> ;; lesen (Registergröße passt)
   569                              <1> ; GETDATA eax, last_error          ; dword read → eax
   570                              <1> ; ---------------------------------------------------------------------------
   571                              <1> ;; lesen (Größe erzwingen)
   572                              <1> ; GETDATA ax,  orig_attr, WORD     ; word read → ax
   573                              <1> ; GETDATA al,  flag8,     BYTE     ; byte read → al
   574                              <1> ; ---------------------------------------------------------------------------
   575                              <1> %macro SET_DATA 1-3
   576                              <1> %if DOS_SHELL == 1
   577                              <1>     %if __pre_stop == 0
   578                              <1>         %if %0 == 2
   579                              <1>             %ifnum %2
   580                              <1>                 section .text
   581                              <1>                 lea ax, [PTR16(_cA_%1)]
   582                              <1>                 mov ax, %2
   583                              <1>             %endif
   584                              <1>         %elif %0 == 3
   585                              <1>             %ifstr %2
   586                              <1>                 %ifndef __var__%1
   587                              <1>                     %define __var__%1 1
   588                              <1>                     section .data
   589                              <1>                     %%__v: db %2, 0
   590                              <1>                 %endif
   591                              <1>             %endif
   592                              <1>             section .text
   593                              <1>             lea ax, [PTR16(_cA_%1)]
   594                              <1>             mov ax, %2
   595                              <1>             jmp %3
   596                              <1>         %endif
   597                              <1>     %endif
   598                              <1> %else
   599                              <1>     %if __pre_stop == 0
   600                              <1>         EMIT_ERROR 'todo'
   601                              <1>     %endif
   602                              <1> %endif
   603                              <1> %endmacro
   604                              <1> %macro SETDATA 2-3
   605                              <1> %if DOS_SHELL == 1
   606                              <1> %else
   607                              <1>     push    rdx
   608                              <1>     mov     rdx, IMAGE_BASE
   609                              <1>     add     rdx, RVA_DATA(%1)
   610                              <1>     %if %0 = 2
   611                              <1>         mov     [%2], rdx
   612                              <1>         pop     rdx
   613                              <1>     %else
   614                              <1>         pop     rdx
   615                              <1>       %ifidni %3, BYTE
   616                              <1>         mov     byte  [rdx], %2
   617                              <1>       %elifidni %3, WORD
   618                              <1>         mov     word  [rdx], %2
   619                              <1>       %elifidni %3, DWORD
   620                              <1>         mov     dword [rdx], %2
   621                              <1>       %elifidni %3, QWORD
   622                              <1>         mov     qword [rdx], %2
   623                              <1>       %elif %3 = 8
   624                              <1>         mov     byte  [rdx], %2
   625                              <1>       %elif %3 = 16
   626                              <1>         mov     word  [rdx], %2
   627                              <1>       %elif %3 = 32
   628                              <1>         mov     dword [rdx], %2
   629                              <1>       %elif %3 = 64
   630                              <1>         mov     qword [rdx], %2
   631                              <1>       %else
   632                              <1>         EMIT_ERROR "SETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   633                              <1>       %endif
   634                              <1>     %endif
   635                              <1> %endif
   636                              <1> %endmacro
   637                              <1> 
   638                              <1> ; ------------------------------------------------------------
   639                              <1> ; GETDATA <dst>, <name> [, <size>]
   640                              <1> ;  - Liest aus Datenlabel <name> in Register <dst>
   641                              <1> ;  - Wenn <size> fehlt, muss <dst> die passende Größe haben
   642                              <1> ;    (al/ax/eax/rax). Sonst <size> angeben (BYTE/WORD/DWORD/QWORD oder 8/16/32/64).
   643                              <1> ; ------------------------------------------------------------
   644                              <1> %macro GETDATA 2-3
   645                              <1>     mov     %1, IMAGE_BASE
   646                              <1>     add     %1, RVA_DATA(%2)
   647                              <1>     %if %0 = 2
   648                              <1>         ;mov     %1, [rdx]
   649                              <1>     %else
   650                              <1>       %ifidni %3, BYTE
   651                              <1>         mov     %1, byte  [rdx]
   652                              <1>       %elifidni %3, WORD
   653                              <1>         mov     %1, word  [rdx]
   654                              <1>       %elifidni %3, DWORD
   655                              <1>         mov     %1, dword [rdx]
   656                              <1>       %elifidni %3, QWORD
   657                              <1>         mov     %1, qword [rdx]
   658                              <1>       %elif %3 = 8
   659                              <1>         mov     %1, byte  [rdx]
   660                              <1>       %elif %3 = 16
   661                              <1>         mov     %1, word  [rdx]
   662                              <1>       %elif %3 = 32
   663                              <1>         mov     %1, dword [rdx]
   664                              <1>       %elif %3 = 64
   665                              <1>         mov     %1, qword [rdx]
   666                              <1>       %else
   667                              <1>         EMIT_ERROR "GETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   668                              <1>       %endif
   669                              <1>     %endif
   670                              <1> %endmacro
   671                              <1> 
   672                              <1> %macro Return 0-1
   673                              <1> %if %0 == 1
   674                              <1>     mov eax, %1
   675                              <1> %else
   676                              <1>     ret
   677                              <1> %endif
   678                              <1> %endmacro
   679                              <1> 
   680                              <1> ; -----------------------------------------------------------------------------
   681                              <1> ; condition jump's after function call -> test eax, eax
   682                              <1> ; -----------------------------------------------------------------------------
   683                              <1> %macro CHECK_NZ 1-2
   684                              <1> %if %0 == 2
   685                              <1>     test eax, eax
   686                              <1>     jnz %1
   687                              <1>     jmp %2
   688                              <1> %else
   689                              <1>     test eax, eax
   690                              <1>     jnz %1
   691                              <1> %endif
   692                              <1> %endmacro
   693                              <1> 
   694                              <1> ; -----------------------------------------------------------------------------
   695                              <1> %macro CHECK_NE 1-2
   696                              <1> %if %0 == 2
   697                              <1>     test eax, eax
   698                              <1>     jne %1
   699                              <1>     jmp %2
   700                              <1> %else
   701                              <1>     test eax, eax
   702                              <1>     jne %1
   703                              <1> %endif
   704                              <1> %endmacro
   705                              <1> 
   706                              <1> ; -----------------------------------------------------------------------------
   707                              <1> %macro CHECK_E 1-2
   708                              <1> %if %0 == 2
   709                              <1>     test eax, eax
   710                              <1>     je  %1
   711                              <1>     jmp %2
   712                              <1> %else
   713                              <1>     test eax, eax
   714                              <1>     je  %1
   715                              <1> %endif
   716                              <1> %endmacro
   717                              <1> 
   718                              <1> ; -----------------------------------------------------------------------------
   719                              <1> ; \brief prolog of a assembler routine + 32 Windows 64 Bit shadow
   720                              <1> ; \param optional shadow at start -> int
   721                              <1> ; -----------------------------------------------------------------------------
   722                              <1> %macro FUNC_ENTER 0-1
   723                              <1> %if %0 == 1
   724                              <1>     AddShadow %1
   725                              <1> %else
   726                              <1>     AddShadow
   727                              <1> %endif
   728                              <1>     push    rbp
   729                              <1>     mov     rbp, rsp
   730                              <1> %endmacro
   731                              <1> 
   732                              <1> ; -----------------------------------------------------------------------------
   733                              <1> ; \brief epilog of a assembler routine - 32 Windows 64 Bit shadow
   734                              <1> ; \param optional shadow at end -> int
   735                              <1> ; -----------------------------------------------------------------------------
   736                              <1> %macro FUNC_LEAVE 0-1
   737                              <1> %if %0 == 1
   738                              <1>     DelShadow %1
   739                              <1> %else
   740                              <1>     DelShadow
   741                              <1> %endif
   742                              <1>     pop     rbp
   743                              <1>     ret
   744                              <1> %endmacro
   745                              <1> 
   746                              <1> ; -----------------------------------------------------------------------------
   747                              <1> ; \brief allocate/open a text console window under Windows 11 desktop.
   748                              <1> ; \param ok  -> label
   749                              <1> ; \param err -> label
   750                              <1> ; \since 1.0
   751                              <1> ;
   752                              <1> ; \return bool - 0 no Error; else Error
   753                              <1> ; -----------------------------------------------------------------------------
   754                              <1> %macro call_AllocConsole 2
   755                              <1> %if DOS_SHELL == 1
   756                              <1>     EMIT_ERROR ERROR_Win32API
   757                              <1> %else
   758                              <1>     CALL_IAT AllocConsole
   759                              <1>     %if %0 == 2
   760                              <1>         CHECK_NZ %1, %2
   761                              <1>     %endif
   762                              <1> %endif
   763                              <1> %endmacro
   764                              <1> 
   765                              <1> ; -----------------------------------------------------------------------------
   766                              <1> ; \brief call the Windows 10 win32api function ExitProcess, to close the thread
   767                              <1> ; -----------------------------------------------------------------------------
   768                              <1> %macro call_ExitProcess 0-1
   769                              <1> %if DOS_SHELL == 1
   770                              <1>     EMIT_ERROR ERROR_Win32API
   771                              <1> %else
   772                              <1>     %if %0 == 1
   773                              <1>         mov rax, %1
   774                              <1>     %else
   775                              <1>         mov rax, 0
   776                              <1>     %endif
   777                              <1>     CALL_IAT ExitProcess
   778                              <1> %endif
   779                              <1> %endmacro
   780                              <1> 
   781                              <1> ; -----------------------------------------------------------------------------
   782                              <1> ; \brief helper function to save source code space for win32api FormatMessageW.
   783                              <1> ; -----------------------------------------------------------------------------
   784                              <1> %macro call_FormatMessageW 0
   785                              <1>     CALL_IAT FormatMessageW
   786                              <1> %endmacro
   787                              <1> 
   788                              <1> ; -----------------------------------------------------------------------------
   789                              <1> ; \brief
   790                              <1> ; -----------------------------------------------------------------------------
   791                              <1> ;macro call_GetConsoleScreenBufferInfo
   792                              <1> ;endmacro
   793                              <1> 
   794                              <1> ; -----------------------------------------------------------------------------
   795                              <1> ; \brief  this macro call the win32api function GetLastError.
   796                              <1> ; \param  nothing
   797                              <1> ; \return ExitCode - int
   798                              <1> ; -----------------------------------------------------------------------------
   799                              <1> %macro call_GetLastError 0
   800                              <1> %if DOS_SHELL == 1
   801                              <1>     EMIT_ERROR ERROR_Win32API
   802                              <1> %else
   803                              <1>     CALL_IAT GetLastError
   804                              <1>     test rax, rax
   805                              <1>     jnz  %%ok
   806                              <1>     AddShadow
   807                              <1>     call HandleLastError
   808                              <1>     DelShadow
   809                              <1> %%ok:
   810                              <1> ;ShowMessageW ShowLastW,capW
   811                              <1> %endif
   812                              <1> %endmacro
   813                              <1> 
   814                              <1> ; -----------------------------------------------------------------------------
   815                              <1> ; \brief  get the standard output device.
   816                              <1> ; \param  ok     -> label
   817                              <1> ; \param  error  -> label
   818                              <1> ; \param  handle -> int
   819                              <1> ; \see    AllocConsole
   820                              <1> ; \since  1.0
   821                              <1> ; \return ?
   822                              <1> ; -----------------------------------------------------------------------------
   823                              <1> %macro call_GetStdHandle 3
   824                              <1> %if DOS_SHELL == 1
   825                              <1>     EMIT_ERROR ERROR_Win32API
   826                              <1> %else
   827                              <1>     mov ecx, %3
   828                              <1>     CALL_IAT GetStdHandle
   829                              <1>     cmp   rax, -1     ; INVALID_HANDLE_VALUE ?
   830                              <1>     je    %%error     ; yes -> error
   831                              <1>     test  rax, rax    ; 0 ?
   832                              <1>     jz    %%error     ; yes -> error
   833                              <1>     ;
   834                              <1>     mov   r12, rax    ; valid handle in rax
   835                              <1>     jmp   %%ok
   836                              <1> %%error:
   837                              <1>     call HandleLastError
   838                              <1>     jmp  %2
   839                              <1> %%ok:
   840                              <1>     jmp  %1
   841                              <1> %endif
   842                              <1> %endmacro
   843                              <1> 
   844                              <1> %macro call_LoadCursorW 0
   845                              <1> %if DOS_SHELL == 1
   846                              <1>     EMIT_ERROR ERROR_Win32API
   847                              <1> %else
   848                              <1>     CALL_IAT LoadCursorW
   849                              <1>     ;ShowMessageW ShowHelloW,capW
   850                              <1>     ;call_GetLastError
   851                              <1> %endif
   852                              <1> %endmacro
   853                              <1> 
   854                              <1> %macro call_LocalFree 0
   855                              <1> %if DOS_SHELL == 1
   856                              <1>     EMIT_ERROR ERROR_Win32API
   857                              <1> %else
   858                              <1>     CALL_IAT MessageBoxW
   859                              <1> %endif
   860                              <1> %endmacro
   861                              <1> 
   862                              <1> ; -----------------------------------------------------------------------------
   863                              <1> ; \brief helper macro to shorten code, and call the win32api MessageBox W
   864                              <1> ; -----------------------------------------------------------------------------
   865                              <1> %macro call_MessageBoxW 0
   866                              <1>     CALL_IAT MessageBoxW
   867                              <1> %endmacro
   868                              <1> 
   869                              <1> ; -----------------------------------------------------------------------------
   870                              <1> ; \brief helper macro to shorten code, and call the win32api function wsprintfW
   871                              <1> ; -----------------------------------------------------------------------------
   872                              <1> %macro call_wsprintfW 0
   873                              <1>     CALL_IAT wsprintfW
   874                              <1> %endmacro
   875                              <1> 
   876                              <1> %macro call_WriteConsoleA 0
   877                              <1> %if DOS_SHELL == 1
   878                              <1>     EMIT_ERROR ERROR_Win32API
   879                              <1> %else
   880                              <1>     CALL_IAT WriteConsoleA
   881                              <1> %endif
   882                              <1> %endmacro
   883                              <1> 
   884                              <1> ; -----------------------------------------------------------------------------
   885                              <1> ; \brief Write - display text on the Windows Console.
   886                              <1> ; \param 1 -> label -> on error
   887                              <1> ; \param 2 -> label -> text to display
   888                              <1> ; \param 3 -> label -> output handle; default is: STD_OUTPUT_HANDLE
   889                              <1> ; \see   AllocConsole
   890                              <1> ; \since 1.0
   891                              <1> ; -----------------------------------------------------------------------------
   892                              <1> %macro call_User_Write 2-3
   893                              <1> %if DOS_SHELL == 1
   894                              <1>     EMIT_ERROR ERROR_Win32API
   895                              <1> %else
   896                              <1> %if %0 == 2
   897                              <1>     call_GetStdHandle %%ok, %1, STD_OUTPUT_HANDLE
   898                              <1> %else
   899                              <1>     call_GetStdHandle %%ok, %1, %3
   900                              <1> %endif
   901                              <1> %%ok:
   902                              <1>     ; --- WriteConsoleA(hOut, fmtHello, hello_len, NULL, NULL) ---
   903                              <1>     mov     rcx, r12                       ; 1. Arg: HANDLE hConsoleOutput
   904                              <1>     mov     rdx, IMAGE_BASE
   905                              <1>     add     rdx, RVA_DATA(%2)              ; 2. Arg: LPCVOID lpBuffer
   906                              <1>     mov     r8d, %2_length                 ; 3. Arg: DWORD nNumberOfCharsToWrite
   907                              <1>     xor     r9d, r9d                       ; lpNumberOfCharsWritten = NULL
   908                              <1>     AddShadow 32 + 8
   909                              <1>     mov     qword [rsp+32], 0              ; 5. Arg: LPVOID lpReserved = NULL
   910                              <1>     call_WriteConsoleA
   911                              <1>     DelShadow 32 + 8
   912                              <1> %endif
   913                              <1> %endmacro
   914                              <1> 
   915                              <1> ; -----------------------------------------------------------------------------
   916                              <1> ; \brief read a string line in console window ...
   917                              <1> ; -----------------------------------------------------------------------------
   918                              <1> %macro call_User_ReadLn 1
   919                              <1>     call user_Console_ReadLn
   920                              <1> %endmacro
   921                              <1> 
   922                              <1> ; -----------------------------------------------------------------------------
   923                              <1> %macro DefWindowProcW 0
   924                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_DefWindowProcW)
   925                              <1> %endmacro
   926                              <1> 
   927                              <1> %macro IAT_CreateWindowExW 0
   928                              <1> %if DOS_SHELL == 1
   929                              <1>     EMIT_ERROR ERROR_Win32API
   930                              <1> %else
   931                              <1>     mov     rax, IMAGE_BASE
   932                              <1>     add     rax, RVA_IDATA(IAT_win32_CreateWindowExW)
   933                              <1>     call    [rax]
   934                              <1> %endif
   935                              <1> %endmacro
   936                              <1> ; -----------------------------------------------------------------------------
   937                              <1> 
   938                              <1> ; -----------------------------------------------------------------------------
   939                              <1> ; \brief  DispatchMessageW
   940                              <1> ; \since  1.0
   941                              <1> ; -----------------------------------------------------------------------------
   942                              <1> %macro DispatchMessageW 0
   943                              <1> %if DOS_SHELL == 1
   944                              <1>     EMIT_ERROR ERROR_Win32API
   945                              <1> %else
   946                              <1>     mov     rcx, rsi
   947                              <1>     CALL_IAT DispatchMessageW
   948                              <1> %endif
   949                              <1> %endmacro
   950                              <1> 
   951                              <1> ; -----------------------------------------------------------------------------
   952                              <1> ; \brief  ExitProcess terminate the given application thread.
   953                              <1> ; \since  1.0
   954                              <1> ; \param  exitcode -> integer
   955                              <1> ; \return exitcode -> rax
   956                              <1> ; -----------------------------------------------------------------------------
   957                              <1> %macro ExitProcess 0-1 0
   958                              <1> %if DOS_SHELL == 1
   959                              <1>     EMIT_ERROR ERROR_Win32API
   960                              <1> %else
   961                              <1>     nop
   962                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   963                              <1>     mov     ecx,%1
   964                              <1>     CALL_IAT ExitProcess
   965                              <1>     ; no return
   966                              <1>     ;DelShadow (32 + 16)
   967                              <1> %endif
   968                              <1> %endmacro
   969                              <1> 
   970                              <1> ; -----------------------------------------------------------------------------
   971                              <1> ; \brief  GetLastError catches the last error that was occured during win32api
   972                              <1> ;         function call.
   973                              <1> ; \since  1.0
   974                              <1> ; \param  nothing
   975                              <1> ; \return ?
   976                              <1> ; -----------------------------------------------------------------------------
   977                              <1> %macro GETLASTERROR 2
   978                              <1>     test    eax, eax
   979                              <1>     %1      %2
   980                              <1> %endmacro
   981                              <1> 
   982                              <1> %macro GetLastError 0
   983                              <1> %if DOS_SHELL == 1
   984                              <1>     EMIT_ERROR ERROR_Win32API
   985                              <1> %else
   986                              <1>     CALL_IAT GetLastError
   987                              <1> %endif
   988                              <1> %endmacro
   989                              <1> 
   990                              <1> ; -----------------------------------------------------------------------------
   991                              <1> ; \brief  GetMessageW
   992                              <1> ; -----------------------------------------------------------------------------
   993                              <1> %macro GetMessageW 0
   994                              <1> %if DOS_SHELL == 1
   995                              <1>     EMIT_ERROR ERROR_Win32API
   996                              <1> %else
   997                              <1>     mov  rcx, rsi
   998                              <1>     Zero edx
   999                              <1>     Zero r8d
  1000                              <1>     Zero r9d
  1001                              <1>     CALL_IAT GetMessageW
  1002                              <1> %endif
  1003                              <1> %endmacro
  1004                              <1> 
  1005                              <1> ; -----------------------------------------------------------------------------
  1006                              <1> ; \brief  LoadCursorW
  1007                              <1> ; \since  1.0
  1008                              <1> ; \param  id - integer: resource id
  1009                              <1> ; -----------------------------------------------------------------------------
  1010                              <1> %macro LoadCursorW 1
  1011                              <1> %if DOS_SHELL == 1
  1012                              <1>     EMIT_ERROR ERROR_Win32API
  1013                              <1> %else
  1014                              <1>     Zero ecx
  1015                              <1>     mov  edx, %1
  1016                              <1>     CALL_IAT LoadCursorW
  1017                              <1> %endif
  1018                              <1> %endmacro
  1019                              <1> 
  1020                              <1> ; -----------------------------------------------------------------------------
  1021                              <1> ; \brief  MESSAGE is a style shortner for better read expierences ...
  1022                              <1> ; -----------------------------------------------------------------------------
  1023                              <1> %macro MESSAGE 2
  1024                              <1>     cmp     edx, %1
  1025                              <1>     je      .%2
  1026                              <1> %endmacro
  1027                              <1> 
  1028                              <1> ; -----------------------------------------------------------------------------
  1029                              <1> ; \brief ShowMessageW display a wide string message on the desktop screen per
  1030                              <1> ;        the wn32api.
  1031                              <1> ; \since 1.0
  1032                              <1> ; \see   ShowMessageA
  1033                              <1> ;
  1034                              <1> ; \param text_str  -> landet in rdx
  1035                              <1> ; \param title_str -> landet in r8
  1036                              <1> ;
  1037                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
  1038                              <1> ; -----------------------------------------------------------------------------
  1039                              <1> %macro ShowMessageW 2-3
  1040                              <1> %if DOS_SHELL == 1
  1041                              <1>     EMIT_ERROR ERROR_Win32API
  1042                              <1> %else
  1043                              <1>     Zero    ecx             ; hWnd = NULL
  1044                              <1>     mov     rdx, PTR64(%1)  ; lpText
  1045                              <1>     mov     r8,  PTR64(%2)  ; lpCaption    
  1046                              <1> %if %0 == 2                 ; %0 = argument count
  1047                              <1>     xor     r9d, r9d        ; uType = MB_OK
  1048                              <1> %else
  1049                              <1>     mov     r9d, %3         ; uType = argument exists
  1050                              <1> %endif
  1051                              <1>     CALL_IAT MessageBoxW
  1052                              <1> %endif
  1053                              <1> %endmacro
  1054                              <1> 
  1055                              <1> ; -----------------------------------------------------------------------------
  1056                              <1> ; \brief ShowMessageA display a ansi string message on the desktop screen per
  1057                              <1> ;        the wn32api.
  1058                              <1> ; \since 1.0
  1059                              <1> ; \see   ShowMessageW
  1060                              <1> ;
  1061                              <1> ; \param text_str  -> landet in rdx
  1062                              <1> ; \param title_str -> landet in r8
  1063                              <1> ;
  1064                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
  1065                              <1> ; -----------------------------------------------------------------------------
  1066                              <1> %macro ShowMessageA 2-3
  1067                              <1> %if DOS_SHELL == 1
  1068                              <1>     EMIT_ERROR ERROR_Win32API
  1069                              <1> %else
  1070                              <1>     Zero    ecx
  1071                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; "MessageBoxW failed"
  1072                              <1>     mov     r8,  IMAGE_BASE + RVA_DATA(_cA_%2)  ; "User32"
  1073                              <1> %if %0 == 2                                     ; %0 = argument count
  1074                              <1>     xor     r9d, r9d                            ; uType = MB_OK
  1075                              <1> %else
  1076                              <1>     mov     r9d, %3                             ; uType = argument exists
  1077                              <1> %endif
  1078                              <1>     CALL_IAT MessageBoxA
  1079                              <1> %endif
  1080                              <1> %endmacro
  1081                              <1> 
  1082                              <1> ; -----------------------------------------------------------------------------
  1083                              <1> ; \brief  ShowWindow shows the window witht the hwnd id in r13.
  1084                              <1> ; \since  1.0
  1085                              <1> ; \param  hwnd -> HWND handle window
  1086                              <1> ; \param  (optional) flag -> integer: default = SW_SHOWDEFAULT
  1087                              <1> ; -----------------------------------------------------------------------------
  1088                              <1> %macro ShowWindow 1-2
  1089                              <1> %if DOS_SHELL == 1
  1090                              <1>     EMIT_ERROR ERROR_Win32API
  1091                              <1> %else
  1092                              <1>     nop
  1093                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
  1094                              <1>     mov     rcx, %1
  1095                              <1> %if %0 == 2
  1096                              <1>     mov     edx, %2
  1097                              <1> %else
  1098                              <1>     mov     edx, SW_SHOWDEFAULT
  1099                              <1> %endif
  1100                              <1>     CALL_IAT ShowWindow
  1101                              <1>     ;DelShadow (32 + 16)
  1102                              <1> %endif
  1103                              <1> %endmacro
  1104                              <1> 
  1105                              <1> ; -----------------------------------------------------------------------------
  1106                              <1> ; \brief display a message box on top of the Windows 11 desktop.
  1107                              <1> ; \param text   -> str
  1108                              <1> ; \param title  -> str
  1109                              <1> ; \param button -> int
  1110                              <1> ; -----------------------------------------------------------------------------
  1111                              <1> %macro call_ShowMessageW 5
  1112                              <1>     ShowMessageW %3, %4, %5
  1113                              <1>     CHECK_NZ %1, %2
  1114                              <1> %endmacro
  1115                              <1> 
  1116                              <1> ; -----------------------------------------------------------------------------
  1117                              <1> ; \brief  TranslateMessage
  1118                              <1> ; \since  1.0
  1119                              <1> ; -----------------------------------------------------------------------------
  1120                              <1> %macro TranslateMessage 0
  1121                              <1> %if DOS_SHELL == 1
  1122                              <1>     EMIT_ERROR ERROR_Win32API
  1123                              <1> %else
  1124                              <1>     mov     rcx, rsi
  1125                              <1>     CALL_IAT TranslateMessage
  1126                              <1> %endif
  1127                              <1> %endmacro
  1128                              <1> 
  1129                              <1> ; -----------------------------------------------------------------------------
  1130                              <1> ; \brief  UpdateWindow refresh the window properties and draw.
  1131                              <1> ; \since  1.0
  1132                              <1> ;
  1133                              <1> ; \see    Invalidate
  1134                              <1> ; \see    Repaint
  1135                              <1> ;
  1136                              <1> ; \param  hwnd -> HWND handle of window to update
  1137                              <1> ; -----------------------------------------------------------------------------
  1138                              <1> %macro UpdateWindow 1
  1139                              <1> %if DOS_SHELL == 1
  1140                              <1>     EMIT_ERROR ERROR_Win32API
  1141                              <1> %else
  1142                              <1>     mov     rcx, %1
  1143                              <1>     CALL_IAT UpdateWindow
  1144                              <1> %endif
  1145                              <1> %endmacro
  1146                              <1> 
  1147                              <1> ; -----------------------------------------------------------------------------
  1148                              <1> ; \brief set the length of a given ASCII string to register ...
  1149                              <1> ; -----------------------------------------------------------------------------
  1150                              <1> %macro SETLEN 2
  1151                              <1>     mov      %1, %2_length
  1152                              <1> %endmacro
  1153                              <1> 
  1154                              <1> ; -----------------------------------------------------------------------------
  1155                              <1> ; \brief write ASCII text on the text Windows console ...
  1156                              <1> ; -----------------------------------------------------------------------------
  1157                              <1> %macro WRITE_CON_A 1-2
  1158                              <1> %if DOS_SHELL == 1
  1159                              <1>     %if %0 == 2
  1160                              <1>         PUTS_COLOR %1, %2
  1161                              <1>     %else
  1162                              <1>         PUTS_COLOR %1, 0x07
  1163                              <1>     %endif
  1164                              <1> %else
  1165                              <1>     ; prepare
  1166                              <1>     xor      eax, eax
  1167                              <1>     mov      rcx, PTR64(_cA_%1)
  1168                              <1>     call     GET_STR_LEN
  1169                              <1>     mov      r14, rax
  1170                              <1>     GET_CON_O_HANDLE r12
  1171                              <1>     mov      rcx, r12
  1172                              <1>     mov      rdx, PTR64(_cA_%1)
  1173                              <1>     mov      r8 , r14
  1174                              <1>     xor      r9d, r9d
  1175                              <1>     mov      qword [rsp+32], 0
  1176                              <1>     CALL_IAT WriteConsoleA
  1177                              <1> %endif
  1178                              <1> %endmacro
  1179                              <1> 
  1180                              <1> ; -----------------------------------------------------------------------------
  1181                              <1> ; \brief read utf-8 text on the text Windows console ...
  1182                              <1> ; \param dst -> buffer for the "readln" text
  1183                              <1> ; -----------------------------------------------------------------------------
  1184                              <1> %macro READL_CON_A 0-1
  1185                              <1> %if DOS_SHELL == 1
  1186                              <1>     %if  %0 == 1
  1187                              <1>         mov  dx, PTR16(_cA_%1)
  1188                              <1>         call DOSReadLn
  1189                              <1>     %else
  1190                              <1>         mov  dx, PTR16(_cA_dos_buffer)
  1191                              <1>         call DOSReadLn
  1192                              <1>     %endif
  1193                              <1> %else
  1194                              <1>     ; prepare
  1195                              <1>     GET_CON_I_HANDLE  r13
  1196                              <1>     ; ReadConsoleA(hIn, inbuf, maxChars, &read, NULL)
  1197                              <1>     mov      rcx, r13
  1198                              <1>     mov      rdx, PTR64(_cA_%1)
  1199                              <1>     mov      r8d, 127           ; maxChars (Reserviere 1 Byte für NUL)
  1200                              <1>     mov      r9 , PTR64(written)
  1201                              <1>     xor      rax, rax           ; lpReserved = NULL (über Shadow Space)
  1202                              <1>     mov      [rsp+32], rax
  1203                              <1>     CALL_IAT ReadConsoleA
  1204                              <1> %endif
  1205                              <1> %endmacro
  1206                              <1> 
  1207                              <1> ; -----------------------------------------------------------------------------
  1208                              <1> ; \brief integer to string
  1209                              <1> ;
  1210                              <1> ; \param number -> register (number to convert)
  1211                              <1> ; \param buffer -> destination buffer
  1212                              <1> ; -----------------------------------------------------------------------------
  1213                              <1> %macro INT2STR 2
  1214                              <1>     mov     edx, %2                             ; number to convert
  1215                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; destination buffer
  1216                              <1>     call    u32_to_dec                          ; buffer -> "12345",0 ; RAX = 5
  1217                              <1> %endmacro
  1218                              <1> 
  1219                              <1> ; -----------------------------------------------------------------------------
  1220                              <1> ; \brief concatenate two strings (%2, %3) to a given string destionation (%1).
  1221                              <1> ; \param dst  -> string buffer
  1222                              <1> ; \param src1 -> string 0-terminated
  1223                              <1> ; \param src2 -> string 0-terminated
  1224                              <1> ; -----------------------------------------------------------------------------
  1225                              <1> %macro STRCPY_ANSI 3
  1226                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)
  1227                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%2)
  1228                              <1>     mov     r8 , IMAGE_BASE + RVA_DATA(_cA_%3)
  1229                              <1>     call    concat_ansi
  1230                              <1> %endmacro
  1231                              <1> %macro STRCAT_ANSI 2-*
  1232                              <1>     %xdefine __DSTSYM (_cA_%1 + 4)
  1233                              <1> 
  1234                              <1>     %rotate 1                     ; ab hier ist %1 der erste src
  1235                              <1>     %rep %0-1
  1236                              <1>         ; --- Ende von dst finden: RDI zeigt nach REPNZ SCASB auf Byte NACH '\0'
  1237                              <1>         mov     rdi, IMAGE_BASE
  1238                              <1>         add     rdi, RVA_DATA(__DSTSYM)
  1239                              <1>         xor     eax, eax          ; AL = 0
  1240                              <1>         mov     rcx, -1
  1241                              <1>         repne   scasb
  1242                              <1>         lea     rcx, [rdi - 1]    ; RCX -> Position des '\0' (Schreibposition)
  1243                              <1> 
  1244                              <1>         ; einen Source anhängen: (s1 = aktueller, s2 = leer)
  1245                              <1>         mov     rdx, PTR64(_cA_%1)
  1246                              <1>         mov     r8 , PTR64(_cA_empty)
  1247                              <1>         call    concat_ansi
  1248                              <1> 
  1249                              <1>         %rotate 1                 ; nächster src
  1250                              <1>     %endrep
  1251                              <1> %endmacro
  1252                              <1> 
  1253                              <1> ; -----------------------------------------------------------------------------
  1254                              <1> ; \brief get the output handle of allocated/open console ...
  1255                              <1> ; \param register to store output handle
  1256                              <1> ; -----------------------------------------------------------------------------
  1257                              <1> %macro GET_CON_O_HANDLE 1
  1258                              <1> %if DOS_SHELL == 1
  1259                              <1>     EMIT_ERROR ERROR_Win32API
  1260                              <1> %else
  1261                              <1>     mov      ecx, STD_OUTPUT_HANDLE
  1262                              <1>     CALL_IAT GetStdHandle
  1263                              <1>     mov      %1, rax         ; hOut
  1264                              <1> %endif
  1265                              <1> %endmacro
  1266                              <1> ; -----------------------------------------------------------------------------
  1267                              <1> ; \brief get the input handle of allocated/open console ...
  1268                              <1> ; \param register to store input handle
  1269                              <1> ; -----------------------------------------------------------------------------
  1270                              <1> %macro GET_CON_I_HANDLE 1
  1271                              <1> %if DOS_SHELL == 1
  1272                              <1>     EMIT_ERROR ERROR_Win32API
  1273                              <1> %else
  1274                              <1>     mov      ecx, STD_INPUT_HANDLE
  1275                              <1>     CALL_IAT GetStdHandle
  1276                              <1>     mov      %1, rax         ; hIn
  1277                              <1> %endif
  1278                              <1> %endmacro
  1279                              <1> 
  1280                              <1> %macro SCREEN_CLEAR 0
  1281                              <1> %if DOS_SHELL == 1
  1282                              <1>     call dos_screen_clear
  1283                              <1> %else
  1284                              <1>     GET_CON_O_HANDLE r12
  1285                              <1>     STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <1>     WRITE_CON_A buffer_B
  1287                              <1> %endif
  1288                              <1> %endmacro
  1289                              <1> 
  1290                              <1> ; -----------------------------------------------------------------------------
  1291                              <1> ; \brief set the cursor position in dos console ...
  1292                              <1> ; \param xpos - <imm>
  1293                              <1> ; \param ypos - <imm>
  1294                              <1> ; -----------------------------------------------------------------------------
  1295                              <1> %macro SET_CURSOR 2
  1296                              <1> %if %0 == 0
  1297                              <1>     EMIT_ERROR 2 argument missing
  1298                              <1> %endif
  1299                              <1> %if DOS_SHELL == 1
  1300                              <1>     mov  dl, %1         ; column
  1301                              <1>     mov  dh, %2         ; row
  1302                              <1>     call dos_set_cursor
  1303                              <1> %else
  1304                              <1> %endif
  1305                              <1> %endmacro
  1306                              <1> 
  1307                              <1> ; -----------------------------------------------------------------------------
  1308                              <1> ; \brief get the cursor position in dos console ...
  1309                              <1> ; -----------------------------------------------------------------------------
  1310                              <1> %macro GET_CURSOR 0
  1311                              <1> %if DOS_SHELL == 1
  1312                              <1>     call dos_get_cursor
  1313                              <1> %else
  1314                              <1>     EMIT_ERROR 'todo: windows'
  1315                              <1> %endif
  1316                              <1> %endmacro
  1317                              <1> 
  1318                              <1> ; -----------------------------------------------------------------------------
  1319                              <1> ; \brief set the color for console window text
  1320                              <1> ; \param 1. background -> int 0..255
  1321                              <1> ; \param 2. foreground -> int 0..255
  1322                              <1> ;
  1323                              <1> ; \desc  color values > 127 == blink chars
  1324                              <1> ; -----------------------------------------------------------------------------
  1325                              <1> %macro SET_COLOR_TO 2
  1326                              <1> %if %0 == 2
  1327                              <1>     STRCPY_ANSI buffer_B, consoleColor_1, empty
  1328                              <1>     STRCAT_ANSI buffer_B,                                     console_color_%1, buffer_semi,                console_color_%2, consoleColor_2
  1331                              <1>     WRITE_CON_A buffer_B
  1332                              <1> %endif
  1333                              <1> %endmacro
  1334                              <1> 
  1335                              <1> ; -----------------------------------------------------------------------------
  1336                              <1> ; \brief 
  1337                              <1> ; -----------------------------------------------------------------------------
  1338                              <1> %macro ARG_CURSOR 2
  1339                              <1> %if DOS_SHELL == 1
  1340                              <1>     GET_ARG  %1             ; save command line argument 1
  1341                              <1>     mov  bl, %2             ; color
  1342                              <1>     call PutStrColor        ; DOS screen
  1343                              <1> %endif
  1344                              <1> %endmacro
  1345                              <1> 
  1346                              <1> ; -----------------------------------------------------------------------------
  1347                              <1> ; \brief macro to put a colored string to the DOS console ...
  1348                              <1> ; -----------------------------------------------------------------------------
  1349                              <1> %macro PUTS_COLOR 2
  1350                              <1> %if DOS_SHELL == 1
  1351                              <1>     ;GET_CURSOR              ; move cursor to col:row
  1352                              <1>     %ifstr %1
  1353                              <1>         section .data
  1354                              <1>         %%msg: db %1, 0
  1355                              <1>         section .text
  1356                              <1>         xor  bx, bx
  1357                              <1>         mov  bl, %2                 ; color
  1358                              <1>         mov  si, PTR16(%%msg)       ; text 0-terminated
  1359                              <1>         call PutStrColor            ; DOS screen
  1360                              <1>     %elifidni %1, SI            ; text is already in SI
  1361                              <1>         section .text
  1362                              <1>         mov  bl, %2
  1363                              <1>         call PutStrColor        ; DOS screen
  1364                              <1>     %elifidni %1, DI            ; text is already in DI
  1365                              <1>         section .text
  1366                              <1>         mov  bl, %2             ; color
  1367                              <1>         call PutStrColor        ; DOS screen
  1368                              <1>     %else
  1369                              <1>         %assign __count 0
  1370                              <1>         %assign __varg  0
  1371                              <1>         %assign __stop  0
  1372                              <1>         %rep MAX_ARGV
  1373                              <1>             %if __stop == 0
  1374                              <1>                 %assign __count (__count + 1)
  1375                              <1>                 %ifidni %1, ARGV_%+__count
  1376                              <1>                     %assign __varg __count
  1377                              <1>                     %assign __stop 1
  1378                              <1>                 %endif
  1379                              <1>             %endif
  1380                              <1>         %endrep
  1381                              <1>         %if __varg > 0
  1382                              <1>             section .text
  1383                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1384                              <1>             mov  bl, __varg
  1385                              <1>             call getCommandLine_Arg
  1386                              <1>             call PutStrColor        ; DOS screen
  1387                              <1>         %else
  1388                              <1>             section .text
  1389                              <1>             mov  bl, %2             ; color
  1390                              <1>             mov  ax, PTR16(_cA_%1)  ; text 0-terminated
  1391                              <1>             mov  si, ax
  1392                              <1>             call PutStrColor        ; DOS screen
  1393                              <1>         %endif
  1394                              <1>         %undef __varg
  1395                              <1>     %endif
  1396                              <1> %else
  1397                              <1>     EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <1> %endif
  1399                              <1> %endmacro
  1400                              <1> 
  1401                              <1> ; -----------------------------------------------------------------------------
  1402                              <1> ; \brief  get the length of given label string
  1403                              <1> ; \param  1. label name/addr
  1404                              <1> ; \return CX = length of string
  1405                              <1> ; -----------------------------------------------------------------------------
  1406                              <1> %macro STRLEN 1
  1407                              <1> %if %0 == 1
  1408                              <1>     mov  si, PTR16(_cA_%1)
  1409                              <1>     call DOSStrLen
  1410                              <1>     mov  ax, cx             ; AX = length
  1411                              <1>     add  cx, 1              ; CX = length + 1
  1412                              <1> %else
  1413                              <1>     EMIT_ERROR 'exactly one argument expected.'
  1414                              <1> %endif
  1415                              <1> %endmacro
  1416                              <1> 
  1417                              <1> ; -----------------------------------------------------------------------------
  1418                              <1> ; \brief  helper macro save code resources.
  1419                              <1> ; \desc   return to DOS with exit code
  1420                              <1> ; \param  1. exit code value (0..255).
  1421                              <1> ; \return nothing
  1422                              <1> ; -----------------------------------------------------------------------------
  1423                              <1> %macro DOS_Exit 1
  1424                              <1> %if DOS_SHELL == 1
  1425                              <1>     %ifidni   %1, ax
  1426                              <1>         EMIT_ERROR 'AX not allowed here.'
  1427                              <1>     %elifidni %1, bx
  1428                              <1>         mov ax, 0x4C00
  1429                              <1>         or  ax, bx
  1430                              <1>         SysCall
  1431                              <1>     %elifidni %1, CX
  1432                              <1>         mov ax, 0x4C00
  1433                              <1>         or  ax, cx
  1434                              <1>         SysCall
  1435                              <1>     %elifidni %1, dx
  1436                              <1>         mov ax, 0x4C00
  1437                              <1>         or  ax, dx
  1438                              <1>         SysCall
  1439                              <1>     %elifnum  %1
  1440                              <1>         mov  ax, 0x4C00 | %1
  1441                              <1>         SysCall
  1442                              <1>     %else
  1443                              <1>         EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <1>     %endif
  1445                              <1> %endif
  1446                              <1> %endmacro
  1447                              <1> 
  1448                              <1> ; -----------------------------------------------------------------------------
  1449                              <1> ; \brief  print a CRLF on DOS console
  1450                              <1> ; \param  nothing
  1451                              <1> ; \return nothing
  1452                              <1> ; -----------------------------------------------------------------------------
  1453                              <1> %macro DOS_crlf 0
  1454                              <1>     call DOSrncrlf
  1455                              <1> %endmacro
  1456                              <1> 
  1457                              <1> ; -----------------------------------------------------------------------------
  1458                              <1> ; \brief write a string in DX to DOS console without "lf", and no "cr" ...
  1459                              <1> ; \param 1. DX - src label
  1460                              <1> ; \see   DOS_WriteLn
  1461                              <1> ; -----------------------------------------------------------------------------
  1462                              <1> %macro DOS_Write 1
  1463                              <1>     lea  dx, [PTR16(_cA_%1)]
  1464                              <1>     call DOS_ConsoleWrite
  1465                              <1> %endmacro
  1466                              <1> 
  1467                              <1> ; -----------------------------------------------------------------------------
  1468                              <1> ; \brief write a string in DX to DOS console with "lf", and "cr" ...
  1469                              <1> ; \param 1. DX - src label
  1470                              <1> ; \see   DOS_Write
  1471                              <1> ; -----------------------------------------------------------------------------
  1472                              <1> %macro DOS_WriteLn 1
  1473                              <1>     DOS_Write %1
  1474                              <1>     DOS_crlf
  1475                              <1> %endmacro
  1476                              <1> 
  1477                              <1> ; -----------------------------------------------------------------------------
  1478                              <1> ; \brief allocate memory for/in the DOS console ...
  1479                              <1> ; \param 1. count paragraphs
  1480                              <1> ; \note  calculate with: 4096 / 16 = 256 (4096 is a example !)
  1481                              <1> ; -----------------------------------------------------------------------------
  1482                              <1> %macro DOS_AllocMem 1
  1483                              <1> %if DOS_SHELL == 1
  1484                              <1>     mov  ax, 4800h      ; AH = 48h -> Allocate Memory Block
  1485                              <1>     mov  bx, %1         ; Paragraph-Anzahl
  1486                              <1>     SysCall
  1487                              <1>     
  1488                              <1>     sbb  ax, ax
  1489                              <1>     cmp  ax, 0
  1490                              <1>     je   %%.successful
  1491                              <1>     
  1492                              <1>     cmp  ax, 0xFF
  1493                              <1>     je   %%.fail        ; CF = 1 -> error, AX = error code
  1494                              <1>     
  1495                              <1>     jmp  %%.fail
  1496                              <1>     
  1497                              <1>     %%.successful:
  1498                              <1>     ; AX = Segment des Blocks
  1499                              <1>     mov  es, ax
  1500                              <1>     xor  di, di
  1501                              <1>     
  1502                              <1>     ; Block mit 0x00 füllen
  1503                              <1>     mov  cx, 4096
  1504                              <1>     mov  al, 0x00
  1505                              <1>     rep  stosb          ; write to ES:DI
  1506                              <1>     
  1507                              <1>     ; demo read access: AL = ES:[1234]
  1508                              <1>     ;mov  di, 1234
  1509                              <1>     ;mov  al, [es:di]
  1510                              <1>     
  1511                              <1>     jmp   %%.next
  1512                              <1>     
  1513                              <1>     %%.fail:
  1514                              <1>     DOS_WriteLn msg_alloc_error
  1515                              <1>     DOS_Exit    1
  1516                              <1>     
  1517                              <1>     %%.next:
  1518                              <1> %endif
  1519                              <1> %endmacro
  1520                              <1> 
  1521                              <1> %macro DOS_FreeMem 0
  1522                              <1> %if DOS_SHELL == 1
  1523                              <1>     mov es, ax
  1524                              <1>     mov ah, 0x49
  1525                              <1>     SysCall
  1526                              <1> %else
  1527                              <1>     EMIT_ERROR 'todo: windows'
  1528                              <1> %endif
  1529                              <1> %endmacro
  1530                              <1> 
  1531                              <1> ; -----------------------------------------------------------------------------
  1532                              <1> ; \brief COMPARE <reg>, <imm>, <label>
  1533                              <1> ; \param 1. <reg>
  1534                              <1> ; \param 2. <imm>
  1535                              <1> ; \param 3. <label>
  1536                              <1> ; \note  example: COMPARE al, 0x0a, printed
  1537                              <1> ;        result:  cmp <reg>, <imm>  /  je <label>
  1538                              <1> ; -----------------------------------------------------------------------------
  1539                              <1> %macro COMPARE 3
  1540                              <1>     cmp %1, %2
  1541                              <1>     je  %3
  1542                              <1> %endmacro
  1543                              <1> 
  1544                              <1> ; -----------------------------------------------------------------------------
  1545                              <1> ; \brief  get the n-th command line, success: jump to %2 ...
  1546                              <1> ; \param  1. <imm>
  1547                              <1> ; \return SI = text (=argument)
  1548                              <1> ; \note   example: GET_ARG 2
  1549                              <1> ;         result:  <text> in SI
  1550                              <1> ; -----------------------------------------------------------------------------
  1551                              <1> %macro GET_ARG 1-2
  1552                              <1> %if DOS_SHELL == 1
  1553                              <1>     lea  si, [PTR16(_cA_cmd_buf)]
  1554                              <1>     mov  bl, %1
  1555                              <1>     call getCommandLine_Arg
  1556                              <1>     %if %0 == 2
  1557                              <1>         jnc  %2
  1558                              <1>     %endif
  1559                              <1> %else
  1560                              <1>     EMIT_ERROR 'todo: windows'
  1561                              <1> %endif
  1562                              <1> %endmacro
  1563                              <1> 
  1564                              <1> ; -----------------------------------------------------------------------------
  1565                              <1> ; \brief save the n-th command line argument to the <label>
  1566                              <1> ; \param 1. <imm> -> n-th argument number
  1567                              <1> ; \param 2. <label>
  1568                              <1> ; \note  example: SET_ARG <imm>, <label>
  1569                              <1> ; -----------------------------------------------------------------------------
  1570                              <1> %macro SET_ARG 1-2
  1571                              <1> %if DOS_SHELL == 1
  1572                              <1>     %if %0 == 1
  1573                              <1>         GET_ARG  %1
  1574                              <1>         STR_COPY _cA_cmd_arg_%1
  1575                              <1>     %else
  1576                              <1>         GET_ARG  %1
  1577                              <1>         STR_COPY _cA_%2
  1578                              <1>     %endif
  1579                              <1> %else
  1580                              <1>     EMIT_ERROR 'todo: windows'
  1581                              <1> %endif
  1582                              <1> %endmacro
  1583                              <1> 
  1584                              <1> ; -----------------------------------------------------------------------------
  1585                              <1> ; \brief copy a string from source index SI to DI <label>
  1586                              <1> ; \param 1. <label>
  1587                              <1> ; \note  example: STR_COPY <label>
  1588                              <1> ; -----------------------------------------------------------------------------
  1589                              <1> %macro STR_COPY 1
  1590                              <1> %if DOS_SHELL == 1
  1591                              <1>     lea  di, [%1]       ; ES wird in string_copy gesetzt
  1592                              <1>     call string_copy    ; kommt zurück mit SI = Zielstart
  1593                              <1> %else
  1594                              <1>     EMIT_ERROR 'todo: windows'
  1595                              <1> %endif
  1596                              <1> %endmacro
  1597                              <1> 
  1598                              <1> ; -----------------------------------------------------------------------------
  1599                              <1> ; \brief short'ner to get the command line arguments given by the user input.
  1600                              <1> ; \brief initialize a console application ...
  1601                              <1> ; \param nothing
  1602                              <1> ; -----------------------------------------------------------------------------
  1603                              <1> %macro INIT_COMMAND_LINE 0
  1604                              <1> %if DOS_SHELL == 1
  1605                              <1>     call dos_get_command_line
  1606                              <1> %else
  1607                              <1>     EMIT_ERROR 'todo: windows'
  1608                              <1> %endif
  1609                              <1> %endmacro
  1610                              <1> 
  1611                              <1> ; -----------------------------------------------------------------------------
  1612                              <1> ; \brief call the DOS console initialize routine ...
  1613                              <1> ; -----------------------------------------------------------------------------
  1614                              <1> %macro INIT_CONSOLE 0
  1615                              <1> %if DOS_SHELL == 1
  1616                              <1>     call dos_init_console
  1617                              <1>     SCREEN_CLEAR
  1618                              <1> %else
  1619                              <1>     call init_app
  1620                              <1>     call init_console
  1621                              <1> %endif
  1622                              <1> %endmacro
  1623                              <1> 
  1624                              <1> ; -----------------------------------------------------------------------------
  1625                              <1> ; \brief generischer Handler für einen Fehlercode ...
  1626                              <1> ; -----------------------------------------------------------------------------
  1627                              <1> %macro DEF_ERROR 2
  1628                              <1> _h%1:
  1629                              <1>     PUTS_COLOR %2, ATTR_DOS_ERROR
  1630                              <1>     mov   cx, %1
  1631                              <1>     jmp   _open_exit
  1632                              <1> %endmacro
  1633                              <1> 
  1634                              <1> ; -----------------------------------------------------------------------------
  1635                              <1> ; \brief DOS seek to <origin> in file <handle> ...
  1636                              <1> ; \param 1. <file handle>
  1637                              <1> ; \param 2. <origin> 0 - begin of file, 1 - current position, 2 - end of file
  1638                              <1> ; -----------------------------------------------------------------------------
  1639                              <1> %macro DOS_Seek 2
  1640                              <1> %if DOS_SHELL == 1
  1641                              <1>     mov  bx, [PTR16(_cA_%1)]
  1642                              <1>     xor  cx, cx
  1643                              <1>     xor  dx, dx
  1644                              <1>     mov  ah, 0x42               ; move to ...
  1645                              <1>     mov  al, %2
  1646                              <1>     SysCall
  1647                              <1> %else
  1648                              <1>     EMIT_ERROR 'todo: windows'
  1649                              <1> %endif
  1650                              <1> %endmacro
  1651                              <1> 
  1652                              <1> ; -----------------------------------------------------------------------------
  1653                              <1> ; \brief DOS open existing <file name>
  1654                              <1> ; \param 1. <file name>
  1655                              <1> ; \param 2. <open mode> - DOS_READ_ONLY, DOW_WRITE_ONLY, DOS_READWRITE
  1656                              <1> ; -----------------------------------------------------------------------------
  1657                              <1> %macro DOS_Open 2
  1658                              <1> %if DOS_SHELL == 1
  1659                              <1>     mov  dx, PTR16(_cA_%1)
  1660                              <1>     mov  ah, 0x3D               ; open existing file
  1661                              <1>     mov  al, %2                 ; read-only
  1662                              <1>     SysCall
  1663                              <1> %else
  1664                              <1>     EMIT_ERROR 'todo: windows'
  1665                              <1> %endif
  1666                              <1> %endmacro
  1667                              <1> 
  1668                              <1> %macro DOS_Close 2
  1669                              <1> %if DOS_SHELL == 1
  1670                              <1>     mov  bx, [PTR16(_cA_%1)]
  1671                              <1>     or   bx, bx
  1672                              <1>     jz   %2
  1673                              <1>     mov  ah, 3Eh
  1674                              <1>     SysCall
  1675                              <1> %else
  1676                              <1>     EMIT_ERROR 'todo: windows'
  1677                              <1> %endif
  1678                              <1> %endmacro
  1679                              <1> 
  1680                              <1> ; -----------------------------------------------------------------------------
  1681                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1682                              <1> ; erzeugt für jedes Argument:
  1683                              <1> ; _cA_errn<arg>:
  1684                              <1> ;     PUTS_COLOR open_error_<arg>, ATTR_DOS_ERROR
  1685                              <1> ;     mov cx, <arg>
  1686                              <1> ;     jmp _open_exit
  1687                              <1> ; -----------------------------------------------------------------------------
  1688                              <1> ; Hilfsmakro: Nibble (0..15) -> Hex-Zeichen 0..F
  1689                              <1> %macro _HEXDIG 2
  1690                              <1>   %if %1 < 10
  1691                              <1>     %define %2 %1
  1692                              <1>   %elif %1 = 10
  1693                              <1>     %define %2 A
  1694                              <1>   %elif %1 = 11
  1695                              <1>     %define %2 B
  1696                              <1>   %elif %1 = 12
  1697                              <1>     %define %2 C
  1698                              <1>   %elif %1 = 13
  1699                              <1>     %define %2 D
  1700                              <1>   %elif %1 = 14
  1701                              <1>     %define %2 E
  1702                              <1>   %elif %1 = 15
  1703                              <1>     %define %2 F
  1704                              <1>   %else
  1705                              <1>     EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <1>   %endif
  1707                              <1> %endmacro
  1708                              <1> ; -----------------------------------------------------------------------------
  1709                              <1> ; expr -> zwei Hex-Zeichen OUT_H/OUT_L (ohne 0x/h), 8-bit
  1710                              <1> ; -----------------------------------------------------------------------------
  1711                              <1> %macro _HEX2 3
  1712                              <1>   %assign __v %1
  1713                              <1>   %assign __v __v & 0FFh
  1714                              <1>   %assign __hi (__v >> 4) & 0Fh
  1715                              <1>   %assign __lo  __v       & 0Fh
  1716                              <1>   _HEXDIG __hi, %2
  1717                              <1>   _HEXDIG __lo, %3
  1718                              <1>   %undef __v
  1719                              <1>   %undef __hi
  1720                              <1>   %undef __lo
  1721                              <1> %endmacro
  1722                              <1> ; -----------------------------------------------------------------------------
  1723                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1724                              <1> ; Baut Labels / Namen mit zwei Hex-Ziffern (00..FF), ohne 0x/h.
  1725                              <1> ; -----------------------------------------------------------------------------
  1726                              <1> %macro ERR_HANDLER 1-*
  1727                              <1> %rep %0
  1728                              <1>     ; Ausdruck auswerten (dezimal/hex ok) und auf 8 Bit begrenzen
  1729                              <1>     %assign __v %1
  1730                              <1>     %assign __v __v & 0FFh
  1731                              <1> 
  1732                              <1>     ; zwei Hex-Ziffern bilden
  1733                              <1>     %assign __hi (__v >> 4) & 0Fh
  1734                              <1>     %assign __lo  __v       & 0Fh
  1735                              <1>     _HEXDIG __hi, __H
  1736                              <1>     _HEXDIG __lo, __L
  1737                              <1> 
  1738                              <1> _cA_errh%+__H%+__L:
  1739                              <1>     PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <1>     mov cx, %1
  1741                              <1>     jmp _open_exit
  1742                              <1>     
  1743                              <1>     ; Aufräumen der temporären Namen dieser Iteration
  1744                              <1>     %undef __H
  1745                              <1>     %undef __L
  1746                              <1>     %undef __hi
  1747                              <1>     %undef __lo
  1748                              <1>     %undef __v
  1749                              <1>     
  1750                              <1>     %rotate 1
  1751                              <1> %endrep
  1752                              <1> %endmacro
  1753                              <1> ; -----------------------------------------------------------------------------
  1754                              <1> ; Für jeden Code: Label _cA_errhXX + Body
  1755                              <1> ;
  1756                              <1> ; ---------- Tabelle (Datenbereich) ----------
  1757                              <1> ; ERZEUGT: 
  1758                              <1> ;   _cA_error_dispatch:
  1759                              <1> ;       dw <code>, _cA_errhXX
  1760                              <1> ;       ...
  1761                              <1> ;       dw 00h, _cA_errhnd
  1762                              <1> ; -----------------------------------------------------------------------------
  1763                              <1> %macro ERR_ITEMS 1-*
  1764                              <1> _cA_error_dispatch:
  1765                              <1>   %rep %0
  1766                              <1>     _HEX2 %1, __H, __L
  1767                              <1>     dw %1, _cA_errh%+__H%+__L
  1768                              <1>     %undef __H
  1769                              <1>     %undef __L
  1770                              <1>     %rotate 1
  1771                              <1>   %endrep
  1772                              <1>   dw 00h, _cA_errhnd
  1773                              <1> %endmacro
  1774                              <1> 
  1775                              <1> ; -----------------------------------------------------------------------------
  1776                              <1> ; \brief check a character at the given position in given label string...
  1777                              <1> ; CMP_CHR <label>, <num-position>, <char to check>, <jump label if equal>
  1778                              <1> ; CMP_CHR argvn, 2, '3', is_three
  1779                              <1> ; -----------------------------------------------------------------------------
  1780                              <1> %macro CMP_CHR 4
  1781                              <1>     %ifstr %1
  1782                              <1>         section .data
  1783                              <1>         %%msg: db %1, 0
  1784                              <1>         section .text
  1785                              <1>         lea si, [PTR16(%%msg)]       ; text 0-terminated
  1786                              <1>     %else
  1787                              <1>     section .text
  1788                              <1>         %assign __count 0
  1789                              <1>         %assign __varg  0
  1790                              <1>         %assign __stop  0
  1791                              <1>         %rep MAX_ARGV
  1792                              <1>             %if __stop == 0
  1793                              <1>                 %assign __count (__count + 1)
  1794                              <1>                 %ifidni %1, ARGV_%+__count
  1795                              <1>                     %assign __varg __count
  1796                              <1>                     %assign __stop 1
  1797                              <1>                 %endif
  1798                              <1>             %endif
  1799                              <1>         %endrep
  1800                              <1>         %if __varg > 0
  1801                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1802                              <1>             mov  bl, __varg
  1803                              <1>             call getCommandLine_Arg
  1804                              <1>         %else
  1805                              <1>             lea si, [PTR16(_cA_%1)]
  1806                              <1>         %endif
  1807                              <1>         %undef __stop
  1808                              <1>         %undef __varg
  1809                              <1>     %endif
  1810                              <1>         xor  cl, cl
  1811                              <1>         push si
  1812                              <1>     %%loop:
  1813                              <1>         lodsb
  1814                              <1>         inc cl
  1815                              <1>         cmp cl, %2
  1816                              <1>         je  %%next
  1817                              <1>         jmp %%loop
  1818                              <1>     %%next:
  1819                              <1>         pop si
  1820                              <1>         cmp al, %3
  1821                              <1>         je  %4
  1822                              <1> %endmacro
  1823                              <1> 
  1824                              <1> %macro SAVE 1
  1825                              <1>     %if __pre_stop == 0
  1826                              <1>         push %1
  1827                              <1>     %endif
  1828                              <1> %endmacro
  1829                              <1> %macro RESTORE 1
  1830                              <1>     %if __pre_stop == 0
  1831                              <1>         pop  %1
  1832                              <1>     %endif
  1833                              <1> %endmacro
  1834                              <1> 
  1835                              <1> ; -----------------------------------------------------------------------------
  1836                              <1> ; \brief LEA.w introduce a 16-Bit (word) LEA - load effective address.
  1837                              <1> ; \note  With this directive, you dont need anymore to give the IMNAGE BASE to
  1838                              <1> ;        the addressing mode. It use the %macro  PTR16(<label>).
  1839                              <1> ; \note  This macro is case-insensitive
  1840                              <1> ; \see   %macro PTR16
  1841                              <1> ; -----------------------------------------------------------------------------
  1842                              <1> %imacro lea.w 2
  1843                              <1> %if DOS_SHELL == 1      ; compilation for DOS 16-Bit ?
  1844                              <1>     %if __pre_stop == 0
  1845                              <1>         %undef __prefix     ; reset
  1846                              <1>         %undef __suffix     ; ...
  1847                              <1>         %ifidni %1, SI
  1848                              <1>             %define __prefix si
  1849                              <1>         %elifidni %1, DI
  1850                              <1>             %define __prefix di
  1851                              <1>         %else
  1852                              <1>             EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <1>         %endif
  1854                              <1>         %ifndef __prefix
  1855                              <1>             %assign __pre_stop 1
  1856                              <1>         %endif
  1857                              <1>         %if __pre_stop == 0
  1858                              <1>             %xdefine __s %str(%2)
  1859                              <1>             %xdefine __n %strlen(__s)
  1860                              <1>             %if __n >= 2
  1861                              <1>                 %xdefine __fst %substr(__s,0,1)
  1862                              <1>                 %xdefine __lst %substr(__s,__n,1)
  1863                              <1>                 %ifidn __fst, '['
  1864                              <1>                     %ifidn __lst, ']'
  1865                              <1>                         %xdefine __inner %substr(__s,2,__n-2)
  1866                              <1>                         %xdefine __tok   %tok(__inner)
  1867                              <1>                         %define __suffix [PTR16(__tok)]
  1868                              <1>                             lea __prefix, __suffix
  1869                              <1>                     %else
  1870                              <1>                         EMIT_ERROR 'closed bracket missing.'
  1871                              <1>                     %endif
  1872                              <1>                 %else
  1873                              <1>                     EMIT_ERROR 'missing brackets.'
  1874                              <1>                     ; todo
  1875                              <1>                 %endif
  1876                              <1>             %else
  1877                              <1>                 EMIT_ERROR 'directive too short.'
  1878                              <1>             %endif
  1879                              <1>         %endif
  1880                              <1>     %endif
  1881                              <1> %else
  1882                              <1>     EMIT_ERROR 'todo: windows'
  1883                              <1> %endif
  1884                              <1> %endmacro
  1885                              <1> 
  1886                              <1> ; -----------------------------------------------------------------------------
  1887                              <1> ; \brief MOV.w introduce a 16-Bit (word) MOV.
  1888                              <1> ; \note  With this directive, you dont need anymore to give the IMNAGE BASE to
  1889                              <1> ;        the addressing mode. It use the %macro  PTR16(<label>).
  1890                              <1> ; \note  This macro is case-insensitive
  1891                              <1> ; \see   %macro PTR16
  1892                              <1> ; -----------------------------------------------------------------------------
  1893                              <1> %imacro mov.w 2
  1894                              <1> %if DOS_SHELL == 1
  1895                              <1>     %if __pre_stop == 0
  1896                              <1>         %ifidni %1, BL
  1897                              <1>             %ifid %2
  1898                              <1>                 mov bl, PTR16(_cA_%2)
  1899                              <1>             %endif
  1900                              <1>         %endif
  1901                              <1>     %endif
  1902                              <1> %else
  1903                              <1>     %if __pre_stop == 0
  1904                              <1>         EMIT_ERROR 'todo: windows'
  1905                              <1>     %endif
  1906                              <1> %endif
  1907                              <1> %endmacro
  1908                              <1> 
  1909                              <1> ; -----------------------------------------------------------------------------
  1910                              <1> ; \brief STR_CMP - compare 2 string's ...
  1911                              <1> ; \note  Examples:
  1912                              <1> ;            STR_CMP ARGV_1, ARGV_2, is_version_2
  1913                              <1> ;            STR_CMP ARGV_1, 'abcd', is_version_3
  1914                              <1> ;            STR_CMP ARGV_2, '1234', is_version_4
  1915                              <1> ;            STR_CMP "abcd", "abcd", is_version_5
  1916                              <1> ; -----------------------------------------------------------------------------
  1917                              <1> %macro STR_STR_HELPER 1
  1918                              <1>     %if __pre_stop == 0
  1919                              <1>         section .text
  1920                              <1>         call string_compare
  1921                              <1>         cmp  al, 0
  1922                              <1>         jne  %%jum4
  1923                              <1>         call %1
  1924                              <1>         %%jum4:
  1925                              <1>     %endif
  1926                              <1> %endmacro
  1927                              <1> %macro STR_ARG_HELPER 1-2
  1928                              <1>     %if __pre_stop == 0
  1929                              <1>         section  .text
  1930                              <1>         SAVE si
  1931                              <1>         %if %0 == 2
  1932                              <1>             lea.w si, [_cA_%1]
  1933                              <1>             mov  bl, %2
  1934                              <1>         %elif %0 == 1
  1935                              <1>             lea.w si, [_cA_cmd_buf]
  1936                              <1>             mov  bl, %1
  1937                              <1>         %else
  1938                              <1>             EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <1>             %assign __pre_stop 1
  1940                              <1>         %endif
  1941                              <1>         call getCommandLine_Arg
  1942                              <1>         mov  di, si
  1943                              <1>         RESTORE  si
  1944                              <1>     %endif
  1945                              <1> %endmacro
  1946                              <1> %macro STR_CMP 3
  1947                              <1>     %if __pre_stop == 0
  1948                              <1>         %ifnum %1                           ; argument 1 is a number ?
  1949                              <1>             EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <1>             %assign __pre_stop 1
  1951                              <1>         %elifstr %1                         ; argument 1 is a string ?
  1952                              <1>             section .data
  1953                              <1>             %%part1: db %1, 0
  1954                              <1>             section .text
  1955                              <1>             lea.w si, [%%part1]
  1956                              <1>             %ifid %2
  1957                              <1>                 GET_VARGS %2, __vargs
  1958                              <1>                 %if __vargs > 0
  1959                              <1>                     STR_ARG_HELPER __vargs
  1960                              <1>                     STR_STR_HELPER %3
  1961                              <1>                 %endif
  1962                              <1>             %elifstr %2                     ; argument 2 is a string ?
  1963                              <1>                 section .data
  1964                              <1>                 %%part2: db %1, 0
  1965                              <1>                 section .text
  1966                              <1>                 LEA.w  DI, [%%part2]        ; dst
  1967                              <1>                 STR_STR_HELPER %3
  1968                              <1>             %elifnum %2                     ; argument 2 is a number ?
  1969                              <1>                 EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <1>                 %assign __pre_stop 1
  1971                              <1>             %else
  1972                              <1>                 EMIT_ERROR 'todo'
  1973                              <1>                 %assign __pre_stop 1
  1974                              <1>             %endif
  1975                              <1>         %elifid %1
  1976                              <1>             %assign __varg1 0
  1977                              <1>             %assign __varg2 0
  1978                              <1>             GET_VARGS %1, _varg1
  1979                              <1>             %ifid %2
  1980                              <1>                 GET_VARGS %2, _varg2
  1981                              <1>                 %if __varg1 > 0
  1982                              <1>                     %if __varg2 > 0
  1983                              <1>                         STR_ARG_HELPER __varg1
  1984                              <1>                         STR_ARG_HELPER __varg2
  1985                              <1>                         STR_STR_HELPER %3
  1986                              <1>                     %else
  1987                              <1>                         LEA.w DI, [_cA_%2]
  1988                              <1>                     %endif
  1989                              <1>                 %else
  1990                              <1>                     LEA.w SI, [_cA_%1]
  1991                              <1>                 %endif
  1992                              <1>             %elifstr %2                     ; argument 2 is a string ?
  1993                              <1>                 section .data
  1994                              <1>                 %%part3: db %2, 0
  1995                              <1>                 section .text
  1996                              <1>                 LEA.w si, [%%part3]
  1997                              <1>                 STR_ARG_HELPER __varg1
  1998                              <1>                 STR_STR_HELPER %3
  1999                              <1>             %elifnum %2                     ; argument 2 is a number ?
  2000                              <1>                 EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <1>             %else
  2002                              <1>                 EMIT_ERROR 'todo'
  2003                              <1>             %endif
  2004                              <1>         %endif
  2005                              <1>         %undef __stop
  2006                              <1>         %undef __varg
  2007                              <1>     %endif
  2008                              <1> %endmacro
    11                                  
    12                                  kernel_start:
    13                                  section .text
    14                                  %include 'code16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  code16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> %define DOS_SHELL 1
     9                              <1> %define MAX_ARGS  7
    10                              <1> bits 16
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief  Create/Append field into dBASE III/IV DBF by INT 21h
    13                              <1> ; \note   Build:  nasm -f bin dbfmake.asm -o DBFMAKE.COM
    14                              <1> ;         Run:    DBFMAKE <type> <cmd> <fieldtype> <feldname> <feldlength>
    15                              <1> ;         Example:
    16                              <1> ;             DBFMAKE 3 CREATE C NAME 20
    17                              <1> ;             DBFMAKE 4 APPEND I AGE 3
    18                              <1> ;
    19                              <1> ; \note   Type: 3 (dBASE III), 4 (dBASE IV)
    20                              <1> ; \note   Cmd:  CREATE | APPEND
    21                              <1> ; \note   Fieldtype: C,I,F,B,D,T  (T only for type 4)
    22                              <1> ; \note   Fieldname: max 10 chars (dBASE-limit, 11. Byte = 0)
    23                              <1> ; \note   Fiedlength: decimal (e.g.. 20)
    24                              <1> ; -----------------------------------------------------------------------------
    25                              <1> code16_start:
    26                              <1>     INIT_COMMAND_LINE
  1604                              <2> %if DOS_SHELL == 1
  1605 00000000 E8C406              <2>  call dos_get_command_line
  1606                              <2> %else
  1607                              <2>  EMIT_ERROR 'todo: windows'
  1608                              <2> %endif
    27                              <1>     INIT_CONSOLE
  1615                              <2> %if DOS_SHELL == 1
  1616 00000003 E89606              <2>  call dos_init_console
  1617                              <2>  SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 00000006 E86208              <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
  1618                              <2> %else
  1619                              <2>  call init_app
  1620                              <2>  call init_console
  1621                              <2> %endif
    28                              <1> 
    29 00000009 E87600              <1>     call PROC_CHECK
    30 0000000C E8A800              <1>     call CHECK_MODE
    31                              <1>     
    32 0000000F FA                  <1>     cli                    ; Interrupts aus
    33                              <1> 
    34                              <1>     ; Segmentregister vorbereiten (Real Mode)
    35 00000010 31C0                <1>     xor ax, ax
    36 00000012 8ED8                <1>     mov ds, ax
    37 00000014 8EC0                <1>     mov es, ax
    38 00000016 8ED0                <1>     mov ss, ax
    39 00000018 BC007C              <1>     mov sp, 0x7C00         ; einfachen Stack setzen
    40                              <1>     
    41                              <1>     ; -----------------------------
    42                              <1>     ; GDT-Deskriptor vorbereiten
    43                              <1>     ; -----------------------------
    44                              <1>     ; Wir müssen die lineare Basisadresse der GDT in den GDTR schreiben
    45                              <1>     ; In Real Mode können wir trotzdem 32-Bit Register benutzen (mit 66h Prefix)
    46                              <1>     
    47                              <1>     ; CS-Segmentbasis berechnen (Segment << 4)
    48 0000001B 8CC8                <1>     mov   ax, cs
    49 0000001D 660FB7C0            <1>     movzx eax, ax          ; EAX = CS (Zero-extend)
    50 00000021 66C1E004            <1>     shl   eax, 4           ; EAX = CS * 16 = lineare Basis des Codesegments
    51                              <1>     
    52 00000025 6605(0B090000)      <1>     add eax, PTR16(_cA_gdt) ; GDT liegt irgendwo in unserem Code, also Basis + Offset
    53 0000002B 66A3(2509)          <1>     mov  [PTR16(_cA_gdt_descriptor)+2], eax  ; GDT-Basis in Descriptor schreiben
    54                              <1>     
    55 0000002F 0F0116(2309)        <1>     lgdt [PTR16(_cA_gdt_descriptor)]  ; GDTR laden
    56                              <1>     
    57                              <1>     ; -----------------------------
    58                              <1>     ; Protected Mode einschalten
    59                              <1>     ; -----------------------------
    60 00000034 0F20C0              <1>     mov eax, cr0
    61 00000037 6683C801            <1>     or  eax, 1             ; PE-Bit (Bit 0) setzen
    62 0000003B 0F22C0              <1>     mov cr0, eax
    63                              <1>     
    64                              <1>     ; Weit-Sprung in 32-Bit Code-Segment, um Pipeline zu leeren und CS zu setzen
    65 0000003E EA[4300]0800        <1>     jmp 0x08:protected_mode_entry  ; 0x08 = 1. GDT-Code-Deskriptor
    66                              <1>     
    67                              <1> ; --------------------------------
    68                              <1> ; Ab hier 32-Bit Code
    69                              <1> ; --------------------------------
    70                              <1> [BITS 32]
    71                              <1> 
    72                              <1> protected_mode_entry:
    73                              <1>     ; Segmentregister auf 32-Bit-Data-Deskriptor setzen
    74 00000043 66B81000            <1>     mov ax, 0x10           ; 0x10 = 2. GDT-Eintrag = Data-Segment
    75 00000047 8ED8                <1>     mov ds, ax
    76 00000049 8EC0                <1>     mov es, ax
    77 0000004B 8EE0                <1>     mov fs, ax
    78 0000004D 8EE8                <1>     mov gs, ax
    79 0000004F 8ED0                <1>     mov ss, ax
    80                              <1> 
    81                              <1>     ; Stack für 32-Bit setzen
    82 00000051 BC00FC0900          <1>     mov esp, 0x9FC00       ; irgendeine hohe Adresse im Low-Memory-Bereich
    83                              <1> 
    84                              <1>     ; Kleine Demo: Text direkt in den VGA-Textmodus-Speicher schreiben (0xB8000)
    85 00000056 BF00800B00          <1>     mov edi, 0xB8000       ; VGA-Textmodus-Adresse
    86 0000005B B8201F201F          <1>     mov eax, 0x1F201F20    ; zwei Zeichen ' ' (Space) mit Attribut 0x1F (weiß auf blau)
    87                              <1>                            ; hier nur als Dummy, um Format zu zeigen
    88                              <1> 
    89                              <1>     ; Beispieltext "PM32" schreiben
    90 00000060 C60750              <1>     mov byte [edi], 'P'
    91 00000063 C647011F            <1>     mov byte [edi+1], 0x1F
    92 00000067 C647024D            <1>     mov byte [edi+2], 'M'
    93 0000006B C647031F            <1>     mov byte [edi+3], 0x1F
    94 0000006F C6470433            <1>     mov byte [edi+4], '3'
    95 00000073 C647051F            <1>     mov byte [edi+5], 0x1F
    96 00000077 C6470632            <1>     mov byte [edi+6], '2'
    97 0000007B C647071F            <1>     mov byte [edi+7], 0x1F
    98                              <1> 
    99                              <1>     .hang:
   100 0000007F EBFE                <1>     jmp .hang              ; Endlosschleife, damit man den Zustand sieht
   101                              <1>     
   102 00000081 C3                  <1>     ret
   103                              <1> 
   104                              <1> ; -----------------------------------------------------------------------------
   105                              <1> ; \brief check, if a compatible 80386 CPU is present on the system ...
   106                              <1> ; -----------------------------------------------------------------------------
   107                              <1> PROC_CHECK:
   108 00000082 9C                  <1>     pushf                   ; save flags
   109 00000083 30E4                <1>     xor  ah, ah             ; clear high byte
   110 00000085 6650                <1>     push ax                 ; push AX onto the stack
   111 00000087 9D                  <1>     popf                    ; pop this value into the flag register
   112 00000088 9C                  <1>     pushf                   ; push flags onto the stack
   113 00000089 6658                <1>     pop  ax                 ; ...and get flags into AX
   114 0000008B 80E4F0              <1>     and  ah, 0xF0           ; try to set the high nibble
   115 0000008E 80FCF0              <1>     cmp  ah, 0xF0           ; the high nibble is never 0f0h on a
   116 00000091 740F                <1>     je   no386              ; 80386!
   117 00000093 B470                <1>     mov  ah, 70h            ; now try to set NT and IOPL
   118 00000095 6650                <1>     push ax
   119 00000097 9D                  <1>     popf
   120 00000098 9C                  <1>     pushf
   121 00000099 6658                <1>     pop  ax
   122 0000009B 80E470              <1>     and  ah, 70h            ; if they couldn't be modified, there
   123 0000009E 7402                <1>     jz   no386              ; is no 80386 installed
   124 000000A0 9D                  <1>     popf                    ; restore the flags
   125 000000A1 C3                  <1>     ret                     ; ...and return
   126                              <1>     
   127                              <1>     no386:                  ; if there isn't a 80386, put a msg
   128                              <1>     PUTS_COLOR no386e, 3    ; and exit
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 000000A2 B303                <2>  mov bl, %2
  1390 000000A4 66B8(C108)          <2>  mov ax, PTR16(_cA_%1)
  1391 000000A8 6689C6              <2>  mov si, ax
  1392 000000AB E837070000          <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   129                              <1>     DOS_Exit 1
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 000000B0 66B8014C            <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 000000B4 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
   130 000000B6 C3                  <1>     ret
   131                              <1> 
   132                              <1> ; -----------------------------------------------------------------------------
   133                              <1> ; \brief check, if we in real mode or not ...
   134                              <1> ; -----------------------------------------------------------------------------
   135                              <1> CHECK_MODE
   135          ******************  <1>  warning: label alone on a line without a colon might be in error [-w+label-orphan]
   136 000000B7 0F20C0              <1>     mov eax, cr0            ; get CR0 to EAX
   137 000000BA 2401                <1>     and al, 1               ; check if PM bit is set
   138 000000BC 7501                <1>     jnz not_real_mode		; yes, it is, so exit
   139 000000BE C3                  <1>     ret                     ; no, it isn't, return
   140                              <1>     
   141                              <1>     not_real_mode:
   142                              <1>     PUTS_COLOR norealmode, 3
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 000000BF B303                <2>  mov bl, %2
  1390 000000C1 66B8(E408)          <2>  mov ax, PTR16(_cA_%1)
  1391 000000C5 6689C6              <2>  mov si, ax
  1392 000000C8 E81A070000          <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   143                              <1>     DOS_Exit 1
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 000000CD 66B8014C            <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 000000D1 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
   144 000000D3 C3                  <1>     ret
   145                              <1>     
   146                              <1> is_version_1:
   147                              <1>     ;mov [PTR16(_cA_db_version)], byte 3
   148                              <1>     SET_CURSOR 10, 1
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000D4 B20A                <2>  mov dl, %1
  1301 000000D6 B601                <2>  mov dh, %2
  1302 000000D8 E8D2000000          <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   149                              <1>     PUTS_COLOR 'argv1 == argv1', 0x0F
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 00000000 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000009 617267763100        <2>
  1355                              <2>  section .text
  1356 000000DD 6631DB              <2>  xor bx, bx
  1357 000000E0 B30F                <2>  mov bl, %2
  1358 000000E2 66BE(0001)          <2>  mov si, PTR16(%%msg)
  1359 000000E6 E8FC060000          <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   150 000000EB C3                  <1>     ret
   151                              <1> is_version_2:
   152                              <1>     ;mov [PTR16(_cA_db_version)], byte 4
   153                              <1>     SET_CURSOR 10, 2
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000EC B20A                <2>  mov dl, %1
  1301 000000EE B602                <2>  mov dh, %2
  1302 000000F0 E8BA000000          <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   154                              <1>     PUTS_COLOR 'argv1 == argv2', 0x0E
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000000F 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000018 617267763200        <2>
  1355                              <2>  section .text
  1356 000000F5 6631DB              <2>  xor bx, bx
  1357 000000F8 B30E                <2>  mov bl, %2
  1358 000000FA 66BE(0F01)          <2>  mov si, PTR16(%%msg)
  1359 000000FE E8E4060000          <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   155 00000103 C3                  <1>     ret
   156                              <1> is_version_3:
   157                              <1>     ;mov [PTR16(_cA_db_version)], byte 5
   158                              <1>     SET_CURSOR 10, 3
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 00000104 B20A                <2>  mov dl, %1
  1301 00000106 B603                <2>  mov dh, %2
  1302 00000108 E8A2000000          <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   159                              <1>     PUTS_COLOR 'argv1 == "abcd"', 0x0F
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000001E 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000027 22616263642200      <2>
  1355                              <2>  section .text
  1356 0000010D 6631DB              <2>  xor bx, bx
  1357 00000110 B30F                <2>  mov bl, %2
  1358 00000112 66BE(1E01)          <2>  mov si, PTR16(%%msg)
  1359 00000116 E8CC060000          <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   160 0000011B C3                  <1>     ret
   161                              <1> is_version_4:
   162                              <1>     ;mov [PTR16(_cA_db_version)], byte 6
   163                              <1>     SET_CURSOR 10, 4
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 0000011C B20A                <2>  mov dl, %1
  1301 0000011E B604                <2>  mov dh, %2
  1302 00000120 E88A000000          <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   164                              <1>     PUTS_COLOR 'argv2 == 1234', 0xF
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000002E 6172677632203D3D20- <2>  %%msg: db %1, 0
  1354 00000037 3132333400          <2>
  1355                              <2>  section .text
  1356 00000125 6631DB              <2>  xor bx, bx
  1357 00000128 B30F                <2>  mov bl, %2
  1358 0000012A 66BE(2E01)          <2>  mov si, PTR16(%%msg)
  1359 0000012E E8B4060000          <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   165 00000133 C3                  <1>     ret
   166                              <1> is_version_5:    
   167                              <1>     ;mov [PTR16(_cA_db_version)], byte 6
   168                              <1>     SET_CURSOR 10, 5
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 00000134 B20A                <2>  mov dl, %1
  1301 00000136 B605                <2>  mov dh, %2
  1302 00000138 E872000000          <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   169                              <1>     PUTS_COLOR '"abcd" == "abcd"', 0xF
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000003C 226162636422203D3D- <2>  %%msg: db %1, 0
  1354 00000045 2022616263642200    <2>
  1355                              <2>  section .text
  1356 0000013D 6631DB              <2>  xor bx, bx
  1357 00000140 B30F                <2>  mov bl, %2
  1358 00000142 66BE(3C01)          <2>  mov si, PTR16(%%msg)
  1359 00000146 E89C060000          <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   170 0000014B C3                  <1>     ret
   171                              <1> 
   172                              <1> ; -----------------------------------------------------------------------------
   173                              <1> ; \brief include DOS 16-bit stdlib function's ...
   174                              <1> ; -----------------------------------------------------------------------------
   175                              <1> %include 'CommandLineArg.asm'       ; get command line arguments
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  CommandLineArg.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief  Sucht den n-ten (1-basiert) Token im ASCIIZ-String bei DS:SI,
    11                              <2> ;         ersetzt das erste Leerzeichen NACH dem Token durch 0 und
    12                              <2> ;         liefert SI auf den Tokenstart (C-String).
    13                              <2> ; \param  Eingabe:
    14                              <2> ;         DS:SI -> 0-terminierter String (muss schreibbar sein!)
    15                              <2> ;         BL    = n (1 = erster Token)
    16                              <2> ; \return Ausgabe bei Erfolg (CF=0):
    17                              <2> ;         SI    = Startadresse des Tokens (in DS)
    18                              <2> ;         CX    = Länge des Tokens
    19                              <2> ; \error  Bei Misserfolg (CF=1): CX=0, SI undefiniert
    20                              <2> ; \note   Verändert: AX, CX, DX, SI, DI, FLAGS
    21                              <2> ; -----------------------------------------------------------------------------
    22                              <2> getCommandLine_Arg:
    23                              <2>     ;push di
    24 0000014C 84DB                <2>     test bl, bl
    25 0000014E 7503                <2>     jnz .start
    26 00000150 F9                  <2>     stc
    27 00000151 EB5B                <2>     jmp .ret
    28                              <2> 
    29                              <2>     .start:
    30                              <2>     ; führende Leerzeichen überspringen
    31                              <2>     .skip_spaces_lead:
    32 00000153 AC                  <2>     lodsb                      ; AL=[SI], SI++
    33 00000154 3C20                <2>     cmp  al, ' '
    34 00000156 74FB                <2>     je   .skip_spaces_lead
    35 00000158 3C00                <2>     cmp  al, 0
    36 0000015A 744E                <2>     je   .not_found
    37                              <2> 
    38                              <2>     ; AL ist erstes Zeichen eines Tokens
    39 0000015C 6689F2              <2>     mov  dx, si
    40 0000015F 664A                <2>     dec  dx                    ; DX = Start dieses Tokens
    41 00000161 66BF0100            <2>     mov  di, 1                 ; di = aktueller Tokenindex (1-basiert)
    42                              <2> 
    43 00000165 6639DF              <2>     cmp  di, bx
    44 00000168 7420                <2>     je   .measure_this
    45                              <2> 
    46                              <2>     ; aktuellen Token bis zum Leerzeichen/0 überspringen
    47                              <2>     .skip_this_token:
    48 0000016A AC                  <2>     lodsb
    49 0000016B 3C00                <2>     cmp  al, 0
    50 0000016D 743B                <2>     je   .not_found
    51 0000016F 3C20                <2>     cmp  al, ' '
    52 00000171 75F7                <2>     jne  .skip_this_token
    53                              <2> 
    54                              <2>     ; Folge-Leerzeichen überspringen
    55                              <2>     .skip_spaces_mid:
    56 00000173 AC                  <2>     lodsb
    57 00000174 3C00                <2>     cmp  al, 0
    58 00000176 7432                <2>     je   .not_found
    59 00000178 3C20                <2>     cmp  al, ' '
    60 0000017A 74F7                <2>     je   .skip_spaces_mid
    61                              <2> 
    62                              <2>     ; Beginn des nächsten Tokens
    63 0000017C 6647                <2>     inc  di
    64 0000017E 6689F2              <2>     mov  dx, si
    65 00000181 664A                <2>     dec  dx
    66 00000183 6639DF              <2>     cmp  di, bx
    67 00000186 7402                <2>     je   .measure_this
    68 00000188 EBE0                <2>     jmp  .skip_this_token
    69                              <2> 
    70                              <2>     .measure_this:
    71                              <2>     ; SI steht bereits auf 2. Zeichen des Tokens (erstes war in AL)
    72 0000018A 66B90100            <2>     mov  cx, 1                 ; bisher 1 Zeichen gezählt
    73                              <2>     .len_loop:
    74 0000018E AC                  <2>     lodsb
    75 0000018F 3C00                <2>     cmp  al, 0
    76 00000191 7408                <2>     je   .done_len             ; Token endet am Stringende (bereits 0-terminiert)
    77 00000193 3C20                <2>     cmp  al, ' '
    78 00000195 7404                <2>     je   .done_len             ; Token endet am Leerzeichen
    79 00000197 6641                <2>     inc  cx
    80 00000199 EBF3                <2>     jmp  .len_loop
    81                              <2> 
    82                              <2>     .done_len:
    83                              <2>     ; Wenn das Ende durch Leerzeichen kam, dieses in 0 verwandeln.
    84 0000019B 3C20                <2>     cmp  al, ' '
    85 0000019D 7505                <2>     jne  .keep_zt              ; AL==0 -> bereits 0-terminiert
    86 0000019F 67C644FF00          <2>     mov  byte [si-1], 0        ; letztes gelesenes Zeichen (Leerzeichen) überschreiben
    87                              <2>     .keep_zt:
    88 000001A4 6689D6              <2>     mov  si, dx                ; SI = Start des Tokens
    89 000001A7 F8                  <2>     clc
    90 000001A8 EB04                <2>     jmp  .ret
    91                              <2> 
    92                              <2>     .not_found:
    93 000001AA 6631C9              <2>     xor  cx, cx
    94 000001AD F9                  <2>     stc
    95                              <2> 
    96                              <2>     .ret:
    97                              <2>     ;pop  di
    98 000001AE C3                  <2>     ret
   176                              <1> %include 'ConsoleCursor.asm'        ; set the teletype video text cursor
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ConsoleCursor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> dos_set_cursor:
    11 000001AF 8815(E0010000)      <2>     mov  [PTR16(dos_xpos)], dl   ; column
    12 000001B5 8835(E1010000)      <2>     mov  [PTR16(dos_ypos)], dh   ; row
    13                              <2>     ;---
    14 000001BB B700                <2>     mov  bh, 0                   ; todo
    15 000001BD 883D(E2010000)      <2>     mov  [PTR16(dos_page)], bh   ; video page
    16                              <2>     ;---
    17 000001C3 B402                <2>     mov  ah, 02h
    18                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000001C5 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    19 000001C7 C3                  <2>     ret
    20                              <2> 
    21                              <2> dos_get_cursor:
    22 000001C8 6657                <2>     push di
    23 000001CA 6656                <2>     push si
    24 000001CC 6653                <2>     push bx
    25 000001CE 6652                <2>     push dx
    26                              <2>     
    27 000001D0 B700                <2>     mov  bh, 0                   ; todo
    28 000001D2 B403                <2>     mov  ah, 0x03
    29                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000001D4 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    30 000001D6 8815(E0010000)      <2>     mov  [PTR16(dos_xpos)], dl   ; column
    31 000001DC 8835(E1010000)      <2>     mov  [PTR16(dos_ypos)], dh   ; row
    32 000001E2 883D(E2010000)      <2>     mov  [PTR16(dos_page)], bh   ; video page
    33                              <2>     
    34 000001E8 665A                <2>     pop  dx
    35 000001EA 665B                <2>     pop  bx
    36 000001EC 665E                <2>     pop  si
    37 000001EE 665F                <2>     pop  di
    38 000001F0 C3                  <2>     ret
   177                              <1> %include 'ErrorCodes.asm'           ; get last error
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ErrorCodes.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief dispatch: search the handler and jump to it ...
    11                              <2> ; -----------------------------------------------------------------------------
    12                              <2> DOS_handle_error_code:
    13                              <2>     ; AX enthält den DOS-Fehlercode
    14 000001F1 6689C3              <2>     mov   bx, ax             ; bx = gesuchter Code
    15 000001F4 66BE[3F07]          <2>     mov   si, _cA_error_dispatch
    16                              <2>     .next:
    17 000001F8 66AD                <2>     lodsw                    ; ax = Tabellencode, si zeigt nun auf Handler-Wort
    18 000001FA 6685C0              <2>     test  ax, ax
    19 000001FD 740F                <2>     jz    .default           ; 0 -> Ende: Default
    20 000001FF 6639D8              <2>     cmp   ax, bx
    21 00000202 7406                <2>     je    .match
    22 00000204 6683C602            <2>     add   si, 2              ; Handlerwort überspringen
    23 00000208 EBEE                <2>     jmp   .next
    24                              <2>     .match:
    25 0000020A 6667FF24            <2>     jmp   word [si]          ; indirekter Sprung zum Handler
    26                              <2>     .default:
    27 0000020E E9(88040000)        <2>     jmp   _cA_open_error_nd
    28                              <2>     
    29                              <2>     ; ----------------------------------------
    30                              <2>     ; Handler minimal & einheitlich per Makro
    31                              <2>     ; ----------------------------------------
    32                              <2>     DEF_ERROR 01h, open_error_01    ; ungültige Funktiob
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000213 B31E                <4>  mov bl, %2
  1390 00000215 66B8(9705)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000219 6689C6              <4>  mov si, ax
  1392 0000021C E8C6050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000221 66B90100            <3>  mov cx, %1
  1631 00000225 E969040000          <3>  jmp _open_exit
    33                              <2>     DEF_ERROR 02h, open_error_02
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000022A B31E                <4>  mov bl, %2
  1390 0000022C 66B8(B905)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000230 6689C6              <4>  mov si, ax
  1392 00000233 E8AF050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000238 66B90200            <3>  mov cx, %1
  1631 0000023C E952040000          <3>  jmp _open_exit
    34                              <2>     DEF_ERROR 03h, open_error_03
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000241 B31E                <4>  mov bl, %2
  1390 00000243 66B8(C905)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000247 6689C6              <4>  mov si, ax
  1392 0000024A E898050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000024F 66B90300            <3>  mov cx, %1
  1631 00000253 E93B040000          <3>  jmp _open_exit
    35                              <2>     DEF_ERROR 04h, open_error_04
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000258 B31E                <4>  mov bl, %2
  1390 0000025A 66B8(D905)          <4>  mov ax, PTR16(_cA_%1)
  1391 0000025E 6689C6              <4>  mov si, ax
  1392 00000261 E881050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000266 66B90400            <3>  mov cx, %1
  1631 0000026A E924040000          <3>  jmp _open_exit
    36                              <2>     DEF_ERROR 05h, open_error_05
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000026F B31E                <4>  mov bl, %2
  1390 00000271 66B8(EE05)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000275 6689C6              <4>  mov si, ax
  1392 00000278 E86A050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000027D 66B90500            <3>  mov cx, %1
  1631 00000281 E90D040000          <3>  jmp _open_exit
    37                              <2>     DEF_ERROR 06h, open_error_06    ; ungültiger Handle
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000286 B31E                <4>  mov bl, %2
  1390 00000288 66B8(FD05)          <4>  mov ax, PTR16(_cA_%1)
  1391 0000028C 6689C6              <4>  mov si, ax
  1392 0000028F E853050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000294 66B90600            <3>  mov cx, %1
  1631 00000298 E9F6030000          <3>  jmp _open_exit
    38                              <2>     DEF_ERROR 07h, open_error_07    ; korrupte Speicherverwaltung
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000029D B31E                <4>  mov bl, %2
  1390 0000029F 66B8(1106)          <4>  mov ax, PTR16(_cA_%1)
  1391 000002A3 6689C6              <4>  mov si, ax
  1392 000002A6 E83C050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000002AB 66B90700            <3>  mov cx, %1
  1631 000002AF E9DF030000          <3>  jmp _open_exit
    39                              <2>     DEF_ERROR 08h, open_error_08    ; nicht genügend Speicher
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000002B4 B31E                <4>  mov bl, %2
  1390 000002B6 66B8(2606)          <4>  mov ax, PTR16(_cA_%1)
  1391 000002BA 6689C6              <4>  mov si, ax
  1392 000002BD E825050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000002C2 66B90800            <3>  mov cx, %1
  1631 000002C6 E9C8030000          <3>  jmp _open_exit
    40                              <2>     DEF_ERROR 09h, open_error_09
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000002CB B31E                <4>  mov bl, %2
  1390 000002CD 66B8(3606)          <4>  mov ax, PTR16(_cA_%1)
  1391 000002D1 6689C6              <4>  mov si, ax
  1392 000002D4 E80E050000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000002D9 66B90900            <3>  mov cx, %1
  1631 000002DD E9B1030000          <3>  jmp _open_exit
    41                              <2>     DEF_ERROR 0Ah, open_error_0A
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000002E2 B31E                <4>  mov bl, %2
  1390 000002E4 66B8(4E06)          <4>  mov ax, PTR16(_cA_%1)
  1391 000002E8 6689C6              <4>  mov si, ax
  1392 000002EB E8F7040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000002F0 66B90A00            <3>  mov cx, %1
  1631 000002F4 E99A030000          <3>  jmp _open_exit
    42                              <2>     DEF_ERROR 0Bh, open_error_0B
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000002F9 B31E                <4>  mov bl, %2
  1390 000002FB 66B8(6306)          <4>  mov ax, PTR16(_cA_%1)
  1391 000002FF 6689C6              <4>  mov si, ax
  1392 00000302 E8E0040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000307 66B90B00            <3>  mov cx, %1
  1631 0000030B E983030000          <3>  jmp _open_exit
    43                              <2>     DEF_ERROR 0Ch, open_error_0C
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000310 B31E                <4>  mov bl, %2
  1390 00000312 66B8(7A06)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000316 6689C6              <4>  mov si, ax
  1392 00000319 E8C9040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000031E 66B90C00            <3>  mov cx, %1
  1631 00000322 E96C030000          <3>  jmp _open_exit
    44                              <2>     DEF_ERROR 0Dh, open_error_0D
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000327 B31E                <4>  mov bl, %2
  1390 00000329 66B8(9006)          <4>  mov ax, PTR16(_cA_%1)
  1391 0000032D 6689C6              <4>  mov si, ax
  1392 00000330 E8B2040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000335 66B90D00            <3>  mov cx, %1
  1631 00000339 E955030000          <3>  jmp _open_exit
    45                              <2>     DEF_ERROR 0Eh, open_error_0E
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000033E B31E                <4>  mov bl, %2
  1390 00000340 66B8(AF06)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000344 6689C6              <4>  mov si, ax
  1392 00000347 E89B040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000034C 66B90E00            <3>  mov cx, %1
  1631 00000350 E93E030000          <3>  jmp _open_exit
    46                              <2>     DEF_ERROR 0Fh, open_error_0F
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000355 B31E                <4>  mov bl, %2
  1390 00000357 66B8(C506)          <4>  mov ax, PTR16(_cA_%1)
  1391 0000035B 6689C6              <4>  mov si, ax
  1392 0000035E E884040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000363 66B90F00            <3>  mov cx, %1
  1631 00000367 E927030000          <3>  jmp _open_exit
    47                              <2>     DEF_ERROR 10h, open_error_10
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000036C B31E                <4>  mov bl, %2
  1390 0000036E 66B8(D406)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000372 6689C6              <4>  mov si, ax
  1392 00000375 E86D040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000037A 66B91000            <3>  mov cx, %1
  1631 0000037E E910030000          <3>  jmp _open_exit
    48                              <2>     DEF_ERROR 11h, open_error_11
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000383 B31E                <4>  mov bl, %2
  1390 00000385 66B8(F706)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000389 6689C6              <4>  mov si, ax
  1392 0000038C E856040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000391 66B91100            <3>  mov cx, %1
  1631 00000395 E9F9020000          <3>  jmp _open_exit
    49                              <2>     DEF_ERROR 12h, open_error_12
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000039A B31E                <4>  mov bl, %2
  1390 0000039C 66B8(0C07)          <4>  mov ax, PTR16(_cA_%1)
  1391 000003A0 6689C6              <4>  mov si, ax
  1392 000003A3 E83F040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000003A8 66B91200            <3>  mov cx, %1
  1631 000003AC E9E2020000          <3>  jmp _open_exit
    50                              <2>     DEF_ERROR 15h, open_error_15
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000003B1 B31E                <4>  mov bl, %2
  1390 000003B3 66B8(2F07)          <4>  mov ax, PTR16(_cA_%1)
  1391 000003B7 6689C6              <4>  mov si, ax
  1392 000003BA E828040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000003BF 66B91500            <3>  mov cx, %1
  1631 000003C3 E9CB020000          <3>  jmp _open_exit
    51                              <2>     DEF_ERROR 1Dh, open_error_1D    ; Seek-Fehler
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000003C8 B31E                <4>  mov bl, %2
  1390 000003CA 66B8(4007)          <4>  mov ax, PTR16(_cA_%1)
  1391 000003CE 6689C6              <4>  mov si, ax
  1392 000003D1 E811040000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000003D6 66B91D00            <3>  mov cx, %1
  1631 000003DA E9B4020000          <3>  jmp _open_exit
    52                              <2>     DEF_ERROR 1Eh, open_error_1E    ; kein DOS-Datenträger
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000003DF B31E                <4>  mov bl, %2
  1390 000003E1 66B8(5D07)          <4>  mov ax, PTR16(_cA_%1)
  1391 000003E5 6689C6              <4>  mov si, ax
  1392 000003E8 E8FA030000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 000003ED 66B91E00            <3>  mov cx, %1
  1631 000003F1 E99D020000          <3>  jmp _open_exit
    53                              <2>     DEF_ERROR 1Fh, open_error_1F
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 000003F6 B31E                <4>  mov bl, %2
  1390 000003F8 66B8(6907)          <4>  mov ax, PTR16(_cA_%1)
  1391 000003FC 6689C6              <4>  mov si, ax
  1392 000003FF E8E3030000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000404 66B91F00            <3>  mov cx, %1
  1631 00000408 E986020000          <3>  jmp _open_exit
    54                              <2>     DEF_ERROR 20h, open_error_20
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000040D B31E                <4>  mov bl, %2
  1390 0000040F 66B8(7E07)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000413 6689C6              <4>  mov si, ax
  1392 00000416 E8CC030000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 0000041B 66B92000            <3>  mov cx, %1
  1631 0000041F E96F020000          <3>  jmp _open_exit
    55                              <2>     DEF_ERROR 21h, open_error_21
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000424 B31E                <4>  mov bl, %2
  1390 00000426 66B8(9607)          <4>  mov ax, PTR16(_cA_%1)
  1391 0000042A 6689C6              <4>  mov si, ax
  1392 0000042D E8B5030000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000432 66B92100            <3>  mov cx, %1
  1631 00000436 E958020000          <3>  jmp _open_exit
    56                              <2>     DEF_ERROR 27h, open_error_27
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 0000043B B31E                <4>  mov bl, %2
  1390 0000043D 66B8(A707)          <4>  mov ax, PTR16(_cA_%1)
  1391 00000441 6689C6              <4>  mov si, ax
  1392 00000444 E89E030000          <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000449 66B92700            <3>  mov cx, %1
  1631 0000044D E941020000          <3>  jmp _open_exit
    57                              <2> 
    58                              <2>     ERR_HANDLER 0x01, 0x02, 0x03, 0x04
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000452 B31E                <5>  mov bl, %2
  1390 00000454 66B8(9705)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000458 6689C6              <5>  mov si, ax
  1392 0000045B E887030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000460 66B90100            <4>  mov cx, %1
  1741 00000464 E92A020000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000469 B31E                <5>  mov bl, %2
  1390 0000046B 66B8(B905)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000046F 6689C6              <5>  mov si, ax
  1392 00000472 E870030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000477 66B90200            <4>  mov cx, %1
  1741 0000047B E913020000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000480 B31E                <5>  mov bl, %2
  1390 00000482 66B8(C905)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000486 6689C6              <5>  mov si, ax
  1392 00000489 E859030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 0000048E 66B90300            <4>  mov cx, %1
  1741 00000492 E9FC010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000497 B31E                <5>  mov bl, %2
  1390 00000499 66B8(D905)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000049D 6689C6              <5>  mov si, ax
  1392 000004A0 E842030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000004A5 66B90400            <4>  mov cx, %1
  1741 000004A9 E9E5010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    59                              <2>     ERR_HANDLER 0x05, 0x06, 0x07, 0x08
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000004AE B31E                <5>  mov bl, %2
  1390 000004B0 66B8(EE05)          <5>  mov ax, PTR16(_cA_%1)
  1391 000004B4 6689C6              <5>  mov si, ax
  1392 000004B7 E82B030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000004BC 66B90500            <4>  mov cx, %1
  1741 000004C0 E9CE010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000004C5 B31E                <5>  mov bl, %2
  1390 000004C7 66B8(FD05)          <5>  mov ax, PTR16(_cA_%1)
  1391 000004CB 6689C6              <5>  mov si, ax
  1392 000004CE E814030000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000004D3 66B90600            <4>  mov cx, %1
  1741 000004D7 E9B7010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000004DC B31E                <5>  mov bl, %2
  1390 000004DE 66B8(1106)          <5>  mov ax, PTR16(_cA_%1)
  1391 000004E2 6689C6              <5>  mov si, ax
  1392 000004E5 E8FD020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000004EA 66B90700            <4>  mov cx, %1
  1741 000004EE E9A0010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000004F3 B31E                <5>  mov bl, %2
  1390 000004F5 66B8(2606)          <5>  mov ax, PTR16(_cA_%1)
  1391 000004F9 6689C6              <5>  mov si, ax
  1392 000004FC E8E6020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000501 66B90800            <4>  mov cx, %1
  1741 00000505 E989010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    60                              <2>     ERR_HANDLER 0x09, 0x0A, 0x0B, 0x0C
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000050A B31E                <5>  mov bl, %2
  1390 0000050C 66B8(3606)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000510 6689C6              <5>  mov si, ax
  1392 00000513 E8CF020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000518 66B90900            <4>  mov cx, %1
  1741 0000051C E972010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000521 B31E                <5>  mov bl, %2
  1390 00000523 66B8(4E06)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000527 6689C6              <5>  mov si, ax
  1392 0000052A E8B8020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 0000052F 66B90A00            <4>  mov cx, %1
  1741 00000533 E95B010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000538 B31E                <5>  mov bl, %2
  1390 0000053A 66B8(6306)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000053E 6689C6              <5>  mov si, ax
  1392 00000541 E8A1020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000546 66B90B00            <4>  mov cx, %1
  1741 0000054A E944010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000054F B31E                <5>  mov bl, %2
  1390 00000551 66B8(7A06)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000555 6689C6              <5>  mov si, ax
  1392 00000558 E88A020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 0000055D 66B90C00            <4>  mov cx, %1
  1741 00000561 E92D010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    61                              <2>     ERR_HANDLER 0x0D, 0x0E, 0x0F, 0x10
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000566 B31E                <5>  mov bl, %2
  1390 00000568 66B8(9006)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000056C 6689C6              <5>  mov si, ax
  1392 0000056F E873020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000574 66B90D00            <4>  mov cx, %1
  1741 00000578 E916010000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000057D B31E                <5>  mov bl, %2
  1390 0000057F 66B8(AF06)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000583 6689C6              <5>  mov si, ax
  1392 00000586 E85C020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 0000058B 66B90E00            <4>  mov cx, %1
  1741 0000058F E9FF000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000594 B31E                <5>  mov bl, %2
  1390 00000596 66B8(C506)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000059A 6689C6              <5>  mov si, ax
  1392 0000059D E845020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000005A2 66B90F00            <4>  mov cx, %1
  1741 000005A6 E9E8000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000005AB B31E                <5>  mov bl, %2
  1390 000005AD 66B8(D406)          <5>  mov ax, PTR16(_cA_%1)
  1391 000005B1 6689C6              <5>  mov si, ax
  1392 000005B4 E82E020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000005B9 66B91000            <4>  mov cx, %1
  1741 000005BD E9D1000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    62                              <2>     ERR_HANDLER 0x11, 0x12, 0x15
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000005C2 B31E                <5>  mov bl, %2
  1390 000005C4 66B8(F706)          <5>  mov ax, PTR16(_cA_%1)
  1391 000005C8 6689C6              <5>  mov si, ax
  1392 000005CB E817020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000005D0 66B91100            <4>  mov cx, %1
  1741 000005D4 E9BA000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000005D9 B31E                <5>  mov bl, %2
  1390 000005DB 66B8(0C07)          <5>  mov ax, PTR16(_cA_%1)
  1391 000005DF 6689C6              <5>  mov si, ax
  1392 000005E2 E800020000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000005E7 66B91200            <4>  mov cx, %1
  1741 000005EB E9A3000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 000005F0 B31E                <5>  mov bl, %2
  1390 000005F2 66B8(2F07)          <5>  mov ax, PTR16(_cA_%1)
  1391 000005F6 6689C6              <5>  mov si, ax
  1392 000005F9 E8E9010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 000005FE 66B91500            <4>  mov cx, %1
  1741 00000602 E98C000000          <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    63                              <2>     ERR_HANDLER 0x1D, 0x1E, 0x1F, 0x20
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000607 B31E                <5>  mov bl, %2
  1390 00000609 66B8(4007)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000060D 6689C6              <5>  mov si, ax
  1392 00000610 E8D2010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000615 66B91D00            <4>  mov cx, %1
  1741 00000619 EB78                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000061B B31E                <5>  mov bl, %2
  1390 0000061D 66B8(5D07)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000621 6689C6              <5>  mov si, ax
  1392 00000624 E8BE010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000629 66B91E00            <4>  mov cx, %1
  1741 0000062D EB64                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000062F B31E                <5>  mov bl, %2
  1390 00000631 66B8(6907)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000635 6689C6              <5>  mov si, ax
  1392 00000638 E8AA010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 0000063D 66B91F00            <4>  mov cx, %1
  1741 00000641 EB50                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000643 B31E                <5>  mov bl, %2
  1390 00000645 66B8(7E07)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000649 6689C6              <5>  mov si, ax
  1392 0000064C E896010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000651 66B92000            <4>  mov cx, %1
  1741 00000655 EB3C                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    64                              <2>     ERR_HANDLER 0x21
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000657 B31E                <5>  mov bl, %2
  1390 00000659 66B8(9607)          <5>  mov ax, PTR16(_cA_%1)
  1391 0000065D 6689C6              <5>  mov si, ax
  1392 00000660 E882010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000665 66B92100            <4>  mov cx, %1
  1741 00000669 EB28                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    65                              <2>     ERR_HANDLER 0x27
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 0000066B B31E                <5>  mov bl, %2
  1390 0000066D 66B8(A707)          <5>  mov ax, PTR16(_cA_%1)
  1391 00000671 6689C6              <5>  mov si, ax
  1392 00000674 E86E010000          <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000679 66B92700            <4>  mov cx, %1
  1741 0000067D EB14                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    66                              <2> 
    67                              <2> _cA_errhnd:
    68                              <2>     PUTS_COLOR open_error_nd, ATTR_DOS_ERROR
  1350                              <3> %if DOS_SHELL == 1
  1351                              <3> 
  1352                              <3>  %ifstr %1
  1353                              <3>  section .data
  1354                              <3>  %%msg: db %1, 0
  1355                              <3>  section .text
  1356                              <3>  xor bx, bx
  1357                              <3>  mov bl, %2
  1358                              <3>  mov si, PTR16(%%msg)
  1359                              <3>  call PutStrColor
  1360                              <3>  %elifidni %1, SI
  1361                              <3>  section .text
  1362                              <3>  mov bl, %2
  1363                              <3>  call PutStrColor
  1364                              <3>  %elifidni %1, DI
  1365                              <3>  section .text
  1366                              <3>  mov bl, %2
  1367                              <3>  call PutStrColor
  1368                              <3>  %else
  1369                              <3>  %assign __count 0
  1370                              <3>  %assign __varg 0
  1371                              <3>  %assign __stop 0
  1372                              <3>  %rep MAX_ARGV
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1380                              <3>  %endrep
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1381                              <3>  %if __varg > 0
  1382                              <3>  section .text
  1383                              <3>  mov si, PTR16(_cA_cmd_buf)
  1384                              <3>  mov bl, __varg
  1385                              <3>  call getCommandLine_Arg
  1386                              <3>  call PutStrColor
  1387                              <3>  %else
  1388                              <3>  section .text
  1389 0000067F B31E                <3>  mov bl, %2
  1390 00000681 66B8(8805)          <3>  mov ax, PTR16(_cA_%1)
  1391 00000685 6689C6              <3>  mov si, ax
  1392 00000688 E85A010000          <3>  call PutStrColor
  1393                              <3>  %endif
  1394                              <3>  %undef __varg
  1395                              <3>  %endif
  1396                              <3> %else
  1397                              <3>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <3> %endif
    69 0000068D 66B92000            <2>     mov   cx, 32
    70 00000691 EB00                <2>     jmp _open_exit
    71                              <2> 
    72                              <2> _open_exit:
    73                              <2>     DOS_Exit cx
  1424                              <3> %if DOS_SHELL == 1
  1425                              <3>  %ifidni %1, ax
  1426                              <3>  EMIT_ERROR 'AX not allowed here.'
  1427                              <3>  %elifidni %1, bx
  1428                              <3>  mov ax, 0x4C00
  1429                              <3>  or ax, bx
  1430                              <3>  SysCall
  1431                              <3>  %elifidni %1, CX
  1432 00000693 66B8004C            <3>  mov ax, 0x4C00
  1433 00000697 6609C8              <3>  or ax, cx
  1434                              <3>  SysCall
   133                              <4> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 0000069A CD21                <4>  int 0x21
   135                              <4> %else
   136                              <4>  EMIT_ERROR 'todo: windows'
   137                              <4> %endif
  1435                              <3>  %elifidni %1, dx
  1436                              <3>  mov ax, 0x4C00
  1437                              <3>  or ax, dx
  1438                              <3>  SysCall
  1439                              <3>  %elifnum %1
  1440                              <3>  mov ax, 0x4C00 | %1
  1441                              <3>  SysCall
  1442                              <3>  %else
  1443                              <3>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <3>  %endif
  1445                              <3> %endif
   178                              <1> %include 'InitConsole.asm'          ; initialize the DOS console
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  InitConsole.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> dos_init_console:
    10 0000069C E810000000          <2>     call dos_get_cols               ; get DOS screen columns
    11 000006A1 E812000000          <2>     call dos_get_rows               ; get DOS screen rows
    12                              <2>     
    13                              <2>     SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 000006A6 E8C0010000          <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
    14                              <2>     
    15 000006AB E817000000          <2>     call dos_get_command_line
    16 000006B0 C3                  <2>     ret
    17                              <2> 
    18                              <2> ; -----------------------------------------------------------------------------
    19                              <2> ; \brief get DOS screen columns
    20                              <2> ; -----------------------------------------------------------------------------
    21                              <2> dos_get_cols:
    22 000006B1 B40F                <2>     mov  ah, 0Fh
    23                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000006B3 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    24                              <2>     ; AL = aktueller Videomodus
    25                              <2>     ; AH = Spaltenzahl
    26                              <2>     ; BH = aktive Seite
    27 000006B5 88E3                <2>     mov  bl, ah           ; BL = Spalten
    28 000006B7 C3                  <2>     ret
    29                              <2> 
    30                              <2> ; -----------------------------------------------------------------------------
    31                              <2> ; \brief get DOS screen rows
    32                              <2> ; -----------------------------------------------------------------------------
    33                              <2> dos_get_rows:
    34 000006B8 66B83011            <2>     mov  ax, 1130h
    35 000006BC B700                <2>     mov  bh, 00h          ; aktuelle Font/Block
    36                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000006BE CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    37 000006C0 88D2                <2>     mov  dl, dl           ; DL = Zeilen-1
    38 000006C2 FEC2                <2>     inc  dl               ; DL = Zeilen
    39 000006C4 88D7                <2>     mov  bh, dl           ; BH = Zeilen
    40 000006C6 C3                  <2>     ret
    41                              <2> 
    42                              <2> ; -----------------------------------------------------------------------------
    43                              <2> ; \brief DOS - get command line arguments from PSP ...
    44                              <2> ; -----------------------------------------------------------------------------
    45                              <2> dos_get_command_line:
    46 000006C7 6631C0              <2>     xor  ax, ax
    47 000006CA 66BE8100            <2>     mov  si, 81h          ; SI -> Beginn der Kommandozeile im PSP
    48 000006CE 8A0D80000000        <2>     mov  cl, [80h]        ; CL = Länge
    49 000006D4 30ED                <2>     xor  ch, ch           ; CX = Länge
    50                              <2> 
    51 000006D6 67E326              <2>     jcxz .no_args       ; nichts übergeben?
    52                              <2>     ; Zielpuffer vorbereiten
    53 000006D9 66BF(C204)          <2>     mov  di, PTR16(_cA_cmd_buf) ; DI -> Ziel
    54                              <2>     .copy:
    55 000006DD AC                  <2>     lodsb                 ; AL = [DS:SI], SI++
    56 000006DE 3C0D                <2>     cmp   al, 0x0D        ; CR markiert das Ende (Sicherheit)
    57 000006E0 7403                <2>     je   .done_copy
    58 000006E2 AA                  <2>     stosb                 ; [ES:DI]=AL (ES=DS in .COM), DI++
    59 000006E3 E2F8                <2>     loop .copy
    60                              <2> 
    61                              <2>     .done_copy:
    62 000006E5 B000                <2>     mov  al, 0
    63 000006E7 AA                  <2>     stosb
    64                              <2>     
    65                              <2>     ; Trim: nachlaufende Spaces entfernen
    66                              <2>     .trim:
    67 000006E8 6681FF(C204)        <2>     cmp  di, PTR16(_cA_cmd_buf)
    68 000006ED 760A                <2>     jbe  .make_dos_str
    69 000006EF 664F                <2>     dec  di
    70 000006F1 67803D20            <2>     cmp  byte [di], ' '
    71 000006F5 74F1                <2>     je   .trim
    72 000006F7 6647                <2>     inc  di
    73                              <2> 
    74                              <2>     .make_dos_str:
    75 000006F9 67C60500            <2>     mov  byte [di], 0     ; für DOS-Funktion 09h Stringabschluss
    76 000006FD EB2B                <2>     jmp  .next
    77                              <2>     
    78                              <2>     .no_args:
    79                              <2>     SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 000006FF E867010000          <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
    80                              <2>     SET_CURSOR 0, 1
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000704 B200                <3>  mov dl, %1
  1301 00000706 B601                <3>  mov dh, %2
  1302 00000708 E8A2FAFFFF          <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    81                              <2>     PUTS_COLOR noargs_msg, 0x02 | 0x10
  1350                              <3> %if DOS_SHELL == 1
  1351                              <3> 
  1352                              <3>  %ifstr %1
  1353                              <3>  section .data
  1354                              <3>  %%msg: db %1, 0
  1355                              <3>  section .text
  1356                              <3>  xor bx, bx
  1357                              <3>  mov bl, %2
  1358                              <3>  mov si, PTR16(%%msg)
  1359                              <3>  call PutStrColor
  1360                              <3>  %elifidni %1, SI
  1361                              <3>  section .text
  1362                              <3>  mov bl, %2
  1363                              <3>  call PutStrColor
  1364                              <3>  %elifidni %1, DI
  1365                              <3>  section .text
  1366                              <3>  mov bl, %2
  1367                              <3>  call PutStrColor
  1368                              <3>  %else
  1369                              <3>  %assign __count 0
  1370                              <3>  %assign __varg 0
  1371                              <3>  %assign __stop 0
  1372                              <3>  %rep MAX_ARGV
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1380                              <3>  %endrep
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1381                              <3>  %if __varg > 0
  1382                              <3>  section .text
  1383                              <3>  mov si, PTR16(_cA_cmd_buf)
  1384                              <3>  mov bl, __varg
  1385                              <3>  call getCommandLine_Arg
  1386                              <3>  call PutStrColor
  1387                              <3>  %else
  1388                              <3>  section .text
  1389 0000070D B312                <3>  mov bl, %2
  1390 0000070F 66B8(4F05)          <3>  mov ax, PTR16(_cA_%1)
  1391 00000713 6689C6              <3>  mov si, ax
  1392 00000716 E8CC000000          <3>  call PutStrColor
  1393                              <3>  %endif
  1394                              <3>  %undef __varg
  1395                              <3>  %endif
  1396                              <3> %else
  1397                              <3>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <3> %endif
    82                              <2>     SET_CURSOR 0, 2
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 0000071B B200                <3>  mov dl, %1
  1301 0000071D B602                <3>  mov dh, %2
  1302 0000071F E88BFAFFFF          <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    83                              <2>     DOS_Exit   0          ; exit - no args.
  1424                              <3> %if DOS_SHELL == 1
  1425                              <3>  %ifidni %1, ax
  1426                              <3>  EMIT_ERROR 'AX not allowed here.'
  1427                              <3>  %elifidni %1, bx
  1428                              <3>  mov ax, 0x4C00
  1429                              <3>  or ax, bx
  1430                              <3>  SysCall
  1431                              <3>  %elifidni %1, CX
  1432                              <3>  mov ax, 0x4C00
  1433                              <3>  or ax, cx
  1434                              <3>  SysCall
  1435                              <3>  %elifidni %1, dx
  1436                              <3>  mov ax, 0x4C00
  1437                              <3>  or ax, dx
  1438                              <3>  SysCall
  1439                              <3>  %elifnum %1
  1440 00000724 66B8004C            <3>  mov ax, 0x4C00 | %1
  1441                              <3>  SysCall
   133                              <4> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000728 CD21                <4>  int 0x21
   135                              <4> %else
   136                              <4>  EMIT_ERROR 'todo: windows'
   137                              <4> %endif
  1442                              <3>  %else
  1443                              <3>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <3>  %endif
  1445                              <3> %endif
    84                              <2>     
    85                              <2>     .next:
    86                              <2>     SET_CURSOR 0, 0
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 0000072A B200                <3>  mov dl, %1
  1301 0000072C B600                <3>  mov dh, %2
  1302 0000072E E87CFAFFFF          <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    87 00000733 C3                  <2>     ret
   179                              <1> %include 'Int16ToStr.asm'           ; convert integer number to string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Int16ToStr.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; ----------------------------------------------------------------------------
    11                              <2> ; \brief  convert number from AX register to a string.
    12                              <2> ; \param  AX: 16-Bit value
    13                              <2> ; \param  DI: destination buffer
    14                              <2> ; \return ASCII-decimal without trailing zeros.
    15                              <2> ;         (min. onr digit, and '0' at end.
    16                              <2> ;
    17                              <2> ; \note   destroy's: AX,BX,CX,DX (internal saved)
    18                              <2> ; \note   buffer: max. 5 digits + '$' => min. 6 bytes
    19                              <2> ; ----------------------------------------------------------------------------
    20                              <2> DOSIntToStr:
    21 00000734 6650                <2>     push ax
    22 00000736 6653                <2>     push bx
    23 00000738 6651                <2>     push cx
    24 0000073A 6652                <2>     push dx
    25 0000073C 6657                <2>     push di
    26                              <2> 
    27 0000073E 66BB0A00            <2>     mov bx, 10
    28 00000742 6631C9              <2>     xor cx, cx                 ; Zähler für gepushte Reste
    29                              <2> 
    30 00000745 6683F800            <2>     cmp ax, 0
    31 00000749 7508                <2>     jne .div_loop
    32 0000074B 67C60530            <2>     mov byte [di], '0'
    33 0000074F 6647                <2>     inc di
    34 00000751 EB1B                <2>     jmp short .finish
    35                              <2> 
    36                              <2>     .div_loop:
    37 00000753 6631D2              <2>     xor dx, dx                 ; DX:AX / 10
    38 00000756 66F7F3              <2>     div bx                     ; AX = Quotient, DX = Rest (0..9)
    39 00000759 6652                <2>     push dx
    40 0000075B 6641                <2>     inc cx
    41 0000075D 6685C0              <2>     test ax, ax
    42 00000760 75F1                <2>     jne .div_loop
    43                              <2> 
    44                              <2>     .write_loop:
    45 00000762 665A                <2>     pop dx
    46 00000764 80C230              <2>     add dl, '0'
    47 00000767 678815              <2>     mov [di], dl
    48 0000076A 6647                <2>     inc di
    49 0000076C E2F4                <2>     loop .write_loop
    50                              <2> 
    51                              <2>     .finish:
    52 0000076E 67C60500            <2>     mov byte [di], 0x00
    53                              <2> 
    54 00000772 665F                <2>     pop di
    55 00000774 665A                <2>     pop dx
    56 00000776 6659                <2>     pop cx
    57 00000778 665B                <2>     pop bx
    58 0000077A 6658                <2>     pop ax
    59 0000077C C3                  <2>     ret
   180                              <1> %include 'PutStrColor.asm'          ; put colored text onto the DOS screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  PutStrColor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; --- String per BIOS-Teletype (AH=0Eh) ausgeben ---
    11                              <2> ; putc: AL -> Zeichen ausgeben
    12                              <2> putc:
    13 0000077D 6652                <2>     push dx
    14 0000077F 88C2                <2>     mov dl, al
    15 00000781 B402                <2>     mov ah, 02h
    16                              <2>     SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000783 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
    17 00000785 665A                <2>     pop dx
    18 00000787 C3                  <2>     ret
    19                              <2> 
    20                              <2> ; crlf: \r\n
    21                              <2> DOSrncrlf:
    22 00000788 B00D                <2>     mov al, 13
    23 0000078A E8EEFFFFFF          <2>     call putc
    24 0000078F B00A                <2>     mov al, 10
    25 00000791 E8E7FFFFFF          <2>     call putc
    26 00000796 C3                  <2>     ret
    27                              <2> 
    28                              <2> DOSPutStrColor:
    29 00000797 B409                <2>     mov  ah, 09h
    30                              <2>     SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000799 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
    31 0000079B C3                  <2>     ret
    32                              <2> 
    33                              <2> print_z:
    34 0000079C 6652                <2>     push dx             ; save DX
    35 0000079E 6689D6              <2>     mov si, dx
    36                              <2>     .find_end:
    37 000007A1 AC                  <2>     lodsb               ; AL = [SI], SI++
    38 000007A2 3C00                <2>     cmp  al, 0
    39 000007A4 75FB                <2>     jne .find_end       ; repeat, till 0x00 is found
    40 000007A6 664E                <2>     dec si              ; SI points to 0x00
    41                              <2>     
    42 000007A8 B024                <2>     mov al, '$'         ; set DOS String end mark
    43 000007AA 678804              <2>     mov [si], al        ; append AL
    44 000007AD 6646                <2>     inc si
    45 000007AF 67C60400            <2>     mov byte [si], 0    ; end of C-String
    46                              <2>     
    47 000007B3 668935(E3160000)    <2>     mov [PTR16(fdbuf)], si
    48                              <2>     DOS_Write fdbuf
  1463 000007BA 668D15(E3160000)    <3>  lea dx, [PTR16(_cA_%1)]
  1464 000007C1 E803000000          <3>  call DOS_ConsoleWrite
    49 000007C6 665A                <2>     pop dx              ; restore DX
    50 000007C8 C3                  <2>     ret
    51                              <2> 
    52                              <2> ; DX -> 0-terminierte Zeichenkette
    53                              <2> DOS_ConsoleWrite:
    54 000007C9 6650                <2>     push ax
    55 000007CB 6652                <2>     push dx
    56 000007CD 6656                <2>     push si
    57 000007CF 6689D6              <2>     mov si, dx
    58                              <2>     .print_z_loop:
    59 000007D2 AC                  <2>     lodsb
    60 000007D3 3C24                <2>     cmp al, '$'
    61 000007D5 7409                <2>     je .pe_done
    62 000007D7 E8A1FFFFFF          <2>     call putc
    63 000007DC 6646                <2>     inc si
    64 000007DE EBF2                <2>     jmp .print_z_loop
    65                              <2>     .pe_done:
    66 000007E0 665E                <2>     pop si
    67 000007E2 665A                <2>     pop dx
    68 000007E4 6658                <2>     pop ax
    69 000007E6 C3                  <2>     ret
    70                              <2> 
    71                              <2> PutStrColor:
    72 000007E7 6653                <2>     push bx
    73                              <2>     
    74 000007E9 8A3D(DF010000)      <2>     mov  bh, [PTR16(dos_readln_flag)]
    75 000007EF 80FF00              <2>     cmp  bh, 0
    76 000007F2 740C                <2>     je   .no_length
    77 000007F4 6683C602            <2>     add  si, 2
    78 000007F8 B700                <2>     mov  bh, 0
    79 000007FA 883D(DF010000)      <2>     mov  [PTR16(dos_readln_flag)], bh
    80                              <2>     .no_length:
    81 00000800 665B                <2>     pop  bx
    82                              <2>     
    83 00000802 668B15(E0010000)    <2>     mov  dx, [PTR16(dos_xpos)]
    84                              <2>     ; -------------------
    85                              <2>     .print_loop:
    86 00000809 AC                  <2>     lodsb                ; AL := [SI], SI++
    87                              <2>     
    88                              <2>     COMPARE al, 0x00, .printed  ; reach end  ?
  1540 0000080A 3C00                <3>  cmp %1, %2
  1541 0000080C 7420                <3>  je %3
    89                              <2>     COMPARE al, 0x0d, .printed
  1540 0000080E 3C0D                <3>  cmp %1, %2
  1541 00000810 741C                <3>  je %3
    90                              <2>     COMPARE al, 0x0a, .printed
  1540 00000812 3C0A                <3>  cmp %1, %2
  1541 00000814 7418                <3>  je %3
    91                              <2>     
    92 00000816 84C0                <2>     test al, al
    93 00000818 7414                <2>     jz   .printed
    94 0000081A B409                <2>     mov  ah, 09h         ; Teletype-Ausgabe
    95 0000081C B700                <2>     mov  bh, 0           ; page 0 todo
    96 0000081E 66B90100            <2>     mov  cx, 1           ; mim
    97                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000822 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    98                              <2>     
    99 00000824 B402                <2>     mov ah, 0x02
   100 00000826 B700                <2>     mov bh, 0
   101 00000828 6642                <2>     inc dx
   102                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 0000082A CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
   103                              <2>     
   104 0000082C EBDB                <2>     jmp  .print_loop
   105                              <2> 
   106                              <2>     .printed:
   107                              <2>     ;call  DOS_getCursor
   108 0000082E C3                  <2>     ret
   109                              <2>     
   110                              <2> ; --- Cursorposition lesen (AH=03h) ---
   111                              <2> DOS_getCursor:
   112 0000082F 6652                <2>     push dx
   113 00000831 6657                <2>     push di
   114 00000833 6656                <2>     push si
   115                              <2>     
   116 00000835 B403                <2>     mov  ah, 03h         ; Read Cursor Position
   117 00000837 B700                <2>     mov  bh, 0           ; Videoseite 0
   118                              <2>     VideoCall            ; Rückgabe: DH=Zeile, DL=Spalte (0-basiert)
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000839 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
   119                              <2>     
   120 0000083B 8835(E1010000)      <2>     mov  [PTR16(dos_ypos)], dh
   121 00000841 8815(E0010000)      <2>     mov  [PTR16(dos_xpos)], dl
   122                              <2>     
   123 00000847 665E                <2>     pop  si
   124 00000849 665F                <2>     pop  di
   125 0000084B 665A                <2>     pop  dx
   126 0000084D C3                  <2>     ret
   181                              <1> %include 'ReadLn16.asm'             ; read a line of text
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ReadLn16.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief Eingabe holen (DOS Zeileneingabe, mit eigenem Editor/Echo)
    12                              <2> ; \param DX - buffer
    13                              <2> ; -----------------------------------------------------------------------------
    14                              <2> DOSReadLn:
    15 0000084E B40A                <2>     mov ah, 0Ah
    16 00000850 CD21                <2>     int 21h              ; Rückkehr nach ENTER; [buf+1]=len, [buf+2..]=Text, [buf+2+len]=0Dh
    17                              <2> 
    18                              <2>     ; SI = &Textanfang, BL = len
    19 00000852 6689D3              <2>     mov bx, dx
    20 00000855 66678D7702          <2>     lea si, [bx + 2]
    21 0000085A 678A5F01            <2>     mov bl, [bx + 1]
    22                              <2> 
    23                              <2>     ; CR hinter dem Text durch 0x00 ersetzen -> sauber terminierter String
    24 0000085E 67C60000            <2>     mov byte [si + bx], 0x00
    25                              <2>     
    26                              <2>     ; set flag for puts_color
    27 00000862 B701                <2>     mov bh, 1
    28 00000864 883D(DF010000)      <2>     mov [PTR16(dos_readln_flag)], bh
    29                              <2> 
    30                              <2>     ; neue Zeile
    31                              <2>     ;mov dx, PTR16(crlf)
    32                              <2>     ;mov ah, 09h
    33                              <2>     ;int 21h
    34                              <2>     
    35 0000086A C3                  <2>     ret
    36                              <2>  
   182                              <1> %include 'ScreenClear.asm'          ; clear the screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ScreenClear.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define TEXT_VRAM 0B800h
     9                              <2> 
    10                              <2> dos_screen_clear:
    11 0000086B 1E                  <2>     push ds
    12 0000086C 66B800B8            <2>     mov  ax, TEXT_VRAM
    13 00000870 8EC0                <2>     mov  es, ax
    14                              <2> 
    15 00000872 6631FF              <2>     xor  di, di         ; Offset 0
    16                              <2>     
    17                              <2>     ; default size is:  80x25
    18 00000875 88D8                <2>     mov  al, bl         ; AL = 25
    19 00000877 F6E7                <2>     mul  bh             ; AX = AL * BH = 25 * 80 = 2000 (0x07D0)
    20 00000879 6689C1              <2>     mov  cx, ax         ; 2000 chars
    21                              <2>     
    22                              <2>     ; color
    23 0000087C 66B82007            <2>     mov  ax, 0x0720     ; AL=' ' (20h), AH=07h (hellgrau auf schwarz)
    24                              <2> 
    25                              <2>     .fill:
    26 00000880 66AB                <2>     stosw               ; schreibt AX -> ES:[DI], DI+=2
    27 00000882 E2FC                <2>     loop .fill
    28                              <2> 
    29 00000884 1F                  <2>     pop  ds
    30                              <2> 
    31                              <2>     SET_CURSOR 0, 0
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000885 B200                <3>  mov dl, %1
  1301 00000887 B600                <3>  mov dh, %2
  1302 00000889 E821F9FFFF          <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    32                              <2>     
    33 0000088E C3                  <2>     ret
    34                              <2>  
   183                              <1> %include 'Str16Len.asm'             ; get the length of a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Str16Len.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief  get the 16 bit length of a 0-terminated string
    12                              <2> ; \param  Input:  ES:SI -> "0"-terminierter String
    13                              <2> ; \return Output: AX = Länge (ohne '0')
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> DOSStrLen:
    16 0000088F 6657                <2>     push di             ; save DI
    17 00000891 6689F7              <2>     mov  di, si         ; DI = SI
    18 00000894 66B80000            <2>     mov  ax, 0          ; reset counter
    19                              <2>     
    20                              <2>     next:
    21 00000898 678A04              <2>     mov  al, [si]       ; get character
    22 0000089B 3C00                <2>     cmp  al, 0          ; found 0-terminator ?
    23 0000089D 7406                <2>     je   done           ; yes -> .done
    24                              <2>     
    25 0000089F 6646                <2>     inc  si
    26 000008A1 6640                <2>     inc  ax
    27 000008A3 EBF3                <2>     jmp  next
    28                              <2>     
    29                              <2>     done:
    30 000008A5 665F                <2>     pop     di
    31 000008A7 C3                  <2>     ret
   184                              <1> %include 'StrCompare.asm'           ; string compare
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCompare.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief strcmp - compares two 0-terminated strings: DS:SI vs. ES:DI.
    11                              <2> ; \param 1. dst > DI
    12                              <2> ; \param 2. src > SI
    13                              <2> ; \return AL = 1 (found/same)
    14                              <2> ;         AL = 0 (not same)
    15                              <2> ; -----------------------------------------------------------------------------
    16                              <2> string_compare:
    17 000008A8 6656                <2>     push si             ; save src > si
    18                              <2>     
    19                              <2>     .next:
    20 000008AA 678A04              <2>     mov  al, [si]       ; get src byte
    21 000008AD 678A1D              <2>     mov  bl, [di]       ; get dst byte
    22                              <2>     
    23 000008B0 673A05              <2>     cmp  al, [di]       ; dst == src ?
    24 000008B3 750D                <2>     jne  .not_equal     ; no ?
    25                              <2> 
    26 000008B5 6646                <2>     inc  si             ; next src pos.
    27 000008B7 6647                <2>     inc  di             ; next dst pos.
    28                              <2>     
    29 000008B9 84C0                <2>     test al, al
    30 000008BB 75ED                <2>     jnz  .next          ; check
    31                              <2>     
    32                              <2>     .term:
    33 000008BD B000                <2>     mov  al, 0          ; found/same, ret
    34 000008BF 665E                <2>     pop  si             ; restore si
    35 000008C1 C3                  <2>     ret                 ; return to caller
    36                              <2>     
    37                              <2>     .not_equal:
    38 000008C2 B001                <2>     mov  al, 1          ; not found, ret
    39 000008C4 665E                <2>     pop  si             ; restore < si
    40 000008C6 C3                  <2>     ret                 ; return to caller
   185                              <1> %include 'StrCopy.asm'              ; copy a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCopy.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; Quelle: DS:SI (ASCIIZ)
    11                              <2> ; Ziel:   ES:DI   (hier setzen wir ES=DS für Daten im selben Segment)
    12                              <2> ; Rückgabe: SI = Zielstart (damit PUTS_COLOR direkt funktioniert)
    13                              <2> ; Clobbers: AX, CX, DI, ES, BX, FLAGS
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> string_copy:
    16 000008C7 6653                <2>     push    bx
    17 000008C9 6656                <2>     push    si
    18                              <2> 
    19                              <2>     ; ES = DS (falls Ziel im selben Segment)
    20 000008CB 1E                  <2>     push    ds
    21 000008CC 07                  <2>     pop     es
    22                              <2> 
    23 000008CD 6689FB              <2>     mov     bx, di          ; Zielstart merken
    24 000008D0 66B93F00            <2>     mov     cx, 63          ; (optional) max. 63 Zeichen + 0
    25                              <2> 
    26                              <2>     .copy:
    27 000008D4 AC                  <2>     lodsb
    28 000008D5 AA                  <2>     stosb
    29 000008D6 84C0                <2>     test    al, al
    30 000008D8 7407                <2>     jz      .done
    31 000008DA E2F8                <2>     loop    .copy
    32 000008DC 2667C60500          <2>     mov     byte [es:di], 0
    33                              <2> 
    34                              <2>     .done:
    35 000008E1 6689DE              <2>     mov     si, bx          ; <- WICHTIG: SI auf Zielstart setzen
    36 000008E4 665B                <2>     pop     bx              ; ursprüngliches SI verwerfen (gewollt)
    37 000008E6 665B                <2>     pop     bx              ; wiederherstellen von BX
    38 000008E8 C3                  <2>     ret
   186                              <1> 
   187                              <1> code16_end:
    15                                  
    16                                  section .data
    17                                  %include 'data16.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  data16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> data16_start:
     9                              <1> 
    10 0000004D 546869732070726F67- <1> msg:            db "This program requieres MS-Windows.$",0
    10 00000056 72616D207265717569- <1>
    10 0000005F 65726573204D532D57- <1>
    10 00000068 696E646F77732E2400  <1>
    11 00000071 4F70656E206572726F- <1> msgErr:         db 'Open error AX=', '$'
    11 0000007A 722041583D24        <1>
    12                              <1> 
    13                              <1> 
    14                              <1> ASTR dos_cap2A,  "ein Text", 0
   512                              <2> %if __pre_stop == 0
   513 00000080 65696E205465787400- <2>  _cA_%1: db %2, 0
   513 00000089 00                  <2>
   514                              <2>  _cA_%1_end:
   515                              <2>  _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <2> %endif
    15                              <1> ASTR dos_prompt, "Eingabe:       ", 0
   512                              <2> %if __pre_stop == 0
   513 0000008A 45696E676162653A20- <2>  _cA_%1: db %2, 0
   513 00000093 2020202020200000    <2>
   514                              <2>  _cA_%1_end:
   515                              <2>  _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <2> %endif
    16                              <1> 
    17 0000009B 0D0A24              <1> crlf:            db 13,10,'$'
    18 0000009E 07                  <1> dos_color:       db 0x07
    19                              <1> 
    20                              <1> ; -----------------------------------------------------------------------------
    21                              <1> ; Buffer-Struktur für AH=0Ah:
    22                              <1> ; [0] = maxlen, [1] = len(out), [2..] = Text, danach CR
    23                              <1> ; -----------------------------------------------------------------------------
    24                              <1> BUFSZ            equ 64
    25 0000009F 3E                  <1> _cA_dos_buffer:  db BUFSZ-2       ; Max. Eingabezeichen (ohne die 2 Verwaltungsbytes)
    26 000000A0 00                  <1>                  db 0             ; tatsächliche Länge (OUT)
    27 000000A1 00<rep 3Eh>         <1>                  times BUFSZ-2 db 0
    28 000000DF 00                  <1> dos_readln_flag: db 0
    29                              <1> 
    30                              <1> ; -----------------------------------------------------------------------------
    31                              <1> ; \brief DOS console settings ...
    32                              <1> ; -----------------------------------------------------------------------------
    33 000000E0 00                  <1> dos_xpos:           db 0      ; current text cursor column
    34 000000E1 00                  <1> dos_ypos:           db 0      ; current text cursor row
    35 000000E2 00                  <1> dos_page:           db 0      ; current video page
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; dBASE data ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 000000E3 444154412E44424600  <1> _cA_DBFNAME:        db 'DATA.DBF',0
    41                              <1> 
    42 000000EC 644241534520495620- <1> msgTitle:           db 'dBASE IV DBF Header',13,10,'$'
    42 000000F5 444246204865616465- <1>
    42 000000FE 720D0A24            <1>
    43 00000102 55736167653A204442- <1> msgUsage:           db 'Usage: DBFHEAD <datei.dbf>',13,10,'$'
    43 0000010B 4648454144203C6461- <1>
    43 00000114 7465692E6462663E0D- <1>
    43 0000011D 0A24                <1>
    44 0000011F 4665686C65723A2044- <1> msgOpenErr:         db 'Fehler: Datei kann nicht geoeffnet werden.',13,10,'$'
    44 00000128 61746569206B616E6E- <1>
    44 00000131 206E69636874206765- <1>
    44 0000013A 6F6566666E65742077- <1>
    44 00000143 657264656E2E0D0A24  <1>
    45 0000014C 4665686C65723A204C- <1> msgReadErr:         db 'Fehler: Lesen fehlgeschlagen.',13,10,'$'
    45 00000155 6573656E206665686C- <1>
    45 0000015E 67657363686C616765- <1>
    45 00000167 6E2E0D0A24          <1>
    46 0000016C 56657273696F6E2028- <1> msgVer:             db 'Version (hex): $'
    46 00000175 686578293A2024      <1>
    47 0000017C 446174756D20285959- <1> msgDate:            db 'Datum (YY-MM-DD): $'
    47 00000185 2D4D4D2D4444293A20- <1>
    47 0000018E 24                  <1>
    48 0000018F 416E7A61686C204461- <1> msgRecs:            db 'Anzahl Datensaetze (hex): $'
    48 00000198 74656E736165747A65- <1>
    48 000001A1 2028686578293A2024  <1>
    49 000001AA 4865616465726C6165- <1> msgHdr:             db 'Headerlaenge (bytes): $'
    49 000001B3 6E6765202862797465- <1>
    49 000001BC 73293A2024          <1>
    50 000001C1 5361747A6C61656E67- <1> msgRec:             db 'Satzlaenge (bytes): $'
    50 000001CA 652028627974657329- <1>
    50 000001D3 3A2024              <1>
    51 000001D6 4D44582D466C616720- <1> msgMDX:             db 'MDX-Flag (hex): $'
    51 000001DF 28686578293A2024    <1>
    52 000001E7 4C616E677561676520- <1> msgLang:            db 'Language Driver ID (hex): $'
    52 000001F0 447269766572204944- <1>
    52 000001F9 2028686578293A2024  <1>
    53 00000202 46656C6465723A0D0A- <1> msgFields:          db 'Felder:',13,10,'$'
    53 0000020B 24                  <1>
    54 0000020C 4B65696E652046656C- <1> msgNoFields:        db 'Keine Felder gefunden.',13,10,'$'
    54 00000215 64657220676566756E- <1>
    54 0000021E 64656E2E0D0A24      <1>
    55 00000225 202046656C64202324  <1> msgFieldN:          db '  Feld #$'
    56 0000022E 3A2024              <1> msgColonSp:         db ': $'
    57 00000231 2C2024              <1> msgCommaSp:         db ', $'
    58 00000234 202F2024            <1> msgSlash:           db ' / $'
    59                              <1> 
    60 00000238 55736167653A204442- <1> _cA_msg_usage:          db 'Usage: DBFMAKE <type:3|4> <CREATE|APPEND> <C|I|F|B|D|T> <feldname> <feldlaenge>', 0
    60 00000241 464D414B45203C7479- <1>
    60 0000024A 70653A337C343E203C- <1>
    60 00000253 4352454154457C4150- <1>
    60 0000025C 50454E443E203C437C- <1>
    60 00000265 497C467C427C447C54- <1>
    60 0000026E 3E203C66656C646E61- <1>
    60 00000277 6D653E203C66656C64- <1>
    60 00000280 6C61656E67653E00    <1>
    61 00000288 4665686C65723A2041- <1> _cA_msg_badargs:        db 'Fehler: Argumente ungueltig.',0
    61 00000291 7267756D656E746520- <1>
    61 0000029A 756E6775656C746967- <1>
    61 000002A3 2E00                <1>
    62 000002A5 4665686C65723A2044- <1> _cA_msg_openfail:       db 'Fehler: Datei kann nicht geoeffnet/erstellt werden.',0
    62 000002AE 61746569206B616E6E- <1>
    62 000002B7 206E69636874206765- <1>
    62 000002C0 6F6566666E65742F65- <1>
    62 000002C9 727374656C6C742077- <1>
    62 000002D2 657264656E2E00      <1>
    63 000002D9 4665686C65723A2044- <1> _cA_msg_ver_mismatch:   db 'Fehler: DBF-Typ passt nicht zur Datei.',0
    63 000002E2 42462D547970207061- <1>
    63 000002EB 737374206E69636874- <1>
    63 000002F4 207A75722044617465- <1>
    63 000002FD 692E00              <1>
    64 00000300 415050454E44206162- <1> _cA_msg_append_recs:    db 'APPEND abgelehnt: Datei enthaelt Datensaetze (nicht unterstuetzt).',0
    64 00000309 67656C65686E743A20- <1>
    64 00000312 446174656920656E74- <1>
    64 0000031B 6861656C7420446174- <1>
    64 00000324 656E736165747A6520- <1>
    64 0000032D 286E6963687420756E- <1>
    64 00000336 74657273747565747A- <1>
    64 0000033F 74292E00            <1>
    65 00000343 492F4F2D4665686C65- <1> _cA_msg_ioerr:          db 'I/O-Fehler.',0
    65 0000034C 722E00              <1>
    66 0000034F 4665686C65723A2075- <1> _cA_msg_badheader:      db 'Fehler: ungueltiger Header/Felddeskriptor.',0
    66 00000358 6E6775656C74696765- <1>
    66 00000361 72204865616465722F- <1>
    66 0000036A 46656C646465736B72- <1>
    66 00000373 6970746F722E00      <1>
    67 0000037A 4E6963687420756E74- <1> _cA_msg_not_supported:  db 'Nicht unterstuetzt: Feldtyp nur mit Typ 4.',0
    67 00000383 657273747565747A74- <1>
    67 0000038C 3A2046656C64747970- <1>
    67 00000395 206E7572206D697420- <1>
    67 0000039E 54797020342E00      <1>
    68 000003A5 4F4B3A204E65756520- <1> _cA_msg_ok_create:      db 'OK: Neue DBF mit einem Feld erstellt (DATA.DBF).',0
    68 000003AE 444246206D69742065- <1>
    68 000003B7 696E656D2046656C64- <1>
    68 000003C0 2065727374656C6C74- <1>
    68 000003C9 2028444154412E4442- <1>
    68 000003D2 46292E00            <1>
    69 000003D6 4F4B3A2046656C6420- <1> msg_ok_append:      db 'OK: Feld an bestehende leere DBF angehaengt.',0
    69 000003DF 616E20626573746568- <1>
    69 000003E8 656E6465206C656572- <1>
    69 000003F1 652044424620616E67- <1>
    69 000003FA 656861656E67742E00  <1>
    70 00000403 48696E776569733A20- <1> msg_fieldexists:    db 'Hinweis: Feld bereits vorhanden; keine Aenderung vorgenommen.',0
    70 0000040C 46656C642062657265- <1>
    70 00000415 69747320766F726861- <1>
    70 0000041E 6E64656E3B206B6569- <1>
    70 00000427 6E652041656E646572- <1>
    70 00000430 756E6720766F726765- <1>
    70 00000439 6E6F6D6D656E2E00    <1>
    71                              <1> 
    72 00000441 43524541544500      <1> str_CREATE:         db 'CREATE',0
    73 00000448 415050454E4400      <1> str_APPEND:         db 'APPEND',0
    74                              <1> 
    75                              <1> ; ---- Daten ----
    76 0000044F 6E6F20617267732E00  <1> _cA_noargs_msg:     db 'no args.', 0
    77 00000458 475A2E45584500      <1> _cA_GzipAppName:    db 'GZ.EXE', 0
    78 0000045F 65786563206F662067- <1> _cA_GzipErrorMsg:   db 'exec of gzip.exe failed.', 0
    78 00000468 7A69702E6578652066- <1>
    78 00000471 61696C65642E00      <1>
    79                              <1> 
    80                              <1> ; Kommandozeile im PSP-Format:
    81                              <1> ; Byte 0: Länge (Anzahl Zeichen)
    82                              <1> ; Danach die Zeichen, abgeschlossen mit 0Dh (CR).
    83                              <1> ; Üblicherweise beginnt die Tail mit einem Leerzeichen vor dem ersten Argument.
    84                              <1> 
    85                              <1> GzipCmdTail:
    86 00000478 0E                  <1>     db GzipCmdTextEnd - GzipCmdText          ; Länge
    87                              <1> GzipCmdText:
    88 00000479 202D64206D6F64756C- <1>     db ' -d modul1.biz'
    88 00000482 312E62697A          <1>
    89                              <1> GzipCmdTextEnd:
    90 00000487 0D                  <1>     db 13
    91                              <1> 
    92                              <1> ; -----------------------------------------------------------------------------
    93                              <1> ; \brief DOS error code messages for int 0x21 function 0x3D (open file)
    94                              <1> ; -----------------------------------------------------------------------------
    95 00000488 756E6B6E6F776E2065- <1> _cA_open_error_nd:  db 'unknown error.',0
    95 00000491 72726F722E00        <1>
    96 00000497 696E76616C69642066- <1> _cA_open_error_01:  db 'invalid function / wrong AH code.', 0
    96 000004A0 756E6374696F6E202F- <1>
    96 000004A9 2077726F6E67204148- <1>
    96 000004B2 20636F64652E00      <1>
    97 000004B9 66696C65206E6F7420- <1> _cA_open_error_02:  db 'file not found.', 0
    97 000004C2 666F756E642E00      <1>
    98 000004C9 70617468206E6F7420- <1> _cA_open_error_03:  db 'path not found.', 0
    98 000004D2 666F756E642E00      <1>
    99 000004D9 746F6F206D616E7920- <1> _cA_open_error_04:  db 'too many open files.', 0
    99 000004E2 6F70656E2066696C65- <1>
    99 000004EB 732E00              <1>
   100 000004EE 616363657373206465- <1> _cA_open_error_05:  db 'access denied.', 0
   100 000004F7 6E6965642E00        <1>
   101 000004FD 696E76616C69642066- <1> _cA_open_error_06:  db 'invalid file handle', 0
   101 00000506 696C652068616E646C- <1>
   101 0000050F 6500                <1>
   102 00000511 6D63622F6172656E61- <1> _cA_open_error_07:  db 'mcb/arena corrupted.', 0
   102 0000051A 20636F727275707465- <1>
   102 00000523 642E00              <1>
   103 00000526 6E6F206D6F7265206D- <1> _cA_open_error_08:  db 'no more memory.', 0
   103 0000052F 656D6F72792E00      <1>
   104 00000536 696E76616C6964206D- <1> _cA_open_error_09:  db 'invalid memory address.', 0
   104 0000053F 656D6F727920616464- <1>
   104 00000548 726573732E00        <1>
   105 0000054E 696E76616C69642065- <1> _cA_open_error_0A:  db 'invalid environment.', 0
   105 00000557 6E7669726F6E6D656E- <1>
   105 00000560 742E00              <1>
   106 00000563 6578652F636F6D2066- <1> _cA_open_error_0B:  db 'exe/com format error..', 0
   106 0000056C 6F726D617420657272- <1>
   106 00000575 6F722E2E00          <1>
   107 0000057A 696E76616C69642061- <1> _cA_open_error_0C:  db 'invalid access token.', 0
   107 00000583 636365737320746F6B- <1>
   107 0000058C 656E2E00            <1>
   108 00000590 6461746120696E666F- <1> _cA_open_error_0D:  db 'data informations are invalid.', 0
   108 00000599 726D6174696F6E7320- <1>
   108 000005A2 61726520696E76616C- <1>
   108 000005AB 69642E00            <1>
   109 000005AF 696E76616C6964206D- <1> _cA_open_error_0E:  db 'invalid memory block.', 0
   109 000005B8 656D6F727920626C6F- <1>
   109 000005C1 636B2E00            <1>
   110 000005C5 696E76616C69642064- <1> _cA_open_error_0F:  db 'invalid drive.', 0
   110 000005CE 726976652E00        <1>
   111 000005D4 747269656420746F20- <1> _cA_open_error_10:  db 'tried to delete current directory.', 0
   111 000005DD 64656C657465206375- <1>
   111 000005E6 7272656E7420646972- <1>
   111 000005EF 6563746F72792E00    <1>
   112 000005F7 66696C65206F6E206F- <1> _cA_open_error_11:  db 'file on other drive.', 0
   112 00000600 746865722064726976- <1>
   112 00000609 652E00              <1>
   113 0000060C 6E6F206D6F72652066- <1> _cA_open_error_12:  db 'no more files/file already exists.', 0
   113 00000615 696C65732F66696C65- <1>
   113 0000061E 20616C726561647920- <1>
   113 00000627 6578697374732E00    <1>
   114 0000062F 6472697665206E6F74- <1> _cA_open_error_15:  db 'drive not ready.', 0
   114 00000638 2072656164792E00    <1>
   115 00000640 6D6564696120646F65- <1> _cA_open_error_1D:  db 'media does not support seek.', 0
   115 00000649 73206E6F7420737570- <1>
   115 00000652 706F7274207365656B- <1>
   115 0000065B 2E00                <1>
   116 0000065D 7365656B206572726F- <1> _cA_open_error_1E:  db 'seek error.', 0
   116 00000666 722E00              <1>
   117 00000669 6472697665206E6F74- <1> _cA_open_error_1F:  db 'drive not available.', 0
   117 00000672 20617661696C61626C- <1>
   117 0000067B 652E00              <1>
   118 0000067E 66696C652063616E20- <1> _cA_open_error_20:  db 'file can not overwrite.', 0
   118 00000687 6E6F74206F76657277- <1>
   118 00000690 726974652E00        <1>
   119 00000696 6472697665206E6F74- <1> _cA_open_error_21:  db 'drive not ready.', 0
   119 0000069F 2072656164792E00    <1>
   120 000006A7 6E6F20646973632063- <1> _cA_open_error_27:  db 'no disc capacities.', 0
   120 000006B0 617061636974696573- <1>
   120 000006B9 2E00                <1>
   121                              <1> 
   122                              <1> ; --- Daten ---
   123 000006BB 4D4F44554C312E4249- <1> _cA_mod_filename:       db 'MODUL1.BIN',0
   123 000006C4 4E00                <1>
   124                              <1> 
   125 000006C6 6D6F64756C65206669- <1> _cA_mod_read_error:     db 'module file not found.',0
   125 000006CF 6C65206E6F7420666F- <1>
   125 000006D8 756E642E00          <1>
   126 000006DD 6F70656E2066696C65- <1> _cA_mod_file_error:     db 'open file error.',0
   126 000006E6 206572726F722E00    <1>
   127 000006EE 66726565206572726F- <1> _cA_mod_free_error:     db 'free error.',0
   127 000006F7 722E00              <1>
   128 000006FA 6D656D6F7279206E6F- <1> _cA_mod_free_error_no:  db 'memory not freed.',0
   128 00000703 742066726565642E00  <1>
   129 0000070C 636C6F736520657272- <1> _cA_mod_clos_error:     db 'close error.',0
   129 00000715 6F722E00            <1>
   130 00000719 66696C65206E6F7420- <1> _cA_mod_clos_error_no:  db 'file not close error.',0
   130 00000722 636C6F736520657272- <1>
   130 0000072B 6F722E00            <1>
   131 0000072F 6E6F206572726F7220- <1> _cA_mod_have_error_no:  db 'no error found.',0
   131 00000738 666F756E642E00      <1>
   132                              <1> 
   133                              <1> ; -----------------------------------------------------------------------------
   134                              <1> ; --- Tabelle: [Fehlercode, Handler] ... 0 = Ende ---
   135                              <1> ; -----------------------------------------------------------------------------
   136                              <1> ERR_ITEMS   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,             0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,                   0x10, 0x11, 0x12, 0x15, 0x1D, 0x1E, 0x1F,                   0x20, 0x21, 0x27
  1764                              <2> _cA_error_dispatch:
  1765                              <2>  %rep %0
  1766                              <2>  _HEX2 %1, __H, __L
  1767                              <2>  dw %1, _cA_errh%+__H%+__L
  1768                              <2>  %undef __H
  1769                              <2>  %undef __L
  1770                              <2>  %rotate 1
  1771                              <2>  %endrep
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000073F 0100[5204]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000743 0200[6904]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000747 0300[8004]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000074B 0400[9704]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000074F 0500[AE04]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000753 0600[C504]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000757 0700[DC04]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000075B 0800[F304]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000075F 0900[0A05]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000763 0A00[2105]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000767 0B00[3805]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000076B 0C00[4F05]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000076F 0D00[6605]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000773 0E00[7D05]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000777 0F00[9405]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000077B 1000[AB05]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000077F 1100[C205]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000783 1200[D905]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000787 1500[F005]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000078B 1D00[0706]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000078F 1E00[1B06]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000793 1F00[2F06]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000797 2000[4306]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000079B 2100[5706]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000079F 2700[6B06]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1772 000007A3 0000[7F06]          <2>  dw 00h, _cA_errhnd
   140                              <1> 
   141 000007A7 0000                <1> _cA_mod_hFile:   dw 0
   142 000007A9 0000                <1> mod_seg_ovl:     dw 0
   143 000007AB 0000                <1> mod_fsize_lo:    dw 0
   144 000007AD 0000                <1> mod_fsize_hi:    dw 0
   145                              <1> 
   146 000007AF 48616C6C6F20766F6D- <1> mod_msg:         db 'Hallo vom Loader!$'
   146 000007B8 204C6F616465722124  <1>
   147                              <1> mod_msg_len:     equ ($ - msg)
   148                              <1> 
   149 000007C1 536F7272792C206174- <1> _cA_no386e:      db 'Sorry, at least a 80386 is needed!',0
   149 000007CA 206C65617374206120- <1>
   149 000007D3 383033383620697320- <1>
   149 000007DC 6E65656465642100    <1>
   150 000007E4 596F75206172652063- <1> _cA_norealmode:  db 'You are currently running in V86 mode!',0
   150 000007ED 757272656E746C7920- <1>
   150 000007F6 72756E6E696E672069- <1>
   150 000007FF 6E20563836206D6F64- <1>
   150 00000808 652100              <1>
   151                              <1> 
   152                              <1> ; --------------------------------
   153                              <1> ; Global Descriptor Table (GDT)
   154                              <1> ; --------------------------------
   155                              <1> 
   156                              <1> _cA_gdt:
   157                              <1>     ; Null-Deskriptor (immer Pflicht)
   158 0000080B 0000000000000000    <1>     dq 0x0000000000000000
   159                              <1> 
   160                              <1>     ; Code-Segment-Deskriptor: Basis=0, Limit=4GB, Executable, Readable
   161                              <1>     ; Access Byte: 0x9A (10011010b)
   162                              <1>     ; Flags+Limit high: 0xCF (11001111b) => Granularity=4K, 32-bit, LimitHigh=0xF
   163                              <1> _cA_gdt_code:
   164 00000813 FFFF                <1>     dw 0xFFFF              ; Limit low
   165 00000815 0000                <1>     dw 0x0000              ; Base low
   166 00000817 00                  <1>     db 0x00                ; Base mid
   167 00000818 9A                  <1>     db 10011010b           ; Access (0x9A)
   168 00000819 CF                  <1>     db 11001111b           ; Flags + Limit high (0xCF)
   169 0000081A 00                  <1>     db 0x00                ; Base high
   170                              <1> 
   171                              <1>     ; Data-Segment-Deskriptor: Basis=0, Limit=4GB, Read/Write
   172                              <1>     ; Access Byte: 0x92 (10010010b)
   173                              <1> _cA_gdt_data:
   174 0000081B FFFF                <1>     dw 0xFFFF              ; Limit low
   175 0000081D 0000                <1>     dw 0x0000              ; Base low
   176 0000081F 00                  <1>     db 0x00                ; Base mid
   177 00000820 92                  <1>     db 10010010b           ; Access (0x92)
   178 00000821 CF                  <1>     db 11001111b           ; Flags + Limit high (0xCF)
   179 00000822 00                  <1>     db 0x00                ; Base high
   180                              <1> _cA_gdt_end:
   181                              <1> 
   182                              <1> _cA_gdt_descriptor:
   183 00000823 1700                <1>     dw PTR16(_cA_gdt_end) - PTR16(_cA_gdt) - 1   ; Limit (Größe der GDT - 1)
   184 00000825 00000000            <1>     dd 0                   ; Basisadresse der GDT (wird oben zur Laufzeit gefüllt)
   185                              <1>     
   186 00000829 0000                <1> hdr_len:            dw 0
   187 0000082B 0000                <1> rec_len:            dw 0
   188                              <1> 
   189 0000082D 343200              <1> _cA_ARGV1: db '42', 0
   190 00000830 203300              <1> _cA_cmd_num: db ' 3',0
   191                              <1> 
   192                              <1> 
   193                              <1> data16_end:
    18                                  
    19                                  section .bss
    20                                  %include 'bss16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  bss16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> bss16_start:
    10                              <1> 
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief hold DOS command line argument information's ...
    13                              <1> ; -----------------------------------------------------------------------------
    14                              <1> %define MAX_ARGS    7
    15                              <1> struc _cA_COMMAND_LINE
    16 00000000 ??                  <1>     .arg_count      resb 1            ; max. 255 arguments
    17 00000001 <res 40h>           <1>     .arg_str        resb 64           ; max. length = 64 bytes
    18                              <1> endstruc
    19 00000000 <res 1C0h>          <1> _cA_command_args:   resb 64 * MAX_ARGS
    20 000001C0 <res 40h>           <1> _cA_command_arglen: resb 64
    21 00000200 ????                <1> arg_total:          resw 1
    22                              <1> 
    23 00000202 <res 40h>           <1> _cA_cmd_arg_1:      resb 64
    24 00000242 <res 40h>           <1> _cA_cmd_arg_2:      resb 64
    25 00000282 <res 40h>           <1> _cA_cmd_arg_3:      resb 64
    26 000002C2 <res 40h>           <1> _cA_cmd_arg_4:      resb 64
    27 00000302 <res 40h>           <1> _cA_cmd_arg_5:      resb 64
    28 00000342 <res 40h>           <1> _cA_cmd_arg_6:      resb 64
    29 00000382 <res 40h>           <1> _cA_cmd_arg_7:      resb 64
    30                              <1> 
    31 000003C2 <res 100h>          <1> _cA_cmd_buf:        resb 256          ; CMD string
    32 000004C2 <res 82h>           <1> _cA_cmd_buffer:     resb 130
    33                              <1> 
    34                              <1> ; EXEC-Parameterblock (14 Bytes)
    35 00000544 <res Eh>            <1> _cA_ExecBlk:        resb 14
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; command line holders ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 00000552 ??                  <1> _cA_db_version:     resb 1   ; 3 -> dBase3, 4 -> dBase4
    41 00000553 ??                  <1> _cA_db_op:          resb 1   ; 0 -> CREATE, 1 -> APPEND
    42 00000554 ??                  <1> _cA_db_type:        resb 1   ; C|I|F|B|D
    43 00000555 ??                  <1> _cA_db_have_token:  resb 1
    44                              <1> 
    45 00000556 <res 1000h>         <1> fdescbuf:           resb 4096
    46                              <1> 
    47 00001556 ????????????        <1> buf_hex:            resb 6            ; 4 Hex-Zeichen + '$' + Reserve
    48 0000155C ??????????????      <1> buf_dec:            resb 7            ; 5 Dezimal-Zeichen + '$' + Reserve
    49                              <1> 
    50 00001563 <res 80h>           <1> filename:           resb 128
    51                              <1> _cA_fdbuf:
    52 000015E3 <res 800h>          <1> fdbuf:              resb 2048
    53 00001DE3 <res 10h>           <1> _cA_namebuf:        resb 16
    54                              <1> 
    55                              <1> hFile:              resw 0
    56                              <1> ; -----------------------------------------------------------------------------
    57                              <1> g_type:             resw 0
    58                              <1> g_cmd:              resb 0
    59                              <1> g_ftype:            resb 0
    60                              <1> g_ftype_mapped:     resb 0
    61                              <1> g_flen:             resw 0
    62                              <1> g_year:             resw 0
    63                              <1> g_month:            resb 0
    64                              <1> g_day:              resb 0
    65                              <1> ; -----------------------------------------------------------------------------
    66                              <1> verByte:            resb 0
    67                              <1> yy:                 resb 0
    68                              <1> mm:                 resb 0
    69                              <1> dd:                 resb 0
    70                              <1> mdx:                resb 0
    71                              <1> lang:               resb 0
    72                              <1> rec32:              resd 0
    73                              <1> 
    74 00001DF3 <res 40h>           <1> tokbuf:             resb 64
    75 00001E33 <res Ch>            <1> fldname:            resb 12
    76                              <1> 
    77 00001E3F <res 20h>           <1> header:             resb 32
    78                              <1> fdbuf_size:         resw 0
    79 00001E5F <res 20h>           <1> tempdesc:           resb 32
    80                              <1> 
    81                              <1> ; -----------------------------------------------------------------------------
    82                              <1> 
    83                              <1> buf_seg:            resw 0
    84                              <1> size_lo:            resw 0
    85                              <1> size_hi:            resw 0
    86                              <1> 
    87                              <1> bss16_end:
    21                                  kernel_end:
