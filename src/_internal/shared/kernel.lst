     1                                  ;---------------------------------------------------
     2                                  ; \file  kernel.asm
     3                                  ; \note  (c) 2025 by Jens Kallup - paule32
     4                                  ;        all rights reserved.
     5                                  ;
     6                                  ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                                  ;---------------------------------------------------
     8                                  bits 16
     9                                  org 0
    10                                  %include 'macros.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  macros.inc
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> ; -----------------------------------------------------------------------------
    10                              <1> ; \brief some pre-defines, to make maintain easier ...
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> %define ERROR_Win32API 'this macro can only be use with win32api (Windows).'
    13                              <1> 
    14                              <1> ; -----------------------------------------------------------------------------
    15                              <1> ; \brief DOS error codes for int 0x21 - 3Dh
    16                              <1> ; -----------------------------------------------------------------------------
    17                              <1> %define ERROR_INVALID_FUNCTION      0x01
    18                              <1> %define ERROR_FILE_NOT_FOUND        0x02
    19                              <1> %define ERROR_PATH_NOT_FOUND        0x03
    20                              <1> %define ERROR_TOO_MANY_OPEN_FILES   0x04
    21                              <1> %define ERROR_ACCESS_DENIED         0x05
    22                              <1> %define ERROR_INVALID_HANDLE        0x06
    23                              <1> %define ERROR_ARENA_TRASHED         0x07
    24                              <1> %define ERROR_NOT_ENOUGH_MEMORY     0x08
    25                              <1> %define ERROR_INVALID_ACCESS        0x0C
    26                              <1> %define ERROR_INVALID_DRIVE         0x0F
    27                              <1> %define ERROR_CURRENT_DIRECTORY     0x10
    28                              <1> %define ERROR_NOT_SAME_DEVICE       0x11
    29                              <1> %define ERROR_NO_MORE_FILES         0x12
    30                              <1> %define ERROR_SEEK                  0x1D
    31                              <1> %define ERROR_NOT_DOS_DISK          0x1E
    32                              <1> 
    33                              <1> ; -----------------------------------------------------------------------------
    34                              <1> ; \brief DOS file open modes ...
    35                              <1> ; -----------------------------------------------------------------------------
    36                              <1> %define DOS_READ_ONLY   0x00    ; read  only
    37                              <1> %define DOS_WRITE_ONLY  0x01    ; write only
    38                              <1> %define DOS_READWRITE   0x02    ; read/write
    39                              <1> 
    40                              <1> ; -----------------------------------------------------------------------------
    41                              <1> ; \brief DOS file seek constants ...
    42                              <1> ; -----------------------------------------------------------------------------
    43                              <1> %define SEEK_BEGIN      0x00    ; begin of file
    44                              <1> %define SEEK_SET        0x01    ; current position
    45                              <1> %define SEEK_END        0x02    ; file end
    46                              <1> 
    47                              <1> ; -----------------------------------------------------------------------------
    48                              <1> ; \brief DOS console settings ...
    49                              <1> ; -----------------------------------------------------------------------------
    50                              <1> %define ATTR_DOS_ERROR              0x0E | 0x10     ; yeloow on blue bakcground
    51                              <1> 
    52                              <1> %define MAX_ARGV        32      ; maximum count of command line arguments
    53                              <1> 
    54                              <1> %ifndef PTR16
    55                              <1> %define PTR16(sym) (sym-code16_start+0x100)
    56                              <1> %endif
    57                              <1> 
    58                              <1> %ifndef PTR64
    59                              <1> %define PTR64(sym) (IMAGE_BASE + RVA_DATA(sym))
    60                              <1> %endif
    61                              <1> 
    62                              <1> ; -----------------------------------------------------------------------------
    63                              <1> ; \brief perform a system call (in this case a DOS int 0x21 call)
    64                              <1> ; -----------------------------------------------------------------------------
    65                              <1> %macro SysCall 0
    66                              <1> %if DOS_SHELL == 1
    67                              <1>     int 0x21        ; DOS interrupt 0x21
    68                              <1> %endif
    69                              <1> %endmacro
    70                              <1> %macro VideoCall 0
    71                              <1> %if DOS_SHELL == 1
    72                              <1>     int 0x10
    73                              <1> %else
    74                              <1>     %error 'only DOS supports interrupts.'
    75                              <1> %endif
    76                              <1> %endmacro
    77                              <1> 
    78                              <1> ; -----------------------------------------------------------------------------
    79                              <1> ; add win64 abi shadow ...
    80                              <1> ; -----------------------------------------------------------------------------
    81                              <1> %macro AddShadow 0-1
    82                              <1> %if %0 == 1
    83                              <1>     sub     rsp, %1
    84                              <1> %else
    85                              <1>     sub     rsp, SW_SHADOW
    86                              <1> %endif
    87                              <1> %endmacro
    88                              <1> 
    89                              <1> ; -----------------------------------------------------------------------------
    90                              <1> ; delete added win64 abi shadow ...
    91                              <1> ; -----------------------------------------------------------------------------
    92                              <1> %macro DelShadow 0-1
    93                              <1> %if %0 == 1
    94                              <1>     add     rsp, %1
    95                              <1> %else
    96                              <1>     add     rsp, SW_SHADOW
    97                              <1> %endif
    98                              <1> %endmacro
    99                              <1> 
   100                              <1> ; -----------------------------------------------------------------------------
   101                              <1> ; MAKE_INT <Label>, <Func1>, <Func2>, ...
   102                              <1> ; -----------------------------------------------------------------------------
   103                              <1> %macro MAKE_INT 2-*
   104                              <1> %1:
   105                              <1> %assign __n %0-1
   106                              <1> %rep __n
   107                              <1>     dq RVA_IDATA(HN_win32_%2)
   108                              <1>     %rotate 1
   109                              <1> %endrep
   110                              <1>     dq 0
   111                              <1> %endmacro
   112                              <1> 
   113                              <1> ; -----------------------------------------------------------------------------
   114                              <1> ; MAKE_IAT <Label>, <Func1>, <Func2>, ...
   115                              <1> ; -----------------------------------------------------------------------------
   116                              <1> %macro MAKE_IAT 2-*
   117                              <1> iat_win32_%1:
   118                              <1> %assign __n %0-1
   119                              <1> %rep __n
   120                              <1> IAT_win32_%2: dq RVA_IDATA(HN_win32_%2)
   121                              <1>     %rotate 1
   122                              <1> %endrep
   123                              <1>     dq 0
   124                              <1> %endmacro
   125                              <1> 
   126                              <1> ; -----------------------------------------------------------------------------
   127                              <1> ; HNSTR <Func1>, <Func2>, ...
   128                              <1> ; -----------------------------------------------------------------------------
   129                              <1> %macro HNSTR 1-*
   130                              <1> %assign __n %0
   131                              <1> %rep __n
   132                              <1> HN_win32_%1: dw 0
   133                              <1>     db %str(%1), 0
   134                              <1> %rotate 1
   135                              <1> %endrep
   136                              <1> %endmacro
   137                              <1> 
   138                              <1> ; -----------------------------------------------------------------------------
   139                              <1> ; MAKE_IMPORT <dir_label>, <mod1>, <mod2>, ...
   140                              <1> ; erzeugt:
   141                              <1> ; dir_label:
   142                              <1> ;   dd RVA_IDATA(INT_<mod>), 0,0, RVA_IDATA(dll_<mod>), RVA_IDATA(iat_<mod>) ...
   143                              <1> ;   dd 0,0,0,0,0
   144                              <1> ; dir_label_end:
   145                              <1> ; -----------------------------------------------------------------------------
   146                              <1> %macro MAKE_IMPORT 1-*
   147                              <1>     %define __DIR %1
   148                              <1>     %1:
   149                              <1>     %assign __n %0-1
   150                              <1>     %rep __n
   151                              <1>         dd RVA_IDATA(INT_win32_%2)
   152                              <1>         dd 0,0
   153                              <1>         dd RVA_IDATA(dll_win32_%2)
   154                              <1>         dd RVA_IDATA(iat_win32_%2)
   155                              <1>         %rotate 1
   156                              <1>     %endrep
   157                              <1>         dd 0,0,0,0,0
   158                              <1>     __DIR %+ _end:
   159                              <1>     %undef __DIR
   160                              <1> %endmacro
   161                              <1> 
   162                              <1> ; -----------------------------------------------------------------------------
   163                              <1> ; mini helper ...
   164                              <1> ; -----------------------------------------------------------------------------
   165                              <1> %macro WIN64_PROLOG 0
   166                              <1>     mov rbp, rsp
   167                              <1>     and rsp, -16
   168                              <1>     AddShadow 32         ; Shadow Space
   169                              <1> %endmacro
   170                              <1> 
   171                              <1> %macro CALL_IAT 1        ; CALL_IAT ExitProcess / RegisterClassExW / ...
   172                              <1>     AddShadow
   173                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_%1)
   174                              <1>     call    [rax]
   175                              <1>     DelShadow
   176                              <1> %endmacro
   177                              <1> 
   178                              <1> ; -----------------------------------------------------------------------------
   179                              <1> ; zero register's
   180                              <1> ; -----------------------------------------------------------------------------
   181                              <1> %macro Zero 1
   182                              <1>     xor %1, %1
   183                              <1> %endmacro
   184                              <1> 
   185                              <1> ; -----------------------------------------------------------------------------
   186                              <1> ; UTF-16LE aus ASCII (<=0x7F) schnell schreiben
   187                              <1> ; -----------------------------------------------------------------------------
   188                              <1> %ifndef WSTR_DEBUG
   189                              <1>     %define WSTR_DEBUG 0
   190                              <1> %endif
   191                              <1> 
   192                              <1> ; -----------------------------------------------------------------------------
   193                              <1> ; WSTR <name>, <items...>
   194                              <1> ; items: Strings ("..."), Zahlen (123, 0x41) oder Ausdrücke/Labels
   195                              <1> ; erzeugt:
   196                              <1> ;   _cW_<name>:              dw ... , 0
   197                              <1> ;   _cW_<name>_end:
   198                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   199                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   200                              <1> ; -----------------------------------------------------------------------------
   201                              <1> %macro WSTR 2+
   202                              <1>     %push WSTR
   203                              <1> 
   204                              <1>     ; Namen sichern, damit %rotate keine Probleme macht
   205                              <1>     %define _WSTR_LBL   _cW_%1
   206                              <1>     %define _WSTR_END   _cW_%1_end
   207                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   208                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   209                              <1> 
   210                              <1> _WSTR_LBL:
   211                              <1>     ; restliche Argumente abarbeiten
   212                              <1>     %assign %$nargs %0-1
   213                              <1>     %rotate 1
   214                              <1> 
   215                              <1>     %rep %$nargs
   216                              <1>         %ifstr %1
   217                              <1>             %strlen %$n %1
   218                              <1>             %assign %$i 0
   219                              <1>             %rep %$n
   220                              <1>                 %substr %$c %1 %$i+1,1
   221                              <1>                 dw %$c                      ; eine 16-bit Code Unit 0x00xx
   222                              <1>                 %assign %$i %$i+1
   223                              <1>             %endrep
   224                              <1>         %elifnum %1
   225                              <1>             dw %1                           ; Zahl/Konstante
   226                              <1>         %else
   227                              <1>             dw %1                           ; Label/Equate/Expression
   228                              <1>         %endif
   229                              <1>         %rotate 1
   230                              <1>     %endrep
   231                              <1> 
   232                              <1>     dw 0                                    ; Null-Terminator (1 Word)
   233                              <1> 
   234                              <1> _WSTR_END:
   235                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2) ; Länge in BYTES (ohne Terminator)
   236                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)              ; Länge in WORDS
   237                              <1> 
   238                              <1>     ; Aufräumen
   239                              <1>     %undef _WSTR_LBL
   240                              <1>     %undef _WSTR_END
   241                              <1>     %undef _WSTR_LENB
   242                              <1>     %undef _WSTR_LENW
   243                              <1>     %pop
   244                              <1> %endmacro
   245                              <1> ; -----------------------------------------------------------------------------
   246                              <1> ; WSTRU <name>, <items...>
   247                              <1> ; items:
   248                              <1> ;   - "ASCII/Latin-1-Strings"  -> jedes Zeichen als 16-bit Code Unit 0x00xx
   249                              <1> ;   - Zahlen/Expressions        -> als Unicode-Codepoint interpretiert:
   250                              <1> ;                                 <=0xFFFF (außer Surrogatbereich) -> 1 Word
   251                              <1> ;                                 >0xFFFF -> Surrogatpaar (2 Words)
   252                              <1> ; erzeugt:
   253                              <1> ;   _cW_<name>:              dw ..., 0
   254                              <1> ;   _cW_<name>_end:
   255                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   256                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   257                              <1> ; -----------------------------------------------------------------------------
   258                              <1> ; --- Helper: einen Unicode-Codepoint als UTF-16 ausgeben ---
   259                              <1> ; -----------------------------------------------------------------------------
   260                              <1> %macro __WSTR_EMIT_CP 1
   261                              <1>     %assign __cp (%1)
   262                              <1> 
   263                              <1>     %if __cp < 0
   264                              <1>         %error "WSTR: negativer Codepoint"
   265                              <1>     %elif __cp <= 0xFFFF
   266                              <1>         ; verbiete explizite Surrogat-Codepoints
   267                              <1>         %if __cp >= 0xD800 && __cp <= 0xDFFF
   268                              <1>             %error "WSTR: Codepoint im Surrogatbereich ist ungueltig"
   269                              <1>         %else
   270                              <1>             dw __cp
   271                              <1>         %endif
   272                              <1>     %elif __cp <= 0x10FFFF
   273                              <1>         %assign __tmp (__cp - 0x10000)
   274                              <1>         %assign __hi  (0xD800 + (__tmp >> 10))
   275                              <1>         %assign __lo  (0xDC00 + (__tmp & 0x3FF))
   276                              <1>         dw __hi, __lo
   277                              <1>     %else
   278                              <1>         %error "WSTR: Codepoint > U+10FFFF"
   279                              <1>     %endif
   280                              <1> %endmacro
   281                              <1> 
   282                              <1> ; --- Hauptmakro ---
   283                              <1> %macro WSTRU 2+
   284                              <1>     %push WSTRU
   285                              <1> 
   286                              <1>     %define _WSTR_LBL   _cW_%1
   287                              <1>     %define _WSTR_END   _cW_%1_end
   288                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   289                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   290                              <1> 
   291                              <1> _WSTR_LBL:
   292                              <1>     %assign %$nargs %0-1
   293                              <1>     %rotate 1
   294                              <1> 
   295                              <1>     %rep %$nargs
   296                              <1>         %ifstr %1
   297                              <1>             ; String: byteweise -> 0x00xx
   298                              <1>             %strlen %$n %1
   299                              <1>             %assign %$i 0
   300                              <1>             %rep %$n
   301                              <1>                 %substr %$c %1 %$i+1,1
   302                              <1>                 dw %$c
   303                              <1>                 %assign %$i %$i+1
   304                              <1>             %endrep
   305                              <1>         %elifnum %1
   306                              <1>             ; Zahl/Expression als Unicode-Scalar
   307                              <1>             __WSTR_EMIT_CP %1
   308                              <1>         %else
   309                              <1>             ; Label/Expression, zur Sicherheit ebenfalls als Codepoint behandeln
   310                              <1>             __WSTR_EMIT_CP %1
   311                              <1>         %endif
   312                              <1>         %rotate 1
   313                              <1>     %endrep
   314                              <1> 
   315                              <1>     dw 0
   316                              <1> 
   317                              <1> _WSTR_END:
   318                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2)
   319                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)
   320                              <1> 
   321                              <1>     %undef _WSTR_LBL
   322                              <1>     %undef _WSTR_END
   323                              <1>     %undef _WSTR_LENB
   324                              <1>     %undef _WSTR_LENW
   325                              <1>     %pop
   326                              <1> %endmacro
   327                              <1> 
   328                              <1> ; -----------------------------------------------------------------------------
   329                              <1> ; WSTRUL  <name>, <args...>   -> definiert <name> und <name>_len
   330                              <1> ; (in Codeunits, ohne Null)
   331                              <1> ; -----------------------------------------------------------------------------
   332                              <1> %macro WSTR_AND_LEN 2-*
   333                              <1>     %push WSTRUL
   334                              <1>     %define %$name %1
   335                              <1> %1:
   336                              <1>     WSTRU %2
   337                              <1> %$name %+ _end:
   338                              <1>     %xdefine %$name %+ _len ( ((%$name %+ _end) - (%$name))/2 - 1 )
   339                              <1>     %pop
   340                              <1> %endmacro
   341                              <1> 
   342                              <1> ; -----------------------------------------------------------------------------
   343                              <1> ; Nach JEDEM vorhandenen Stringlabel einfach:
   344                              <1> ;   <label>_end:   (direkt nach dem String)
   345                              <1> ; und dann:
   346                              <1> ; -----------------------------------------------------------------------------
   347                              <1> %macro WSTR_LENGTH 1
   348                              <1>     %xdefine %1_len ( ((%1_end) - (%1))/2 - 1 )
   349                              <1> %endmacro
   350                              <1> 
   351                              <1> %macro AWSTR 1
   352                              <1> %push
   353                              <1> %strlen __n %1
   354                              <1> %assign __i 0
   355                              <1> %rep __n
   356                              <1>     %substr __c %1 __i+1,1
   357                              <1>     dw __c
   358                              <1>     %assign __i __i+1
   359                              <1> %endrep
   360                              <1>     dw 0
   361                              <1> %pop
   362                              <1> %endmacro
   363                              <1> 
   364                              <1> ; -----------------------------------------------------------------------------
   365                              <1> ; \brief String-Definition mit auto *_length (ohne 0-Byte)
   366                              <1> ; \desc  section .data
   367                              <1> ;        ZSTR cap2A, "Hallo", 13, 10
   368                              <1> ;
   369                              <1> ;        ergibt automatisch:
   370                              <1> ;        cap2A          db "Hallo",13,10,0
   371                              <1> ;        cap2A_end:
   372                              <1> ;        %define cap2A_length (cap2A_end - cap2A - 1)
   373                              <1> ; -----------------------------------------------------------------------------
   374                              <1> %macro ASTR 2+                    ; ASTR <name>, <bytes...>
   375                              <1> _cA_%1:       db %2, 0
   376                              <1> _cA_%1_end:
   377                              <1> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   378                              <1> %endmacro
   379                              <1> 
   380                              <1> ; -----------------------------------------------------------------------------
   381                              <1> ; \brief set the string label from %2 to register %1 ...
   382                              <1> ; -----------------------------------------------------------------------------
   383                              <1> %macro GETEXT 2
   384                              <1>     mov     %1, IMAGE_BASE
   385                              <1>     add     %1, RVA_DATA(_cW_%2)
   386                              <1> %endmacro
   387                              <1> 
   388                              <1> ; ------------------------------------------------------------
   389                              <1> ; ---- RVA-Helfer: bleibt wie bei dir ----
   390                              <1> ; %define RVA_DATA(L)   (DATA_VA  + ((L) - data_start))
   391                              <1> ; ------------------------------------------------------------
   392                              <1> ; Optional: einfacher Alias ohne Klammern/EXPR:
   393                              <1> ; ------------------------------------------------------------
   394                              <1> %imacro DATA_ABS 1
   395                              <1>     IMAGE_BASE + RVA_DATA(%1)
   396                              <1> %endmacro
   397                              <1> ; ------------------------------------------------------------
   398                              <1> ; Helfer: absolute VA einer Data-Variable bauen
   399                              <1> ; ------------------------------------------------------------
   400                              <1> %macro DATA_PTR 1
   401                              <1>     (IMAGE_BASE + RVA_DATA(%1))
   402                              <1> %endmacro
   403                              <1> ; ---------------------------------------------------------------------------
   404                              <1> ;; SETDATA <name>, <src> [, <size>]
   405                              <1> ;  - Schreibt <src> an Datenlabel <name>
   406                              <1> ;  - Wenn <size> fehlt, wird die Größe aus <src>-Register abgeleitet
   407                              <1> ;    (al/ax/eax/rax → 8/16/32/64 Bit). Bei Immediate bitte <size> angeben.
   408                              <1> ;  - <size> darf BYTE/WORD/DWORD/QWORD oder 8/16/32/64 sein.
   409                              <1> ; ---------------------------------------------------------------------------
   410                              <1> ;; Beispiele:
   411                              <1> ; last_error: dd 0
   412                              <1> ; orig_attr:  dw 0
   413                              <1> ; flag8:      db 0
   414                              <1> ; ---------------------------------------------------------------------------
   415                              <1> ;; schreiben (Registergröße bestimmt Breite)
   416                              <1> ; mov   eax, 0xDEADBEEF
   417                              <1> ; SETDATA last_error, eax          ; dword write
   418                              <1> ; ---------------------------------------------------------------------------
   419                              <1> ;; schreiben (Immediate -> Größe angeben)
   420                              <1> ; SETDATA orig_attr, 0x000F, WORD  ; word write
   421                              <1> ; SETDATA flag8,     1,      BYTE  ; byte write
   422                              <1> ; ---------------------------------------------------------------------------
   423                              <1> ;; lesen (Registergröße passt)
   424                              <1> ; GETDATA eax, last_error          ; dword read → eax
   425                              <1> ; ---------------------------------------------------------------------------
   426                              <1> ;; lesen (Größe erzwingen)
   427                              <1> ; GETDATA ax,  orig_attr, WORD     ; word read → ax
   428                              <1> ; GETDATA al,  flag8,     BYTE     ; byte read → al
   429                              <1> ; ---------------------------------------------------------------------------
   430                              <1> %macro SETDATA 2-3
   431                              <1>     push    rdx
   432                              <1>     mov     rdx, IMAGE_BASE
   433                              <1>     add     rdx, RVA_DATA(%1)
   434                              <1>     %if %0 = 2
   435                              <1>         mov     [%2], rdx
   436                              <1>         pop     rdx
   437                              <1>     %else
   438                              <1>         pop     rdx
   439                              <1>       %ifidni %3, BYTE
   440                              <1>         mov     byte  [rdx], %2
   441                              <1>       %elifidni %3, WORD
   442                              <1>         mov     word  [rdx], %2
   443                              <1>       %elifidni %3, DWORD
   444                              <1>         mov     dword [rdx], %2
   445                              <1>       %elifidni %3, QWORD
   446                              <1>         mov     qword [rdx], %2
   447                              <1>       %elif %3 = 8
   448                              <1>         mov     byte  [rdx], %2
   449                              <1>       %elif %3 = 16
   450                              <1>         mov     word  [rdx], %2
   451                              <1>       %elif %3 = 32
   452                              <1>         mov     dword [rdx], %2
   453                              <1>       %elif %3 = 64
   454                              <1>         mov     qword [rdx], %2
   455                              <1>       %else
   456                              <1>         %error "SETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   457                              <1>       %endif
   458                              <1>     %endif
   459                              <1> %endmacro
   460                              <1> 
   461                              <1> ; ------------------------------------------------------------
   462                              <1> ; GETDATA <dst>, <name> [, <size>]
   463                              <1> ;  - Liest aus Datenlabel <name> in Register <dst>
   464                              <1> ;  - Wenn <size> fehlt, muss <dst> die passende Größe haben
   465                              <1> ;    (al/ax/eax/rax). Sonst <size> angeben (BYTE/WORD/DWORD/QWORD oder 8/16/32/64).
   466                              <1> ; ------------------------------------------------------------
   467                              <1> %macro GETDATA 2-3
   468                              <1>     mov     %1, IMAGE_BASE
   469                              <1>     add     %1, RVA_DATA(%2)
   470                              <1>     %if %0 = 2
   471                              <1>         ;mov     %1, [rdx]
   472                              <1>     %else
   473                              <1>       %ifidni %3, BYTE
   474                              <1>         mov     %1, byte  [rdx]
   475                              <1>       %elifidni %3, WORD
   476                              <1>         mov     %1, word  [rdx]
   477                              <1>       %elifidni %3, DWORD
   478                              <1>         mov     %1, dword [rdx]
   479                              <1>       %elifidni %3, QWORD
   480                              <1>         mov     %1, qword [rdx]
   481                              <1>       %elif %3 = 8
   482                              <1>         mov     %1, byte  [rdx]
   483                              <1>       %elif %3 = 16
   484                              <1>         mov     %1, word  [rdx]
   485                              <1>       %elif %3 = 32
   486                              <1>         mov     %1, dword [rdx]
   487                              <1>       %elif %3 = 64
   488                              <1>         mov     %1, qword [rdx]
   489                              <1>       %else
   490                              <1>         %error "GETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   491                              <1>       %endif
   492                              <1>     %endif
   493                              <1> %endmacro
   494                              <1> 
   495                              <1> %macro Return 0-1
   496                              <1> %if %0 == 1
   497                              <1>     mov eax, %1
   498                              <1> %else
   499                              <1>     ret
   500                              <1> %endif
   501                              <1> %endmacro
   502                              <1> 
   503                              <1> ; -----------------------------------------------------------------------------
   504                              <1> ; condition jump's after function call -> test eax, eax
   505                              <1> ; -----------------------------------------------------------------------------
   506                              <1> %macro CHECK_NZ 1-2
   507                              <1> %if %0 == 2
   508                              <1>     test eax, eax
   509                              <1>     jnz %1
   510                              <1>     jmp %2
   511                              <1> %else
   512                              <1>     test eax, eax
   513                              <1>     jnz %1
   514                              <1> %endif
   515                              <1> %endmacro
   516                              <1> 
   517                              <1> ; -----------------------------------------------------------------------------
   518                              <1> %macro CHECK_NE 1-2
   519                              <1> %if %0 == 2
   520                              <1>     test eax, eax
   521                              <1>     jne %1
   522                              <1>     jmp %2
   523                              <1> %else
   524                              <1>     test eax, eax
   525                              <1>     jne %1
   526                              <1> %endif
   527                              <1> %endmacro
   528                              <1> 
   529                              <1> ; -----------------------------------------------------------------------------
   530                              <1> %macro CHECK_E 1-2
   531                              <1> %if %0 == 2
   532                              <1>     test eax, eax
   533                              <1>     je  %1
   534                              <1>     jmp %2
   535                              <1> %else
   536                              <1>     test eax, eax
   537                              <1>     je  %1
   538                              <1> %endif
   539                              <1> %endmacro
   540                              <1> 
   541                              <1> ; -----------------------------------------------------------------------------
   542                              <1> ; \brief prolog of a assembler routine + 32 Windows 64 Bit shadow
   543                              <1> ; \param optional shadow at start -> int
   544                              <1> ; -----------------------------------------------------------------------------
   545                              <1> %macro FUNC_ENTER 0-1
   546                              <1> %if %0 == 1
   547                              <1>     AddShadow %1
   548                              <1> %else
   549                              <1>     AddShadow
   550                              <1> %endif
   551                              <1>     push    rbp
   552                              <1>     mov     rbp, rsp
   553                              <1> %endmacro
   554                              <1> 
   555                              <1> ; -----------------------------------------------------------------------------
   556                              <1> ; \brief epilog of a assembler routine - 32 Windows 64 Bit shadow
   557                              <1> ; \param optional shadow at end -> int
   558                              <1> ; -----------------------------------------------------------------------------
   559                              <1> %macro FUNC_LEAVE 0-1
   560                              <1> %if %0 == 1
   561                              <1>     DelShadow %1
   562                              <1> %else
   563                              <1>     DelShadow
   564                              <1> %endif
   565                              <1>     pop     rbp
   566                              <1>     ret
   567                              <1> %endmacro
   568                              <1> 
   569                              <1> ; -----------------------------------------------------------------------------
   570                              <1> ; \brief allocate/open a text console window under Windows 11 desktop.
   571                              <1> ; \param ok  -> label
   572                              <1> ; \param err -> label
   573                              <1> ; \since 1.0
   574                              <1> ;
   575                              <1> ; \return bool - 0 no Error; else Error
   576                              <1> ; -----------------------------------------------------------------------------
   577                              <1> %macro call_AllocConsole 2
   578                              <1> %if DOS_SHELL == 1
   579                              <1>     %error ERROR_Win32API
   580                              <1> %else
   581                              <1>     CALL_IAT AllocConsole
   582                              <1>     %if %0 == 2
   583                              <1>         CHECK_NZ %1, %2
   584                              <1>     %endif
   585                              <1> %endif
   586                              <1> %endmacro
   587                              <1> 
   588                              <1> ; -----------------------------------------------------------------------------
   589                              <1> ; \brief call the Windows 10 win32api function ExitProcess, to close the thread
   590                              <1> ; -----------------------------------------------------------------------------
   591                              <1> %macro call_ExitProcess 0-1
   592                              <1> %if DOS_SHELL == 1
   593                              <1>     %error ERROR_Win32API
   594                              <1> %else
   595                              <1>     %if %0 == 1
   596                              <1>         mov rax, %1
   597                              <1>     %else
   598                              <1>         mov rax, 0
   599                              <1>     %endif
   600                              <1>     CALL_IAT ExitProcess
   601                              <1> %endif
   602                              <1> %endmacro
   603                              <1> 
   604                              <1> ; -----------------------------------------------------------------------------
   605                              <1> ; \brief helper function to save source code space for win32api FormatMessageW.
   606                              <1> ; -----------------------------------------------------------------------------
   607                              <1> %macro call_FormatMessageW 0
   608                              <1>     CALL_IAT FormatMessageW
   609                              <1> %endmacro
   610                              <1> 
   611                              <1> ; -----------------------------------------------------------------------------
   612                              <1> ; \brief
   613                              <1> ; -----------------------------------------------------------------------------
   614                              <1> ;macro call_GetConsoleScreenBufferInfo
   615                              <1> ;endmacro
   616                              <1> 
   617                              <1> ; -----------------------------------------------------------------------------
   618                              <1> ; \brief  this macro call the win32api function GetLastError.
   619                              <1> ; \param  nothing
   620                              <1> ; \return ExitCode - int
   621                              <1> ; -----------------------------------------------------------------------------
   622                              <1> %macro call_GetLastError 0
   623                              <1> %if DOS_SHELL == 1
   624                              <1>     %error ERROR_Win32API
   625                              <1> %else
   626                              <1>     CALL_IAT GetLastError
   627                              <1>     test rax, rax
   628                              <1>     jnz  %%ok
   629                              <1>     AddShadow
   630                              <1>     call HandleLastError
   631                              <1>     DelShadow
   632                              <1> %%ok:
   633                              <1> ;ShowMessageW ShowLastW,capW
   634                              <1> %endif
   635                              <1> %endmacro
   636                              <1> 
   637                              <1> ; -----------------------------------------------------------------------------
   638                              <1> ; \brief  get the standard output device.
   639                              <1> ; \param  ok     -> label
   640                              <1> ; \param  error  -> label
   641                              <1> ; \param  handle -> int
   642                              <1> ; \see    AllocConsole
   643                              <1> ; \since  1.0
   644                              <1> ; \return ?
   645                              <1> ; -----------------------------------------------------------------------------
   646                              <1> %macro call_GetStdHandle 3
   647                              <1> %if DOS_SHELL == 1
   648                              <1>     %error ERROR_Win32API
   649                              <1> %else
   650                              <1>     mov ecx, %3
   651                              <1>     CALL_IAT GetStdHandle
   652                              <1>     cmp   rax, -1     ; INVALID_HANDLE_VALUE ?
   653                              <1>     je    %%error     ; yes -> error
   654                              <1>     test  rax, rax    ; 0 ?
   655                              <1>     jz    %%error     ; yes -> error
   656                              <1>     ;
   657                              <1>     mov   r12, rax    ; valid handle in rax
   658                              <1>     jmp   %%ok
   659                              <1> %%error:
   660                              <1>     call HandleLastError
   661                              <1>     jmp  %2
   662                              <1> %%ok:
   663                              <1>     jmp  %1
   664                              <1> %endif
   665                              <1> %endmacro
   666                              <1> 
   667                              <1> %macro call_LoadCursorW 0
   668                              <1> %if DOS_SHELL == 1
   669                              <1>     %error ERROR_Win32API
   670                              <1> %else
   671                              <1>     CALL_IAT LoadCursorW
   672                              <1>     ;ShowMessageW ShowHelloW,capW
   673                              <1>     ;call_GetLastError
   674                              <1> %endif
   675                              <1> %endmacro
   676                              <1> 
   677                              <1> %macro call_LocalFree 0
   678                              <1> %if DOS_SHELL == 1
   679                              <1>     %error ERROR_Win32API
   680                              <1> %else
   681                              <1>     CALL_IAT MessageBoxW
   682                              <1> %endif
   683                              <1> %endmacro
   684                              <1> 
   685                              <1> ; -----------------------------------------------------------------------------
   686                              <1> ; \brief helper macro to shorten code, and call the win32api MessageBox W
   687                              <1> ; -----------------------------------------------------------------------------
   688                              <1> %macro call_MessageBoxW 0
   689                              <1>     CALL_IAT MessageBoxW
   690                              <1> %endmacro
   691                              <1> 
   692                              <1> ; -----------------------------------------------------------------------------
   693                              <1> ; \brief helper macro to shorten code, and call the win32api function wsprintfW
   694                              <1> ; -----------------------------------------------------------------------------
   695                              <1> %macro call_wsprintfW 0
   696                              <1>     CALL_IAT wsprintfW
   697                              <1> %endmacro
   698                              <1> 
   699                              <1> %macro call_WriteConsoleA 0
   700                              <1> %if DOS_SHELL == 1
   701                              <1>     %error ERROR_Win32API
   702                              <1> %else
   703                              <1>     CALL_IAT WriteConsoleA
   704                              <1> %endif
   705                              <1> %endmacro
   706                              <1> 
   707                              <1> ; -----------------------------------------------------------------------------
   708                              <1> ; \brief Write - display text on the Windows Console.
   709                              <1> ; \param 1 -> label -> on error
   710                              <1> ; \param 2 -> label -> text to display
   711                              <1> ; \param 3 -> label -> output handle; default is: STD_OUTPUT_HANDLE
   712                              <1> ; \see   AllocConsole
   713                              <1> ; \since 1.0
   714                              <1> ; -----------------------------------------------------------------------------
   715                              <1> %macro call_User_Write 2-3
   716                              <1> %if DOS_SHELL == 1
   717                              <1>     %error ERROR_Win32API
   718                              <1> %else
   719                              <1> %if %0 == 2
   720                              <1>     call_GetStdHandle %%ok, %1, STD_OUTPUT_HANDLE
   721                              <1> %else
   722                              <1>     call_GetStdHandle %%ok, %1, %3
   723                              <1> %endif
   724                              <1> %%ok:
   725                              <1>     ; --- WriteConsoleA(hOut, fmtHello, hello_len, NULL, NULL) ---
   726                              <1>     mov     rcx, r12                       ; 1. Arg: HANDLE hConsoleOutput
   727                              <1>     mov     rdx, IMAGE_BASE
   728                              <1>     add     rdx, RVA_DATA(%2)              ; 2. Arg: LPCVOID lpBuffer
   729                              <1>     mov     r8d, %2_length                 ; 3. Arg: DWORD nNumberOfCharsToWrite
   730                              <1>     xor     r9d, r9d                       ; lpNumberOfCharsWritten = NULL
   731                              <1>     AddShadow 32 + 8
   732                              <1>     mov     qword [rsp+32], 0              ; 5. Arg: LPVOID lpReserved = NULL
   733                              <1>     call_WriteConsoleA
   734                              <1>     DelShadow 32 + 8
   735                              <1> %endif
   736                              <1> %endmacro
   737                              <1> 
   738                              <1> ; -----------------------------------------------------------------------------
   739                              <1> ; \brief read a string line in console window ...
   740                              <1> ; -----------------------------------------------------------------------------
   741                              <1> %macro call_User_ReadLn 1
   742                              <1>     call user_Console_ReadLn
   743                              <1> %endmacro
   744                              <1> 
   745                              <1> ; -----------------------------------------------------------------------------
   746                              <1> %macro DefWindowProcW 0
   747                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_DefWindowProcW)
   748                              <1> %endmacro
   749                              <1> 
   750                              <1> %macro IAT_CreateWindowExW 0
   751                              <1> %if DOS_SHELL == 1
   752                              <1>     %error ERROR_Win32API
   753                              <1> %else
   754                              <1>     mov     rax, IMAGE_BASE
   755                              <1>     add     rax, RVA_IDATA(IAT_win32_CreateWindowExW)
   756                              <1>     call    [rax]
   757                              <1> %endif
   758                              <1> %endmacro
   759                              <1> ; -----------------------------------------------------------------------------
   760                              <1> 
   761                              <1> ; -----------------------------------------------------------------------------
   762                              <1> ; \brief  DispatchMessageW
   763                              <1> ; \since  1.0
   764                              <1> ; -----------------------------------------------------------------------------
   765                              <1> %macro DispatchMessageW 0
   766                              <1> %if DOS_SHELL == 1
   767                              <1>     %error ERROR_Win32API
   768                              <1> %else
   769                              <1>     mov     rcx, rsi
   770                              <1>     CALL_IAT DispatchMessageW
   771                              <1> %endif
   772                              <1> %endmacro
   773                              <1> 
   774                              <1> ; -----------------------------------------------------------------------------
   775                              <1> ; \brief  ExitProcess terminate the given application thread.
   776                              <1> ; \since  1.0
   777                              <1> ; \param  exitcode -> integer
   778                              <1> ; \return exitcode -> rax
   779                              <1> ; -----------------------------------------------------------------------------
   780                              <1> %macro ExitProcess 0-1 0
   781                              <1> %if DOS_SHELL == 1
   782                              <1>     %error ERROR_Win32API
   783                              <1> %else
   784                              <1>     nop
   785                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   786                              <1>     mov     ecx,%1
   787                              <1>     CALL_IAT ExitProcess
   788                              <1>     ; no return
   789                              <1>     ;DelShadow (32 + 16)
   790                              <1> %endif
   791                              <1> %endmacro
   792                              <1> 
   793                              <1> ; -----------------------------------------------------------------------------
   794                              <1> ; \brief  GetLastError catches the last error that was occured during win32api
   795                              <1> ;         function call.
   796                              <1> ; \since  1.0
   797                              <1> ; \param  nothing
   798                              <1> ; \return ?
   799                              <1> ; -----------------------------------------------------------------------------
   800                              <1> %macro GETLASTERROR 2
   801                              <1>     test    eax, eax
   802                              <1>     %1      %2
   803                              <1> %endmacro
   804                              <1> 
   805                              <1> %macro GetLastError 0
   806                              <1> %if DOS_SHELL == 1
   807                              <1>     %error ERROR_Win32API
   808                              <1> %else
   809                              <1>     CALL_IAT GetLastError
   810                              <1> %endif
   811                              <1> %endmacro
   812                              <1> 
   813                              <1> ; -----------------------------------------------------------------------------
   814                              <1> ; \brief  GetMessageW
   815                              <1> ; -----------------------------------------------------------------------------
   816                              <1> %macro GetMessageW 0
   817                              <1> %if DOS_SHELL == 1
   818                              <1>     %error ERROR_Win32API
   819                              <1> %else
   820                              <1>     mov  rcx, rsi
   821                              <1>     Zero edx
   822                              <1>     Zero r8d
   823                              <1>     Zero r9d
   824                              <1>     CALL_IAT GetMessageW
   825                              <1> %endif
   826                              <1> %endmacro
   827                              <1> 
   828                              <1> ; -----------------------------------------------------------------------------
   829                              <1> ; \brief  LoadCursorW
   830                              <1> ; \since  1.0
   831                              <1> ; \param  id - integer: resource id
   832                              <1> ; -----------------------------------------------------------------------------
   833                              <1> %macro LoadCursorW 1
   834                              <1> %if DOS_SHELL == 1
   835                              <1>     %error ERROR_Win32API
   836                              <1> %else
   837                              <1>     Zero ecx
   838                              <1>     mov  edx, %1
   839                              <1>     CALL_IAT LoadCursorW
   840                              <1> %endif
   841                              <1> %endmacro
   842                              <1> 
   843                              <1> ; -----------------------------------------------------------------------------
   844                              <1> ; \brief  MESSAGE is a style shortner for better read expierences ...
   845                              <1> ; -----------------------------------------------------------------------------
   846                              <1> %macro MESSAGE 2
   847                              <1>     cmp     edx, %1
   848                              <1>     je      .%2
   849                              <1> %endmacro
   850                              <1> 
   851                              <1> ; -----------------------------------------------------------------------------
   852                              <1> ; \brief ShowMessageW display a wide string message on the desktop screen per
   853                              <1> ;        the wn32api.
   854                              <1> ; \since 1.0
   855                              <1> ; \see   ShowMessageA
   856                              <1> ;
   857                              <1> ; \param text_str  -> landet in rdx
   858                              <1> ; \param title_str -> landet in r8
   859                              <1> ;
   860                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
   861                              <1> ; -----------------------------------------------------------------------------
   862                              <1> %macro ShowMessageW 2-3
   863                              <1> %if DOS_SHELL == 1
   864                              <1>     %error ERROR_Win32API
   865                              <1> %else
   866                              <1>     Zero    ecx             ; hWnd = NULL
   867                              <1>     mov     rdx, PTR64(%1)  ; lpText
   868                              <1>     mov     r8,  PTR64(%2)  ; lpCaption    
   869                              <1> %if %0 == 2                 ; %0 = argument count
   870                              <1>     xor     r9d, r9d        ; uType = MB_OK
   871                              <1> %else
   872                              <1>     mov     r9d, %3         ; uType = argument exists
   873                              <1> %endif
   874                              <1>     CALL_IAT MessageBoxW
   875                              <1> %endif
   876                              <1> %endmacro
   877                              <1> 
   878                              <1> ; -----------------------------------------------------------------------------
   879                              <1> ; \brief ShowMessageA display a ansi string message on the desktop screen per
   880                              <1> ;        the wn32api.
   881                              <1> ; \since 1.0
   882                              <1> ; \see   ShowMessageW
   883                              <1> ;
   884                              <1> ; \param text_str  -> landet in rdx
   885                              <1> ; \param title_str -> landet in r8
   886                              <1> ;
   887                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
   888                              <1> ; -----------------------------------------------------------------------------
   889                              <1> %macro ShowMessageA 2-3
   890                              <1> %if DOS_SHELL == 1
   891                              <1>     %error ERROR_Win32API
   892                              <1> %else
   893                              <1>     Zero    ecx
   894                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; "MessageBoxW failed"
   895                              <1>     mov     r8,  IMAGE_BASE + RVA_DATA(_cA_%2)  ; "User32"
   896                              <1> %if %0 == 2                                     ; %0 = argument count
   897                              <1>     xor     r9d, r9d                            ; uType = MB_OK
   898                              <1> %else
   899                              <1>     mov     r9d, %3                             ; uType = argument exists
   900                              <1> %endif
   901                              <1>     CALL_IAT MessageBoxA
   902                              <1> %endif
   903                              <1> %endmacro
   904                              <1> 
   905                              <1> ; -----------------------------------------------------------------------------
   906                              <1> ; \brief  ShowWindow shows the window witht the hwnd id in r13.
   907                              <1> ; \since  1.0
   908                              <1> ; \param  hwnd -> HWND handle window
   909                              <1> ; \param  (optional) flag -> integer: default = SW_SHOWDEFAULT
   910                              <1> ; -----------------------------------------------------------------------------
   911                              <1> %macro ShowWindow 1-2
   912                              <1> %if DOS_SHELL == 1
   913                              <1>     %error ERROR_Win32API
   914                              <1> %else
   915                              <1>     nop
   916                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   917                              <1>     mov     rcx, %1
   918                              <1> %if %0 == 2
   919                              <1>     mov     edx, %2
   920                              <1> %else
   921                              <1>     mov     edx, SW_SHOWDEFAULT
   922                              <1> %endif
   923                              <1>     CALL_IAT ShowWindow
   924                              <1>     ;DelShadow (32 + 16)
   925                              <1> %endif
   926                              <1> %endmacro
   927                              <1> 
   928                              <1> ; -----------------------------------------------------------------------------
   929                              <1> ; \brief display a message box on top of the Windows 11 desktop.
   930                              <1> ; \param text   -> str
   931                              <1> ; \param title  -> str
   932                              <1> ; \param button -> int
   933                              <1> ; -----------------------------------------------------------------------------
   934                              <1> %macro call_ShowMessageW 5
   935                              <1>     ShowMessageW %3, %4, %5
   936                              <1>     CHECK_NZ %1, %2
   937                              <1> %endmacro
   938                              <1> 
   939                              <1> ; -----------------------------------------------------------------------------
   940                              <1> ; \brief  TranslateMessage
   941                              <1> ; \since  1.0
   942                              <1> ; -----------------------------------------------------------------------------
   943                              <1> %macro TranslateMessage 0
   944                              <1> %if DOS_SHELL == 1
   945                              <1>     %error ERROR_Win32API
   946                              <1> %else
   947                              <1>     mov     rcx, rsi
   948                              <1>     CALL_IAT TranslateMessage
   949                              <1> %endif
   950                              <1> %endmacro
   951                              <1> 
   952                              <1> ; -----------------------------------------------------------------------------
   953                              <1> ; \brief  UpdateWindow refresh the window properties and draw.
   954                              <1> ; \since  1.0
   955                              <1> ;
   956                              <1> ; \see    Invalidate
   957                              <1> ; \see    Repaint
   958                              <1> ;
   959                              <1> ; \param  hwnd -> HWND handle of window to update
   960                              <1> ; -----------------------------------------------------------------------------
   961                              <1> %macro UpdateWindow 1
   962                              <1> %if DOS_SHELL == 1
   963                              <1>     %error ERROR_Win32API
   964                              <1> %else
   965                              <1>     mov     rcx, %1
   966                              <1>     CALL_IAT UpdateWindow
   967                              <1> %endif
   968                              <1> %endmacro
   969                              <1> 
   970                              <1> ; -----------------------------------------------------------------------------
   971                              <1> ; \brief set the length of a given ASCII string to register ...
   972                              <1> ; -----------------------------------------------------------------------------
   973                              <1> %macro SETLEN 2
   974                              <1>     mov      %1, %2_length
   975                              <1> %endmacro
   976                              <1> 
   977                              <1> ; -----------------------------------------------------------------------------
   978                              <1> ; \brief write ASCII text on the text Windows console ...
   979                              <1> ; -----------------------------------------------------------------------------
   980                              <1> %macro WRITE_CON_A 1-2
   981                              <1> %if DOS_SHELL == 1
   982                              <1>     %if %0 == 2
   983                              <1>         PUTS_COLOR %1, %2
   984                              <1>     %else
   985                              <1>         PUTS_COLOR %1, 0x07
   986                              <1>     %endif
   987                              <1> %else
   988                              <1>     ; prepare
   989                              <1>     xor      eax, eax
   990                              <1>     mov      rcx, PTR64(_cA_%1)
   991                              <1>     call     GET_STR_LEN
   992                              <1>     mov      r14, rax
   993                              <1>     GET_CON_O_HANDLE r12
   994                              <1>     mov      rcx, r12
   995                              <1>     mov      rdx, PTR64(_cA_%1)
   996                              <1>     mov      r8 , r14
   997                              <1>     xor      r9d, r9d
   998                              <1>     mov      qword [rsp+32], 0
   999                              <1>     CALL_IAT WriteConsoleA
  1000                              <1> %endif
  1001                              <1> %endmacro
  1002                              <1> 
  1003                              <1> ; -----------------------------------------------------------------------------
  1004                              <1> ; \brief read utf-8 text on the text Windows console ...
  1005                              <1> ; \param dst -> buffer for the "readln" text
  1006                              <1> ; -----------------------------------------------------------------------------
  1007                              <1> %macro READL_CON_A 0-1
  1008                              <1> %if DOS_SHELL == 1
  1009                              <1>     %if  %0 == 1
  1010                              <1>         mov  dx, PTR16(_cA_%1)
  1011                              <1>         call DOSReadLn
  1012                              <1>     %else
  1013                              <1>         mov  dx, PTR16(_cA_dos_buffer)
  1014                              <1>         call DOSReadLn
  1015                              <1>     %endif
  1016                              <1> %else
  1017                              <1>     ; prepare
  1018                              <1>     GET_CON_I_HANDLE  r13
  1019                              <1>     ; ReadConsoleA(hIn, inbuf, maxChars, &read, NULL)
  1020                              <1>     mov      rcx, r13
  1021                              <1>     mov      rdx, PTR64(_cA_%1)
  1022                              <1>     mov      r8d, 127           ; maxChars (Reserviere 1 Byte für NUL)
  1023                              <1>     mov      r9 , PTR64(written)
  1024                              <1>     xor      rax, rax           ; lpReserved = NULL (über Shadow Space)
  1025                              <1>     mov      [rsp+32], rax
  1026                              <1>     CALL_IAT ReadConsoleA
  1027                              <1> %endif
  1028                              <1> %endmacro
  1029                              <1> 
  1030                              <1> ; -----------------------------------------------------------------------------
  1031                              <1> ; \brief integer to string
  1032                              <1> ;
  1033                              <1> ; \param number -> register (number to convert)
  1034                              <1> ; \param buffer -> destination buffer
  1035                              <1> ; -----------------------------------------------------------------------------
  1036                              <1> %macro INT2STR 2
  1037                              <1>     mov     edx, %2                             ; number to convert
  1038                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; destination buffer
  1039                              <1>     call    u32_to_dec                          ; buffer -> "12345",0 ; RAX = 5
  1040                              <1> %endmacro
  1041                              <1> 
  1042                              <1> ; -----------------------------------------------------------------------------
  1043                              <1> ; \brief concatenate two strings (%2, %3) to a given string destionation (%1).
  1044                              <1> ; \param dst  -> string buffer
  1045                              <1> ; \param src1 -> string 0-terminated
  1046                              <1> ; \param src2 -> string 0-terminated
  1047                              <1> ; -----------------------------------------------------------------------------
  1048                              <1> %macro STRCPY_ANSI 3
  1049                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)
  1050                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%2)
  1051                              <1>     mov     r8 , IMAGE_BASE + RVA_DATA(_cA_%3)
  1052                              <1>     call    concat_ansi
  1053                              <1> %endmacro
  1054                              <1> %macro STRCAT_ANSI 2-*
  1055                              <1>     %xdefine __DSTSYM (_cA_%1 + 4)
  1056                              <1> 
  1057                              <1>     %rotate 1                     ; ab hier ist %1 der erste src
  1058                              <1>     %rep %0-1
  1059                              <1>         ; --- Ende von dst finden: RDI zeigt nach REPNZ SCASB auf Byte NACH '\0'
  1060                              <1>         mov     rdi, IMAGE_BASE
  1061                              <1>         add     rdi, RVA_DATA(__DSTSYM)
  1062                              <1>         xor     eax, eax          ; AL = 0
  1063                              <1>         mov     rcx, -1
  1064                              <1>         repne   scasb
  1065                              <1>         lea     rcx, [rdi - 1]    ; RCX -> Position des '\0' (Schreibposition)
  1066                              <1> 
  1067                              <1>         ; einen Source anhängen: (s1 = aktueller, s2 = leer)
  1068                              <1>         mov     rdx, PTR64(_cA_%1)
  1069                              <1>         mov     r8 , PTR64(_cA_empty)
  1070                              <1>         call    concat_ansi
  1071                              <1> 
  1072                              <1>         %rotate 1                 ; nächster src
  1073                              <1>     %endrep
  1074                              <1> %endmacro
  1075                              <1> 
  1076                              <1> ; -----------------------------------------------------------------------------
  1077                              <1> ; \brief get the output handle of allocated/open console ...
  1078                              <1> ; \param register to store output handle
  1079                              <1> ; -----------------------------------------------------------------------------
  1080                              <1> %macro GET_CON_O_HANDLE 1
  1081                              <1> %if DOS_SHELL == 1
  1082                              <1>     %error ERROR_Win32API
  1083                              <1> %else
  1084                              <1>     mov      ecx, STD_OUTPUT_HANDLE
  1085                              <1>     CALL_IAT GetStdHandle
  1086                              <1>     mov      %1, rax         ; hOut
  1087                              <1> %endif
  1088                              <1> %endmacro
  1089                              <1> ; -----------------------------------------------------------------------------
  1090                              <1> ; \brief get the input handle of allocated/open console ...
  1091                              <1> ; \param register to store input handle
  1092                              <1> ; -----------------------------------------------------------------------------
  1093                              <1> %macro GET_CON_I_HANDLE 1
  1094                              <1> %if DOS_SHELL == 1
  1095                              <1>     %error ERROR_Win32API
  1096                              <1> %else
  1097                              <1>     mov      ecx, STD_INPUT_HANDLE
  1098                              <1>     CALL_IAT GetStdHandle
  1099                              <1>     mov      %1, rax         ; hIn
  1100                              <1> %endif
  1101                              <1> %endmacro
  1102                              <1> 
  1103                              <1> %macro SCREEN_CLEAR 0
  1104                              <1> %if DOS_SHELL == 1
  1105                              <1>     call dos_screen_clear
  1106                              <1> %else
  1107                              <1>     GET_CON_O_HANDLE r12
  1108                              <1>     STRCPY_ANSI buffer_B, consoleColor_3, empty
  1109                              <1>     WRITE_CON_A buffer_B
  1110                              <1> %endif
  1111                              <1> %endmacro
  1112                              <1> 
  1113                              <1> ; -----------------------------------------------------------------------------
  1114                              <1> ; \brief set the cursor position in dos console ...
  1115                              <1> ; \param xpos - <imm>
  1116                              <1> ; \param ypos - <imm>
  1117                              <1> ; -----------------------------------------------------------------------------
  1118                              <1> %macro SET_CURSOR 2
  1119                              <1> %if %0 == 0
  1120                              <1>     %error 2 argument missing
  1121                              <1> %endif
  1122                              <1> %if DOS_SHELL == 1
  1123                              <1>     mov  dl, %1         ; column
  1124                              <1>     mov  dh, %2         ; row
  1125                              <1>     call dos_set_cursor
  1126                              <1> %else
  1127                              <1> %endif
  1128                              <1> %endmacro
  1129                              <1> 
  1130                              <1> ; -----------------------------------------------------------------------------
  1131                              <1> ; \brief get the cursor position in dos console ...
  1132                              <1> ; -----------------------------------------------------------------------------
  1133                              <1> %macro GET_CURSOR 0
  1134                              <1> %if DOS_SHELL == 1
  1135                              <1>     call dos_get_cursor
  1136                              <1> %else
  1137                              <1>     %error 'todo: windows'
  1138                              <1> %endif
  1139                              <1> %endmacro
  1140                              <1> 
  1141                              <1> ; -----------------------------------------------------------------------------
  1142                              <1> ; \brief set the color for console window text
  1143                              <1> ; \param 1. background -> int 0..255
  1144                              <1> ; \param 2. foreground -> int 0..255
  1145                              <1> ;
  1146                              <1> ; \desc  color values > 127 == blink chars
  1147                              <1> ; -----------------------------------------------------------------------------
  1148                              <1> %macro SET_COLOR_TO 2
  1149                              <1> %if %0 == 2
  1150                              <1>     STRCPY_ANSI buffer_B, consoleColor_1, empty
  1151                              <1>     STRCAT_ANSI buffer_B,                                     console_color_%1, buffer_semi,                console_color_%2, consoleColor_2
  1154                              <1>     WRITE_CON_A buffer_B
  1155                              <1> %endif
  1156                              <1> %endmacro
  1157                              <1> 
  1158                              <1> ; -----------------------------------------------------------------------------
  1159                              <1> ; \brief 
  1160                              <1> ; -----------------------------------------------------------------------------
  1161                              <1> %macro ARG_CURSOR 2
  1162                              <1> %if DOS_SHELL == 1
  1163                              <1>     GET_ARG  %1             ; save command line argument 1
  1164                              <1>     mov  bl, %2             ; color
  1165                              <1>     call PutStrColor        ; DOS screen
  1166                              <1> %endif
  1167                              <1> %endmacro
  1168                              <1> 
  1169                              <1> ; -----------------------------------------------------------------------------
  1170                              <1> ; \brief macro to put a colored string to the DOS console ...
  1171                              <1> ; -----------------------------------------------------------------------------
  1172                              <1> %macro PUTS_COLOR 2
  1173                              <1> %if DOS_SHELL == 1
  1174                              <1>     GET_CURSOR              ; move cursor to col:row
  1175                              <1>     %ifstr %1
  1176                              <1>         section .data
  1177                              <1>         %%msg: db %1, 0
  1178                              <1>         section .text
  1179                              <1>         mov  bl, %2                 ; color
  1180                              <1>         mov  si, PTR16(%%msg)       ; text 0-terminated
  1181                              <1>         call PutStrColor            ; DOS screen
  1182                              <1>     %else
  1183                              <1>         %ifidni %1, DI
  1184                              <1>             section .text
  1185                              <1>             mov  bl, %2
  1186                              <1>             call PutStrColor        ; DOS screen
  1187                              <1>         %elifidni %1, SI            ; text is already in SI
  1188                              <1>             section .text
  1189                              <1>             mov  bl, %2             ; color
  1190                              <1>             call PutStrColor        ; DOS screen
  1191                              <1>         %else
  1192                              <1>             %assign __count 0
  1193                              <1>             %assign __varg  0
  1194                              <1>             %assign __stop  0
  1195                              <1>             %rep MAX_ARGV
  1196                              <1>                 %if __stop == 0
  1197                              <1>                     %assign __count (__count + 1)
  1198                              <1>                     %ifidni %1, ARGV_%+__count
  1199                              <1>                         %assign __varg __count
  1200                              <1>                         %assign __stop 1
  1201                              <1>                     %endif
  1202                              <1>                 %endif
  1203                              <1>             %endrep
  1204                              <1>             %if __varg > 0
  1205                              <1>                 section .text
  1206                              <1>                 mov  si, PTR16(_cA_cmd_buf)
  1207                              <1>                 mov  bl, __varg
  1208                              <1>                 call getCommandLine_Arg
  1209                              <1>                 call PutStrColor        ; DOS screen
  1210                              <1>             %else
  1211                              <1>                 section .text
  1212                              <1>                 mov  bl, %2             ; color
  1213                              <1>                 mov  si, PTR16(_cA_%1)  ; text 0-terminated
  1214                              <1>                 call PutStrColor        ; DOS screen
  1215                              <1>             %endif
  1216                              <1>             %undef __varg
  1217                              <1>         %endif
  1218                              <1>     %endif
  1219                              <1> %else
  1220                              <1>     %error 'this macro is only for DOS programming.'
  1221                              <1> %endif
  1222                              <1> %endmacro
  1223                              <1> 
  1224                              <1> ; -----------------------------------------------------------------------------
  1225                              <1> ; \brief  get the length of given label string
  1226                              <1> ; \param  1. label name/addr
  1227                              <1> ; \return CX = length of string
  1228                              <1> ; -----------------------------------------------------------------------------
  1229                              <1> %macro STRLEN 1
  1230                              <1> %if %0 == 1
  1231                              <1>     mov  si, PTR16(_cA_%1)
  1232                              <1>     call DOSStrLen
  1233                              <1>     mov  ax, cx             ; AX = length
  1234                              <1>     add  cx, 1              ; CX = length + 1
  1235                              <1> %else
  1236                              <1>     %error 'exactly one argument expected.'
  1237                              <1> %endif
  1238                              <1> %endmacro
  1239                              <1> 
  1240                              <1> ; -----------------------------------------------------------------------------
  1241                              <1> ; \brief  helper macro save code resources.
  1242                              <1> ; \desc   return to DOS with exit code
  1243                              <1> ; \param  1. exit code value (0..255).
  1244                              <1> ; \return nothing
  1245                              <1> ; -----------------------------------------------------------------------------
  1246                              <1> %macro DOS_Exit 1
  1247                              <1> %if DOS_SHELL == 1
  1248                              <1>     %ifidni   %1, ax
  1249                              <1>         %error 'AX not allowed here.'
  1250                              <1>     %elifidni %1, bx
  1251                              <1>         mov ax, 0x4C00
  1252                              <1>         or  ax, bx
  1253                              <1>         SysCall
  1254                              <1>     %elifidni %1, CX
  1255                              <1>         mov ax, 0x4C00
  1256                              <1>         or  ax, cx
  1257                              <1>         SysCall
  1258                              <1>     %elifidni %1, dx
  1259                              <1>         mov ax, 0x4C00
  1260                              <1>         or  ax, dx
  1261                              <1>         SysCall
  1262                              <1>     %elifnum  %1
  1263                              <1>         mov  ax, 0x4C00 | %1
  1264                              <1>         SysCall
  1265                              <1>     %else
  1266                              <1>         %error 'BX, CX, DX or <NUM> expected.'
  1267                              <1>     %endif
  1268                              <1> %endif
  1269                              <1> %endmacro
  1270                              <1> 
  1271                              <1> ; -----------------------------------------------------------------------------
  1272                              <1> ; \brief  print a CRLF on DOS console
  1273                              <1> ; \param  nothing
  1274                              <1> ; \return nothing
  1275                              <1> ; -----------------------------------------------------------------------------
  1276                              <1> %macro DOS_crlf 0
  1277                              <1>     call DOSrncrlf
  1278                              <1> %endmacro
  1279                              <1> 
  1280                              <1> ; -----------------------------------------------------------------------------
  1281                              <1> ; \brief write a string in DX to DOS console without "lf", and no "cr" ...
  1282                              <1> ; \param 1. DX - src label
  1283                              <1> ; \see   DOS_WriteLn
  1284                              <1> ; -----------------------------------------------------------------------------
  1285                              <1> %macro DOS_Write 1
  1286                              <1>     lea  dx, [PTR16(_cA_%1)]
  1287                              <1>     call DOS_ConsoleWrite
  1288                              <1> %endmacro
  1289                              <1> 
  1290                              <1> ; -----------------------------------------------------------------------------
  1291                              <1> ; \brief write a string in DX to DOS console with "lf", and "cr" ...
  1292                              <1> ; \param 1. DX - src label
  1293                              <1> ; \see   DOS_Write
  1294                              <1> ; -----------------------------------------------------------------------------
  1295                              <1> %macro DOS_WriteLn 1
  1296                              <1>     DOS_Write %1
  1297                              <1>     DOS_crlf
  1298                              <1> %endmacro
  1299                              <1> 
  1300                              <1> ; -----------------------------------------------------------------------------
  1301                              <1> ; \brief allocate memory for/in the DOS console ...
  1302                              <1> ; \param 1. count paragraphs
  1303                              <1> ; \note  calculate with: 4096 / 16 = 256 (4096 is a example !)
  1304                              <1> ; -----------------------------------------------------------------------------
  1305                              <1> %macro DOS_AllocMem 1
  1306                              <1> %if DOS_SHELL == 1
  1307                              <1>     mov  ax, 4800h      ; AH = 48h -> Allocate Memory Block
  1308                              <1>     mov  bx, %1         ; Paragraph-Anzahl
  1309                              <1>     SysCall
  1310                              <1>     
  1311                              <1>     sbb  ax, ax
  1312                              <1>     cmp  ax, 0
  1313                              <1>     je   %%.successful
  1314                              <1>     
  1315                              <1>     cmp  ax, 0xFF
  1316                              <1>     je   %%.fail        ; CF = 1 -> error, AX = error code
  1317                              <1>     
  1318                              <1>     jmp  %%.fail
  1319                              <1>     
  1320                              <1>     %%.successful:
  1321                              <1>     ; AX = Segment des Blocks
  1322                              <1>     mov  es, ax
  1323                              <1>     xor  di, di
  1324                              <1>     
  1325                              <1>     ; Block mit 0x00 füllen
  1326                              <1>     mov  cx, 4096
  1327                              <1>     mov  al, 0x00
  1328                              <1>     rep  stosb          ; write to ES:DI
  1329                              <1>     
  1330                              <1>     ; demo read access: AL = ES:[1234]
  1331                              <1>     ;mov  di, 1234
  1332                              <1>     ;mov  al, [es:di]
  1333                              <1>     
  1334                              <1>     jmp   %%.next
  1335                              <1>     
  1336                              <1>     %%.fail:
  1337                              <1>     DOS_WriteLn msg_alloc_error
  1338                              <1>     DOS_Exit    1
  1339                              <1>     
  1340                              <1>     %%.next:
  1341                              <1> %endif
  1342                              <1> %endmacro
  1343                              <1> 
  1344                              <1> %macro DOS_FreeMem 0
  1345                              <1> %if DOS_SHELL == 1
  1346                              <1>     mov es, ax
  1347                              <1>     mov ah, 0x49
  1348                              <1>     SysCall
  1349                              <1> %else
  1350                              <1>     %error 'todo: windows'
  1351                              <1> %endif
  1352                              <1> %endmacro
  1353                              <1> 
  1354                              <1> ; -----------------------------------------------------------------------------
  1355                              <1> ; \brief COMPARE <reg>, <imm>, <label>
  1356                              <1> ; \param 1. <reg>
  1357                              <1> ; \param 2. <imm>
  1358                              <1> ; \param 3. <label>
  1359                              <1> ; \note  example: COMPARE al, 0x0a, printed
  1360                              <1> ;        result:  cmp <reg>, <imm>  /  je <label>
  1361                              <1> ; -----------------------------------------------------------------------------
  1362                              <1> %macro COMPARE 3
  1363                              <1>     cmp %1, %2
  1364                              <1>     je  %3
  1365                              <1> %endmacro
  1366                              <1> 
  1367                              <1> ; -----------------------------------------------------------------------------
  1368                              <1> ; \brief  get the n-th command line, success: jump to %2 ...
  1369                              <1> ; \param  1. <imm>
  1370                              <1> ; \return SI = text (=argument)
  1371                              <1> ; \note   example: GET_ARG 2
  1372                              <1> ;         result:  <text> in SI
  1373                              <1> ; -----------------------------------------------------------------------------
  1374                              <1> %macro GET_ARG 1-2
  1375                              <1> %if DOS_SHELL == 1
  1376                              <1>     lea  si, [PTR16(_cA_cmd_buf)]
  1377                              <1>     mov  bl, %1
  1378                              <1>     call getCommandLine_Arg
  1379                              <1>     %if %0 == 2
  1380                              <1>         jnc  %2
  1381                              <1>     %endif
  1382                              <1> %else
  1383                              <1>     %error 'todo: windows'
  1384                              <1> %endif
  1385                              <1> %endmacro
  1386                              <1> 
  1387                              <1> ; -----------------------------------------------------------------------------
  1388                              <1> ; \brief save the n-th command line argument to the <label>
  1389                              <1> ; \param 1. <imm> -> n-th argument number
  1390                              <1> ; \param 2. <label>
  1391                              <1> ; \note  example: SET_ARG <imm>, <label>
  1392                              <1> ; -----------------------------------------------------------------------------
  1393                              <1> %macro SET_ARG 1-2
  1394                              <1> %if DOS_SHELL == 1
  1395                              <1>     %if %0 == 1
  1396                              <1>         GET_ARG  %1
  1397                              <1>         STR_COPY _cA_cmd_arg_%1
  1398                              <1>     %else
  1399                              <1>         GET_ARG  %1
  1400                              <1>         STR_COPY _cA_%2
  1401                              <1>     %endif
  1402                              <1> %else
  1403                              <1>     %error 'todo: windows'
  1404                              <1> %endif
  1405                              <1> %endmacro
  1406                              <1> 
  1407                              <1> ; -----------------------------------------------------------------------------
  1408                              <1> ; \brief copy a string from source index SI to DI <label>
  1409                              <1> ; \param 1. <label>
  1410                              <1> ; \note  example: STR_COPY <label>
  1411                              <1> ; -----------------------------------------------------------------------------
  1412                              <1> %macro STR_COPY 1
  1413                              <1> %if DOS_SHELL == 1
  1414                              <1>     lea  di, [%1]       ; ES wird in string_copy gesetzt
  1415                              <1>     call string_copy    ; kommt zurück mit SI = Zielstart
  1416                              <1> %else
  1417                              <1>     %error 'todo: windows'
  1418                              <1> %endif
  1419                              <1> %endmacro
  1420                              <1> 
  1421                              <1> ; -----------------------------------------------------------------------------
  1422                              <1> ; \brief short'ner to get the command line arguments given by the user input.
  1423                              <1> ; \brief initialize a console application ...
  1424                              <1> ; \param nothing
  1425                              <1> ; -----------------------------------------------------------------------------
  1426                              <1> %macro INIT_COMMAND_LINE 0
  1427                              <1> %if DOS_SHELL == 1
  1428                              <1>     call dos_get_command_line
  1429                              <1> %else
  1430                              <1>     %error 'todo: windows'
  1431                              <1> %endif
  1432                              <1> %endmacro
  1433                              <1> 
  1434                              <1> ; -----------------------------------------------------------------------------
  1435                              <1> ; \brief call the DOS console initialize routine ...
  1436                              <1> ; -----------------------------------------------------------------------------
  1437                              <1> %macro INIT_CONSOLE 0
  1438                              <1> %if DOS_SHELL == 1
  1439                              <1>     call dos_init_console
  1440                              <1>     SCREEN_CLEAR
  1441                              <1> %else
  1442                              <1>     call init_app
  1443                              <1>     call init_console
  1444                              <1> %endif
  1445                              <1> %endmacro
  1446                              <1> 
  1447                              <1> ; -----------------------------------------------------------------------------
  1448                              <1> ; \brief generischer Handler für einen Fehlercode ...
  1449                              <1> ; -----------------------------------------------------------------------------
  1450                              <1> %macro DEF_ERROR 2
  1451                              <1> _h%1:
  1452                              <1>     PUTS_COLOR %2, ATTR_DOS_ERROR
  1453                              <1>     mov   cx, %1
  1454                              <1>     jmp   _open_exit
  1455                              <1> %endmacro
  1456                              <1> 
  1457                              <1> ; -----------------------------------------------------------------------------
  1458                              <1> ; \brief DOS seek to <origin> in file <handle> ...
  1459                              <1> ; \param 1. <file handle>
  1460                              <1> ; \param 2. <origin> 0 - begin of file, 1 - current position, 2 - end of file
  1461                              <1> ; -----------------------------------------------------------------------------
  1462                              <1> %macro DOS_Seek 2
  1463                              <1> %if DOS_SHELL == 1
  1464                              <1>     mov  bx, [PTR16(_cA_%1)]
  1465                              <1>     xor  cx, cx
  1466                              <1>     xor  dx, dx
  1467                              <1>     mov  ah, 0x42               ; move to ...
  1468                              <1>     mov  al, %2
  1469                              <1>     SysCall
  1470                              <1> %else
  1471                              <1>     %error 'todo: windows'
  1472                              <1> %endif
  1473                              <1> %endmacro
  1474                              <1> 
  1475                              <1> ; -----------------------------------------------------------------------------
  1476                              <1> ; \brief DOS open existing <file name>
  1477                              <1> ; \param 1. <file name>
  1478                              <1> ; \param 2. <open mode> - DOS_READ_ONLY, DOW_WRITE_ONLY, DOS_READWRITE
  1479                              <1> ; -----------------------------------------------------------------------------
  1480                              <1> %macro DOS_Open 2
  1481                              <1> %if DOS_SHELL == 1
  1482                              <1>     mov  dx, PTR16(_cA_%1)
  1483                              <1>     mov  ah, 0x3D               ; open existing file
  1484                              <1>     mov  al, %2                 ; read-only
  1485                              <1>     SysCall
  1486                              <1> %else
  1487                              <1>     %error 'todo: windows'
  1488                              <1> %endif
  1489                              <1> %endmacro
  1490                              <1> 
  1491                              <1> %macro DOS_Close 2
  1492                              <1> %if DOS_SHELL == 1
  1493                              <1>     mov  bx, [PTR16(_cA_%1)]
  1494                              <1>     or   bx, bx
  1495                              <1>     jz   %2
  1496                              <1>     mov  ah, 3Eh
  1497                              <1>     SysCall
  1498                              <1> %else
  1499                              <1>     %error 'todo: windows'
  1500                              <1> %endif
  1501                              <1> %endmacro
  1502                              <1> 
  1503                              <1> ; -----------------------------------------------------------------------------
  1504                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1505                              <1> ; erzeugt für jedes Argument:
  1506                              <1> ; _cA_errn<arg>:
  1507                              <1> ;     PUTS_COLOR open_error_<arg>, ATTR_DOS_ERROR
  1508                              <1> ;     mov cx, <arg>
  1509                              <1> ;     jmp _open_exit
  1510                              <1> ; -----------------------------------------------------------------------------
  1511                              <1> ; Hilfsmakro: Nibble (0..15) -> Hex-Zeichen 0..F
  1512                              <1> %macro _HEXDIG 2
  1513                              <1>   %if %1 < 10
  1514                              <1>     %define %2 %1
  1515                              <1>   %elif %1 = 10
  1516                              <1>     %define %2 A
  1517                              <1>   %elif %1 = 11
  1518                              <1>     %define %2 B
  1519                              <1>   %elif %1 = 12
  1520                              <1>     %define %2 C
  1521                              <1>   %elif %1 = 13
  1522                              <1>     %define %2 D
  1523                              <1>   %elif %1 = 14
  1524                              <1>     %define %2 E
  1525                              <1>   %elif %1 = 15
  1526                              <1>     %define %2 F
  1527                              <1>   %else
  1528                              <1>     %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <1>   %endif
  1530                              <1> %endmacro
  1531                              <1> ; -----------------------------------------------------------------------------
  1532                              <1> ; expr -> zwei Hex-Zeichen OUT_H/OUT_L (ohne 0x/h), 8-bit
  1533                              <1> ; -----------------------------------------------------------------------------
  1534                              <1> %macro _HEX2 3
  1535                              <1>   %assign __v %1
  1536                              <1>   %assign __v __v & 0FFh
  1537                              <1>   %assign __hi (__v >> 4) & 0Fh
  1538                              <1>   %assign __lo  __v       & 0Fh
  1539                              <1>   _HEXDIG __hi, %2
  1540                              <1>   _HEXDIG __lo, %3
  1541                              <1>   %undef __v
  1542                              <1>   %undef __hi
  1543                              <1>   %undef __lo
  1544                              <1> %endmacro
  1545                              <1> ; -----------------------------------------------------------------------------
  1546                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1547                              <1> ; Baut Labels / Namen mit zwei Hex-Ziffern (00..FF), ohne 0x/h.
  1548                              <1> ; -----------------------------------------------------------------------------
  1549                              <1> %macro ERR_HANDLER 1-*
  1550                              <1> %rep %0
  1551                              <1>     ; Ausdruck auswerten (dezimal/hex ok) und auf 8 Bit begrenzen
  1552                              <1>     %assign __v %1
  1553                              <1>     %assign __v __v & 0FFh
  1554                              <1> 
  1555                              <1>     ; zwei Hex-Ziffern bilden
  1556                              <1>     %assign __hi (__v >> 4) & 0Fh
  1557                              <1>     %assign __lo  __v       & 0Fh
  1558                              <1>     _HEXDIG __hi, __H
  1559                              <1>     _HEXDIG __lo, __L
  1560                              <1> 
  1561                              <1> _cA_errh%+__H%+__L:
  1562                              <1>     PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <1>     mov cx, %1
  1564                              <1>     jmp _open_exit
  1565                              <1>     
  1566                              <1>     ; Aufräumen der temporären Namen dieser Iteration
  1567                              <1>     %undef __H
  1568                              <1>     %undef __L
  1569                              <1>     %undef __hi
  1570                              <1>     %undef __lo
  1571                              <1>     %undef __v
  1572                              <1>     
  1573                              <1>     %rotate 1
  1574                              <1> %endrep
  1575                              <1> %endmacro
  1576                              <1> ; -----------------------------------------------------------------------------
  1577                              <1> ; Für jeden Code: Label _cA_errhXX + Body
  1578                              <1> ;
  1579                              <1> ; ---------- Tabelle (Datenbereich) ----------
  1580                              <1> ; ERZEUGT: 
  1581                              <1> ;   _cA_error_dispatch:
  1582                              <1> ;       dw <code>, _cA_errhXX
  1583                              <1> ;       ...
  1584                              <1> ;       dw 00h, _cA_errhnd
  1585                              <1> ; -----------------------------------------------------------------------------
  1586                              <1> %macro ERR_ITEMS 1-*
  1587                              <1> _cA_error_dispatch:
  1588                              <1>   %rep %0
  1589                              <1>     _HEX2 %1, __H, __L
  1590                              <1>     dw %1, _cA_errh%+__H%+__L
  1591                              <1>     %undef __H
  1592                              <1>     %undef __L
  1593                              <1>     %rotate 1
  1594                              <1>   %endrep
  1595                              <1>   dw 00h, _cA_errhnd
  1596                              <1> %endmacro
  1597                              <1> 
  1598                              <1> ; -----------------------------------------------------------------------------
  1599                              <1> ; \brief check a character at the given position in given label string...
  1600                              <1> ; CMP_CHR <label>, <num-position>, <char to check>, <jump label if equal>
  1601                              <1> ; CMP_CHR argvn, 2, '3', is_three
  1602                              <1> ; -----------------------------------------------------------------------------
  1603                              <1> %macro CMP_CHR 4
  1604                              <1>     %ifstr %1
  1605                              <1>         section .data
  1606                              <1>         %%msg: db %1, 0
  1607                              <1>         section .text
  1608                              <1>         lea si, [PTR16(%%msg)]       ; text 0-terminated
  1609                              <1>     %else
  1610                              <1>     section .text
  1611                              <1>         %assign __count 0
  1612                              <1>         %assign __varg  0
  1613                              <1>         %assign __stop  0
  1614                              <1>         %rep MAX_ARGV
  1615                              <1>             %if __stop == 0
  1616                              <1>                 %assign __count (__count + 1)
  1617                              <1>                 %ifidni %1, ARGV_%+__count
  1618                              <1>                     %assign __varg __count
  1619                              <1>                     %assign __stop 1
  1620                              <1>                 %endif
  1621                              <1>             %endif
  1622                              <1>         %endrep
  1623                              <1>         %if __varg > 0
  1624                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1625                              <1>             mov  bl, __varg
  1626                              <1>             call getCommandLine_Arg
  1627                              <1>         %else
  1628                              <1>             lea si, [PTR16(_cA_%1)]
  1629                              <1>         %endif
  1630                              <1>         %undef __stop
  1631                              <1>         %undef __varg
  1632                              <1>     %endif
  1633                              <1>         xor  cl, cl
  1634                              <1>         push si
  1635                              <1>     %%loop:
  1636                              <1>         lodsb
  1637                              <1>         inc cl
  1638                              <1>         cmp cl, %2
  1639                              <1>         je  %%next
  1640                              <1>         jmp %%loop
  1641                              <1>     %%next:
  1642                              <1>         pop si
  1643                              <1>         cmp al, %3
  1644                              <1>         je  %4
  1645                              <1> %endmacro
  1646                              <1> 
  1647                              <1> ; -----------------------------------------------------------------------------
  1648                              <1> ; \brief compare 2 string's ...
  1649                              <1> ; -----------------------------------------------------------------------------
  1650                              <1> %macro CMP_STR 3
  1651                              <1>     %ifnum %1                           ; argument 1 is a number ?
  1652                              <1>         %error 'numbers can not be handled as string.'
  1653                              <1>     %elifstr %1                         ; argument 1 is a string ?
  1654                              <1>         section .data
  1655                              <1>         %%part1: db %1, 0
  1656                              <1>         section .text
  1657                              <1>         lea  si, [PTR16(%%part1)]       ; dst
  1658                              <1>         %ifstr %2                       ; argument 2 is a string ?
  1659                              <1>             section .data
  1660                              <1>             %%part2: db %2, 0
  1661                              <1>             section .text
  1662                              <1>             lea di, [PTR16(%%part2)]    ; src
  1663                              <1>             call string_compare
  1664                              <1>             cmp al, 0
  1665                              <1>             je  %3
  1666                              <1>         %elifnum %2                     ; argument 2 is a number ?
  1667                              <1>             %error 'numbers can not be handled as string.'
  1668                              <1>         %else
  1669                              <1>             %error 'todo'
  1670                              <1>         %endif
  1671                              <1>     %else
  1672                              <1>     section .text
  1673                              <1>         %assign __count 0
  1674                              <1>         %assign __varg  0
  1675                              <1>         %assign __stop  0
  1676                              <1>         %rep MAX_ARGV
  1677                              <1>             %if __stop == 0
  1678                              <1>                 %assign __count (__count + 1)
  1679                              <1>                 %ifidni %1, ARGV_%+__count
  1680                              <1>                     %assign __varg __count
  1681                              <1>                     %assign __stop 1
  1682                              <1>                 %endif
  1683                              <1>             %endif
  1684                              <1>         %endrep
  1685                              <1>         %if __varg > 0
  1686                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1687                              <1>             mov  bl, __varg
  1688                              <1>             call getCommandLine_Arg
  1689                              <1>         %else
  1690                              <1>             lea si, [PTR16(_cA_%1)]
  1691                              <1>         %endif
  1692                              <1>         %imdef __stop
  1693                              <1>         %undef __varg
  1694                              <1>     %endif
  1695                              <1> %endmacro
    11                                  
    12                                  kernel_start:
    13                                  section .text
    14                                  %include 'code16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  code16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> %define DOS_SHELL 1
     9                              <1> %define MAX_ARGS  7
    10                              <1> bits 16
    11                              <1> code16_start:
    12                              <1>     INIT_COMMAND_LINE
  1427                              <2> %if DOS_SHELL == 1
  1428 00000000 E8B20D              <2>  call dos_get_command_line
  1429                              <2> %else
  1430                              <2>  %error 'todo: windows'
  1431                              <2> %endif
    13                              <1>     INIT_CONSOLE
  1438                              <2> %if DOS_SHELL == 1
  1439 00000003 E88D0D              <2>  call dos_init_console
  1440                              <2>  SCREEN_CLEAR
  1104                              <3> %if DOS_SHELL == 1
  1105 00000006 E8DF0E              <3>  call dos_screen_clear
  1106                              <3> %else
  1107                              <3>  GET_CON_O_HANDLE r12
  1108                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1109                              <3>  WRITE_CON_A buffer_B
  1110                              <3> %endif
  1441                              <2> %else
  1442                              <2>  call init_app
  1443                              <2>  call init_console
  1444                              <2> %endif
    14                              <1>         
    15                              <1>     READL_CON_A dos_buffer
  1008                              <2> %if DOS_SHELL == 1
  1009                              <2>  %if %0 == 1
  1010 00000009 BA(7601)            <2>  mov dx, PTR16(_cA_%1)
  1011 0000000C E8C30E              <2>  call DOSReadLn
  1012                              <2>  %else
  1013                              <2>  mov dx, PTR16(_cA_dos_buffer)
  1014                              <2>  call DOSReadLn
  1015                              <2>  %endif
  1016                              <2> %else
  1017                              <2> 
  1018                              <2>  GET_CON_I_HANDLE r13
  1019                              <2> 
  1020                              <2>  mov rcx, r13
  1021                              <2>  mov rdx, PTR64(_cA_%1)
  1022                              <2>  mov r8d, 127
  1023                              <2>  mov r9 , PTR64(written)
  1024                              <2>  xor rax, rax
  1025                              <2>  mov [rsp+32], rax
  1026                              <2>  CALL_IAT ReadConsoleA
  1027                              <2> %endif
    16                              <1>     SET_CURSOR  10, 5
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 0000000F B20A                <2>  mov dl, %1
  1124 00000011 B605                <2>  mov dh, %2
  1125 00000013 E8D509              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    17                              <1>     PUTS_COLOR  dos_buffer, 0x02 | 0x10
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000016 E8E509              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 00000019 B312                <2>  mov bl, %2
  1213 0000001B BE(7601)            <2>  mov si, PTR16(_cA_%1)
  1214 0000001E E8660E              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    18                              <1>     
    19                              <1>     ; text + prompt ausgeben
    20                              <1>     ;SET_CURSOR 2, 10
    21                              <1>     ;PUTS_COLOR dos_prompt, 0x0E | 0x10
    22                              <1>     
    23                              <1>     ;SET_CURSOR 10, 10
    24                              <1>     ;READL_CON_A dos_buffer
    25                              <1>     
    26                              <1>     ;SET_CURSOR 10, 3
    27                              <1>     ;PUTS_COLOR dos_buffer, 0x0E | 0x10
    28                              <1>     
    29                              <1>     ;SET_CURSOR 10, 7
    30                              <1>     ;PUTS_COLOR cmd_buf, 0x0E | 0x10
    31                              <1>     
    32                              <1>     ;SET_CURSOR 20, 7
    33                              <1>     ;PUTS_COLOR DBFNAME, 0x0E
    34                              <1> ;    DOS_Exit 0
    35                              <1> 
    36                              <1> ; -----------------------------------------------------------------------------
    37                              <1> ; dbfmake.asm  - Create/Append field into dBASE III/IV DBF by INT 21h
    38                              <1> ; Build:  nasm -f bin dbfmake.asm -o DBFMAKE.COM
    39                              <1> ; Run:    DBFMAKE <type> <cmd> <feldtype> <feldname> <feldlaenge>
    40                              <1> ; Example:
    41                              <1> ;   DBFMAKE 3 CREATE C NAME 20
    42                              <1> ;   DBFMAKE 4 APPEND I AGE 3
    43                              <1> ; Type: 3 (dBASE III), 4 (dBASE IV)
    44                              <1> ; Cmd:  CREATE | APPEND
    45                              <1> ; Feldtype: C,I,F,B,D,T  (T only for type 4)
    46                              <1> ; Feldname: max 10 Zeichen (dBASE-Beschränkung, 11. Byte = 0)
    47                              <1> ; Feldlaenge: Dezimal (z.B. 20)
    48                              <1> ; -----------------------------------------------------------------------------
    49                              <1> 
    50                              <1>     GET_CURSOR
  1134                              <2> %if DOS_SHELL == 1
  1135 00000021 E8DA09              <2>  call dos_get_cursor
  1136                              <2> %else
  1137                              <2>  %error 'todo: windows'
  1138                              <2> %endif
    51                              <1>     SET_CURSOR 20, 7
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 00000024 B214                <2>  mov dl, %1
  1124 00000026 B607                <2>  mov dh, %2
  1125 00000028 E8C009              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    52                              <1>     PUTS_COLOR 'schärpfel', 2
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000002B E8D009              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177 00000000 736368C3A472706665- <2>  %%msg: db %1, 0
  1177 00000009 6C00                <2>
  1178                              <2>  section .text
  1179 0000002E B302                <2>  mov bl, %2
  1180 00000030 BE(0001)            <2>  mov si, PTR16(%%msg)
  1181 00000033 E8510E              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212                              <2>  mov bl, %2
  1213                              <2>  mov si, PTR16(_cA_%1)
  1214                              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    53                              <1>     
    54                              <1>     SET_CURSOR 20, 8
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 00000036 B214                <2>  mov dl, %1
  1124 00000038 B608                <2>  mov dh, %2
  1125 0000003A E8AE09              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    55                              <1>     PUTS_COLOR 'schupfel', 3
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000003D E8BE09              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177 0000000B 736368757066656C00  <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179 00000040 B303                <2>  mov bl, %2
  1180 00000042 BE(0B01)            <2>  mov si, PTR16(%%msg)
  1181 00000045 E83F0E              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212                              <2>  mov bl, %2
  1213                              <2>  mov si, PTR16(_cA_%1)
  1214                              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    56                              <1> 
    57                              <1>     CMP_CHR ARGV_1, 3, '5', is_three
  1604                              <2>  %ifstr %1
  1605                              <2>  section .data
  1606                              <2>  %%msg: db %1, 0
  1607                              <2>  section .text
  1608                              <2>  lea si, [PTR16(%%msg)]
  1609                              <2>  %else
  1610                              <2>  section .text
  1611                              <2>  %assign __count 0
  1612                              <2>  %assign __varg 0
  1613                              <2>  %assign __stop 0
  1614                              <2>  %rep MAX_ARGV
  1615                              <2>  %if __stop == 0
  1616                              <2>  %assign __count (__count + 1)
  1617                              <2>  %ifidni %1, ARGV_%+__count
  1618                              <2>  %assign __varg __count
  1619                              <2>  %assign __stop 1
  1620                              <2>  %endif
  1621                              <2>  %endif
  1622                              <2>  %endrep
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1615                              <3>  %if __stop == 0
  1616                              <3>  %assign __count (__count + 1)
  1617                              <3>  %ifidni %1, ARGV_%+__count
  1618                              <3>  %assign __varg __count
  1619                              <3>  %assign __stop 1
  1620                              <3>  %endif
  1621                              <3>  %endif
  1623                              <2>  %if __varg > 0
  1624 00000048 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1625 0000004B B301                <2>  mov bl, __varg
  1626 0000004D E84509              <2>  call getCommandLine_Arg
  1627                              <2>  %else
  1628                              <2>  lea si, [PTR16(_cA_%1)]
  1629                              <2>  %endif
  1630                              <2>  %undef __stop
  1631                              <2>  %undef __varg
  1632                              <2>  %endif
  1633 00000050 30C9                <2>  xor cl, cl
  1634 00000052 56                  <2>  push si
  1635                              <2>  %%loop:
  1636 00000053 AC                  <2>  lodsb
  1637 00000054 FEC1                <2>  inc cl
  1638 00000056 80F903              <2>  cmp cl, %2
  1639 00000059 7402                <2>  je %%next
  1640 0000005B EBF6                <2>  jmp %%loop
  1641                              <2>  %%next:
  1642 0000005D 5E                  <2>  pop si
  1643 0000005E 3C35                <2>  cmp al, %3
  1644 00000060 742D                <2>  je %4
    58                              <1>     CMP_STR 'zuza', 'zuza', is_okk
  1651                              <2>  %ifnum %1
  1652                              <2>  %error 'numbers can not be handled as string.'
  1653                              <2>  %elifstr %1
  1654                              <2>  section .data
  1655 00000014 7A757A6100          <2>  %%part1: db %1, 0
  1656                              <2>  section .text
  1657 00000062 8D36(1401)          <2>  lea si, [PTR16(%%part1)]
  1658                              <2>  %ifstr %2
  1659                              <2>  section .data
  1660 00000019 7A757A6100          <2>  %%part2: db %2, 0
  1661                              <2>  section .text
  1662 00000066 8D3E(1901)          <2>  lea di, [PTR16(%%part2)]
  1663 0000006A E8B00E              <2>  call string_compare
  1664 0000006D 3C00                <2>  cmp al, 0
  1665 0000006F 7432                <2>  je %3
  1666                              <2>  %elifnum %2
  1667                              <2>  %error 'numbers can not be handled as string.'
  1668                              <2>  %else
  1669                              <2>  %error 'todo'
  1670                              <2>  %endif
  1671                              <2>  %else
  1672                              <2>  section .text
  1673                              <2>  %assign __count 0
  1674                              <2>  %assign __varg 0
  1675                              <2>  %assign __stop 0
  1676                              <2>  %rep MAX_ARGV
  1677                              <2>  %if __stop == 0
  1678                              <2>  %assign __count (__count + 1)
  1679                              <2>  %ifidni %1, ARGV_%+__count
  1680                              <2>  %assign __varg __count
  1681                              <2>  %assign __stop 1
  1682                              <2>  %endif
  1683                              <2>  %endif
  1684                              <2>  %endrep
  1685                              <2>  %if __varg > 0
  1686                              <2>  mov si, PTR16(_cA_cmd_buf)
  1687                              <2>  mov bl, __varg
  1688                              <2>  call getCommandLine_Arg
  1689                              <2>  %else
  1690                              <2>  lea si, [PTR16(_cA_%1)]
  1691                              <2>  %endif
  1692                              <2>  %imdef __stop
  1693                              <2>  %undef __varg
  1694                              <2>  %endif
    59 00000071 84C0                <1>     test al, al
    60 00000073 742E                <1>     jz is_okk
    61                              <1>     
    62                              <1>     SET_CURSOR 20, 3
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 00000075 B214                <2>  mov dl, %1
  1124 00000077 B603                <2>  mov dh, %2
  1125 00000079 E86F09              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    63                              <1>     PUTS_COLOR ARGV_2, 1
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000007C E87F09              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206 0000007F BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1207 00000082 B302                <2>  mov bl, __varg
  1208 00000084 E80E09              <2>  call getCommandLine_Arg
  1209 00000087 E8FD0D              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212                              <2>  mov bl, %2
  1213                              <2>  mov si, PTR16(_cA_%1)
  1214                              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    64                              <1>     DOS_Exit 0
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 0000008A B8004C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 0000008D CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
    65                              <1>     
    66                              <1>     is_three:
    67                              <1>     SET_CURSOR 20, 5
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 0000008F B214                <2>  mov dl, %1
  1124 00000091 B605                <2>  mov dh, %2
  1125 00000093 E85509              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    68                              <1>     PUTS_COLOR SI, 0x0F
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000096 E86509              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189 00000099 B30F                <2>  mov bl, %2
  1190 0000009B E8E90D              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212                              <2>  mov bl, %2
  1213                              <2>  mov si, PTR16(_cA_%1)
  1214                              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    69                              <1>     DOS_Exit   0
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 0000009E B8004C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000000A1 CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
    70                              <1>     
    71                              <1>     is_okk:
    72                              <1>     SET_CURSOR 40, 5
  1119                              <2> %if %0 == 0
  1120                              <2>  %error 2 argument missing
  1121                              <2> %endif
  1122                              <2> %if DOS_SHELL == 1
  1123 000000A3 B228                <2>  mov dl, %1
  1124 000000A5 B605                <2>  mov dh, %2
  1125 000000A7 E84109              <2>  call dos_set_cursor
  1126                              <2> %else
  1127                              <2> %endif
    73                              <1>     PUTS_COLOR 'mufti', 0x1C
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 000000AA E85109              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177 0000001E 6D7566746900        <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179 000000AD B31C                <2>  mov bl, %2
  1180 000000AF BE(1E01)            <2>  mov si, PTR16(%%msg)
  1181 000000B2 E8D20D              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212                              <2>  mov bl, %2
  1213                              <2>  mov si, PTR16(_cA_%1)
  1214                              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
    74                              <1>     DOS_Exit   0
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 000000B5 B8004C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000000B8 CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
    75                              <1>     ;ret
    76 000000BA E98D05              <1> jmp usage
    77                              <1>     .token_done:
    78                              <1>     DOS_Exit 0
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 000000BD B8004C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000000C0 CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
    79                              <1>         
    80                              <1>     ; -------- <type> --------
    81 000000C2 E88403              <1>     call next_token
    82 000000C5 0F828105            <1>     jc  usage
    83 000000C9 BA(EF1E)            <1>     mov dx, PTR16(tokbuf)
    84 000000CC E84004              <1>     call parse_u16
    85 000000CF 0F828405            <1>     jc  badargs
    86 000000D3 83F803              <1>     cmp ax, 3
    87 000000D6 7407                <1>     je  .have_type
    88 000000D8 83F804              <1>     cmp ax, 4
    89 000000DB 0F857805            <1>     jne badargs
    90                              <1>     .have_type:
    91 000000DF A3(EF1E)            <1>     mov [PTR16(g_type)], ax
    92                              <1> 
    93                              <1>     ; -------- <cmd> --------
    94 000000E2 E86403              <1>     call next_token
    95 000000E5 0F826105            <1>     jc  usage
    96 000000E9 E85104              <1>     call upper_inplace_dx
    97 000000EC 89D6                <1>     mov si, dx
    98 000000EE BF(1805)            <1>     mov di, PTR16(str_CREATE)
    99 000000F1 E8F803              <1>     call strcmp
   100 000000F4 85C0                <1>     test ax, ax
   101 000000F6 740F                <1>     jz  .cmd_create
   102 000000F8 BF(1F05)            <1>     mov di, PTR16(str_APPEND)
   103 000000FB 89D6                <1>     mov si, dx
   104 000000FD E8EC03              <1>     call strcmp
   105 00000100 85C0                <1>     test ax, ax
   106 00000102 740A                <1>     jz  .cmd_append
   107 00000104 E95005              <1>     jmp badargs
   108                              <1>     .cmd_create:
   109 00000107 C606(EF1E)01        <1>     mov byte [PTR16(g_cmd)], 1
   110 0000010C EB05                <1>     jmp .got_cmd
   111                              <1>     .cmd_append:
   112 0000010E C606(EF1E)02        <1>     mov byte [PTR16(g_cmd)], 2
   113                              <1>     .got_cmd:
   114                              <1> 
   115                              <1>     ; -------- <feldtype> --------
   116 00000113 E83303              <1>     call next_token
   117 00000116 0F823005            <1>     jc  usage
   118 0000011A 89D6                <1>     mov si, dx
   119 0000011C 8A04                <1>     mov al, [si]          ; erstes Zeichen des Tokens
   120 0000011E E83004              <1>     call to_upper
   121 00000121 A2(EF1E)            <1>     mov [PTR16(g_ftype)], al
   122                              <1> 
   123                              <1>     ; -------- <feldname> (max 10) --------
   124 00000124 BF(2F1F)            <1>     mov di, PTR16(fldname)
   125 00000127 E86603              <1>     call copy_token_max_10
   126 0000012A 0F821C05            <1>     jc  usage
   127 0000012E C60500              <1>     mov byte [di], 0      ; Nullterminierung (Routine schreibt sie ohnehin)
   128                              <1> 
   129                              <1>     ; -------- <feldlaenge> --------
   130 00000131 E81503              <1>     call next_token
   131 00000134 0F821205            <1>     jc  usage
   132 00000138 BA(EF1E)            <1>     mov dx, PTR16(tokbuf)
   133 0000013B E8D103              <1>     call parse_u16
   134 0000013E 0F821505            <1>     jc  badargs
   135 00000142 A3(EF1E)            <1>     mov [PTR16(g_flen)], ax
   136                              <1> 
   137                              <1>     ; --- Feldtyp mappen + Länge validieren ---
   138 00000145 A0(EF1E)            <1>     mov al, [PTR16(g_ftype)]
   139 00000148 E81D04              <1>     call map_fieldtype      ; AL=DBF Type, BL=fixedLen(0/const), BH=only4
   140 0000014B 0F820805            <1>     jc  badargs
   141 0000014F 80FF01              <1>     cmp bh, 1
   142 00000152 7509                <1>     jne .ok_ftyp
   143 00000154 833E(EF1E)04        <1>     cmp word [PTR16(g_type)], 4
   144 00000159 0F852E05            <1>     jne not_supported
   145                              <1>     .ok_ftyp:
   146 0000015D 80FB00              <1>     cmp bl, 0
   147 00000160 7409                <1>     je  .keep_len
   148 00000162 881E(EF1E)          <1>     mov byte [PTR16(g_flen)    ], bl   ; fixe Länge erzwingen
   149 00000166 C606(F01E)00        <1>     mov byte [PTR16(g_flen) + 1], 0
   150                              <1>     .keep_len:
   151 0000016B A1(EF1E)            <1>     mov ax, [PTR16(g_flen)]
   152 0000016E 8A16(EF1E)          <1>     mov dl, [PTR16(g_ftype)]
   153 00000172 E85104              <1>     call validate_length
   154 00000175 0F82DE04            <1>     jc  badargs
   155                              <1> 
   156                              <1>     ; Datum für Header holen
   157 00000179 B42A                <1>     mov ah, 2Ah
   158 0000017B CD21                <1>     int 21h
   159 0000017D 890E(EF1E)          <1>     mov [PTR16(g_year)], cx
   160 00000181 8836(EF1E)          <1>     mov [PTR16(g_month)], dh
   161 00000185 8816(EF1E)          <1>     mov [PTR16(g_day)], dl
   162                              <1> 
   163                              <1>     ; --- Dispatch nach CMD ---
   164                              <1> do_dispatch:
   165 00000189 803E(EF1E)01        <1>     cmp byte [PTR16(g_cmd)], 1
   166 0000018E 7437                <1>     je  do_create
   167 00000190 EB64                <1>     jmp do_append
   168                              <1> 
   169                              <1> ; --- Hex-Ausgabe (AX -> XXXXh, nutzt int 21h/AH=02h) ---
   170                              <1> print_hex16:
   171 00000192 50                  <1>     push ax
   172 00000193 53                  <1>     push bx
   173 00000194 51                  <1>     push cx
   174 00000195 52                  <1>     push dx
   175 00000196 89C3                <1>     mov  bx, ax
   176 00000198 B90400              <1>     mov  cx, 4
   177                              <1>     .next_nibble:
   178 0000019B C1C304              <1>     rol  bx, 4
   179 0000019E 88DA                <1>     mov  dl, bl
   180 000001A0 80E20F              <1>     and  dl, 0Fh
   181 000001A3 80C230              <1>     add  dl, '0'
   182 000001A6 80FA39              <1>     cmp  dl, '9'
   183 000001A9 7603                <1>     jbe  .out
   184 000001AB 80C207              <1>     add  dl, 7          ; 'A'..'F'
   185                              <1>     .out:
   186 000001AE B402                <1>     mov  ah, 02h
   187 000001B0 CD21                <1>     int  21h
   188 000001B2 E2E7                <1>     loop .next_nibble
   189 000001B4 B268                <1>     mov  dl, 'h'
   190 000001B6 B402                <1>     mov  ah, 02h
   191 000001B8 CD21                <1>     int  21h
   192 000001BA B20D                <1>     mov  dl, 13         ; CR LF
   193 000001BC CD21                <1>     int  21h
   194 000001BE B20A                <1>     mov  dl, 10
   195 000001C0 CD21                <1>     int  21h
   196 000001C2 5A                  <1>     pop  dx
   197 000001C3 59                  <1>     pop  cx
   198 000001C4 5B                  <1>     pop  bx
   199 000001C5 58                  <1>     pop  ax
   200 000001C6 C3                  <1>     ret
   201                              <1> ; ---------------- CREATE ----------------
   202                              <1> do_create:
   203                              <1>     ; vorhandene Datei (ignoriert Fehler) löschen
   204 000001C7 BA(BA01)            <1>     mov dx, PTR16(_cA_DBFNAME)
   205 000001CA B441                <1>     mov ah, 41h
   206 000001CC CD21                <1>     int 21h
   207                              <1> 
   208                              <1>     ; neu anlegen
   209 000001CE BA(BA01)            <1>     mov dx, PTR16(_cA_DBFNAME)
   210 000001D1 B90000              <1>     mov cx, 0
   211 000001D4 B43C                <1>     mov ah, 3Ch
   212 000001D6 CD21                <1>     int 21h
   213 000001D8 0F82BC04            <1>     jc  io_error
   214 000001DC A3(EF1E)            <1>     mov [PTR16(hFile)], ax
   215                              <1> 
   216                              <1>     ; Header + 1 Feld bauen und schreiben
   217 000001DF E82401              <1>     call build_header_for_new
   218 000001E2 E89401              <1>     call write_full_header
   219                              <1> 
   220                              <1>     ; schließen
   221 000001E5 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   222 000001E9 B43E                <1>     mov ah, 3Eh
   223 000001EB CD21                <1>     int 21h
   224                              <1>     
   225                              <1> ;todo paule32
   226                              <1> ;    DOS_WriteLn msg_ok_create
   227                              <1> 
   228                              <1>     ;lea dx, PTR16(msg_ok_create)
   229                              <1> 
   230 000001ED E84204              <1>     call print_$
   231                              <1>     DOS_crlf
  1277 000001F0 E8520C              <2>  call DOSrncrlf
   232 000001F3 E9BC04              <1>     jmp exit0
   233                              <1> 
   234                              <1> ; ---------------- APPEND ----------------
   235                              <1> do_append:
   236                              <1>     ; RDWR öffnen
   237 000001F6 BA(BA01)            <1>     mov dx, PTR16(_cA_DBFNAME)
   238 000001F9 B8023D              <1>     mov ax, 3D02h
   239 000001FC CD21                <1>     int 21h
   240 000001FE 0F826204            <1>     jc  open_fail
   241 00000202 A3(EF1E)            <1>     mov [PTR16(hFile)], ax
   242                              <1> 
   243                              <1>     ; Header lesen (32)
   244 00000205 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   245 00000209 BA(3B1F)            <1>     mov dx, PTR16(header)
   246 0000020C B92000              <1>     mov cx, 32
   247 0000020F B43F                <1>     mov ah, 3Fh
   248 00000211 CD21                <1>     int 21h
   249 00000213 0F828104            <1>     jc  io_error
   250 00000217 83F820              <1>     cmp ax, 32
   251 0000021A 0F857A04            <1>     jne io_error
   252                              <1> 
   253                              <1>     ; Typ prüfen
   254 0000021E A0(3B1F)            <1>     mov al, [PTR16(header)+0]
   255 00000221 833E(EF1E)03        <1>     cmp word [PTR16(g_type)], 3
   256 00000226 7508                <1>     jne .chk4
   257 00000228 3C03                <1>     cmp al, 03h
   258 0000022A 0F854304            <1>     jne ver_mismatch
   259 0000022E EB06                <1>     jmp .t_ok
   260                              <1>     .chk4:
   261 00000230 3C04                <1>     cmp al, 04h
   262 00000232 0F853B04            <1>     jne ver_mismatch
   263                              <1>     .t_ok:
   264                              <1> 
   265                              <1>     ; Records==0?
   266 00000236 A1(3F1F)            <1>     mov ax, [PTR16(header)+4]
   267 00000239 8B16(411F)          <1>     mov dx, [PTR16(header)+6]
   268 0000023D 09C0                <1>     or  ax, ax
   269 0000023F 09D2                <1>     or  dx, dx
   270 00000241 0F853904            <1>     jnz append_with_records_not_supported
   271                              <1> 
   272                              <1>     ; Header-/Recordlänge
   273 00000245 A1(431F)            <1>     mov ax, [PTR16(header)+8]
   274 00000248 A3(9808)            <1>     mov [PTR16(hdr_len)], ax
   275 0000024B A1(451F)            <1>     mov ax, [PTR16(header)+10]
   276 0000024E A3(9A08)            <1>     mov [PTR16(rec_len)], ax
   277                              <1> 
   278                              <1>     ; Felddeskriptoren laden (hdr_len - 32)
   279 00000251 A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
   280 00000254 83E820              <1>     sub ax, 32
   281 00000257 0F864A04            <1>     jbe bad_header
   282 0000025B 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   283 0000025F BA(5206)            <1>     mov dx, PTR16(fdescbuf)
   284 00000262 89C1                <1>     mov cx, ax
   285 00000264 B43F                <1>     mov ah, 3Fh
   286 00000266 CD21                <1>     int 21h
   287 00000268 0F822C04            <1>     jc  io_error
   288 0000026C A3(5B1F)            <1>     mov [PTR16(fdbuf_size)], ax
   289                              <1> 
   290                              <1>     ; existiert Feld?
   291 0000026F E88701              <1>     call field_exists
   292 00000272 0F82C103            <1>     jc  field_already
   293                              <1> 
   294                              <1>     ; Terminator finden
   295 00000276 BE(5206)            <1>     mov si, PTR16(fdescbuf)
   296 00000279 8B0E(5B1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   297                              <1>     .find_term:
   298 0000027D 83F900              <1>     cmp cx, 0
   299 00000280 0F842104            <1>     je  bad_header
   300 00000284 803C0D              <1>     cmp byte [si], 0Dh
   301 00000287 7408                <1>     je  .term_found
   302 00000289 83C620              <1>     add si, 32
   303 0000028C 83E920              <1>     sub cx, 32
   304 0000028F EBEC                <1>     jmp .find_term
   305                              <1>     .term_found:
   306                              <1>     ; neuen FD in tempdesc bauen
   307 00000291 E85E01              <1>     call build_one_descriptor_to_temp
   308                              <1>     ; 32 Byte an Terminatorstelle kopieren
   309 00000294 56                  <1>     push si
   310 00000295 89F7                <1>     mov di, si
   311 00000297 BE(5B1F)            <1>     mov si, PTR16(tempdesc)
   312 0000029A B92000              <1>     mov cx, 32
   313 0000029D F3A4                <1>     rep movsb
   314 0000029F 5E                  <1>     pop si
   315                              <1>     ; neuen Terminator hinterher
   316 000002A0 C6040D              <1>     mov byte [si], 0Dh
   317                              <1> 
   318                              <1>     ; Header anpassen
   319 000002A3 A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
   320 000002A6 83C020              <1>     add ax, 32
   321 000002A9 A3(9808)            <1>     mov [PTR16(hdr_len)], ax
   322 000002AC A3(431F)            <1>     mov [PTR16(header)+8], ax
   323 000002AF A1(9A08)            <1>     mov ax, [PTR16(rec_len)]
   324 000002B2 0306(EF1E)          <1>     add ax, [PTR16(g_flen)]
   325 000002B6 A3(9A08)            <1>     mov [PTR16(rec_len)], ax
   326 000002B9 A3(451F)            <1>     mov [PTR16(header)+10], ax
   327                              <1> 
   328                              <1>     ; an BOF seeken
   329 000002BC 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   330 000002C0 31D2                <1>     xor dx, dx
   331 000002C2 31C9                <1>     xor cx, cx
   332 000002C4 B80042              <1>     mov ax, 4200h
   333 000002C7 CD21                <1>     int 21h
   334                              <1> 
   335                              <1>     ; Header schreiben (32)
   336 000002C9 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   337 000002CD BA(3B1F)            <1>     mov dx, PTR16(header)
   338 000002D0 B92000              <1>     mov cx, 32
   339 000002D3 B440                <1>     mov ah, 40h
   340 000002D5 CD21                <1>     int 21h
   341 000002D7 0F82BD03            <1>     jc  io_error
   342                              <1> 
   343                              <1>     ; FD-Region schreiben (hdr_len - 32)
   344 000002DB A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
   345 000002DE 83E820              <1>     sub ax, 32
   346 000002E1 89C1                <1>     mov cx, ax
   347 000002E3 BA(5206)            <1>     mov dx, PTR16(fdescbuf)
   348 000002E6 8B1E[EF1D]          <1>     mov bx, [hFile]
   349 000002EA B440                <1>     mov ah, 40h
   350 000002EC CD21                <1>     int 21h
   351 000002EE 0F82A603            <1>     jc  io_error
   352                              <1> 
   353                              <1>     ; schließen
   354 000002F2 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   355 000002F6 B43E                <1>     mov ah, 3Eh
   356 000002F8 CD21                <1>     int 21h
   357                              <1> 
   358 000002FA BA(AD04)            <1>     mov dx, PTR16(msg_ok_append)
   359 000002FD E83203              <1>     call print_$
   360                              <1>     DOS_crlf
  1277 00000300 E8420B              <2>  call DOSrncrlf
   361 00000303 E9AC03              <1>     jmp exit0
   362                              <1> 
   363                              <1> ; ---------------- Helper: Build/Write ----------------
   364                              <1> 
   365                              <1> ; build_header_for_new: header + 1 FD in fdescbuf (mit 0Dh) erzeugen
   366                              <1> build_header_for_new:
   367 00000306 50                  <1>     push ax
   368 00000307 53                  <1>     push bx
   369 00000308 51                  <1>     push cx
   370 00000309 52                  <1>     push dx
   371                              <1> 
   372                              <1>     ; clear header (32) + fdescbuf
   373 0000030A BF(3B1F)            <1>     mov di, PTR16(header)
   374 0000030D B91000              <1>     mov cx, 16
   375 00000310 31C0                <1>     xor ax, ax
   376 00000312 F3AB                <1>     rep stosw
   377 00000314 BF(5206)            <1>     mov di, PTR16(fdescbuf)
   378 00000317 B90008              <1>     mov cx, 2048
   379 0000031A F3AB                <1>     rep stosw
   380                              <1> 
   381                              <1>     ; version
   382 0000031C A1(EF1E)            <1>     mov ax, [PTR16(g_type)]
   383 0000031F 83F803              <1>     cmp ax, 3
   384 00000322 7507                <1>     jne .v4
   385 00000324 C606(3B1F)03        <1>     mov byte [PTR16(header)+0], 03h
   386 00000329 EB05                <1>     jmp .v_ok
   387                              <1>     .v4:
   388 0000032B C606(3B1F)04        <1>     mov byte [PTR16(header)+0], 04h
   389                              <1>     .v_ok:
   390                              <1>     ; date YY,MM,DD
   391 00000330 A1(EF1E)            <1>     mov ax, [PTR16(g_year)]
   392 00000333 BB6400              <1>     mov bx, 100
   393 00000336 31D2                <1>     xor dx, dx
   394 00000338 F7F3                <1>     div bx            ; AX=year/100, DX=YY
   395 0000033A 88D0                <1>     mov al, dl
   396 0000033C A2(3C1F)            <1>     mov [PTR16(header)+1], al
   397 0000033F A0(EF1E)            <1>     mov al, [PTR16(g_month)]
   398 00000342 A2(3D1F)            <1>     mov [PTR16(header)+2], al
   399 00000345 A0(EF1E)            <1>     mov al, [PTR16(g_day)]
   400 00000348 A2(3E1F)            <1>     mov [PTR16(header)+3], al
   401                              <1> 
   402                              <1>     ; num records = 0
   403 0000034B 66C706(3F1F)000000- <1>     mov dword [PTR16(header)+4], 0
   403 00000353 00                  <1>
   404                              <1> 
   405                              <1>     ; record length = 1 (delete flag) + field len
   406 00000354 A1(EF1E)            <1>     mov ax, [PTR16(g_flen)]
   407 00000357 83C001              <1>     add ax, 1
   408 0000035A A3(451F)            <1>     mov [PTR16(header)+10], ax
   409 0000035D A3(9A08)            <1>     mov [PTR16(rec_len)], ax
   410                              <1> 
   411                              <1>     ; header length = 32 + 32 (one FD) + 1 (0Dh)
   412 00000360 B84100              <1>     mov ax, 32+32+1
   413 00000363 A3(431F)            <1>     mov [PTR16(header)+8], ax
   414 00000366 A3(9808)            <1>     mov [PTR16(hdr_len)], ax
   415                              <1> 
   416                              <1>     ; MDX/langid = 0
   417                              <1> 
   418                              <1>     ; FD in fdescbuf und Terminator
   419 00000369 BF(5206)            <1>     mov di, PTR16(fdescbuf)
   420 0000036C E84100              <1>     call build_one_descriptor_at_di
   421 0000036F C606(7206)0D        <1>     mov byte [PTR16(fdescbuf)+32], 0Dh
   422                              <1> 
   423 00000374 5A                  <1>     pop dx
   424 00000375 59                  <1>     pop cx
   425 00000376 5B                  <1>     pop bx
   426 00000377 58                  <1>     pop ax
   427 00000378 C3                  <1>     ret
   428                              <1> 
   429                              <1> ; write_full_header: schreibt Header (32) + FD-Region (hdr_len-32)
   430                              <1> write_full_header:
   431                              <1>     ; seek BOF
   432 00000379 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   433 0000037D 31D2                <1>     xor dx, dx
   434 0000037F 31C9                <1>     xor cx, cx
   435 00000381 B80042              <1>     mov ax, 4200h
   436 00000384 CD21                <1>     int 21h
   437                              <1>     ; header
   438 00000386 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   439 0000038A BA(3B1F)            <1>     mov dx, PTR16(header)
   440 0000038D B92000              <1>     mov cx, 32
   441 00000390 B440                <1>     mov ah, 40h
   442 00000392 CD21                <1>     int 21h
   443 00000394 0F820003            <1>     jc  io_error
   444                              <1>     ; FD region
   445 00000398 A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
   446 0000039B 83E820              <1>     sub ax, 32
   447 0000039E 89C1                <1>     mov cx, ax
   448 000003A0 BA(5206)            <1>     mov dx, PTR16(fdescbuf)
   449 000003A3 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   450 000003A7 B440                <1>     mov ah, 40h
   451 000003A9 CD21                <1>     int 21h
   452 000003AB 0F82E902            <1>     jc  io_error
   453 000003AF C3                  <1>     ret
   454                              <1> 
   455                              <1> ; build_one_descriptor_at_di: DI->32 Byte Ziel
   456                              <1> build_one_descriptor_at_di:
   457 000003B0 56                  <1>     push si
   458 000003B1 50                  <1>     push ax
   459 000003B2 51                  <1>     push cx
   460                              <1> 
   461                              <1>     ; name (max 10 + 0) in 11 Bytes
   462 000003B3 BE(2F1F)            <1>     mov si, PTR16(fldname)
   463 000003B6 B90B00              <1>     mov cx, 11
   464                              <1>     .ncopy:
   465 000003B9 AC                  <1>     lodsb
   466 000003BA 3C00                <1>     cmp al, 0
   467 000003BC 7405                <1>     je  .padz
   468 000003BE AA                  <1>     stosb
   469 000003BF E2F8                <1>     loop .ncopy
   470 000003C1 EB08                <1>     jmp .name_done
   471                              <1>     .padz:
   472 000003C3 AA                  <1>     stosb
   473 000003C4 49                  <1>     dec cx
   474 000003C5 7404                <1>     jz  .name_done
   475 000003C7 B000                <1>     mov al, 0
   476 000003C9 F3AA                <1>     rep stosb
   477                              <1>     .name_done:
   478                              <1> 
   479                              <1>     ; type char
   480 000003CB A0(EF1E)            <1>     mov al, [PTR16(g_ftype)]
   481 000003CE E8EC01              <1>     call map_fieldtype_char_only
   482 000003D1 AA                  <1>     stosb
   483                              <1> 
   484                              <1>     ; data address (4) = 0
   485 000003D2 31C0                <1>     xor ax, ax
   486 000003D4 B90400              <1>     mov cx, 4
   487 000003D7 F3AA                <1>     rep stosb
   488                              <1> 
   489                              <1>     ; length (1)
   490 000003D9 A1(EF1E)            <1>     mov ax, [PTR16(g_flen)]
   491 000003DC 88C0                <1>     mov al, al
   492 000003DE AA                  <1>     stosb
   493                              <1> 
   494                              <1>     ; decimals (1) = 0
   495 000003DF B000                <1>     mov al, 0
   496 000003E1 AA                  <1>     stosb
   497                              <1> 
   498                              <1>     ; reserved(2)
   499 000003E2 AA                  <1>     stosb
   500 000003E3 AA                  <1>     stosb
   501                              <1> 
   502                              <1>     ; flags(1)=0
   503 000003E4 B000                <1>     mov al, 0
   504 000003E6 AA                  <1>     stosb
   505                              <1> 
   506                              <1>     ; autoinc next(4)+step(1)+reserved(6)=0
   507 000003E7 B90B00              <1>     mov cx, 11
   508 000003EA B000                <1>     mov al, 0
   509 000003EC F3AA                <1>     rep stosb
   510                              <1> 
   511 000003EE 59                  <1>     pop cx
   512 000003EF 58                  <1>     pop ax
   513 000003F0 5E                  <1>     pop si
   514 000003F1 C3                  <1>     ret
   515                              <1> 
   516                              <1> build_one_descriptor_to_temp:
   517 000003F2 BF(5B1F)            <1>     mov di, PTR16(tempdesc)
   518 000003F5 E8B8FF              <1>     call build_one_descriptor_at_di
   519 000003F8 C3                  <1>     ret
   520                              <1> 
   521                              <1> ; field_exists: CF=1 wenn Name bereits vorhanden
   522                              <1> field_exists:
   523 000003F9 56                  <1>     push si
   524 000003FA 57                  <1>     push di
   525 000003FB 51                  <1>     push cx
   526 000003FC 50                  <1>     push ax
   527 000003FD BE(5206)            <1>     mov si, PTR16(fdescbuf)
   528 00000400 8B0E(5B1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   529                              <1>     .floop:
   530 00000404 83F900              <1>     cmp cx, 0
   531 00000407 743A                <1>     je  .no
   532 00000409 803C0D              <1>     cmp byte [si], 0Dh
   533 0000040C 7435                <1>     je  .no
   534                              <1>     ; vergleiche 0-term feldname (bis 11)
   535 0000040E 56                  <1>     push si
   536 0000040F BF(2F1F)            <1>     mov di, PTR16(fldname)
   537 00000412 BB0B00              <1>     mov bx, 11
   538 00000415 BA0100              <1>     mov dx, 1          ; assume match
   539                              <1>     .cmpn:
   540 00000418 8A04                <1>     mov al, [si]
   541 0000041A 8A25                <1>     mov ah, [di]
   542 0000041C 80FC00              <1>     cmp ah, 0
   543 0000041F 7409                <1>     je  .endcmp
   544 00000421 38E0                <1>     cmp al, ah
   545 00000423 7507                <1>     jne .not
   546 00000425 46                  <1>     inc si
   547 00000426 47                  <1>     inc di
   548 00000427 4B                  <1>     dec bx
   549 00000428 75EE                <1>     jnz .cmpn
   550                              <1>     .endcmp:
   551                              <1>     ; wenn bis 0 gleich -> match
   552 0000042A EB03                <1>     jmp .match
   553                              <1>     .not:
   554 0000042C BA0000              <1>     mov dx, 0
   555                              <1>     .match:
   556 0000042F 5E                  <1>     pop si
   557 00000430 83FA01              <1>     cmp dx, 1
   558 00000433 7408                <1>     je  .yes
   559 00000435 83C620              <1>     add si, 32
   560 00000438 83E920              <1>     sub cx, 32
   561 0000043B EBC7                <1>     jmp .floop
   562                              <1>     .yes:
   563 0000043D F9                  <1>     stc
   564 0000043E 58                  <1>     pop ax
   565 0000043F 59                  <1>     pop cx
   566 00000440 5F                  <1>     pop di
   567 00000441 5E                  <1>     pop si
   568 00000442 C3                  <1>     ret
   569                              <1>     .no:
   570 00000443 F8                  <1>     clc
   571 00000444 58                  <1>     pop ax
   572 00000445 59                  <1>     pop cx
   573 00000446 5F                  <1>     pop di
   574 00000447 5E                  <1>     pop si
   575 00000448 C3                  <1>     ret
   576                              <1> 
   577                              <1> ; ---------------- Token/Parsing ----------------
   578                              <1> 
   579                              <1> ; next_token: PSP tail -> tokbuf, DX=tokbuf, CF=1 wenn keins
   580                              <1> next_token:
   581 00000449 50                  <1>     push ax
   582 0000044A 57                  <1>     push di
   583                              <1>     ; skip ws
   584                              <1>     .nt_skip:
   585 0000044B 80FB00              <1>     cmp bl, 0
   586 0000044E 743C                <1>     je  .none
   587 00000450 8A04                <1>     mov al, [si]
   588 00000452 46                  <1>     inc si
   589 00000453 FECB                <1>     dec bl
   590 00000455 3C0D                <1>     cmp al, 13
   591 00000457 7433                <1>     je  .none
   592 00000459 3C20                <1>     cmp al, ' '
   593 0000045B 74EE                <1>     je  .nt_skip
   594 0000045D 3C09                <1>     cmp al, 9
   595 0000045F 74EA                <1>     je  .nt_skip
   596 00000461 4E                  <1>     dec si
   597 00000462 FEC3                <1>     inc bl
   598                              <1>     ; copy
   599 00000464 BF(C204)            <1>     mov di, PTR16(_cA_cmd_buf)
   600                              <1>     .nt_copy:
   601 00000467 80FB00              <1>     cmp bl, 0
   602 0000046A 7416                <1>     je  .done
   603 0000046C 8A04                <1>     mov al, [si]
   604 0000046E 3C0D                <1>     cmp al, 13
   605 00000470 7410                <1>     je  .done
   606 00000472 3C20                <1>     cmp al, ' '
   607 00000474 740C                <1>     je  .done
   608 00000476 3C09                <1>     cmp al, 9
   609 00000478 7408                <1>     je  .done
   610 0000047A 8805                <1>     mov [di], al
   611 0000047C 47                  <1>     inc di
   612 0000047D 46                  <1>     inc si
   613 0000047E FECB                <1>     dec bl
   614 00000480 EBE5                <1>     jmp .nt_copy
   615                              <1>     .done:
   616 00000482 C60500              <1>     mov byte [di], 0
   617 00000485 BA(C204)            <1>     mov dx, PTR16(_cA_cmd_buf)
   618 00000488 F8                  <1>     clc
   619 00000489 5F                  <1>     pop di
   620 0000048A 58                  <1>     pop ax
   621 0000048B C3                  <1>     ret
   622                              <1>     .none:
   623 0000048C F9                  <1>     stc
   624 0000048D 5F                  <1>     pop di
   625 0000048E 58                  <1>     pop ax
   626 0000048F C3                  <1>     ret
   627                              <1> 
   628                              <1> ; copy_token_max_10: SI/BL => [DI], max 10, 0-term, CF wie oben
   629                              <1> copy_token_max_10:
   630 00000490 50                  <1>     push ax
   631 00000491 51                  <1>     push cx
   632                              <1>     ; skip ws
   633                              <1>     .ct10_skip:
   634 00000492 80FB00              <1>     cmp bl, 0
   635 00000495 7451                <1>     je  .none
   636 00000497 8A04                <1>     mov al, [si]
   637 00000499 46                  <1>     inc si
   638 0000049A FECB                <1>     dec bl
   639 0000049C 3C0D                <1>     cmp al, 13
   640 0000049E 7448                <1>     je  .none
   641 000004A0 3C20                <1>     cmp al, ' '
   642 000004A2 74EE                <1>     je  .ct10_skip
   643 000004A4 3C09                <1>     cmp al, 9
   644 000004A6 74EA                <1>     je  .ct10_skip
   645 000004A8 4E                  <1>     dec si
   646 000004A9 FEC3                <1>     inc bl
   647                              <1>     ; copy up to 10
   648 000004AB B90A00              <1>     mov cx, 10
   649                              <1>     .ct10_copy:
   650 000004AE 80FB00              <1>     cmp bl, 0
   651 000004B1 742E                <1>     je  .end
   652 000004B3 8A04                <1>     mov al, [si]
   653 000004B5 3C0D                <1>     cmp al, 13
   654 000004B7 7428                <1>     je  .end
   655 000004B9 3C20                <1>     cmp al, ' '
   656 000004BB 7424                <1>     je  .end
   657 000004BD 3C09                <1>     cmp al, 9
   658 000004BF 7420                <1>     je  .end
   659 000004C1 83F900              <1>     cmp cx, 0
   660 000004C4 7409                <1>     je  .skip_rest
   661 000004C6 8805                <1>     mov [di], al
   662 000004C8 47                  <1>     inc di
   663 000004C9 46                  <1>     inc si
   664 000004CA FECB                <1>     dec bl
   665 000004CC 49                  <1>     dec cx
   666 000004CD EBDF                <1>     jmp .ct10_copy
   667                              <1>     .skip_rest:
   668 000004CF 80FB00              <1>     cmp bl, 0
   669 000004D2 740D                <1>     je  .end
   670 000004D4 8A04                <1>     mov al, [si]
   671 000004D6 46                  <1>     inc si
   672 000004D7 FECB                <1>     dec bl
   673 000004D9 3C0D                <1>     cmp al, 13
   674 000004DB 7404                <1>     je  .end
   675 000004DD 3C20                <1>     cmp al, ' '
   676 000004DF 75EE                <1>     jne .skip_rest
   677                              <1>     .end:
   678 000004E1 C60500              <1>     mov byte [di], 0
   679 000004E4 F8                  <1>     clc
   680 000004E5 59                  <1>     pop cx
   681 000004E6 58                  <1>     pop ax
   682 000004E7 C3                  <1>     ret
   683                              <1>     .none:
   684 000004E8 F9                  <1>     stc
   685 000004E9 59                  <1>     pop cx
   686 000004EA 58                  <1>     pop ax
   687 000004EB C3                  <1>     ret
   688                              <1> 
   689                              <1> ; strcmp: SI=str1, DI=str2, AX=0 bei Gleichheit (ZF=1)
   690                              <1> strcmp:
   691 000004EC 56                  <1>     push si
   692 000004ED 57                  <1>     push di
   693                              <1>     .sc_loop:
   694 000004EE AC                  <1>     lodsb
   695 000004EF 8A25                <1>     mov ah, [di]
   696 000004F1 47                  <1>     inc di
   697 000004F2 E86700              <1>     call to_upper_al
   698 000004F5 E86800              <1>     call to_upper_ah
   699 000004F8 38E0                <1>     cmp al, ah
   700 000004FA 750B                <1>     jne .ne
   701 000004FC 84C0                <1>     test al, al
   702 000004FE 75EE                <1>     jnz .sc_loop
   703 00000500 31C0                <1>     xor ax, ax
   704 00000502 09C0                <1>     or  ax, ax
   705 00000504 5F                  <1>     pop di
   706 00000505 5E                  <1>     pop si
   707 00000506 C3                  <1>     ret
   708                              <1>     .ne:
   709 00000507 B80100              <1>     mov ax, 1
   710 0000050A 09C0                <1>     or  ax, ax
   711 0000050C 5F                  <1>     pop di
   712 0000050D 5E                  <1>     pop si
   713 0000050E C3                  <1>     ret
   714                              <1> 
   715                              <1> ; parse_u16: DX->zstr, AX=result, CF=1 bei Fehler
   716                              <1> parse_u16:
   717 0000050F 53                  <1>     push bx
   718 00000510 56                  <1>     push si
   719 00000511 89D6                <1>     mov si, dx
   720 00000513 31C0                <1>     xor ax, ax
   721                              <1>     .pu_loop:
   722 00000515 AC                  <1>     lodsb
   723 00000516 84C0                <1>     test al, al
   724 00000518 741B                <1>     jz  .ok
   725 0000051A 3C30                <1>     cmp al, '0'
   726 0000051C 721B                <1>     jb  .err
   727 0000051E 3C39                <1>     cmp al, '9'
   728 00000520 7717                <1>     ja  .err
   729 00000522 2C30                <1>     sub al, '0'         ; digit in AL
   730 00000524 89C3                <1>     mov bx, ax          ; BX = acc
   731 00000526 D1E0                <1>     shl ax, 1           ; acc*2
   732 00000528 89C2                <1>     mov dx, ax
   733 0000052A C1E002              <1>     shl ax, 2           ; acc*8
   734 0000052D 01D0                <1>     add ax, dx          ; acc*10
   735 0000052F 01D8                <1>     add ax, bx          ; +digit
   736 00000531 7206                <1>     jc  .err
   737 00000533 EBE0                <1>     jmp .pu_loop
   738                              <1>     .ok:
   739 00000535 F8                  <1>     clc
   740 00000536 5E                  <1>     pop si
   741 00000537 5B                  <1>     pop bx
   742 00000538 C3                  <1>     ret
   743                              <1>     .err:
   744 00000539 F9                  <1>     stc
   745 0000053A 5E                  <1>     pop si
   746 0000053B 5B                  <1>     pop bx
   747 0000053C C3                  <1>     ret
   748                              <1> 
   749                              <1> ; upper_inplace_dx: DX->zstr upper-case
   750                              <1> upper_inplace_dx:
   751 0000053D 50                  <1>     push ax
   752 0000053E 52                  <1>     push dx
   753 0000053F 89D6                <1>     mov si, dx
   754                              <1>     .upl:
   755 00000541 AC                  <1>     lodsb
   756 00000542 84C0                <1>     test al, al
   757 00000544 7408                <1>     jz  .done
   758 00000546 E80800              <1>     call to_upper
   759 00000549 8844FF              <1>     mov [si-1], al
   760 0000054C EBF3                <1>     jmp .upl
   761                              <1>     .done:
   762 0000054E 5A                  <1>     pop dx
   763 0000054F 58                  <1>     pop ax
   764 00000550 C3                  <1>     ret
   765                              <1> 
   766                              <1> ; to_upper helpers
   767                              <1> to_upper:
   768 00000551 3C61                <1>     cmp al, 'a'
   769 00000553 7206                <1>     jb  .ret
   770 00000555 3C7A                <1>     cmp al, 'z'
   771 00000557 7702                <1>     ja  .ret
   772 00000559 2C20                <1>     sub al, 32
   773                              <1>     .ret:
   774 0000055B C3                  <1>     ret
   775                              <1> to_upper_al:
   776 0000055C E8F2FF              <1>     call to_upper
   777 0000055F C3                  <1>     ret
   778                              <1> to_upper_ah:
   779 00000560 86E0                <1>     xchg al, ah
   780 00000562 E8ECFF              <1>     call to_upper
   781 00000565 86E0                <1>     xchg al, ah
   782 00000567 C3                  <1>     ret
   783                              <1> 
   784                              <1> ; map_fieldtype: AL=CLI(C/I/F/B/D/T)-> DBF Typ in [g_ftype_mapped]
   785                              <1> ; out: AL=dbfType, BL=fixedLen(0/const), BH=only4(1=T), CF=1 on error
   786                              <1> map_fieldtype:
   787 00000568 50                  <1>     push ax
   788 00000569 E8F0FF              <1>     call to_upper_al
   789 0000056C 3C43                <1>     cmp al, 'C'
   790 0000056E 7417                <1>     je .C
   791 00000570 3C49                <1>     cmp al, 'I'
   792 00000572 741B                <1>     je .I
   793 00000574 3C46                <1>     cmp al, 'F'
   794 00000576 741F                <1>     je .F
   795 00000578 3C42                <1>     cmp al, 'B'
   796 0000057A 7423                <1>     je .B
   797 0000057C 3C44                <1>     cmp al, 'D'
   798 0000057E 7427                <1>     je .D
   799 00000580 3C54                <1>     cmp al, 'T'
   800 00000582 742B                <1>     je .T
   801 00000584 F9                  <1>     stc
   802 00000585 EB34                <1>     jmp .out
   803 00000587 B043                <1>     .C: mov al, 'C'   ; 1..254
   804 00000589 30DB                <1>     xor bl, bl
   805 0000058B 30FF                <1>     xor bh, bh
   806 0000058D EB28                <1>     jmp .ok
   807 0000058F B04E                <1>     .I: mov al, 'N'   ; 1..20
   808 00000591 30DB                <1>     xor bl, bl
   809 00000593 30FF                <1>     xor bh, bh
   810 00000595 EB20                <1>     jmp .ok
   811 00000597 B046                <1>     .F: mov al, 'F'   ; 1..20
   812 00000599 30DB                <1>     xor bl, bl
   813 0000059B 30FF                <1>     xor bh, bh
   814 0000059D EB18                <1>     jmp .ok
   815 0000059F B04C                <1>     .B: mov al, 'L'   ; exakt 1
   816 000005A1 B301                <1>     mov bl, 1
   817 000005A3 30FF                <1>     xor bh, bh
   818 000005A5 EB10                <1>     jmp .ok
   819 000005A7 B044                <1>     .D: mov al, 'D'   ; exakt 8
   820 000005A9 B308                <1>     mov bl, 8
   821 000005AB 30FF                <1>     xor bh, bh
   822 000005AD EB08                <1>     jmp .ok
   823 000005AF B054                <1>     .T: mov al, 'T'   ; exakt 8, nur Typ 4
   824 000005B1 B308                <1>     mov bl, 8
   825 000005B3 B701                <1>     mov bh, 1
   826 000005B5 EB00                <1>     jmp .ok
   827                              <1>     .ok:
   828 000005B7 A2(EF1E)            <1>     mov [PTR16(g_ftype_mapped)], al
   829 000005BA F8                  <1>     clc
   830                              <1>     .out:
   831 000005BB 58                  <1>     pop ax
   832 000005BC C3                  <1>     ret
   833                              <1> 
   834                              <1> map_fieldtype_char_only:
   835 000005BD 53                  <1>     push bx
   836 000005BE E8A7FF              <1>     call map_fieldtype
   837 000005C1 A0(EF1E)            <1>     mov al, [PTR16(g_ftype_mapped)]
   838 000005C4 5B                  <1>     pop bx
   839 000005C5 C3                  <1>     ret
   840                              <1> 
   841                              <1> ; validate_length: AX=len, DL=CLI type (upper), CF=1 invalid
   842                              <1> validate_length:
   843 000005C6 50                  <1>     push ax
   844 000005C7 52                  <1>     push dx
   845 000005C8 E85F00              <1>     call to_upper_dl
   846 000005CB 80FA42              <1>     cmp dl, 'B'       ; 1
   847 000005CE 7507                <1>     jne .nB
   848 000005D0 83F801              <1>         cmp ax, 1
   849 000005D3 7551                <1>         jne .bad
   850 000005D5 EB4B                <1>         jmp .ok
   851                              <1>     .nB:
   852 000005D7 80FA44              <1>     cmp dl, 'D'       ; 8
   853 000005DA 7507                <1>     jne .nD
   854 000005DC 83F808              <1>         cmp ax, 8
   855 000005DF 7545                <1>         jne .bad
   856 000005E1 EB3F                <1>         jmp .ok
   857                              <1>     .nD:
   858 000005E3 80FA54              <1>     cmp dl, 'T'       ; 8
   859 000005E6 7507                <1>     jne .nT
   860 000005E8 83F808              <1>         cmp ax, 8
   861 000005EB 7539                <1>         jne .bad
   862 000005ED EB33                <1>         jmp .ok
   863                              <1>     .nT:
   864 000005EF 80FA43              <1>     cmp dl, 'C'       ; 1..254
   865 000005F2 750C                <1>     jne .nC
   866 000005F4 83F801              <1>         cmp ax, 1
   867 000005F7 722D                <1>         jb .bad
   868 000005F9 3DFE00              <1>         cmp ax, 254
   869 000005FC 7728                <1>         ja .bad
   870 000005FE EB22                <1>         jmp .ok
   871                              <1>     .nC:
   872 00000600 80FA49              <1>     cmp dl, 'I'       ; 1..20
   873 00000603 750C                <1>     jne .nI
   874 00000605 83F801              <1>         cmp ax, 1
   875 00000608 721C                <1>         jb .bad
   876 0000060A 83F814              <1>         cmp ax, 20
   877 0000060D 7717                <1>         ja .bad
   878 0000060F EB11                <1>         jmp .ok
   879                              <1>     .nI:
   880 00000611 80FA46              <1>     cmp dl, 'F'       ; 1..20 (konservativ)
   881 00000614 7510                <1>     jne .bad
   882 00000616 83F801              <1>         cmp ax, 1
   883 00000619 720B                <1>         jb .bad
   884 0000061B 83F814              <1>         cmp ax, 20
   885 0000061E 7706                <1>         ja .bad
   886 00000620 EB00                <1>         jmp .ok
   887                              <1>     .ok:
   888 00000622 F8                  <1>     clc
   889 00000623 5A                  <1>     pop dx
   890 00000624 58                  <1>     pop ax
   891 00000625 C3                  <1>     ret
   892                              <1>     .bad:
   893 00000626 F9                  <1>     stc
   894 00000627 5A                  <1>     pop dx
   895 00000628 58                  <1>     pop ax
   896 00000629 C3                  <1>     ret
   897                              <1> 
   898                              <1> to_upper_dl:
   899 0000062A 86D0                <1>     xchg al, dl
   900 0000062C E822FF              <1>     call to_upper
   901 0000062F 86D0                <1>     xchg al, dl
   902 00000631 C3                  <1>     ret
   903                              <1> 
   904                              <1> ; --------- Ausgabe & Exit ---------
   905                              <1> print_$:
   906 00000632 B409                <1>     mov ah, 09h
   907 00000634 CD21                <1>     int 21h
   908 00000636 C3                  <1>     ret
   909                              <1> 
   910                              <1> field_already:
   911                              <1>     ; Datei schließen und Hinweis ausgeben
   912 00000637 8B1E[EF1D]          <1>     mov bx, [hFile]
   913 0000063B B43E                <1>     mov ah, 3Eh
   914 0000063D CD21                <1>     int 21h
   915 0000063F BA(DA04)            <1>     mov dx, PTR16(msg_fieldexists)
   916 00000642 E8EDFF              <1>     call print_$
   917                              <1>     DOS_crlf
  1277 00000645 E8FD07              <2>  call DOSrncrlf
   918 00000648 EB68                <1>     jmp exit0
   919                              <1> 
   920                              <1> usage:
   921                              <1>     PUTS_COLOR msg_usage, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000064A E8B103              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 0000064D B302                <2>  mov bl, %2
  1213 0000064F BE(0F03)            <2>  mov si, PTR16(_cA_%1)
  1214 00000652 E83208              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   922 00000655 EB60                <1>     jmp exit1
   923                              <1> 
   924                              <1> badargs:
   925                              <1>     PUTS_COLOR msg_badargs, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000657 E8A403              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 0000065A B302                <2>  mov bl, %2
  1213 0000065C BE(5F03)            <2>  mov si, PTR16(_cA_%1)
  1214 0000065F E82508              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   926                              <1>     ;DOS_crlf
   927 00000662 EB53                <1>     jmp exit1
   928                              <1> 
   929                              <1> open_fail:
   930                              <1>     PUTS_COLOR msg_openfail, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000664 E89703              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 00000667 B302                <2>  mov bl, %2
  1213 00000669 BE(7C03)            <2>  mov si, PTR16(_cA_%1)
  1214 0000066C E81808              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   931 0000066F EB46                <1>     jmp exit1
   932                              <1> 
   933                              <1> ver_mismatch:
   934                              <1>     PUTS_COLOR msg_ver_mismatch, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000671 E88A03              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 00000674 B302                <2>  mov bl, %2
  1213 00000676 BE(B003)            <2>  mov si, PTR16(_cA_%1)
  1214 00000679 E80B08              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   935 0000067C EB39                <1>     jmp exit1
   936                              <1> 
   937                              <1> append_with_records_not_supported:
   938                              <1>     PUTS_COLOR msg_append_recs, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000067E E87D03              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 00000681 B302                <2>  mov bl, %2
  1213 00000683 BE(D703)            <2>  mov si, PTR16(_cA_%1)
  1214 00000686 E8FE07              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   939 00000689 EB2C                <1>     jmp exit1
   940                              <1> 
   941                              <1> not_supported:
   942                              <1>     PUTS_COLOR msg_not_supported, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 0000068B E87003              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 0000068E B302                <2>  mov bl, %2
  1213 00000690 BE(5104)            <2>  mov si, PTR16(_cA_%1)
  1214 00000693 E8F107              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   943 00000696 EB1F                <1>     jmp exit1
   944                              <1> 
   945                              <1> io_error:
   946                              <1>     PUTS_COLOR msg_ioerr, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 00000698 E86303              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 0000069B B302                <2>  mov bl, %2
  1213 0000069D BE(1A04)            <2>  mov si, PTR16(_cA_%1)
  1214 000006A0 E8E407              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   947 000006A3 EB12                <1>     jmp exit1
   948                              <1> 
   949                              <1> bad_header:
   950                              <1>     PUTS_COLOR msg_badheader, 0x02
  1173                              <2> %if DOS_SHELL == 1
  1174                              <2>  GET_CURSOR
  1134                              <3> %if DOS_SHELL == 1
  1135 000006A5 E85603              <3>  call dos_get_cursor
  1136                              <3> %else
  1137                              <3>  %error 'todo: windows'
  1138                              <3> %endif
  1175                              <2>  %ifstr %1
  1176                              <2>  section .data
  1177                              <2>  %%msg: db %1, 0
  1178                              <2>  section .text
  1179                              <2>  mov bl, %2
  1180                              <2>  mov si, PTR16(%%msg)
  1181                              <2>  call PutStrColor
  1182                              <2>  %else
  1183                              <2>  %ifidni %1, DI
  1184                              <2>  section .text
  1185                              <2>  mov bl, %2
  1186                              <2>  call PutStrColor
  1187                              <2>  %elifidni %1, SI
  1188                              <2>  section .text
  1189                              <2>  mov bl, %2
  1190                              <2>  call PutStrColor
  1191                              <2>  %else
  1192                              <2>  %assign __count 0
  1193                              <2>  %assign __varg 0
  1194                              <2>  %assign __stop 0
  1195                              <2>  %rep MAX_ARGV
  1196                              <2>  %if __stop == 0
  1197                              <2>  %assign __count (__count + 1)
  1198                              <2>  %ifidni %1, ARGV_%+__count
  1199                              <2>  %assign __varg __count
  1200                              <2>  %assign __stop 1
  1201                              <2>  %endif
  1202                              <2>  %endif
  1203                              <2>  %endrep
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1204                              <2>  %if __varg > 0
  1205                              <2>  section .text
  1206                              <2>  mov si, PTR16(_cA_cmd_buf)
  1207                              <2>  mov bl, __varg
  1208                              <2>  call getCommandLine_Arg
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  section .text
  1212 000006A8 B302                <2>  mov bl, %2
  1213 000006AA BE(2604)            <2>  mov si, PTR16(_cA_%1)
  1214 000006AD E8D707              <2>  call PutStrColor
  1215                              <2>  %endif
  1216                              <2>  %undef __varg
  1217                              <2>  %endif
  1218                              <2>  %endif
  1219                              <2> %else
  1220                              <2>  %error 'this macro is only for DOS programming.'
  1221                              <2> %endif
   951 000006B0 EB05                <1>     jmp exit1
   952                              <1> 
   953                              <1> exit0:
   954                              <1>     DOS_Exit 0
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 000006B2 B8004C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000006B5 CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
   955                              <1> exit1:
   956                              <1>     DOS_Exit 1
  1247                              <2> %if DOS_SHELL == 1
  1248                              <2>  %ifidni %1, ax
  1249                              <2>  %error 'AX not allowed here.'
  1250                              <2>  %elifidni %1, bx
  1251                              <2>  mov ax, 0x4C00
  1252                              <2>  or ax, bx
  1253                              <2>  SysCall
  1254                              <2>  %elifidni %1, CX
  1255                              <2>  mov ax, 0x4C00
  1256                              <2>  or ax, cx
  1257                              <2>  SysCall
  1258                              <2>  %elifidni %1, dx
  1259                              <2>  mov ax, 0x4C00
  1260                              <2>  or ax, dx
  1261                              <2>  SysCall
  1262                              <2>  %elifnum %1
  1263 000006B7 B8014C              <2>  mov ax, 0x4C00 | %1
  1264                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000006BA CD21                <3>  int 0x21
    68                              <3> %endif
  1265                              <2>  %else
  1266                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <2>  %endif
  1268                              <2> %endif
   957                              <1> 
   958                              <1> ;------------------------------------------------------------------------------
   959                              <1> ; dbfhead.asm - dBASE IV DBF-Header anzeigen (DOS .COM)
   960                              <1> ; Assemble: nasm -f bin dbfhead.asm -o DBFHEAD.COM
   961                              <1> ; Lauf:      DBFHEAD TEST.DBF
   962                              <1> ; -----------------------------------------------------------------------------
   963                              <1>     ; Kommandozeile aus PSP:80h holen -> Dateiname parsen
   964 000006BC BE8000              <1>     mov si, 80h            ; PSP:80h = Längenbyte gefolgt vom Tail
   965 000006BF AC                  <1>     lodsb                  ; AL = Länge
   966 000006C0 88C3                <1>     mov bl, al             ; BL = verbleibende Zeichen
   967 000006C2 0F84AC01            <1>     jz  .usage
   968 000006C6 BF(5F16)            <1>     mov di, PTR16(filename)
   969 000006C9 E83D02              <1>     call skip_spaces_2
   970 000006CC 0F82A201            <1>     jc  .usage
   971 000006D0 E85202              <1>     call copy_token_to_di_2  ; kopiert bis Space/CR
   972 000006D3 C60500              <1>     mov byte [di], 0       ; 0-terminiert
   973                              <1> 
   974                              <1>     ; Datei öffnen (INT 21h, 3Dh)
   975 000006D6 BA(5F16)            <1>     mov dx, PTR16(filename)
   976 000006D9 B8003D              <1>     mov ax, 3D00h          ; AH=3Dh open, AL=0 read-only
   977 000006DC CD21                <1>     int 21h
   978 000006DE 0F829801            <1>     jc  .open_fail
   979 000006E2 A3(EF1E)            <1>     mov [PTR16(hFile)], ax
   980                              <1> 
   981                              <1>     ; 32 Bytes Header lesen
   982 000006E5 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
   983 000006E9 BA(3B1F)            <1>     mov dx, PTR16(header)
   984 000006EC B92000              <1>     mov cx, 32
   985 000006EF B43F                <1>     mov ah, 3Fh
   986 000006F1 CD21                <1>     int 21h
   987 000006F3 0F828B01            <1>     jc  .read_fail
   988 000006F7 83F820              <1>     cmp ax, 32
   989 000006FA 0F858401            <1>     jne .read_fail
   990                              <1> 
   991                              <1>     ; Headerfelder auswerten
   992                              <1>     ; Version
   993 000006FE A0(3B1F)            <1>     mov al, [PTR16(header) + 0]
   994 00000701 A2(EF1E)            <1>     mov [PTR16(verByte)], al
   995                              <1> 
   996                              <1>     ; Datum: YY, MM, DD (Bytes 1..3)
   997 00000704 A0(3C1F)            <1>     mov al, [PTR16(header) + 1]
   998 00000707 A2(EF1E)            <1>     mov [PTR16(yy)], al
   999 0000070A A0(3D1F)            <1>     mov al, [PTR16(header) + 2]
  1000 0000070D A2(EF1E)            <1>     mov [PTR16(mm)], al
  1001 00000710 A0(3E1F)            <1>     mov al, [PTR16(header) + 3]
  1002 00000713 A2(EF1E)            <1>     mov [PTR16(dd)], al
  1003                              <1> 
  1004                              <1>     ; Anzahl Datensätze (4..7) -> 32-bit LE in regs: DX:AX
  1005 00000716 A1(3F1F)            <1>     mov ax, [PTR16(header) + 4]
  1006 00000719 8B16(411F)          <1>     mov dx, [PTR16(header) + 6]
  1007 0000071D A3(EF1E)            <1>     mov [PTR16(rec32) + 0], ax
  1008 00000720 8916(F11E)          <1>     mov [PTR16(rec32) + 2], dx
  1009                              <1> 
  1010                              <1>     ; Headerlänge (8..9), Satzlänge (10..11)
  1011 00000724 A1(431F)            <1>     mov ax, [PTR16(header) +  8]
  1012 00000727 A3(9808)            <1>     mov [PTR16(hdr_len)], ax
  1013 0000072A A1(451F)            <1>     mov ax, [PTR16(header) + 10]
  1014 0000072D A3(9A08)            <1>     mov [PTR16(rec_len)], ax
  1015                              <1> 
  1016                              <1>     ; MDX-Flag (28), Languagedriver (29)
  1017 00000730 A0(571F)            <1>     mov al, [PTR16(header)+28]
  1018 00000733 A2(EF1E)            <1>     mov [PTR16(mdx)], al
  1019 00000736 A0(581F)            <1>     mov al, [PTR16(header)+29]
  1020 00000739 A2(EF1E)            <1>     mov [PTR16(lang)], al
  1021                              <1> 
  1022                              <1>     ; Ausgabe Header-Info
  1023 0000073C BA(C301)            <1>     mov dx, PTR16(msgTitle)
  1024 0000073F E8F0FE              <1>     call print_$
  1025                              <1> 
  1026 00000742 BA(4302)            <1>     mov dx, PTR16(msgVer)
  1027 00000745 E8EAFE              <1>     call print_$
  1028 00000748 A0(EF1E)            <1>     mov al, [PTR16(verByte)]
  1029 0000074B E84E01              <1>     call print_hex8
  1030                              <1>     DOS_crlf
  1277 0000074E E8F406              <2>  call DOSrncrlf
  1031                              <1> 
  1032 00000751 BA(5302)            <1>     mov dx, PTR16(msgDate)
  1033 00000754 E8DBFE              <1>     call print_$
  1034 00000757 A0(EF1E)            <1>     mov al, [PTR16(yy)]
  1035 0000075A E87301              <1>     call print_dec8
  1036 0000075D B02D                <1>     mov al, '-'
  1037 0000075F E8DA06              <1>     call putc
  1038 00000762 A0(EF1E)            <1>     mov al, [PTR16(mm)]
  1039 00000765 E86801              <1>     call print_dec8
  1040 00000768 B02D                <1>     mov al, '-'
  1041 0000076A E8CF06              <1>     call putc
  1042 0000076D A0(EF1E)            <1>     mov al, [PTR16(dd)]
  1043 00000770 E85D01              <1>     call print_dec8
  1044                              <1>     DOS_crlf
  1277 00000773 E8CF06              <2>  call DOSrncrlf
  1045                              <1> 
  1046 00000776 BA(6602)            <1>     mov dx, PTR16(msgRecs)
  1047 00000779 E8B6FE              <1>     call print_$
  1048                              <1>     ; 32-bit hex ausgeben: DX:AX aus rec32
  1049 0000077C A1(EF1E)            <1>     mov ax, [PTR16(rec32) + 0]
  1050 0000077F 8B16(F11E)          <1>     mov dx, [PTR16(rec32) + 2]
  1051 00000783 E83D01              <1>     call print_hex32
  1052                              <1>     DOS_crlf
  1277 00000786 E8BC06              <2>  call DOSrncrlf
  1053                              <1> 
  1054 00000789 BA(8102)            <1>     mov dx, PTR16(msgHdr)
  1055 0000078C E8A3FE              <1>     call print_$
  1056 0000078F A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
  1057 00000792 E84301              <1>     call print_dec16
  1058                              <1>     DOS_crlf
  1277 00000795 E8AD06              <2>  call DOSrncrlf
  1059                              <1> 
  1060 00000798 BA(9802)            <1>     mov dx, PTR16(msgRec)
  1061 0000079B E894FE              <1>     call print_$
  1062 0000079E A1(9A08)            <1>     mov ax, [PTR16(rec_len)]
  1063 000007A1 E83401              <1>     call print_dec16
  1064                              <1>     DOS_crlf
  1277 000007A4 E89E06              <2>  call DOSrncrlf
  1065                              <1> 
  1066 000007A7 BA(AD02)            <1>     mov dx, PTR16(msgMDX)
  1067 000007AA E885FE              <1>     call print_$
  1068 000007AD A0(EF1E)            <1>     mov al, [PTR16(mdx)]
  1069 000007B0 E8E900              <1>     call print_hex8
  1070                              <1>     DOS_crlf
  1277 000007B3 E88F06              <2>  call DOSrncrlf
  1071                              <1> 
  1072 000007B6 BA(BE02)            <1>     mov dx, PTR16(msgLang)
  1073 000007B9 E876FE              <1>     call print_$
  1074 000007BC A0(EF1E)            <1>     mov al, [PTR16(lang)]
  1075 000007BF E8DA00              <1>     call print_hex8
  1076                              <1>     DOS_crlf
  1277 000007C2 E88006              <2>  call DOSrncrlf
  1077                              <1>     DOS_crlf
  1277 000007C5 E87D06              <2>  call DOSrncrlf
  1078                              <1> 
  1079                              <1>     ; Feld-Deskriptoren lesen:
  1080                              <1>     ; Anzahl Bytes bis Terminator = hdr_len - 32
  1081 000007C8 A1(9808)            <1>     mov ax, [PTR16(hdr_len)]
  1082 000007CB 83E820              <1>     sub ax, 32
  1083 000007CE 0F869500            <1>     jbe .no_fields
  1084 000007D2 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
  1085 000007D6 BA(DF16)            <1>     mov dx,  PTR16(fdbuf)
  1086 000007D9 89C1                <1>     mov cx, ax
  1087 000007DB B43F                <1>     mov ah, 3Fh
  1088 000007DD CD21                <1>     int 21h
  1089 000007DF 0F829F00            <1>     jc  .read_fail
  1090                              <1>     ; AX = tatsächlich gelesene Bytes
  1091                              <1> 
  1092 000007E3 BA(D902)            <1>     mov dx, PTR16(msgFields)
  1093 000007E6 E849FE              <1>     call print_$
  1094                              <1>     DOS_crlf
  1277 000007E9 E85906              <2>  call DOSrncrlf
  1095                              <1> 
  1096                              <1>     ; Durch fdbuf iterieren: 32-Byte Blöcke bis 0Dh
  1097 000007EC BE(DF16)            <1>     mov si, PTR16(fdbuf)
  1098 000007EF 89C1                <1>     mov cx, ax           ; CX = bytes available
  1099 000007F1 31ED                <1>     xor bp, bp           ; BP = Feldindex
  1100                              <1> 
  1101                              <1>     .next_field:
  1102 000007F3 83F900              <1>     cmp cx, 0
  1103 000007F6 766D                <1>     jbe .done_fields
  1104                              <1>     ; Terminator?
  1105 000007F8 803C0D              <1>     cmp byte [si], 0Dh
  1106 000007FB 7468                <1>     je  .done_fields
  1107                              <1> 
  1108                              <1>     ; Feldnummer ausgeben
  1109 000007FD 45                  <1>     inc bp
  1110 000007FE BA(FC02)            <1>     mov dx, PTR16(msgFieldN)
  1111 00000801 E82EFE              <1>     call print_$
  1112 00000804 89E8                <1>     mov ax, bp
  1113 00000806 E8CF00              <1>     call print_dec16
  1114 00000809 BA(0503)            <1>     mov dx, PTR16(msgColonSp)
  1115 0000080C E823FE              <1>     call print_$
  1116                              <1> 
  1117                              <1>     ; Feldname (11 Byte, 0-terminiert)
  1118                              <1>     ; Wir kopieren/normalisieren in namebuf
  1119 0000080F 56                  <1>     push si
  1120 00000810 BF(DF1E)            <1>     mov di, PTR16(_cA_namebuf)
  1121 00000813 BB0B00              <1>     mov bx, 11
  1122                              <1>     .copy_name:
  1123 00000816 8A04                <1>     mov al, [si]
  1124 00000818 3C00                <1>     cmp al, 0
  1125 0000081A 7409                <1>     je  .pad_zero
  1126                              <1>     ; Nur druckbare? Einfach übernehmen
  1127 0000081C 8805                <1>     mov [di], al
  1128 0000081E 47                  <1>     inc di
  1129 0000081F 46                  <1>     inc si
  1130 00000820 4B                  <1>     dec bx
  1131 00000821 75F3                <1>     jnz .copy_name
  1132 00000823 EB02                <1>     jmp short .name_done
  1133                              <1>     .pad_zero:
  1134 00000825 8805                <1>     mov [di], al
  1135                              <1>     .name_done:
  1136 00000827 C60500              <1>     mov byte [di], 0
  1137                              <1>     ; Ausgabe Name
  1138                              <1>     DOS_Write namebuf
  1286 0000082A 8D16(DF1E)          <2>  lea dx, [PTR16(_cA_%1)]
  1287 0000082E E84206              <2>  call DOS_ConsoleWrite
  1139 00000831 BA(0803)            <1>     mov dx, PTR16(msgCommaSp)
  1140 00000834 E8FBFD              <1>     call print_$
  1141                              <1> 
  1142                              <1>     ; Feldtyp (Byte 11)
  1143 00000837 5E                  <1>     pop si               ; si zurück auf Start des FD
  1144 00000838 8A440B              <1>     mov al, [si+11]
  1145 0000083B E8FE05              <1>     call putc
  1146 0000083E BA(0803)            <1>     mov dx, PTR16(msgCommaSp)
  1147 00000841 E8EEFD              <1>     call print_$
  1148                              <1> 
  1149                              <1>     ; Länge (Byte 16), Dezimal (Byte 17)
  1150 00000844 8A4410              <1>     mov al, [si+16]
  1151 00000847 B400                <1>     mov ah, 0
  1152 00000849 E88C00              <1>     call print_dec16
  1153 0000084C BA(0B03)            <1>     mov dx, PTR16(msgSlash)
  1154 0000084F E8E0FD              <1>     call print_$
  1155 00000852 8A4411              <1>     mov al, [si+17]
  1156 00000855 B400                <1>     mov ah, 0
  1157 00000857 E87E00              <1>     call print_dec16
  1158                              <1>     DOS_crlf
  1277 0000085A E8E805              <2>  call DOSrncrlf
  1159                              <1> 
  1160                              <1>     ; Nächster Descriptor
  1161 0000085D 83C620              <1>     add si, 32
  1162 00000860 83E920              <1>     sub cx, 32
  1163 00000863 EB8E                <1>     jmp .next_field
  1164                              <1> 
  1165                              <1>     .done_fields:
  1166 00000865 EB23                <1>     jmp .close_and_exit
  1167                              <1> 
  1168                              <1>     .no_fields:
  1169 00000867 BA(E302)            <1>     mov dx, PTR16(msgNoFields)
  1170 0000086A E8C5FD              <1>     call print_$
  1171                              <1>     DOS_crlf
  1277 0000086D E8D505              <2>  call DOSrncrlf
  1172 00000870 EB18                <1>     jmp .close_and_exit
  1173                              <1> 
  1174                              <1> ; ----- Fehlerpfade & Exit -----
  1175                              <1>     .usage:
  1176 00000872 BA(D901)            <1>     mov dx, PTR16(msgUsage)
  1177 00000875 E8BAFD              <1>     call print_$
  1178 00000878 EB18                <1>     jmp .exit
  1179                              <1> 
  1180                              <1>     .open_fail:
  1181 0000087A BA(F601)            <1>     mov dx, PTR16(msgOpenErr)
  1182 0000087D E8B2FD              <1>     call print_$
  1183 00000880 EB10                <1>     jmp .exit
  1184                              <1> 
  1185                              <1>     .read_fail:
  1186 00000882 BA(2302)            <1>     mov dx, PTR16(msgReadErr)
  1187 00000885 E8AAFD              <1>     call print_$
  1188 00000888 EB00                <1>     jmp .close_and_exit
  1189                              <1> 
  1190                              <1>     .close_and_exit:
  1191 0000088A 8B1E(EF1E)          <1>     mov bx, [PTR16(hFile)]
  1192 0000088E B43E                <1>     mov ah, 3Eh
  1193 00000890 CD21                <1>     int 21h
  1194                              <1>     .exit:
  1195 00000892 B8004C              <1>     mov ax, 4C00h
  1196 00000895 CD21                <1>     int 21h
  1197                              <1> 
  1198                              <1> ; ======== Hilfsroutinen ========
  1199                              <1> ; print_$: DX -> '$'-terminierte Zeichenkette
  1200                              <1> print_$_2:
  1201 00000897 B409                <1>     mov ah, 09h
  1202 00000899 CD21                <1>     int 21h
  1203 0000089B C3                  <1>     ret
  1204                              <1> 
  1205                              <1> ; print_hex8: AL -> 2 HEX
  1206                              <1> print_hex8:
  1207 0000089C 50                  <1>     push ax
  1208 0000089D 53                  <1>     push bx
  1209 0000089E 88C3                <1>     mov bl, al
  1210 000008A0 88C7                <1>     mov bh, al
  1211 000008A2 C0EB04              <1>     shr bl, 4
  1212 000008A5 80E70F              <1>     and bh, 0Fh
  1213 000008A8 88D8                <1>     mov al, bl
  1214 000008AA E80800              <1>     call hex_nibble
  1215 000008AD 88F8                <1>     mov al, bh
  1216 000008AF E80300              <1>     call hex_nibble
  1217 000008B2 5B                  <1>     pop bx
  1218 000008B3 58                  <1>     pop ax
  1219 000008B4 C3                  <1>     ret
  1220                              <1> 
  1221                              <1> hex_nibble:
  1222 000008B5 240F                <1>     and al, 0Fh
  1223 000008B7 3C09                <1>     cmp al, 9
  1224 000008B9 7602                <1>     jbe .digit
  1225 000008BB 0407                <1>     add al, 7
  1226                              <1>     .digit:
  1227 000008BD 0430                <1>     add al, '0'
  1228 000008BF E87A05              <1>     call putc
  1229 000008C2 C3                  <1>     ret
  1230                              <1> 
  1231                              <1> ; print_hex32: DX:AX -> 8 HEX
  1232                              <1> print_hex32:
  1233 000008C3 50                  <1>     push ax
  1234 000008C4 52                  <1>     push dx
  1235 000008C5 89D0                <1>     mov ax, dx
  1236 000008C7 E8C8F8              <1>     call print_hex16
  1237 000008CA 5A                  <1>     pop dx
  1238 000008CB 58                  <1>     pop ax
  1239 000008CC E8C3F8              <1>     call print_hex16
  1240 000008CF C3                  <1>     ret
  1241                              <1> 
  1242                              <1> ; print_dec8: AL (0..255) ohne führende Nullen
  1243                              <1> print_dec8:
  1244 000008D0 50                  <1>     push ax
  1245 000008D1 30E4                <1>     xor ah, ah
  1246 000008D3 E80200              <1>     call print_dec16
  1247 000008D6 58                  <1>     pop ax
  1248 000008D7 C3                  <1>     ret
  1249                              <1> 
  1250                              <1> ; print_dec16: AX -> dezimal ohne führende Nullen
  1251                              <1> ; einfache Division durch 10
  1252                              <1> print_dec16:
  1253 000008D8 50                  <1>     push ax
  1254 000008D9 53                  <1>     push bx
  1255 000008DA 52                  <1>     push dx
  1256 000008DB 51                  <1>     push cx
  1257 000008DC B90000              <1>     mov cx, 0          ; Zähler Ziffern im Stack
  1258 000008DF 83F800              <1>     cmp ax, 0
  1259 000008E2 7507                <1>     jne .pd_loop
  1260 000008E4 B030                <1>     mov al, '0'
  1261 000008E6 E85305              <1>     call putc
  1262 000008E9 EB19                <1>     jmp .pd_done
  1263                              <1>     .pd_loop:
  1264 000008EB 31D2                <1>     xor dx, dx
  1265 000008ED BB0A00              <1>     mov bx, 10
  1266 000008F0 F7F3                <1>     div bx            ; AX = AX/10, DX = Rest
  1267 000008F2 52                  <1>     push dx           ; Rest (Ziffer)
  1268 000008F3 41                  <1>     inc cx
  1269 000008F4 83F800              <1>     cmp ax, 0
  1270 000008F7 75F2                <1>     jne .pd_loop
  1271                              <1>     .pd_out:
  1272 000008F9 5A                  <1>     pop dx
  1273 000008FA 80C230              <1>     add dl, '0'
  1274 000008FD 88D0                <1>     mov al, dl
  1275 000008FF E83A05              <1>     call putc
  1276 00000902 E2F5                <1>     loop .pd_out
  1277                              <1>     .pd_done:
  1278 00000904 59                  <1>     pop cx
  1279 00000905 5A                  <1>     pop dx
  1280 00000906 5B                  <1>     pop bx
  1281 00000907 58                  <1>     pop ax
  1282 00000908 C3                  <1>     ret
  1283                              <1> 
  1284                              <1> ; --- Kommandozeilen-Parsing ---
  1285                              <1> ; skip_spaces: SI->Tail, BL=Restlänge. Setzt ZF=1 wenn nichts übrig.
  1286                              <1> skip_spaces_2:
  1287 00000909 50                  <1>     push ax
  1288                              <1>     .ss_loop:
  1289 0000090A 80FB00              <1>     cmp bl, 0
  1290 0000090D 7413                <1>     jz  .ss_empty
  1291 0000090F 8A04                <1>     mov al, [si]
  1292 00000911 46                  <1>     inc si
  1293 00000912 FECB                <1>     dec bl
  1294 00000914 3C20                <1>     cmp al, ' '
  1295 00000916 74F2                <1>     jz  .ss_loop
  1296 00000918 3C09                <1>     cmp al, 9
  1297 0000091A 74EE                <1>     jz  .ss_loop
  1298                              <1>     ; ein Nicht-Leerzeichen gesehen -> SI eine Position zurück
  1299 0000091C 4E                  <1>     dec si
  1300 0000091D FEC3                <1>     inc bl
  1301 0000091F F8                  <1>     clc
  1302 00000920 58                  <1>     pop ax
  1303 00000921 C3                  <1>     ret
  1304                              <1>     .ss_empty:
  1305 00000922 F9                  <1>     stc
  1306 00000923 58                  <1>     pop ax
  1307 00000924 C3                  <1>     ret
  1308                              <1> 
  1309                              <1> ; copy_token_to_di: kopiert ab SI bis Space/CR nach DI, aktualisiert SI/BL
  1310                              <1> copy_token_to_di_2:
  1311 00000925 50                  <1>     push ax
  1312                              <1>     .ct_loop:
  1313 00000926 80FB00              <1>     cmp bl, 0
  1314 00000929 7412                <1>     jz  .ct_done
  1315 0000092B 8A04                <1>     mov al, [si]
  1316 0000092D 3C0D                <1>     cmp al, 13         ; CR
  1317 0000092F 740C                <1>     je  .ct_done
  1318 00000931 3C20                <1>     cmp al, ' '
  1319 00000933 7408                <1>     je  .ct_done
  1320 00000935 8805                <1>     mov [di], al
  1321 00000937 47                  <1>     inc di
  1322 00000938 46                  <1>     inc si
  1323 00000939 FECB                <1>     dec bl
  1324 0000093B EBE9                <1>     jmp .ct_loop
  1325                              <1>     .ct_done:
  1326 0000093D 58                  <1>     pop ax
  1327 0000093E C3                  <1>     ret
  1328                              <1>     
  1329                              <1> ; ---- Hilfen ---------------------------------------------------
  1330                              <1> MAXLEN equ 63
  1331                              <1> 
  1332                              <1> ; Zeigt "Open error AX=xxxx" (bx enthält Fehlercode)
  1333                              <1> print_err_ax_bx:
  1334 0000093F 50                  <1>     push ax
  1335 00000940 51                  <1>     push cx
  1336 00000941 52                  <1>     push dx
  1337 00000942 BA(4801)            <1>     mov  dx, PTR16(msgErr)
  1338 00000945 B409                <1>     mov  ah, 0x09
  1339 00000947 CD21                <1>     int  0x21
  1340 00000949 89D8                <1>     mov  ax, bx
  1341 0000094B E80B00              <1>     call print_ax_hex
  1342 0000094E BA(7201)            <1>     mov  dx, PTR16(crlf)
  1343 00000951 B409                <1>     mov  ah, 0x09
  1344 00000953 CD21                <1>     int  0x21
  1345 00000955 5A                  <1>     pop  dx
  1346 00000956 59                  <1>     pop  cx
  1347 00000957 58                  <1>     pop  ax
  1348 00000958 C3                  <1>     ret
  1349                              <1> 
  1350                              <1> ; AX als 4 hex-Zeichen ausgeben
  1351                              <1> print_ax_hex:
  1352 00000959 50                  <1>     push ax
  1353 0000095A 53                  <1>     push bx
  1354 0000095B 51                  <1>     push cx
  1355 0000095C 52                  <1>     push dx
  1356 0000095D 89C3                <1>     mov  bx, ax
  1357 0000095F B90400              <1>     mov  cx, 4
  1358                              <1>     .hexloop:
  1359 00000962 C1C304              <1>     rol  bx, 4
  1360 00000965 88D8                <1>     mov  al, bl
  1361 00000967 240F                <1>     and  al, 0x0F
  1362 00000969 0430                <1>     add  al, '0'
  1363 0000096B 3C39                <1>     cmp  al, '9'
  1364 0000096D 7602                <1>     jbe  .put
  1365 0000096F 0407                <1>     add  al, 7
  1366                              <1>     .put:
  1367 00000971 88C2                <1>     mov  dl, al
  1368 00000973 B402                <1>     mov  ah, 0x02
  1369 00000975 CD21                <1>     int  0x21
  1370 00000977 E2E9                <1>     loop .hexloop
  1371 00000979 5A                  <1>     pop  dx
  1372 0000097A 59                  <1>     pop  cx
  1373 0000097B 5B                  <1>     pop  bx
  1374 0000097C 58                  <1>     pop  ax
  1375 0000097D C3                  <1>     ret
  1376                              <1> 
  1377                              <1> ; ------------------------------------------------------------
  1378                              <1> ; Hilfsroutine: ein Zeichen an aktuelles arg_str anhängen,
  1379                              <1> ;               maximal 63 Nutzzeichen. Bei Overflow werden
  1380                              <1> ;               zusätzliche Zeichen bis zum nächsten Separator
  1381                              <1> ;               verworfen (wir schreiben einfach nicht mehr).
  1382                              <1> ; IN:
  1383                              <1> ;   AL = Zeichen
  1384                              <1> ;   DI = Schreibzeiger (zeigt immer auf nächste freie Stelle)
  1385                              <1> ;   CX = aktuelle Länge (0..63)
  1386                              <1> ; OUT:
  1387                              <1> ;   DI/CX aktualisiert
  1388                              <1> ; Zerstört: nichts weiter (AX benutzt)
  1389                              <1> ; ------------------------------------------------------------
  1390                              <1> put_char_maybe:
  1391 0000097E 83F93F              <1>     cmp     cx, 63
  1392 00000981 7303                <1>     jae     .skip_write
  1393 00000983 AA                  <1>     stosb                   ; [DI] = AL, DI++
  1394 00000984 41                  <1>     inc     cx
  1395 00000985 C3                  <1>     ret
  1396                              <1> .skip_write:
  1397                              <1>     ; Zeichen verwerfen (nichts schreiben)
  1398 00000986 C3                  <1>     ret
  1399                              <1> 
  1400                              <1> ; DS:SI -> ASCIIZ
  1401                              <1> print_z0:
  1402                              <1>     .loop:
  1403 00000987 AC                  <1>     lodsb
  1404 00000988 84C0                <1>     test    al, al
  1405 0000098A 7408                <1>     jz      .done
  1406 0000098C 88C2                <1>     mov     dl, al
  1407 0000098E B402                <1>     mov     ah, 02h
  1408                              <1>     SysCall
    66                              <2> %if DOS_SHELL == 1
    67 00000990 CD21                <2>  int 0x21
    68                              <2> %endif
  1409 00000992 EBF3                <1>     jmp     .loop
  1410                              <1>     .done:
  1411 00000994 C3                  <1>     ret
  1412                              <1> 
  1413                              <1> ; -----------------------------------------------------------------------------
  1414                              <1> ; \brief include DOS 16-bit stdlib function's ...
  1415                              <1> ; -----------------------------------------------------------------------------
  1416                              <1> %include 'CommandLineArg.asm'       ; get command line arguments
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  CommandLineArg.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief  Sucht den n-ten (1-basiert) Token im ASCIIZ-String bei DS:SI,
    11                              <2> ;         ersetzt das erste Leerzeichen NACH dem Token durch 0 und
    12                              <2> ;         liefert SI auf den Tokenstart (C-String).
    13                              <2> ; \param  Eingabe:
    14                              <2> ;         DS:SI -> 0-terminierter String (muss schreibbar sein!)
    15                              <2> ;         BL    = n (1 = erster Token)
    16                              <2> ; \return Ausgabe bei Erfolg (CF=0):
    17                              <2> ;         SI    = Startadresse des Tokens (in DS)
    18                              <2> ;         CX    = Länge des Tokens
    19                              <2> ; \error  Bei Misserfolg (CF=1): CX=0, SI undefiniert
    20                              <2> ; \note   Verändert: AX, CX, DX, SI, DI, FLAGS
    21                              <2> ; -----------------------------------------------------------------------------
    22                              <2> getCommandLine_Arg:
    23                              <2>     ;push di
    24 00000995 84DB                <2>     test bl, bl
    25 00000997 7503                <2>     jnz .start
    26 00000999 F9                  <2>     stc
    27 0000099A EB4E                <2>     jmp .ret
    28                              <2> 
    29                              <2>     .start:
    30                              <2>     ; führende Leerzeichen überspringen
    31                              <2>     .skip_spaces_lead:
    32 0000099C AC                  <2>     lodsb                      ; AL=[SI], SI++
    33 0000099D 3C20                <2>     cmp  al, ' '
    34 0000099F 74FB                <2>     je   .skip_spaces_lead
    35 000009A1 3C00                <2>     cmp  al, 0
    36 000009A3 7442                <2>     je   .not_found
    37                              <2> 
    38                              <2>     ; AL ist erstes Zeichen eines Tokens
    39 000009A5 89F2                <2>     mov  dx, si
    40 000009A7 4A                  <2>     dec  dx                    ; DX = Start dieses Tokens
    41 000009A8 BF0100              <2>     mov  di, 1                 ; di = aktueller Tokenindex (1-basiert)
    42                              <2> 
    43 000009AB 39DF                <2>     cmp  di, bx
    44 000009AD 741C                <2>     je   .measure_this
    45                              <2> 
    46                              <2>     ; aktuellen Token bis zum Leerzeichen/0 überspringen
    47                              <2>     .skip_this_token:
    48 000009AF AC                  <2>     lodsb
    49 000009B0 3C00                <2>     cmp  al, 0
    50 000009B2 7433                <2>     je   .not_found
    51 000009B4 3C20                <2>     cmp  al, ' '
    52 000009B6 75F7                <2>     jne  .skip_this_token
    53                              <2> 
    54                              <2>     ; Folge-Leerzeichen überspringen
    55                              <2>     .skip_spaces_mid:
    56 000009B8 AC                  <2>     lodsb
    57 000009B9 3C00                <2>     cmp  al, 0
    58 000009BB 742A                <2>     je   .not_found
    59 000009BD 3C20                <2>     cmp  al, ' '
    60 000009BF 74F7                <2>     je   .skip_spaces_mid
    61                              <2> 
    62                              <2>     ; Beginn des nächsten Tokens
    63 000009C1 47                  <2>     inc  di
    64 000009C2 89F2                <2>     mov  dx, si
    65 000009C4 4A                  <2>     dec  dx
    66 000009C5 39DF                <2>     cmp  di, bx
    67 000009C7 7402                <2>     je   .measure_this
    68 000009C9 EBE4                <2>     jmp  .skip_this_token
    69                              <2> 
    70                              <2>     .measure_this:
    71                              <2>     ; SI steht bereits auf 2. Zeichen des Tokens (erstes war in AL)
    72 000009CB B90100              <2>     mov  cx, 1                 ; bisher 1 Zeichen gezählt
    73                              <2>     .len_loop:
    74 000009CE AC                  <2>     lodsb
    75 000009CF 3C00                <2>     cmp  al, 0
    76 000009D1 7407                <2>     je   .done_len             ; Token endet am Stringende (bereits 0-terminiert)
    77 000009D3 3C20                <2>     cmp  al, ' '
    78 000009D5 7403                <2>     je   .done_len             ; Token endet am Leerzeichen
    79 000009D7 41                  <2>     inc  cx
    80 000009D8 EBF4                <2>     jmp  .len_loop
    81                              <2> 
    82                              <2>     .done_len:
    83                              <2>     ; Wenn das Ende durch Leerzeichen kam, dieses in 0 verwandeln.
    84 000009DA 3C20                <2>     cmp  al, ' '
    85 000009DC 7504                <2>     jne  .keep_zt              ; AL==0 -> bereits 0-terminiert
    86 000009DE C644FF00            <2>     mov  byte [si-1], 0        ; letztes gelesenes Zeichen (Leerzeichen) überschreiben
    87                              <2>     .keep_zt:
    88 000009E2 89D6                <2>     mov  si, dx                ; SI = Start des Tokens
    89 000009E4 F8                  <2>     clc
    90 000009E5 EB03                <2>     jmp  .ret
    91                              <2> 
    92                              <2>     .not_found:
    93 000009E7 31C9                <2>     xor  cx, cx
    94 000009E9 F9                  <2>     stc
    95                              <2> 
    96                              <2>     .ret:
    97                              <2>     ;pop  di
    98 000009EA C3                  <2>     ret
  1417                              <1> %include 'ConsoleCursor.asm'        ; set the teletype video text cursor
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ConsoleCursor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> dos_set_cursor:
    11 000009EB 8816(B701)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    12 000009EF 8836(B801)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    13                              <2>     ;---
    14 000009F3 B700                <2>     mov  bh, 0                   ; todo
    15 000009F5 883E(B901)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    16                              <2>     ;---
    17 000009F9 B402                <2>     mov  ah, 02h
    18                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 000009FB CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    19 000009FD C3                  <2>     ret
    20                              <2> 
    21                              <2> dos_get_cursor:
    22 000009FE 57                  <2>     push di
    23 000009FF 56                  <2>     push si
    24 00000A00 53                  <2>     push bx
    25 00000A01 52                  <2>     push dx
    26                              <2>     
    27 00000A02 B700                <2>     mov  bh, 0                   ; todo
    28 00000A04 B403                <2>     mov  ah, 0x03
    29                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000A06 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    30 00000A08 8816(B701)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    31 00000A0C 8836(B801)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    32 00000A10 883E(B901)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    33                              <2>     
    34 00000A14 5A                  <2>     pop  dx
    35 00000A15 5B                  <2>     pop  bx
    36 00000A16 5E                  <2>     pop  si
    37 00000A17 5F                  <2>     pop  di
    38 00000A18 C3                  <2>     ret
  1418                              <1> %include 'ErrorCodes.asm'           ; get last error
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ErrorCodes.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief dispatch: search the handler and jump to it ...
    11                              <2> ; -----------------------------------------------------------------------------
    12                              <2> DOS_handle_error_code:
    13                              <2>     ; AX enthält den DOS-Fehlercode
    14 00000A19 89C3                <2>     mov   bx, ax             ; bx = gesuchter Code
    15 00000A1B BE[1607]            <2>     mov   si, _cA_error_dispatch
    16                              <2>     .next:
    17 00000A1E AD                  <2>     lodsw                    ; ax = Tabellencode, si zeigt nun auf Handler-Wort
    18 00000A1F 85C0                <2>     test  ax, ax
    19 00000A21 740B                <2>     jz    .default           ; 0 -> Ende: Default
    20 00000A23 39D8                <2>     cmp   ax, bx
    21 00000A25 7405                <2>     je    .match
    22 00000A27 83C602              <2>     add   si, 2              ; Handlerwort überspringen
    23 00000A2A EBF2                <2>     jmp   .next
    24                              <2>     .match:
    25 00000A2C FF24                <2>     jmp   word [si]          ; indirekter Sprung zum Handler
    26                              <2>     .default:
    27 00000A2E E9(5F04)            <2>     jmp   _cA_open_error_nd
    28                              <2>     
    29                              <2>     ; ----------------------------------------
    30                              <2>     ; Handler minimal & einheitlich per Makro
    31                              <2>     ; ----------------------------------------
    32                              <2>     DEF_ERROR 01h, open_error_01    ; ungültige Funktiob
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A31 E8CAFF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A34 B31E                <4>  mov bl, %2
  1213 00000A36 BE(6E05)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A39 E84B04              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A3C B90100              <3>  mov cx, %1
  1454 00000A3F E94A03              <3>  jmp _open_exit
    33                              <2>     DEF_ERROR 02h, open_error_02
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A42 E8B9FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A45 B31E                <4>  mov bl, %2
  1213 00000A47 BE(9005)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A4A E83A04              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A4D B90200              <3>  mov cx, %1
  1454 00000A50 E93903              <3>  jmp _open_exit
    34                              <2>     DEF_ERROR 03h, open_error_03
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A53 E8A8FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A56 B31E                <4>  mov bl, %2
  1213 00000A58 BE(A005)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A5B E82904              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A5E B90300              <3>  mov cx, %1
  1454 00000A61 E92803              <3>  jmp _open_exit
    35                              <2>     DEF_ERROR 04h, open_error_04
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A64 E897FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A67 B31E                <4>  mov bl, %2
  1213 00000A69 BE(B005)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A6C E81804              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A6F B90400              <3>  mov cx, %1
  1454 00000A72 E91703              <3>  jmp _open_exit
    36                              <2>     DEF_ERROR 05h, open_error_05
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A75 E886FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A78 B31E                <4>  mov bl, %2
  1213 00000A7A BE(C505)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A7D E80704              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A80 B90500              <3>  mov cx, %1
  1454 00000A83 E90603              <3>  jmp _open_exit
    37                              <2>     DEF_ERROR 06h, open_error_06    ; ungültiger Handle
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A86 E875FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A89 B31E                <4>  mov bl, %2
  1213 00000A8B BE(D405)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A8E E8F603              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000A91 B90600              <3>  mov cx, %1
  1454 00000A94 E9F502              <3>  jmp _open_exit
    38                              <2>     DEF_ERROR 07h, open_error_07    ; korrupte Speicherverwaltung
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000A97 E864FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000A9A B31E                <4>  mov bl, %2
  1213 00000A9C BE(E805)            <4>  mov si, PTR16(_cA_%1)
  1214 00000A9F E8E503              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AA2 B90700              <3>  mov cx, %1
  1454 00000AA5 E9E402              <3>  jmp _open_exit
    39                              <2>     DEF_ERROR 08h, open_error_08    ; nicht genügend Speicher
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000AA8 E853FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000AAB B31E                <4>  mov bl, %2
  1213 00000AAD BE(FD05)            <4>  mov si, PTR16(_cA_%1)
  1214 00000AB0 E8D403              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AB3 B90800              <3>  mov cx, %1
  1454 00000AB6 E9D302              <3>  jmp _open_exit
    40                              <2>     DEF_ERROR 09h, open_error_09
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000AB9 E842FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000ABC B31E                <4>  mov bl, %2
  1213 00000ABE BE(0D06)            <4>  mov si, PTR16(_cA_%1)
  1214 00000AC1 E8C303              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AC4 B90900              <3>  mov cx, %1
  1454 00000AC7 E9C202              <3>  jmp _open_exit
    41                              <2>     DEF_ERROR 0Ah, open_error_0A
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000ACA E831FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000ACD B31E                <4>  mov bl, %2
  1213 00000ACF BE(2506)            <4>  mov si, PTR16(_cA_%1)
  1214 00000AD2 E8B203              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AD5 B90A00              <3>  mov cx, %1
  1454 00000AD8 E9B102              <3>  jmp _open_exit
    42                              <2>     DEF_ERROR 0Bh, open_error_0B
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000ADB E820FF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000ADE B31E                <4>  mov bl, %2
  1213 00000AE0 BE(3A06)            <4>  mov si, PTR16(_cA_%1)
  1214 00000AE3 E8A103              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AE6 B90B00              <3>  mov cx, %1
  1454 00000AE9 E9A002              <3>  jmp _open_exit
    43                              <2>     DEF_ERROR 0Ch, open_error_0C
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000AEC E80FFF              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000AEF B31E                <4>  mov bl, %2
  1213 00000AF1 BE(5106)            <4>  mov si, PTR16(_cA_%1)
  1214 00000AF4 E89003              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000AF7 B90C00              <3>  mov cx, %1
  1454 00000AFA E98F02              <3>  jmp _open_exit
    44                              <2>     DEF_ERROR 0Dh, open_error_0D
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000AFD E8FEFE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B00 B31E                <4>  mov bl, %2
  1213 00000B02 BE(6706)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B05 E87F03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B08 B90D00              <3>  mov cx, %1
  1454 00000B0B E97E02              <3>  jmp _open_exit
    45                              <2>     DEF_ERROR 0Eh, open_error_0E
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B0E E8EDFE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B11 B31E                <4>  mov bl, %2
  1213 00000B13 BE(8606)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B16 E86E03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B19 B90E00              <3>  mov cx, %1
  1454 00000B1C E96D02              <3>  jmp _open_exit
    46                              <2>     DEF_ERROR 0Fh, open_error_0F
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B1F E8DCFE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B22 B31E                <4>  mov bl, %2
  1213 00000B24 BE(9C06)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B27 E85D03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B2A B90F00              <3>  mov cx, %1
  1454 00000B2D E95C02              <3>  jmp _open_exit
    47                              <2>     DEF_ERROR 10h, open_error_10
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B30 E8CBFE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B33 B31E                <4>  mov bl, %2
  1213 00000B35 BE(AB06)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B38 E84C03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B3B B91000              <3>  mov cx, %1
  1454 00000B3E E94B02              <3>  jmp _open_exit
    48                              <2>     DEF_ERROR 11h, open_error_11
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B41 E8BAFE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B44 B31E                <4>  mov bl, %2
  1213 00000B46 BE(CE06)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B49 E83B03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B4C B91100              <3>  mov cx, %1
  1454 00000B4F E93A02              <3>  jmp _open_exit
    49                              <2>     DEF_ERROR 12h, open_error_12
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B52 E8A9FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B55 B31E                <4>  mov bl, %2
  1213 00000B57 BE(E306)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B5A E82A03              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B5D B91200              <3>  mov cx, %1
  1454 00000B60 E92902              <3>  jmp _open_exit
    50                              <2>     DEF_ERROR 15h, open_error_15
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B63 E898FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B66 B31E                <4>  mov bl, %2
  1213 00000B68 BE(0607)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B6B E81903              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B6E B91500              <3>  mov cx, %1
  1454 00000B71 E91802              <3>  jmp _open_exit
    51                              <2>     DEF_ERROR 1Dh, open_error_1D    ; Seek-Fehler
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B74 E887FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B77 B31E                <4>  mov bl, %2
  1213 00000B79 BE(1707)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B7C E80803              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B7F B91D00              <3>  mov cx, %1
  1454 00000B82 E90702              <3>  jmp _open_exit
    52                              <2>     DEF_ERROR 1Eh, open_error_1E    ; kein DOS-Datenträger
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B85 E876FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B88 B31E                <4>  mov bl, %2
  1213 00000B8A BE(3407)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B8D E8F702              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000B90 B91E00              <3>  mov cx, %1
  1454 00000B93 E9F601              <3>  jmp _open_exit
    53                              <2>     DEF_ERROR 1Fh, open_error_1F
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000B96 E865FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000B99 B31E                <4>  mov bl, %2
  1213 00000B9B BE(4007)            <4>  mov si, PTR16(_cA_%1)
  1214 00000B9E E8E602              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000BA1 B91F00              <3>  mov cx, %1
  1454 00000BA4 E9E501              <3>  jmp _open_exit
    54                              <2>     DEF_ERROR 20h, open_error_20
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000BA7 E854FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000BAA B31E                <4>  mov bl, %2
  1213 00000BAC BE(5507)            <4>  mov si, PTR16(_cA_%1)
  1214 00000BAF E8D502              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000BB2 B92000              <3>  mov cx, %1
  1454 00000BB5 E9D401              <3>  jmp _open_exit
    55                              <2>     DEF_ERROR 21h, open_error_21
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000BB8 E843FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000BBB B31E                <4>  mov bl, %2
  1213 00000BBD BE(6D07)            <4>  mov si, PTR16(_cA_%1)
  1214 00000BC0 E8C402              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000BC3 B92100              <3>  mov cx, %1
  1454 00000BC6 E9C301              <3>  jmp _open_exit
    56                              <2>     DEF_ERROR 27h, open_error_27
  1451                              <3> _h%1:
  1452                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1173                              <4> %if DOS_SHELL == 1
  1174                              <4>  GET_CURSOR
  1134                              <5> %if DOS_SHELL == 1
  1135 00000BC9 E832FE              <5>  call dos_get_cursor
  1136                              <5> %else
  1137                              <5>  %error 'todo: windows'
  1138                              <5> %endif
  1175                              <4>  %ifstr %1
  1176                              <4>  section .data
  1177                              <4>  %%msg: db %1, 0
  1178                              <4>  section .text
  1179                              <4>  mov bl, %2
  1180                              <4>  mov si, PTR16(%%msg)
  1181                              <4>  call PutStrColor
  1182                              <4>  %else
  1183                              <4>  %ifidni %1, DI
  1184                              <4>  section .text
  1185                              <4>  mov bl, %2
  1186                              <4>  call PutStrColor
  1187                              <4>  %elifidni %1, SI
  1188                              <4>  section .text
  1189                              <4>  mov bl, %2
  1190                              <4>  call PutStrColor
  1191                              <4>  %else
  1192                              <4>  %assign __count 0
  1193                              <4>  %assign __varg 0
  1194                              <4>  %assign __stop 0
  1195                              <4>  %rep MAX_ARGV
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1203                              <4>  %endrep
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1204                              <4>  %if __varg > 0
  1205                              <4>  section .text
  1206                              <4>  mov si, PTR16(_cA_cmd_buf)
  1207                              <4>  mov bl, __varg
  1208                              <4>  call getCommandLine_Arg
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  section .text
  1212 00000BCC B31E                <4>  mov bl, %2
  1213 00000BCE BE(7E07)            <4>  mov si, PTR16(_cA_%1)
  1214 00000BD1 E8B302              <4>  call PutStrColor
  1215                              <4>  %endif
  1216                              <4>  %undef __varg
  1217                              <4>  %endif
  1218                              <4>  %endif
  1219                              <4> %else
  1220                              <4>  %error 'this macro is only for DOS programming.'
  1221                              <4> %endif
  1453 00000BD4 B92700              <3>  mov cx, %1
  1454 00000BD7 E9B201              <3>  jmp _open_exit
    57                              <2> 
    58                              <2>     ERR_HANDLER 0x01, 0x02, 0x03, 0x04
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000BDA E821FE              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000BDD B31E                <5>  mov bl, %2
  1213 00000BDF BE(6E05)            <5>  mov si, PTR16(_cA_%1)
  1214 00000BE2 E8A202              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000BE5 B90100              <4>  mov cx, %1
  1564 00000BE8 E9A101              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000BEB E810FE              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000BEE B31E                <5>  mov bl, %2
  1213 00000BF0 BE(9005)            <5>  mov si, PTR16(_cA_%1)
  1214 00000BF3 E89102              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000BF6 B90200              <4>  mov cx, %1
  1564 00000BF9 E99001              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000BFC E8FFFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000BFF B31E                <5>  mov bl, %2
  1213 00000C01 BE(A005)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C04 E88002              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C07 B90300              <4>  mov cx, %1
  1564 00000C0A E97F01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C0D E8EEFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C10 B31E                <5>  mov bl, %2
  1213 00000C12 BE(B005)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C15 E86F02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C18 B90400              <4>  mov cx, %1
  1564 00000C1B E96E01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    59                              <2>     ERR_HANDLER 0x05, 0x06, 0x07, 0x08
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C1E E8DDFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C21 B31E                <5>  mov bl, %2
  1213 00000C23 BE(C505)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C26 E85E02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C29 B90500              <4>  mov cx, %1
  1564 00000C2C E95D01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C2F E8CCFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C32 B31E                <5>  mov bl, %2
  1213 00000C34 BE(D405)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C37 E84D02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C3A B90600              <4>  mov cx, %1
  1564 00000C3D E94C01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C40 E8BBFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C43 B31E                <5>  mov bl, %2
  1213 00000C45 BE(E805)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C48 E83C02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C4B B90700              <4>  mov cx, %1
  1564 00000C4E E93B01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C51 E8AAFD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C54 B31E                <5>  mov bl, %2
  1213 00000C56 BE(FD05)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C59 E82B02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C5C B90800              <4>  mov cx, %1
  1564 00000C5F E92A01              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    60                              <2>     ERR_HANDLER 0x09, 0x0A, 0x0B, 0x0C
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C62 E899FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C65 B31E                <5>  mov bl, %2
  1213 00000C67 BE(0D06)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C6A E81A02              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C6D B90900              <4>  mov cx, %1
  1564 00000C70 E91901              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C73 E888FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C76 B31E                <5>  mov bl, %2
  1213 00000C78 BE(2506)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C7B E80902              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C7E B90A00              <4>  mov cx, %1
  1564 00000C81 E90801              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C84 E877FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C87 B31E                <5>  mov bl, %2
  1213 00000C89 BE(3A06)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C8C E8F801              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000C8F B90B00              <4>  mov cx, %1
  1564 00000C92 E9F700              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000C95 E866FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000C98 B31E                <5>  mov bl, %2
  1213 00000C9A BE(5106)            <5>  mov si, PTR16(_cA_%1)
  1214 00000C9D E8E701              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CA0 B90C00              <4>  mov cx, %1
  1564 00000CA3 E9E600              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    61                              <2>     ERR_HANDLER 0x0D, 0x0E, 0x0F, 0x10
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CA6 E855FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CA9 B31E                <5>  mov bl, %2
  1213 00000CAB BE(6706)            <5>  mov si, PTR16(_cA_%1)
  1214 00000CAE E8D601              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CB1 B90D00              <4>  mov cx, %1
  1564 00000CB4 E9D500              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CB7 E844FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CBA B31E                <5>  mov bl, %2
  1213 00000CBC BE(8606)            <5>  mov si, PTR16(_cA_%1)
  1214 00000CBF E8C501              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CC2 B90E00              <4>  mov cx, %1
  1564 00000CC5 E9C400              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CC8 E833FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CCB B31E                <5>  mov bl, %2
  1213 00000CCD BE(9C06)            <5>  mov si, PTR16(_cA_%1)
  1214 00000CD0 E8B401              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CD3 B90F00              <4>  mov cx, %1
  1564 00000CD6 E9B300              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CD9 E822FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CDC B31E                <5>  mov bl, %2
  1213 00000CDE BE(AB06)            <5>  mov si, PTR16(_cA_%1)
  1214 00000CE1 E8A301              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CE4 B91000              <4>  mov cx, %1
  1564 00000CE7 E9A200              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    62                              <2>     ERR_HANDLER 0x11, 0x12, 0x15
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CEA E811FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CED B31E                <5>  mov bl, %2
  1213 00000CEF BE(CE06)            <5>  mov si, PTR16(_cA_%1)
  1214 00000CF2 E89201              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000CF5 B91100              <4>  mov cx, %1
  1564 00000CF8 E99100              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000CFB E800FD              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000CFE B31E                <5>  mov bl, %2
  1213 00000D00 BE(E306)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D03 E88101              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D06 B91200              <4>  mov cx, %1
  1564 00000D09 E98000              <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D0C E8EFFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D0F B31E                <5>  mov bl, %2
  1213 00000D11 BE(0607)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D14 E87001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D17 B91500              <4>  mov cx, %1
  1564 00000D1A EB70                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    63                              <2>     ERR_HANDLER 0x1D, 0x1E, 0x1F, 0x20
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D1C E8DFFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D1F B31E                <5>  mov bl, %2
  1213 00000D21 BE(1707)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D24 E86001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D27 B91D00              <4>  mov cx, %1
  1564 00000D2A EB60                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D2C E8CFFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D2F B31E                <5>  mov bl, %2
  1213 00000D31 BE(3407)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D34 E85001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D37 B91E00              <4>  mov cx, %1
  1564 00000D3A EB50                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D3C E8BFFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D3F B31E                <5>  mov bl, %2
  1213 00000D41 BE(4007)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D44 E84001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D47 B91F00              <4>  mov cx, %1
  1564 00000D4A EB40                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D4C E8AFFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D4F B31E                <5>  mov bl, %2
  1213 00000D51 BE(5507)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D54 E83001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D57 B92000              <4>  mov cx, %1
  1564 00000D5A EB30                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    64                              <2>     ERR_HANDLER 0x21
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D5C E89FFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D5F B31E                <5>  mov bl, %2
  1213 00000D61 BE(6D07)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D64 E82001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D67 B92100              <4>  mov cx, %1
  1564 00000D6A EB20                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    65                              <2>     ERR_HANDLER 0x27
  1550                              <3> %rep %0
  1551                              <3> 
  1552                              <3>  %assign __v %1
  1553                              <3>  %assign __v __v & 0FFh
  1554                              <3> 
  1555                              <3> 
  1556                              <3>  %assign __hi (__v >> 4) & 0Fh
  1557                              <3>  %assign __lo __v & 0Fh
  1558                              <3>  _HEXDIG __hi, __H
  1559                              <3>  _HEXDIG __lo, __L
  1560                              <3> 
  1561                              <3> _cA_errh%+__H%+__L:
  1562                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1563                              <3>  mov cx, %1
  1564                              <3>  jmp _open_exit
  1565                              <3> 
  1566                              <3> 
  1567                              <3>  %undef __H
  1568                              <3>  %undef __L
  1569                              <3>  %undef __hi
  1570                              <3>  %undef __lo
  1571                              <3>  %undef __v
  1572                              <3> 
  1573                              <3>  %rotate 1
  1574                              <3> %endrep
  1551                              <4> 
  1552                              <4>  %assign __v %1
  1553                              <4>  %assign __v __v & 0FFh
  1554                              <4> 
  1555                              <4> 
  1556                              <4>  %assign __hi (__v >> 4) & 0Fh
  1557                              <4>  %assign __lo __v & 0Fh
  1558                              <4>  _HEXDIG __hi, __H
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1559                              <4>  _HEXDIG __lo, __L
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1560                              <4> 
  1561                              <4> _cA_errh%+__H%+__L:
  1562                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1173                              <5> %if DOS_SHELL == 1
  1174                              <5>  GET_CURSOR
  1134                              <6> %if DOS_SHELL == 1
  1135 00000D6C E88FFC              <6>  call dos_get_cursor
  1136                              <6> %else
  1137                              <6>  %error 'todo: windows'
  1138                              <6> %endif
  1175                              <5>  %ifstr %1
  1176                              <5>  section .data
  1177                              <5>  %%msg: db %1, 0
  1178                              <5>  section .text
  1179                              <5>  mov bl, %2
  1180                              <5>  mov si, PTR16(%%msg)
  1181                              <5>  call PutStrColor
  1182                              <5>  %else
  1183                              <5>  %ifidni %1, DI
  1184                              <5>  section .text
  1185                              <5>  mov bl, %2
  1186                              <5>  call PutStrColor
  1187                              <5>  %elifidni %1, SI
  1188                              <5>  section .text
  1189                              <5>  mov bl, %2
  1190                              <5>  call PutStrColor
  1191                              <5>  %else
  1192                              <5>  %assign __count 0
  1193                              <5>  %assign __varg 0
  1194                              <5>  %assign __stop 0
  1195                              <5>  %rep MAX_ARGV
  1196                              <5>  %if __stop == 0
  1197                              <5>  %assign __count (__count + 1)
  1198                              <5>  %ifidni %1, ARGV_%+__count
  1199                              <5>  %assign __varg __count
  1200                              <5>  %assign __stop 1
  1201                              <5>  %endif
  1202                              <5>  %endif
  1203                              <5>  %endrep
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1196                              <6>  %if __stop == 0
  1197                              <6>  %assign __count (__count + 1)
  1198                              <6>  %ifidni %1, ARGV_%+__count
  1199                              <6>  %assign __varg __count
  1200                              <6>  %assign __stop 1
  1201                              <6>  %endif
  1202                              <6>  %endif
  1204                              <5>  %if __varg > 0
  1205                              <5>  section .text
  1206                              <5>  mov si, PTR16(_cA_cmd_buf)
  1207                              <5>  mov bl, __varg
  1208                              <5>  call getCommandLine_Arg
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  section .text
  1212 00000D6F B31E                <5>  mov bl, %2
  1213 00000D71 BE(7E07)            <5>  mov si, PTR16(_cA_%1)
  1214 00000D74 E81001              <5>  call PutStrColor
  1215                              <5>  %endif
  1216                              <5>  %undef __varg
  1217                              <5>  %endif
  1218                              <5>  %endif
  1219                              <5> %else
  1220                              <5>  %error 'this macro is only for DOS programming.'
  1221                              <5> %endif
  1563 00000D77 B92700              <4>  mov cx, %1
  1564 00000D7A EB10                <4>  jmp _open_exit
  1565                              <4> 
  1566                              <4> 
  1567                              <4>  %undef __H
  1568                              <4>  %undef __L
  1569                              <4>  %undef __hi
  1570                              <4>  %undef __lo
  1571                              <4>  %undef __v
  1572                              <4> 
  1573                              <4>  %rotate 1
    66                              <2> 
    67                              <2> _cA_errhnd:
    68                              <2>     PUTS_COLOR open_error_nd, ATTR_DOS_ERROR
  1173                              <3> %if DOS_SHELL == 1
  1174                              <3>  GET_CURSOR
  1134                              <4> %if DOS_SHELL == 1
  1135 00000D7C E87FFC              <4>  call dos_get_cursor
  1136                              <4> %else
  1137                              <4>  %error 'todo: windows'
  1138                              <4> %endif
  1175                              <3>  %ifstr %1
  1176                              <3>  section .data
  1177                              <3>  %%msg: db %1, 0
  1178                              <3>  section .text
  1179                              <3>  mov bl, %2
  1180                              <3>  mov si, PTR16(%%msg)
  1181                              <3>  call PutStrColor
  1182                              <3>  %else
  1183                              <3>  %ifidni %1, DI
  1184                              <3>  section .text
  1185                              <3>  mov bl, %2
  1186                              <3>  call PutStrColor
  1187                              <3>  %elifidni %1, SI
  1188                              <3>  section .text
  1189                              <3>  mov bl, %2
  1190                              <3>  call PutStrColor
  1191                              <3>  %else
  1192                              <3>  %assign __count 0
  1193                              <3>  %assign __varg 0
  1194                              <3>  %assign __stop 0
  1195                              <3>  %rep MAX_ARGV
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1203                              <3>  %endrep
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1204                              <3>  %if __varg > 0
  1205                              <3>  section .text
  1206                              <3>  mov si, PTR16(_cA_cmd_buf)
  1207                              <3>  mov bl, __varg
  1208                              <3>  call getCommandLine_Arg
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  section .text
  1212 00000D7F B31E                <3>  mov bl, %2
  1213 00000D81 BE(5F05)            <3>  mov si, PTR16(_cA_%1)
  1214 00000D84 E80001              <3>  call PutStrColor
  1215                              <3>  %endif
  1216                              <3>  %undef __varg
  1217                              <3>  %endif
  1218                              <3>  %endif
  1219                              <3> %else
  1220                              <3>  %error 'this macro is only for DOS programming.'
  1221                              <3> %endif
    69 00000D87 B92000              <2>     mov   cx, 32
    70 00000D8A EB00                <2>     jmp _open_exit
    71                              <2> 
    72                              <2> _open_exit:
    73                              <2>     DOS_Exit cx
  1247                              <3> %if DOS_SHELL == 1
  1248                              <3>  %ifidni %1, ax
  1249                              <3>  %error 'AX not allowed here.'
  1250                              <3>  %elifidni %1, bx
  1251                              <3>  mov ax, 0x4C00
  1252                              <3>  or ax, bx
  1253                              <3>  SysCall
  1254                              <3>  %elifidni %1, CX
  1255 00000D8C B8004C              <3>  mov ax, 0x4C00
  1256 00000D8F 09C8                <3>  or ax, cx
  1257                              <3>  SysCall
    66                              <4> %if DOS_SHELL == 1
    67 00000D91 CD21                <4>  int 0x21
    68                              <4> %endif
  1258                              <3>  %elifidni %1, dx
  1259                              <3>  mov ax, 0x4C00
  1260                              <3>  or ax, dx
  1261                              <3>  SysCall
  1262                              <3>  %elifnum %1
  1263                              <3>  mov ax, 0x4C00 | %1
  1264                              <3>  SysCall
  1265                              <3>  %else
  1266                              <3>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <3>  %endif
  1268                              <3> %endif
  1419                              <1> %include 'InitConsole.asm'          ; initialize the DOS console
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  InitConsole.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> dos_init_console:
    10 00000D93 E80A00              <2>     call dos_get_cols               ; get DOS screen columns
    11 00000D96 E80E00              <2>     call dos_get_rows               ; get DOS screen rows
    12                              <2>     
    13                              <2>     SCREEN_CLEAR
  1104                              <3> %if DOS_SHELL == 1
  1105 00000D99 E84C01              <3>  call dos_screen_clear
  1106                              <3> %else
  1107                              <3>  GET_CON_O_HANDLE r12
  1108                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1109                              <3>  WRITE_CON_A buffer_B
  1110                              <3> %endif
    14                              <2>     
    15 00000D9C E81600              <2>     call dos_get_command_line
    16 00000D9F C3                  <2>     ret
    17                              <2> 
    18                              <2> ; -----------------------------------------------------------------------------
    19                              <2> ; \brief get DOS screen columns
    20                              <2> ; -----------------------------------------------------------------------------
    21                              <2> dos_get_cols:
    22 00000DA0 B40F                <2>     mov  ah, 0Fh
    23                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000DA2 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    24                              <2>     ; AL = aktueller Videomodus
    25                              <2>     ; AH = Spaltenzahl
    26                              <2>     ; BH = aktive Seite
    27 00000DA4 88E3                <2>     mov  bl, ah           ; BL = Spalten
    28 00000DA6 C3                  <2>     ret
    29                              <2> 
    30                              <2> ; -----------------------------------------------------------------------------
    31                              <2> ; \brief get DOS screen rows
    32                              <2> ; -----------------------------------------------------------------------------
    33                              <2> dos_get_rows:
    34 00000DA7 B83011              <2>     mov  ax, 1130h
    35 00000DAA B700                <2>     mov  bh, 00h          ; aktuelle Font/Block
    36                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000DAC CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    37 00000DAE 88D2                <2>     mov  dl, dl           ; DL = Zeilen-1
    38 00000DB0 FEC2                <2>     inc  dl               ; DL = Zeilen
    39 00000DB2 88D7                <2>     mov  bh, dl           ; BH = Zeilen
    40 00000DB4 C3                  <2>     ret
    41                              <2> 
    42                              <2> ; -----------------------------------------------------------------------------
    43                              <2> ; \brief DOS - get command line arguments from PSP ...
    44                              <2> ; -----------------------------------------------------------------------------
    45                              <2> dos_get_command_line:
    46 00000DB5 31C0                <2>     xor  ax, ax
    47 00000DB7 BE8100              <2>     mov  si, 81h          ; SI -> Beginn der Kommandozeile im PSP
    48 00000DBA 8A0E8000            <2>     mov  cl, [80h]        ; CL = Länge
    49 00000DBE 30ED                <2>     xor  ch, ch           ; CX = Länge
    50                              <2> 
    51 00000DC0 E320                <2>     jcxz .no_args       ; nichts übergeben?
    52                              <2>     ; Zielpuffer vorbereiten
    53 00000DC2 BF(C204)            <2>     mov  di, PTR16(_cA_cmd_buf) ; DI -> Ziel
    54                              <2>     .copy:
    55 00000DC5 AC                  <2>     lodsb                 ; AL = [DS:SI], SI++
    56 00000DC6 3C0D                <2>     cmp   al, 0x0D        ; CR markiert das Ende (Sicherheit)
    57 00000DC8 7403                <2>     je   .done_copy
    58 00000DCA AA                  <2>     stosb                 ; [ES:DI]=AL (ES=DS in .COM), DI++
    59 00000DCB E2F8                <2>     loop .copy
    60                              <2> 
    61                              <2>     .done_copy:
    62 00000DCD B000                <2>     mov  al, 0
    63 00000DCF AA                  <2>     stosb
    64                              <2>     
    65                              <2>     ; Trim: nachlaufende Spaces entfernen
    66                              <2>     .trim:
    67 00000DD0 81FF(C204)          <2>     cmp  di, PTR16(_cA_cmd_buf)
    68 00000DD4 7607                <2>     jbe  .make_dos_str
    69 00000DD6 4F                  <2>     dec  di
    70 00000DD7 803D20              <2>     cmp  byte [di], ' '
    71 00000DDA 74F4                <2>     je   .trim
    72 00000DDC 47                  <2>     inc  di
    73                              <2> 
    74                              <2>     .make_dos_str:
    75 00000DDD C60500              <2>     mov  byte [di], 0     ; für DOS-Funktion 09h Stringabschluss
    76 00000DE0 EB21                <2>     jmp  .next
    77                              <2>     
    78                              <2>     .no_args:
    79                              <2>     SCREEN_CLEAR
  1104                              <3> %if DOS_SHELL == 1
  1105 00000DE2 E80301              <3>  call dos_screen_clear
  1106                              <3> %else
  1107                              <3>  GET_CON_O_HANDLE r12
  1108                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1109                              <3>  WRITE_CON_A buffer_B
  1110                              <3> %endif
    80                              <2>     SET_CURSOR 0, 1
  1119                              <3> %if %0 == 0
  1120                              <3>  %error 2 argument missing
  1121                              <3> %endif
  1122                              <3> %if DOS_SHELL == 1
  1123 00000DE5 B200                <3>  mov dl, %1
  1124 00000DE7 B601                <3>  mov dh, %2
  1125 00000DE9 E8FFFB              <3>  call dos_set_cursor
  1126                              <3> %else
  1127                              <3> %endif
    81                              <2>     PUTS_COLOR noargs_msg, 0x02 | 0x10
  1173                              <3> %if DOS_SHELL == 1
  1174                              <3>  GET_CURSOR
  1134                              <4> %if DOS_SHELL == 1
  1135 00000DEC E80FFC              <4>  call dos_get_cursor
  1136                              <4> %else
  1137                              <4>  %error 'todo: windows'
  1138                              <4> %endif
  1175                              <3>  %ifstr %1
  1176                              <3>  section .data
  1177                              <3>  %%msg: db %1, 0
  1178                              <3>  section .text
  1179                              <3>  mov bl, %2
  1180                              <3>  mov si, PTR16(%%msg)
  1181                              <3>  call PutStrColor
  1182                              <3>  %else
  1183                              <3>  %ifidni %1, DI
  1184                              <3>  section .text
  1185                              <3>  mov bl, %2
  1186                              <3>  call PutStrColor
  1187                              <3>  %elifidni %1, SI
  1188                              <3>  section .text
  1189                              <3>  mov bl, %2
  1190                              <3>  call PutStrColor
  1191                              <3>  %else
  1192                              <3>  %assign __count 0
  1193                              <3>  %assign __varg 0
  1194                              <3>  %assign __stop 0
  1195                              <3>  %rep MAX_ARGV
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1203                              <3>  %endrep
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1196                              <4>  %if __stop == 0
  1197                              <4>  %assign __count (__count + 1)
  1198                              <4>  %ifidni %1, ARGV_%+__count
  1199                              <4>  %assign __varg __count
  1200                              <4>  %assign __stop 1
  1201                              <4>  %endif
  1202                              <4>  %endif
  1204                              <3>  %if __varg > 0
  1205                              <3>  section .text
  1206                              <3>  mov si, PTR16(_cA_cmd_buf)
  1207                              <3>  mov bl, __varg
  1208                              <3>  call getCommandLine_Arg
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  section .text
  1212 00000DEF B312                <3>  mov bl, %2
  1213 00000DF1 BE(2605)            <3>  mov si, PTR16(_cA_%1)
  1214 00000DF4 E89000              <3>  call PutStrColor
  1215                              <3>  %endif
  1216                              <3>  %undef __varg
  1217                              <3>  %endif
  1218                              <3>  %endif
  1219                              <3> %else
  1220                              <3>  %error 'this macro is only for DOS programming.'
  1221                              <3> %endif
    82                              <2>     SET_CURSOR 0, 2
  1119                              <3> %if %0 == 0
  1120                              <3>  %error 2 argument missing
  1121                              <3> %endif
  1122                              <3> %if DOS_SHELL == 1
  1123 00000DF7 B200                <3>  mov dl, %1
  1124 00000DF9 B602                <3>  mov dh, %2
  1125 00000DFB E8EDFB              <3>  call dos_set_cursor
  1126                              <3> %else
  1127                              <3> %endif
    83                              <2>     DOS_Exit   0          ; exit - no args.
  1247                              <3> %if DOS_SHELL == 1
  1248                              <3>  %ifidni %1, ax
  1249                              <3>  %error 'AX not allowed here.'
  1250                              <3>  %elifidni %1, bx
  1251                              <3>  mov ax, 0x4C00
  1252                              <3>  or ax, bx
  1253                              <3>  SysCall
  1254                              <3>  %elifidni %1, CX
  1255                              <3>  mov ax, 0x4C00
  1256                              <3>  or ax, cx
  1257                              <3>  SysCall
  1258                              <3>  %elifidni %1, dx
  1259                              <3>  mov ax, 0x4C00
  1260                              <3>  or ax, dx
  1261                              <3>  SysCall
  1262                              <3>  %elifnum %1
  1263 00000DFE B8004C              <3>  mov ax, 0x4C00 | %1
  1264                              <3>  SysCall
    66                              <4> %if DOS_SHELL == 1
    67 00000E01 CD21                <4>  int 0x21
    68                              <4> %endif
  1265                              <3>  %else
  1266                              <3>  %error 'BX, CX, DX or <NUM> expected.'
  1267                              <3>  %endif
  1268                              <3> %endif
    84                              <2>     
    85                              <2>     .next:
    86                              <2>     SET_CURSOR 0, 0
  1119                              <3> %if %0 == 0
  1120                              <3>  %error 2 argument missing
  1121                              <3> %endif
  1122                              <3> %if DOS_SHELL == 1
  1123 00000E03 B200                <3>  mov dl, %1
  1124 00000E05 B600                <3>  mov dh, %2
  1125 00000E07 E8E1FB              <3>  call dos_set_cursor
  1126                              <3> %else
  1127                              <3> %endif
    87 00000E0A C3                  <2>     ret
  1420                              <1> %include 'Int16ToStr.asm'           ; convert integer number to string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Int16ToStr.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; ----------------------------------------------------------------------------
    11                              <2> ; \brief  convert number from AX register to a string.
    12                              <2> ; \param  AX: 16-Bit value
    13                              <2> ; \param  DI: destination buffer
    14                              <2> ; \return ASCII-decimal without trailing zeros.
    15                              <2> ;         (min. onr digit, and '0' at end.
    16                              <2> ;
    17                              <2> ; \note   destroy's: AX,BX,CX,DX (internal saved)
    18                              <2> ; \note   buffer: max. 5 digits + '$' => min. 6 bytes
    19                              <2> ; ----------------------------------------------------------------------------
    20                              <2> DOSIntToStr:
    21 00000E0B 50                  <2>     push ax
    22 00000E0C 53                  <2>     push bx
    23 00000E0D 51                  <2>     push cx
    24 00000E0E 52                  <2>     push dx
    25 00000E0F 57                  <2>     push di
    26                              <2> 
    27 00000E10 BB0A00              <2>     mov bx, 10
    28 00000E13 31C9                <2>     xor cx, cx                 ; Zähler für gepushte Reste
    29                              <2> 
    30 00000E15 83F800              <2>     cmp ax, 0
    31 00000E18 7506                <2>     jne .div_loop
    32 00000E1A C60530              <2>     mov byte [di], '0'
    33 00000E1D 47                  <2>     inc di
    34 00000E1E EB13                <2>     jmp short .finish
    35                              <2> 
    36                              <2>     .div_loop:
    37 00000E20 31D2                <2>     xor dx, dx                 ; DX:AX / 10
    38 00000E22 F7F3                <2>     div bx                     ; AX = Quotient, DX = Rest (0..9)
    39 00000E24 52                  <2>     push dx
    40 00000E25 41                  <2>     inc cx
    41 00000E26 85C0                <2>     test ax, ax
    42 00000E28 75F6                <2>     jne .div_loop
    43                              <2> 
    44                              <2>     .write_loop:
    45 00000E2A 5A                  <2>     pop dx
    46 00000E2B 80C230              <2>     add dl, '0'
    47 00000E2E 8815                <2>     mov [di], dl
    48 00000E30 47                  <2>     inc di
    49 00000E31 E2F7                <2>     loop .write_loop
    50                              <2> 
    51                              <2>     .finish:
    52 00000E33 C60500              <2>     mov byte [di], 0x00
    53                              <2> 
    54 00000E36 5F                  <2>     pop di
    55 00000E37 5A                  <2>     pop dx
    56 00000E38 59                  <2>     pop cx
    57 00000E39 5B                  <2>     pop bx
    58 00000E3A 58                  <2>     pop ax
    59 00000E3B C3                  <2>     ret
  1421                              <1> %include 'PutStrColor.asm'          ; put colored text onto the DOS screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  PutStrColor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; --- String per BIOS-Teletype (AH=0Eh) ausgeben ---
    11                              <2> ; putc: AL -> Zeichen ausgeben
    12                              <2> putc:
    13 00000E3C 52                  <2>     push dx
    14 00000E3D 88C2                <2>     mov dl, al
    15 00000E3F B402                <2>     mov ah, 02h
    16                              <2>     SysCall
    66                              <3> %if DOS_SHELL == 1
    67 00000E41 CD21                <3>  int 0x21
    68                              <3> %endif
    17 00000E43 5A                  <2>     pop dx
    18 00000E44 C3                  <2>     ret
    19                              <2> 
    20                              <2> ; crlf: \r\n
    21                              <2> DOSrncrlf:
    22 00000E45 B00D                <2>     mov al, 13
    23 00000E47 E8F2FF              <2>     call putc
    24 00000E4A B00A                <2>     mov al, 10
    25 00000E4C E8EDFF              <2>     call putc
    26 00000E4F C3                  <2>     ret
    27                              <2> 
    28                              <2> DOSPutStrColor:
    29 00000E50 B409                <2>     mov  ah, 09h
    30                              <2>     SysCall
    66                              <3> %if DOS_SHELL == 1
    67 00000E52 CD21                <3>  int 0x21
    68                              <3> %endif
    31 00000E54 C3                  <2>     ret
    32                              <2> 
    33                              <2> print_z:
    34 00000E55 52                  <2>     push dx             ; save DX
    35 00000E56 89D6                <2>     mov si, dx
    36                              <2>     .find_end:
    37 00000E58 AC                  <2>     lodsb               ; AL = [SI], SI++
    38 00000E59 3C00                <2>     cmp  al, 0
    39 00000E5B 75FB                <2>     jne .find_end       ; repeat, till 0x00 is found
    40 00000E5D 4E                  <2>     dec si              ; SI points to 0x00
    41                              <2>     
    42 00000E5E B024                <2>     mov al, '$'         ; set DOS String end mark
    43 00000E60 8804                <2>     mov [si], al        ; append AL
    44 00000E62 46                  <2>     inc si
    45 00000E63 C60400              <2>     mov byte [si], 0    ; end of C-String
    46                              <2>     
    47 00000E66 8936(DF16)          <2>     mov [PTR16(fdbuf)], si
    48                              <2>     DOS_Write fdbuf
  1286 00000E6A 8D16(DF16)          <3>  lea dx, [PTR16(_cA_%1)]
  1287 00000E6E E80200              <3>  call DOS_ConsoleWrite
    49 00000E71 5A                  <2>     pop dx              ; restore DX
    50 00000E72 C3                  <2>     ret
    51                              <2> 
    52                              <2> ; DX -> 0-terminierte Zeichenkette
    53                              <2> DOS_ConsoleWrite:
    54 00000E73 50                  <2>     push ax
    55 00000E74 52                  <2>     push dx
    56 00000E75 56                  <2>     push si
    57 00000E76 89D6                <2>     mov si, dx
    58                              <2>     .print_z_loop:
    59 00000E78 AC                  <2>     lodsb
    60 00000E79 3C24                <2>     cmp al, '$'
    61 00000E7B 7406                <2>     je .pe_done
    62 00000E7D E8BCFF              <2>     call putc
    63 00000E80 46                  <2>     inc si
    64 00000E81 EBF5                <2>     jmp .print_z_loop
    65                              <2>     .pe_done:
    66 00000E83 5E                  <2>     pop si
    67 00000E84 5A                  <2>     pop dx
    68 00000E85 58                  <2>     pop ax
    69 00000E86 C3                  <2>     ret
    70                              <2> 
    71                              <2> PutStrColor:
    72 00000E87 53                  <2>     push bx
    73 00000E88 8A3E(B601)          <2>     mov  bh, [PTR16(dos_readln_flag)]
    74 00000E8C 80FF00              <2>     cmp  bh, 0
    75 00000E8F 7409                <2>     je   .no_length
    76 00000E91 83C602              <2>     add  si, 2
    77 00000E94 B700                <2>     mov  bh, 0
    78 00000E96 883E(B601)          <2>     mov  [PTR16(dos_readln_flag)], bh
    79                              <2>     .no_length:
    80 00000E9A 5B                  <2>     pop  bx
    81                              <2>     
    82 00000E9B 8B16(B701)          <2>     mov  dx, [PTR16(dos_xpos)]
    83                              <2>     ; -------------------
    84                              <2>     .print_loop:
    85 00000E9F AC                  <2>     lodsb                ; AL := [SI], SI++
    86                              <2>     
    87                              <2>     COMPARE al, 0x00, .printed  ; reach end  ?
  1363 00000EA0 3C00                <3>  cmp %1, %2
  1364 00000EA2 741E                <3>  je %3
    88                              <2>     COMPARE al, 0x0d, .printed
  1363 00000EA4 3C0D                <3>  cmp %1, %2
  1364 00000EA6 741A                <3>  je %3
    89                              <2>     COMPARE al, 0x0a, .printed
  1363 00000EA8 3C0A                <3>  cmp %1, %2
  1364 00000EAA 7416                <3>  je %3
    90                              <2>     
    91 00000EAC 84C0                <2>     test al, al
    92 00000EAE 7412                <2>     jz   .printed
    93 00000EB0 B409                <2>     mov  ah, 09h         ; Teletype-Ausgabe
    94 00000EB2 B700                <2>     mov  bh, 0           ; page 0 todo
    95 00000EB4 B90100              <2>     mov  cx, 1           ; mim
    96                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000EB7 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    97                              <2>     
    98 00000EB9 B402                <2>     mov ah, 0x02
    99 00000EBB B700                <2>     mov bh, 0
   100 00000EBD 42                  <2>     inc dx
   101                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000EBE CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
   102                              <2>     
   103 00000EC0 EBDD                <2>     jmp  .print_loop
   104                              <2> 
   105                              <2>     .printed:
   106                              <2>     ;call  DOS_getCursor
   107 00000EC2 C3                  <2>     ret
   108                              <2>     
   109                              <2> ; --- Cursorposition lesen (AH=03h) ---
   110                              <2> DOS_getCursor:
   111 00000EC3 B403                <2>     mov  ah, 03h         ; Read Cursor Position
   112 00000EC5 B700                <2>     mov  bh, 0           ; Videoseite 0
   113                              <2>     VideoCall            ; Rückgabe: DH=Zeile, DL=Spalte (0-basiert)
    71                              <3> %if DOS_SHELL == 1
    72 00000EC7 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
   114 00000EC9 8836(B801)          <2>     mov  [PTR16(dos_ypos)], dh
   115 00000ECD 8816(B701)          <2>     mov  [PTR16(dos_xpos)], dl
   116                              <2> 
   117 00000ED1 C3                  <2>     ret
  1422                              <1> %include 'ReadLn16.asm'             ; read a line of text
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ReadLn16.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief Eingabe holen (DOS Zeileneingabe, mit eigenem Editor/Echo)
    12                              <2> ; \param DX - buffer
    13                              <2> ; -----------------------------------------------------------------------------
    14                              <2> DOSReadLn:
    15 00000ED2 B40A                <2>     mov ah, 0Ah
    16 00000ED4 CD21                <2>     int 21h              ; Rückkehr nach ENTER; [buf+1]=len, [buf+2..]=Text, [buf+2+len]=0Dh
    17                              <2> 
    18                              <2>     ; SI = &Textanfang, BL = len
    19 00000ED6 89D3                <2>     mov bx, dx
    20 00000ED8 8D7702              <2>     lea si, [bx + 2]
    21 00000EDB 8A5F01              <2>     mov bl, [bx + 1]
    22                              <2> 
    23                              <2>     ; CR hinter dem Text durch 0x00 ersetzen -> sauber terminierter String
    24 00000EDE C60000              <2>     mov byte [si + bx], 0x00
    25                              <2>     
    26                              <2>     ; set flag for puts_color
    27 00000EE1 B701                <2>     mov bh, 1
    28 00000EE3 883E(B601)          <2>     mov [PTR16(dos_readln_flag)], bh
    29                              <2> 
    30                              <2>     ; neue Zeile
    31                              <2>     ;mov dx, PTR16(crlf)
    32                              <2>     ;mov ah, 09h
    33                              <2>     ;int 21h
    34                              <2>     
    35 00000EE7 C3                  <2>     ret
    36                              <2>  
  1423                              <1> %include 'ScreenClear.asm'          ; clear the screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ScreenClear.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define TEXT_VRAM 0B800h
     9                              <2> 
    10                              <2> dos_screen_clear:
    11 00000EE8 1E                  <2>     push ds
    12 00000EE9 B800B8              <2>     mov  ax, TEXT_VRAM
    13 00000EEC 8EC0                <2>     mov  es, ax
    14                              <2> 
    15 00000EEE 31FF                <2>     xor  di, di         ; Offset 0
    16                              <2>     
    17                              <2>     ; default size is:  80x25
    18 00000EF0 88D8                <2>     mov  al, bl         ; AL = 25
    19 00000EF2 F6E7                <2>     mul  bh             ; AX = AL * BH = 25 * 80 = 2000 (0x07D0)
    20 00000EF4 89C1                <2>     mov  cx, ax         ; 2000 chars
    21                              <2>     
    22                              <2>     ; color
    23 00000EF6 B82007              <2>     mov  ax, 0x0720     ; AL=' ' (20h), AH=07h (hellgrau auf schwarz)
    24                              <2> 
    25                              <2>     .fill:
    26 00000EF9 AB                  <2>     stosw               ; schreibt AX -> ES:[DI], DI+=2
    27 00000EFA E2FD                <2>     loop .fill
    28                              <2> 
    29 00000EFC 1F                  <2>     pop  ds
    30                              <2> 
    31                              <2>     SET_CURSOR 0, 0
  1119                              <3> %if %0 == 0
  1120                              <3>  %error 2 argument missing
  1121                              <3> %endif
  1122                              <3> %if DOS_SHELL == 1
  1123 00000EFD B200                <3>  mov dl, %1
  1124 00000EFF B600                <3>  mov dh, %2
  1125 00000F01 E8E7FA              <3>  call dos_set_cursor
  1126                              <3> %else
  1127                              <3> %endif
    32                              <2>     
    33 00000F04 C3                  <2>     ret
    34                              <2>  
  1424                              <1> %include 'Str16Len.asm'             ; get the length of a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Str16Len.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief  get the 16 bit length of a 0-terminated string
    12                              <2> ; \param  Input:  ES:SI -> "0"-terminierter String
    13                              <2> ; \return Output: CX = Länge (ohne '0')
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> DOSStrLen:
    16 00000F05 57                  <2>     push    di
    17 00000F06 89F7                <2>     mov     di, si
    18 00000F08 B000                <2>     mov     al, 0x00
    19 00000F0A FC                  <2>     cld
    20 00000F0B B9FFFF              <2>     mov     cx, 0FFFFh
    21 00000F0E F2AE                <2>     repne   scasb          ; search '0x00'
    22 00000F10 B8FFFF              <2>     mov     ax, 0FFFFh
    23 00000F13 29C8                <2>     sub     ax, cx         ; AX = Anzahl verglichener Bytes inkl. '0x00'
    24 00000F15 48                  <2>     dec     ax             ; ohne Terminierer
    25 00000F16 83E802              <2>     sub     ax, 2
    26 00000F19 89C1                <2>     mov     cx, ax
    27 00000F1B 5F                  <2>     pop     di
    28 00000F1C C3                  <2>     ret
  1425                              <1> %include 'StrCompare.asm'           ; string compare
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCompare.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief strcmp - compares two 0-terminated strings: DS:SI vs. ES:DI.
    11                              <2> ; \param 1. dst > DI
    12                              <2> ; \param 2. src > SI
    13                              <2> ; \return AL = 1 (found/same)
    14                              <2> ;         AL = 0 (not same)
    15                              <2> ; -----------------------------------------------------------------------------
    16                              <2> string_compare:
    17 00000F1D 56                  <2>     push si             ; save src > si
    18 00000F1E 57                  <2>     push di             ; save dst > di
    19                              <2>     
    20                              <2>     SET_CURSOR 1, 1
  1119                              <3> %if %0 == 0
  1120                              <3>  %error 2 argument missing
  1121                              <3> %endif
  1122                              <3> %if DOS_SHELL == 1
  1123 00000F1F B201                <3>  mov dl, %1
  1124 00000F21 B601                <3>  mov dh, %2
  1125 00000F23 E8C5FA              <3>  call dos_set_cursor
  1126                              <3> %else
  1127                              <3> %endif
    21                              <2>     PUTS_COLOR SI, 6
  1173                              <3> %if DOS_SHELL == 1
  1174                              <3>  GET_CURSOR
  1134                              <4> %if DOS_SHELL == 1
  1135 00000F26 E8D5FA              <4>  call dos_get_cursor
  1136                              <4> %else
  1137                              <4>  %error 'todo: windows'
  1138                              <4> %endif
  1175                              <3>  %ifstr %1
  1176                              <3>  section .data
  1177                              <3>  %%msg: db %1, 0
  1178                              <3>  section .text
  1179                              <3>  mov bl, %2
  1180                              <3>  mov si, PTR16(%%msg)
  1181                              <3>  call PutStrColor
  1182                              <3>  %else
  1183                              <3>  %ifidni %1, DI
  1184                              <3>  section .text
  1185                              <3>  mov bl, %2
  1186                              <3>  call PutStrColor
  1187                              <3>  %elifidni %1, SI
  1188                              <3>  section .text
  1189 00000F29 B306                <3>  mov bl, %2
  1190 00000F2B E859FF              <3>  call PutStrColor
  1191                              <3>  %else
  1192                              <3>  %assign __count 0
  1193                              <3>  %assign __varg 0
  1194                              <3>  %assign __stop 0
  1195                              <3>  %rep MAX_ARGV
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1203                              <3>  %endrep
  1204                              <3>  %if __varg > 0
  1205                              <3>  section .text
  1206                              <3>  mov si, PTR16(_cA_cmd_buf)
  1207                              <3>  mov bl, __varg
  1208                              <3>  call getCommandLine_Arg
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  section .text
  1212                              <3>  mov bl, %2
  1213                              <3>  mov si, PTR16(_cA_%1)
  1214                              <3>  call PutStrColor
  1215                              <3>  %endif
  1216                              <3>  %undef __varg
  1217                              <3>  %endif
  1218                              <3>  %endif
  1219                              <3> %else
  1220                              <3>  %error 'this macro is only for DOS programming.'
  1221                              <3> %endif
    22                              <2>     PUTS_COLOR DI, 1
  1173                              <3> %if DOS_SHELL == 1
  1174                              <3>  GET_CURSOR
  1134                              <4> %if DOS_SHELL == 1
  1135 00000F2E E8CDFA              <4>  call dos_get_cursor
  1136                              <4> %else
  1137                              <4>  %error 'todo: windows'
  1138                              <4> %endif
  1175                              <3>  %ifstr %1
  1176                              <3>  section .data
  1177                              <3>  %%msg: db %1, 0
  1178                              <3>  section .text
  1179                              <3>  mov bl, %2
  1180                              <3>  mov si, PTR16(%%msg)
  1181                              <3>  call PutStrColor
  1182                              <3>  %else
  1183                              <3>  %ifidni %1, DI
  1184                              <3>  section .text
  1185 00000F31 B301                <3>  mov bl, %2
  1186 00000F33 E851FF              <3>  call PutStrColor
  1187                              <3>  %elifidni %1, SI
  1188                              <3>  section .text
  1189                              <3>  mov bl, %2
  1190                              <3>  call PutStrColor
  1191                              <3>  %else
  1192                              <3>  %assign __count 0
  1193                              <3>  %assign __varg 0
  1194                              <3>  %assign __stop 0
  1195                              <3>  %rep MAX_ARGV
  1196                              <3>  %if __stop == 0
  1197                              <3>  %assign __count (__count + 1)
  1198                              <3>  %ifidni %1, ARGV_%+__count
  1199                              <3>  %assign __varg __count
  1200                              <3>  %assign __stop 1
  1201                              <3>  %endif
  1202                              <3>  %endif
  1203                              <3>  %endrep
  1204                              <3>  %if __varg > 0
  1205                              <3>  section .text
  1206                              <3>  mov si, PTR16(_cA_cmd_buf)
  1207                              <3>  mov bl, __varg
  1208                              <3>  call getCommandLine_Arg
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  section .text
  1212                              <3>  mov bl, %2
  1213                              <3>  mov si, PTR16(_cA_%1)
  1214                              <3>  call PutStrColor
  1215                              <3>  %endif
  1216                              <3>  %undef __varg
  1217                              <3>  %endif
  1218                              <3>  %endif
  1219                              <3> %else
  1220                              <3>  %error 'this macro is only for DOS programming.'
  1221                              <3> %endif
    23                              <2> 
    24                              <2>     .next:
    25 00000F36 8A04                <2>     mov  al, [si]       ; get src byte
    26 00000F38 8A1D                <2>     mov  bl, [di]       ; get dst byte
    27                              <2>     
    28 00000F3A 84C0                <2>     test al, al         ; found terminator ?
    29 00000F3C 740C                <2>     jz   .term          ; yes -> end
    30 00000F3E 84DB                <2>     test bl, bl         ; found terminator ?
    31 00000F40 7408                <2>     jz   .term          ; yes -> end
    32                              <2>     
    33 00000F42 38D8                <2>     cmp  al, bl         ; dst == src ?
    34 00000F44 7509                <2>     jne  .not_equal     ; no ?
    35                              <2>     
    36 00000F46 46                  <2>     inc  si             ; next src pos.
    37 00000F47 47                  <2>     inc  di             ; next dst pos.
    38 00000F48 EBEC                <2>     jmp  .next          ; check
    39                              <2>     
    40                              <2>     .term:
    41 00000F4A 5F                  <2>     pop  di             ; restore di
    42 00000F4B 5E                  <2>     pop  si             ; restore si
    43 00000F4C B000                <2>     mov  al, 0          ; found/same, ret
    44 00000F4E C3                  <2>     ret                 ; return to caller
    45                              <2>     
    46                              <2>     .not_equal:
    47 00000F4F 5F                  <2>     pop  di             ; restore < di
    48 00000F50 5E                  <2>     pop  si             ; restore < si
    49 00000F51 B001                <2>     mov  al, 1          ; not found, ret
    50 00000F53 C3                  <2>     ret                 ; return to caller
  1426                              <1> %include 'StrCopy.asm'              ; copy a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCopy.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; Quelle: DS:SI (ASCIIZ)
    11                              <2> ; Ziel:   ES:DI   (hier setzen wir ES=DS für Daten im selben Segment)
    12                              <2> ; Rückgabe: SI = Zielstart (damit PUTS_COLOR direkt funktioniert)
    13                              <2> ; Clobbers: AX, CX, DI, ES, BX, FLAGS
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> string_copy:
    16 00000F54 53                  <2>     push    bx
    17 00000F55 56                  <2>     push    si
    18                              <2> 
    19                              <2>     ; ES = DS (falls Ziel im selben Segment)
    20 00000F56 1E                  <2>     push    ds
    21 00000F57 07                  <2>     pop     es
    22                              <2> 
    23 00000F58 89FB                <2>     mov     bx, di          ; Zielstart merken
    24 00000F5A B93F00              <2>     mov     cx, 63          ; (optional) max. 63 Zeichen + 0
    25                              <2> 
    26                              <2>     .copy:
    27 00000F5D AC                  <2>     lodsb
    28 00000F5E AA                  <2>     stosb
    29 00000F5F 84C0                <2>     test    al, al
    30 00000F61 7406                <2>     jz      .done
    31 00000F63 E2F8                <2>     loop    .copy
    32 00000F65 26C60500            <2>     mov     byte [es:di], 0
    33                              <2> 
    34                              <2>     .done:
    35 00000F69 89DE                <2>     mov     si, bx          ; <- WICHTIG: SI auf Zielstart setzen
    36 00000F6B 5B                  <2>     pop     bx              ; ursprüngliches SI verwerfen (gewollt)
    37 00000F6C 5B                  <2>     pop     bx              ; wiederherstellen von BX
    38 00000F6D C3                  <2>     ret
  1427                              <1> 
  1428                              <1> code16_end:
    15                                  
    16                                  section .data
    17                                  %include 'data16.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  data16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> data16_start:
     9                              <1> 
    10 00000024 546869732070726F67- <1> msg:            db "This program requieres MS-Windows.$",0
    10 0000002D 72616D207265717569- <1>
    10 00000036 65726573204D532D57- <1>
    10 0000003F 696E646F77732E2400  <1>
    11 00000048 4F70656E206572726F- <1> msgErr:         db 'Open error AX=', '$'
    11 00000051 722041583D24        <1>
    12                              <1> 
    13                              <1> 
    14                              <1> ASTR dos_cap2A,  "ein Text", 0
   375 00000057 65696E205465787400- <2> _cA_%1: db %2, 0
   375 00000060 00                  <2>
   376                              <2> _cA_%1_end:
   377                              <2> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
    15                              <1> ASTR dos_prompt, "Eingabe:       ", 0
   375 00000061 45696E676162653A20- <2> _cA_%1: db %2, 0
   375 0000006A 2020202020200000    <2>
   376                              <2> _cA_%1_end:
   377                              <2> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
    16                              <1> 
    17 00000072 0D0A24              <1> crlf:            db 13,10,'$'
    18 00000075 07                  <1> dos_color:       db 0x07
    19                              <1> 
    20                              <1> ; -----------------------------------------------------------------------------
    21                              <1> ; Buffer-Struktur für AH=0Ah:
    22                              <1> ; [0] = maxlen, [1] = len(out), [2..] = Text, danach CR
    23                              <1> ; -----------------------------------------------------------------------------
    24                              <1> BUFSZ            equ 64
    25 00000076 3E                  <1> _cA_dos_buffer:  db BUFSZ-2       ; Max. Eingabezeichen (ohne die 2 Verwaltungsbytes)
    26 00000077 00                  <1>                  db 0             ; tatsächliche Länge (OUT)
    27 00000078 00<rep 3Eh>         <1>                  times BUFSZ-2 db 0
    28 000000B6 00                  <1> dos_readln_flag: db 0
    29                              <1> 
    30                              <1> ; -----------------------------------------------------------------------------
    31                              <1> ; \brief DOS console settings ...
    32                              <1> ; -----------------------------------------------------------------------------
    33 000000B7 00                  <1> dos_xpos:           db 0      ; current text cursor column
    34 000000B8 00                  <1> dos_ypos:           db 0      ; current text cursor row
    35 000000B9 00                  <1> dos_page:           db 0      ; current video page
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; dBASE data ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 000000BA 444154412E44424600  <1> _cA_DBFNAME:        db 'DATA.DBF',0
    41                              <1> 
    42 000000C3 644241534520495620- <1> msgTitle:           db 'dBASE IV DBF Header',13,10,'$'
    42 000000CC 444246204865616465- <1>
    42 000000D5 720D0A24            <1>
    43 000000D9 55736167653A204442- <1> msgUsage:           db 'Usage: DBFHEAD <datei.dbf>',13,10,'$'
    43 000000E2 4648454144203C6461- <1>
    43 000000EB 7465692E6462663E0D- <1>
    43 000000F4 0A24                <1>
    44 000000F6 4665686C65723A2044- <1> msgOpenErr:         db 'Fehler: Datei kann nicht geoeffnet werden.',13,10,'$'
    44 000000FF 61746569206B616E6E- <1>
    44 00000108 206E69636874206765- <1>
    44 00000111 6F6566666E65742077- <1>
    44 0000011A 657264656E2E0D0A24  <1>
    45 00000123 4665686C65723A204C- <1> msgReadErr:         db 'Fehler: Lesen fehlgeschlagen.',13,10,'$'
    45 0000012C 6573656E206665686C- <1>
    45 00000135 67657363686C616765- <1>
    45 0000013E 6E2E0D0A24          <1>
    46 00000143 56657273696F6E2028- <1> msgVer:             db 'Version (hex): $'
    46 0000014C 686578293A2024      <1>
    47 00000153 446174756D20285959- <1> msgDate:            db 'Datum (YY-MM-DD): $'
    47 0000015C 2D4D4D2D4444293A20- <1>
    47 00000165 24                  <1>
    48 00000166 416E7A61686C204461- <1> msgRecs:            db 'Anzahl Datensaetze (hex): $'
    48 0000016F 74656E736165747A65- <1>
    48 00000178 2028686578293A2024  <1>
    49 00000181 4865616465726C6165- <1> msgHdr:             db 'Headerlaenge (bytes): $'
    49 0000018A 6E6765202862797465- <1>
    49 00000193 73293A2024          <1>
    50 00000198 5361747A6C61656E67- <1> msgRec:             db 'Satzlaenge (bytes): $'
    50 000001A1 652028627974657329- <1>
    50 000001AA 3A2024              <1>
    51 000001AD 4D44582D466C616720- <1> msgMDX:             db 'MDX-Flag (hex): $'
    51 000001B6 28686578293A2024    <1>
    52 000001BE 4C616E677561676520- <1> msgLang:            db 'Language Driver ID (hex): $'
    52 000001C7 447269766572204944- <1>
    52 000001D0 2028686578293A2024  <1>
    53 000001D9 46656C6465723A0D0A- <1> msgFields:          db 'Felder:',13,10,'$'
    53 000001E2 24                  <1>
    54 000001E3 4B65696E652046656C- <1> msgNoFields:        db 'Keine Felder gefunden.',13,10,'$'
    54 000001EC 64657220676566756E- <1>
    54 000001F5 64656E2E0D0A24      <1>
    55 000001FC 202046656C64202324  <1> msgFieldN:          db '  Feld #$'
    56 00000205 3A2024              <1> msgColonSp:         db ': $'
    57 00000208 2C2024              <1> msgCommaSp:         db ', $'
    58 0000020B 202F2024            <1> msgSlash:           db ' / $'
    59                              <1> 
    60 0000020F 55736167653A204442- <1> _cA_msg_usage:          db 'Usage: DBFMAKE <type:3|4> <CREATE|APPEND> <C|I|F|B|D|T> <feldname> <feldlaenge>', 0
    60 00000218 464D414B45203C7479- <1>
    60 00000221 70653A337C343E203C- <1>
    60 0000022A 4352454154457C4150- <1>
    60 00000233 50454E443E203C437C- <1>
    60 0000023C 497C467C427C447C54- <1>
    60 00000245 3E203C66656C646E61- <1>
    60 0000024E 6D653E203C66656C64- <1>
    60 00000257 6C61656E67653E00    <1>
    61 0000025F 4665686C65723A2041- <1> _cA_msg_badargs:        db 'Fehler: Argumente ungueltig.',0
    61 00000268 7267756D656E746520- <1>
    61 00000271 756E6775656C746967- <1>
    61 0000027A 2E00                <1>
    62 0000027C 4665686C65723A2044- <1> _cA_msg_openfail:       db 'Fehler: Datei kann nicht geoeffnet/erstellt werden.',0
    62 00000285 61746569206B616E6E- <1>
    62 0000028E 206E69636874206765- <1>
    62 00000297 6F6566666E65742F65- <1>
    62 000002A0 727374656C6C742077- <1>
    62 000002A9 657264656E2E00      <1>
    63 000002B0 4665686C65723A2044- <1> _cA_msg_ver_mismatch:   db 'Fehler: DBF-Typ passt nicht zur Datei.',0
    63 000002B9 42462D547970207061- <1>
    63 000002C2 737374206E69636874- <1>
    63 000002CB 207A75722044617465- <1>
    63 000002D4 692E00              <1>
    64 000002D7 415050454E44206162- <1> _cA_msg_append_recs:    db 'APPEND abgelehnt: Datei enthaelt Datensaetze (nicht unterstuetzt).',0
    64 000002E0 67656C65686E743A20- <1>
    64 000002E9 446174656920656E74- <1>
    64 000002F2 6861656C7420446174- <1>
    64 000002FB 656E736165747A6520- <1>
    64 00000304 286E6963687420756E- <1>
    64 0000030D 74657273747565747A- <1>
    64 00000316 74292E00            <1>
    65 0000031A 492F4F2D4665686C65- <1> _cA_msg_ioerr:          db 'I/O-Fehler.',0
    65 00000323 722E00              <1>
    66 00000326 4665686C65723A2075- <1> _cA_msg_badheader:      db 'Fehler: ungueltiger Header/Felddeskriptor.',0
    66 0000032F 6E6775656C74696765- <1>
    66 00000338 72204865616465722F- <1>
    66 00000341 46656C646465736B72- <1>
    66 0000034A 6970746F722E00      <1>
    67 00000351 4E6963687420756E74- <1> _cA_msg_not_supported:  db 'Nicht unterstuetzt: Feldtyp nur mit Typ 4.',0
    67 0000035A 657273747565747A74- <1>
    67 00000363 3A2046656C64747970- <1>
    67 0000036C 206E7572206D697420- <1>
    67 00000375 54797020342E00      <1>
    68 0000037C 4F4B3A204E65756520- <1> _cA_msg_ok_create:      db 'OK: Neue DBF mit einem Feld erstellt (DATA.DBF).',0
    68 00000385 444246206D69742065- <1>
    68 0000038E 696E656D2046656C64- <1>
    68 00000397 2065727374656C6C74- <1>
    68 000003A0 2028444154412E4442- <1>
    68 000003A9 46292E00            <1>
    69 000003AD 4F4B3A2046656C6420- <1> msg_ok_append:      db 'OK: Feld an bestehende leere DBF angehaengt.',0
    69 000003B6 616E20626573746568- <1>
    69 000003BF 656E6465206C656572- <1>
    69 000003C8 652044424620616E67- <1>
    69 000003D1 656861656E67742E00  <1>
    70 000003DA 48696E776569733A20- <1> msg_fieldexists:    db 'Hinweis: Feld bereits vorhanden; keine Aenderung vorgenommen.',0
    70 000003E3 46656C642062657265- <1>
    70 000003EC 69747320766F726861- <1>
    70 000003F5 6E64656E3B206B6569- <1>
    70 000003FE 6E652041656E646572- <1>
    70 00000407 756E6720766F726765- <1>
    70 00000410 6E6F6D6D656E2E00    <1>
    71                              <1> 
    72 00000418 43524541544500      <1> str_CREATE:         db 'CREATE',0
    73 0000041F 415050454E4400      <1> str_APPEND:         db 'APPEND',0
    74                              <1> 
    75                              <1> ; ---- Daten ----
    76 00000426 6E6F20617267732E00  <1> _cA_noargs_msg:     db 'no args.', 0
    77 0000042F 475A2E45584500      <1> _cA_GzipAppName:    db 'GZ.EXE', 0
    78 00000436 65786563206F662067- <1> _cA_GzipErrorMsg:   db 'exec of gzip.exe failed.', 0
    78 0000043F 7A69702E6578652066- <1>
    78 00000448 61696C65642E00      <1>
    79                              <1> 
    80                              <1> ; Kommandozeile im PSP-Format:
    81                              <1> ; Byte 0: Länge (Anzahl Zeichen)
    82                              <1> ; Danach die Zeichen, abgeschlossen mit 0Dh (CR).
    83                              <1> ; Üblicherweise beginnt die Tail mit einem Leerzeichen vor dem ersten Argument.
    84                              <1> 
    85                              <1> GzipCmdTail:
    86 0000044F 0E                  <1>     db GzipCmdTextEnd - GzipCmdText          ; Länge
    87                              <1> GzipCmdText:
    88 00000450 202D64206D6F64756C- <1>     db ' -d modul1.biz'
    88 00000459 312E62697A          <1>
    89                              <1> GzipCmdTextEnd:
    90 0000045E 0D                  <1>     db 13
    91                              <1> 
    92                              <1> ; -----------------------------------------------------------------------------
    93                              <1> ; \brief DOS error code messages for int 0x21 function 0x3D (open file)
    94                              <1> ; -----------------------------------------------------------------------------
    95 0000045F 756E6B6E6F776E2065- <1> _cA_open_error_nd:  db 'unknown error.',0
    95 00000468 72726F722E00        <1>
    96 0000046E 696E76616C69642066- <1> _cA_open_error_01:  db 'invalid function / wrong AH code.', 0
    96 00000477 756E6374696F6E202F- <1>
    96 00000480 2077726F6E67204148- <1>
    96 00000489 20636F64652E00      <1>
    97 00000490 66696C65206E6F7420- <1> _cA_open_error_02:  db 'file not found.', 0
    97 00000499 666F756E642E00      <1>
    98 000004A0 70617468206E6F7420- <1> _cA_open_error_03:  db 'path not found.', 0
    98 000004A9 666F756E642E00      <1>
    99 000004B0 746F6F206D616E7920- <1> _cA_open_error_04:  db 'too many open files.', 0
    99 000004B9 6F70656E2066696C65- <1>
    99 000004C2 732E00              <1>
   100 000004C5 616363657373206465- <1> _cA_open_error_05:  db 'access denied.', 0
   100 000004CE 6E6965642E00        <1>
   101 000004D4 696E76616C69642066- <1> _cA_open_error_06:  db 'invalid file handle', 0
   101 000004DD 696C652068616E646C- <1>
   101 000004E6 6500                <1>
   102 000004E8 6D63622F6172656E61- <1> _cA_open_error_07:  db 'mcb/arena corrupted.', 0
   102 000004F1 20636F727275707465- <1>
   102 000004FA 642E00              <1>
   103 000004FD 6E6F206D6F7265206D- <1> _cA_open_error_08:  db 'no more memory.', 0
   103 00000506 656D6F72792E00      <1>
   104 0000050D 696E76616C6964206D- <1> _cA_open_error_09:  db 'invalid memory address.', 0
   104 00000516 656D6F727920616464- <1>
   104 0000051F 726573732E00        <1>
   105 00000525 696E76616C69642065- <1> _cA_open_error_0A:  db 'invalid environment.', 0
   105 0000052E 6E7669726F6E6D656E- <1>
   105 00000537 742E00              <1>
   106 0000053A 6578652F636F6D2066- <1> _cA_open_error_0B:  db 'exe/com format error..', 0
   106 00000543 6F726D617420657272- <1>
   106 0000054C 6F722E2E00          <1>
   107 00000551 696E76616C69642061- <1> _cA_open_error_0C:  db 'invalid access token.', 0
   107 0000055A 636365737320746F6B- <1>
   107 00000563 656E2E00            <1>
   108 00000567 6461746120696E666F- <1> _cA_open_error_0D:  db 'data informations are invalid.', 0
   108 00000570 726D6174696F6E7320- <1>
   108 00000579 61726520696E76616C- <1>
   108 00000582 69642E00            <1>
   109 00000586 696E76616C6964206D- <1> _cA_open_error_0E:  db 'invalid memory block.', 0
   109 0000058F 656D6F727920626C6F- <1>
   109 00000598 636B2E00            <1>
   110 0000059C 696E76616C69642064- <1> _cA_open_error_0F:  db 'invalid drive.', 0
   110 000005A5 726976652E00        <1>
   111 000005AB 747269656420746F20- <1> _cA_open_error_10:  db 'tried to delete current directory.', 0
   111 000005B4 64656C657465206375- <1>
   111 000005BD 7272656E7420646972- <1>
   111 000005C6 6563746F72792E00    <1>
   112 000005CE 66696C65206F6E206F- <1> _cA_open_error_11:  db 'file on other drive.', 0
   112 000005D7 746865722064726976- <1>
   112 000005E0 652E00              <1>
   113 000005E3 6E6F206D6F72652066- <1> _cA_open_error_12:  db 'no more files/file already exists.', 0
   113 000005EC 696C65732F66696C65- <1>
   113 000005F5 20616C726561647920- <1>
   113 000005FE 6578697374732E00    <1>
   114 00000606 6472697665206E6F74- <1> _cA_open_error_15:  db 'drive not ready.', 0
   114 0000060F 2072656164792E00    <1>
   115 00000617 6D6564696120646F65- <1> _cA_open_error_1D:  db 'media does not support seek.', 0
   115 00000620 73206E6F7420737570- <1>
   115 00000629 706F7274207365656B- <1>
   115 00000632 2E00                <1>
   116 00000634 7365656B206572726F- <1> _cA_open_error_1E:  db 'seek error.', 0
   116 0000063D 722E00              <1>
   117 00000640 6472697665206E6F74- <1> _cA_open_error_1F:  db 'drive not available.', 0
   117 00000649 20617661696C61626C- <1>
   117 00000652 652E00              <1>
   118 00000655 66696C652063616E20- <1> _cA_open_error_20:  db 'file can not overwrite.', 0
   118 0000065E 6E6F74206F76657277- <1>
   118 00000667 726974652E00        <1>
   119 0000066D 6472697665206E6F74- <1> _cA_open_error_21:  db 'drive not ready.', 0
   119 00000676 2072656164792E00    <1>
   120 0000067E 6E6F20646973632063- <1> _cA_open_error_27:  db 'no disc capacities.', 0
   120 00000687 617061636974696573- <1>
   120 00000690 2E00                <1>
   121                              <1> 
   122                              <1> ; --- Daten ---
   123 00000692 4D4F44554C312E4249- <1> _cA_mod_filename:       db 'MODUL1.BIN',0
   123 0000069B 4E00                <1>
   124                              <1> 
   125 0000069D 6D6F64756C65206669- <1> _cA_mod_read_error:     db 'module file not found.',0
   125 000006A6 6C65206E6F7420666F- <1>
   125 000006AF 756E642E00          <1>
   126 000006B4 6F70656E2066696C65- <1> _cA_mod_file_error:     db 'open file error.',0
   126 000006BD 206572726F722E00    <1>
   127 000006C5 66726565206572726F- <1> _cA_mod_free_error:     db 'free error.',0
   127 000006CE 722E00              <1>
   128 000006D1 6D656D6F7279206E6F- <1> _cA_mod_free_error_no:  db 'memory not freed.',0
   128 000006DA 742066726565642E00  <1>
   129 000006E3 636C6F736520657272- <1> _cA_mod_clos_error:     db 'close error.',0
   129 000006EC 6F722E00            <1>
   130 000006F0 66696C65206E6F7420- <1> _cA_mod_clos_error_no:  db 'file not close error.',0
   130 000006F9 636C6F736520657272- <1>
   130 00000702 6F722E00            <1>
   131 00000706 6E6F206572726F7220- <1> _cA_mod_have_error_no:  db 'no error found.',0
   131 0000070F 666F756E642E00      <1>
   132                              <1> 
   133                              <1> ; -----------------------------------------------------------------------------
   134                              <1> ; --- Tabelle: [Fehlercode, Handler] ... 0 = Ende ---
   135                              <1> ; -----------------------------------------------------------------------------
   136                              <1> ERR_ITEMS   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,             0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,                   0x10, 0x11, 0x12, 0x15, 0x1D, 0x1E, 0x1F,                   0x20, 0x21, 0x27
  1587                              <2> _cA_error_dispatch:
  1588                              <2>  %rep %0
  1589                              <2>  _HEX2 %1, __H, __L
  1590                              <2>  dw %1, _cA_errh%+__H%+__L
  1591                              <2>  %undef __H
  1592                              <2>  %undef __L
  1593                              <2>  %rotate 1
  1594                              <2>  %endrep
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000716 0100[DA0B]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000071A 0200[EB0B]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000071E 0300[FC0B]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000722 0400[0D0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000726 0500[1E0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000072A 0600[2F0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000072E 0700[400C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000732 0800[510C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000736 0900[620C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000073A 0A00[730C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000073E 0B00[840C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000742 0C00[950C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000746 0D00[A60C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000074A 0E00[B70C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000074E 0F00[C80C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000752 1000[D90C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000756 1100[EA0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000075A 1200[FB0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000075E 1500[0C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000762 1D00[1C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000766 1E00[2C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000076A 1F00[3C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 0000076E 2000[4C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000772 2100[5C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1589                              <3>  _HEX2 %1, __H, __L
  1535                              <4>  %assign __v %1
  1536                              <4>  %assign __v __v & 0FFh
  1537                              <4>  %assign __hi (__v >> 4) & 0Fh
  1538                              <4>  %assign __lo __v & 0Fh
  1539                              <4>  _HEXDIG __hi, %2
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1540                              <4>  _HEXDIG __lo, %3
  1513                              <5>  %if %1 < 10
  1514                              <5>  %define %2 %1
  1515                              <5>  %elif %1 = 10
  1516                              <5>  %define %2 A
  1517                              <5>  %elif %1 = 11
  1518                              <5>  %define %2 B
  1519                              <5>  %elif %1 = 12
  1520                              <5>  %define %2 C
  1521                              <5>  %elif %1 = 13
  1522                              <5>  %define %2 D
  1523                              <5>  %elif %1 = 14
  1524                              <5>  %define %2 E
  1525                              <5>  %elif %1 = 15
  1526                              <5>  %define %2 F
  1527                              <5>  %else
  1528                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1529                              <5>  %endif
  1541                              <4>  %undef __v
  1542                              <4>  %undef __hi
  1543                              <4>  %undef __lo
  1590 00000776 2700[6C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1591                              <3>  %undef __H
  1592                              <3>  %undef __L
  1593                              <3>  %rotate 1
  1595 0000077A 0000[7C0D]          <2>  dw 00h, _cA_errhnd
   140                              <1> 
   141 0000077E 0000                <1> _cA_mod_hFile:   dw 0
   142 00000780 0000                <1> mod_seg_ovl:     dw 0
   143 00000782 0000                <1> mod_fsize_lo:    dw 0
   144 00000784 0000                <1> mod_fsize_hi:    dw 0
   145                              <1> 
   146 00000786 48616C6C6F20766F6D- <1> mod_msg:         db 'Hallo vom Loader!$'
   146 0000078F 204C6F616465722124  <1>
   147                              <1> mod_msg_len:     equ ($ - msg)
   148                              <1> 
   149 00000798 0000                <1> hdr_len:            dw 0
   150 0000079A 0000                <1> rec_len:            dw 0
   151                              <1> 
   152                              <1> data16_end:
    18                                  
    19                                  section .bss
    20                                  %include 'bss16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  bss16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> bss16_start:
    10                              <1> 
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief hold DOS command line argument information's ...
    13                              <1> ; -----------------------------------------------------------------------------
    14                              <1> %define MAX_ARGS    7
    15                              <1> struc _cA_COMMAND_LINE
    16 00000000 ??                  <1>     .arg_count      resb 1            ; max. 255 arguments
    17 00000001 <res 40h>           <1>     .arg_str        resb 64           ; max. length = 64 bytes
    18                              <1> endstruc
    19 00000000 <res 1C0h>          <1> _cA_command_args:   resb 64 * MAX_ARGS
    20 000001C0 <res 40h>           <1> _cA_command_arglen: resb 64
    21 00000200 ????                <1> arg_total:          resw 1
    22                              <1> 
    23 00000202 <res 40h>           <1> _cA_cmd_arg_1:      resb 64
    24 00000242 <res 40h>           <1> _cA_cmd_arg_2:      resb 64
    25 00000282 <res 40h>           <1> _cA_cmd_arg_3:      resb 64
    26 000002C2 <res 40h>           <1> _cA_cmd_arg_4:      resb 64
    27 00000302 <res 40h>           <1> _cA_cmd_arg_5:      resb 64
    28 00000342 <res 40h>           <1> _cA_cmd_arg_6:      resb 64
    29 00000382 <res 40h>           <1> _cA_cmd_arg_7:      resb 64
    30                              <1> 
    31 000003C2 <res 100h>          <1> _cA_cmd_buf:        resb 256          ; CMD string
    32 000004C2 <res 82h>           <1> _cA_cmd_buffer:     resb 130
    33                              <1> 
    34                              <1> ; EXEC-Parameterblock (14 Bytes)
    35 00000544 <res Eh>            <1> _cA_ExecBlk:        resb 14
    36                              <1> 
    37 00000552 <res 1000h>         <1> fdescbuf:           resb 4096
    38                              <1> 
    39 00001552 ????????????        <1> buf_hex:            resb 6            ; 4 Hex-Zeichen + '$' + Reserve
    40 00001558 ??????????????      <1> buf_dec:            resb 7            ; 5 Dezimal-Zeichen + '$' + Reserve
    41                              <1> 
    42 0000155F <res 80h>           <1> filename:           resb 128
    43                              <1> _cA_fdbuf:
    44 000015DF <res 800h>          <1> fdbuf:              resb 2048
    45 00001DDF <res 10h>           <1> _cA_namebuf:        resb 16
    46                              <1> 
    47                              <1> hFile:              resw 0
    48                              <1> ; -----------------------------------------------------------------------------
    49                              <1> g_type:             resw 0
    50                              <1> g_cmd:              resb 0
    51                              <1> g_ftype:            resb 0
    52                              <1> g_ftype_mapped:     resb 0
    53                              <1> g_flen:             resw 0
    54                              <1> g_year:             resw 0
    55                              <1> g_month:            resb 0
    56                              <1> g_day:              resb 0
    57                              <1> ; -----------------------------------------------------------------------------
    58                              <1> verByte:            resb 0
    59                              <1> yy:                 resb 0
    60                              <1> mm:                 resb 0
    61                              <1> dd:                 resb 0
    62                              <1> mdx:                resb 0
    63                              <1> lang:               resb 0
    64                              <1> rec32:              resd 0
    65                              <1> 
    66 00001DEF <res 40h>           <1> tokbuf:             resb 64
    67 00001E2F <res Ch>            <1> fldname:            resb 12
    68                              <1> 
    69 00001E3B <res 20h>           <1> header:             resb 32
    70                              <1> fdbuf_size:         resw 0
    71 00001E5B <res 20h>           <1> tempdesc:           resb 32
    72                              <1> 
    73                              <1> ; -----------------------------------------------------------------------------
    74                              <1> 
    75                              <1> buf_seg:            resw 0
    76                              <1> size_lo:            resw 0
    77                              <1> size_hi:            resw 0
    78                              <1> 
    79                              <1> bss16_end:
    21                                  kernel_end:
