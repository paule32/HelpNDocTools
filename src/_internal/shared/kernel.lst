     1                                  ;---------------------------------------------------
     2                                  ; \file  kernel.asm
     3                                  ; \note  (c) 2025 by Jens Kallup - paule32
     4                                  ;        all rights reserved.
     5                                  ;
     6                                  ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                                  ;---------------------------------------------------
     8                                  bits 16
     9                                  org 0
    10                                  %include 'macros.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  macros.inc
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> ; -----------------------------------------------------------------------------
    10                              <1> ; \brief some pre-defines, to make maintain easier ...
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> %define ERROR_Win32API 'this macro can only be use with win32api (Windows).'
    13                              <1> 
    14                              <1> ; -----------------------------------------------------------------------------
    15                              <1> ; \brief DOS error codes for int 0x21 - 3Dh
    16                              <1> ; -----------------------------------------------------------------------------
    17                              <1> %define ERROR_INVALID_FUNCTION      0x01
    18                              <1> %define ERROR_FILE_NOT_FOUND        0x02
    19                              <1> %define ERROR_PATH_NOT_FOUND        0x03
    20                              <1> %define ERROR_TOO_MANY_OPEN_FILES   0x04
    21                              <1> %define ERROR_ACCESS_DENIED         0x05
    22                              <1> %define ERROR_INVALID_HANDLE        0x06
    23                              <1> %define ERROR_ARENA_TRASHED         0x07
    24                              <1> %define ERROR_NOT_ENOUGH_MEMORY     0x08
    25                              <1> %define ERROR_INVALID_ACCESS        0x0C
    26                              <1> %define ERROR_INVALID_DRIVE         0x0F
    27                              <1> %define ERROR_CURRENT_DIRECTORY     0x10
    28                              <1> %define ERROR_NOT_SAME_DEVICE       0x11
    29                              <1> %define ERROR_NO_MORE_FILES         0x12
    30                              <1> %define ERROR_SEEK                  0x1D
    31                              <1> %define ERROR_NOT_DOS_DISK          0x1E
    32                              <1> 
    33                              <1> ; -----------------------------------------------------------------------------
    34                              <1> ; \brief DOS file open modes ...
    35                              <1> ; -----------------------------------------------------------------------------
    36                              <1> %define DOS_READ_ONLY   0x00    ; read  only
    37                              <1> %define DOS_WRITE_ONLY  0x01    ; write only
    38                              <1> %define DOS_READWRITE   0x02    ; read/write
    39                              <1> 
    40                              <1> ; -----------------------------------------------------------------------------
    41                              <1> ; \brief DOS file seek constants ...
    42                              <1> ; -----------------------------------------------------------------------------
    43                              <1> %define SEEK_BEGIN      0x00    ; begin of file
    44                              <1> %define SEEK_SET        0x01    ; current position
    45                              <1> %define SEEK_END        0x02    ; file end
    46                              <1> 
    47                              <1> ; -----------------------------------------------------------------------------
    48                              <1> ; \brief DOS console settings ...
    49                              <1> ; -----------------------------------------------------------------------------
    50                              <1> %define ATTR_DOS_ERROR              0x0E | 0x10     ; yeloow on blue bakcground
    51                              <1> 
    52                              <1> %define MAX_ARGV        32      ; maximum count of command line arguments
    53                              <1> 
    54                              <1> %ifndef PTR16
    55                              <1> %define PTR16(sym) (sym-code16_start+0x100)
    56                              <1> %endif
    57                              <1> 
    58                              <1> %ifndef PTR64
    59                              <1> %define PTR64(sym) (IMAGE_BASE + RVA_DATA(sym))
    60                              <1> %endif
    61                              <1> 
    62                              <1> ; -----------------------------------------------------------------------------
    63                              <1> ; \brief perform a system call (in this case a DOS int 0x21 call)
    64                              <1> ; -----------------------------------------------------------------------------
    65                              <1> %macro SysCall 0
    66                              <1> %if DOS_SHELL == 1
    67                              <1>     int 0x21        ; DOS interrupt 0x21
    68                              <1> %endif
    69                              <1> %endmacro
    70                              <1> %macro VideoCall 0
    71                              <1> %if DOS_SHELL == 1
    72                              <1>     int 0x10
    73                              <1> %else
    74                              <1>     %error 'only DOS supports interrupts.'
    75                              <1> %endif
    76                              <1> %endmacro
    77                              <1> 
    78                              <1> ; -----------------------------------------------------------------------------
    79                              <1> ; add win64 abi shadow ...
    80                              <1> ; -----------------------------------------------------------------------------
    81                              <1> %macro AddShadow 0-1
    82                              <1> %if %0 == 1
    83                              <1>     sub     rsp, %1
    84                              <1> %else
    85                              <1>     sub     rsp, SW_SHADOW
    86                              <1> %endif
    87                              <1> %endmacro
    88                              <1> 
    89                              <1> ; -----------------------------------------------------------------------------
    90                              <1> ; delete added win64 abi shadow ...
    91                              <1> ; -----------------------------------------------------------------------------
    92                              <1> %macro DelShadow 0-1
    93                              <1> %if %0 == 1
    94                              <1>     add     rsp, %1
    95                              <1> %else
    96                              <1>     add     rsp, SW_SHADOW
    97                              <1> %endif
    98                              <1> %endmacro
    99                              <1> 
   100                              <1> ; -----------------------------------------------------------------------------
   101                              <1> ; MAKE_INT <Label>, <Func1>, <Func2>, ...
   102                              <1> ; -----------------------------------------------------------------------------
   103                              <1> %macro MAKE_INT 2-*
   104                              <1> %1:
   105                              <1> %assign __n %0-1
   106                              <1> %rep __n
   107                              <1>     dq RVA_IDATA(HN_win32_%2)
   108                              <1>     %rotate 1
   109                              <1> %endrep
   110                              <1>     dq 0
   111                              <1> %endmacro
   112                              <1> 
   113                              <1> ; -----------------------------------------------------------------------------
   114                              <1> ; MAKE_IAT <Label>, <Func1>, <Func2>, ...
   115                              <1> ; -----------------------------------------------------------------------------
   116                              <1> %macro MAKE_IAT 2-*
   117                              <1> iat_win32_%1:
   118                              <1> %assign __n %0-1
   119                              <1> %rep __n
   120                              <1> IAT_win32_%2: dq RVA_IDATA(HN_win32_%2)
   121                              <1>     %rotate 1
   122                              <1> %endrep
   123                              <1>     dq 0
   124                              <1> %endmacro
   125                              <1> 
   126                              <1> ; -----------------------------------------------------------------------------
   127                              <1> ; HNSTR <Func1>, <Func2>, ...
   128                              <1> ; -----------------------------------------------------------------------------
   129                              <1> %macro HNSTR 1-*
   130                              <1> %assign __n %0
   131                              <1> %rep __n
   132                              <1> HN_win32_%1: dw 0
   133                              <1>     db %str(%1), 0
   134                              <1> %rotate 1
   135                              <1> %endrep
   136                              <1> %endmacro
   137                              <1> 
   138                              <1> ; -----------------------------------------------------------------------------
   139                              <1> ; MAKE_IMPORT <dir_label>, <mod1>, <mod2>, ...
   140                              <1> ; erzeugt:
   141                              <1> ; dir_label:
   142                              <1> ;   dd RVA_IDATA(INT_<mod>), 0,0, RVA_IDATA(dll_<mod>), RVA_IDATA(iat_<mod>) ...
   143                              <1> ;   dd 0,0,0,0,0
   144                              <1> ; dir_label_end:
   145                              <1> ; -----------------------------------------------------------------------------
   146                              <1> %macro MAKE_IMPORT 1-*
   147                              <1>     %define __DIR %1
   148                              <1>     %1:
   149                              <1>     %assign __n %0-1
   150                              <1>     %rep __n
   151                              <1>         dd RVA_IDATA(INT_win32_%2)
   152                              <1>         dd 0,0
   153                              <1>         dd RVA_IDATA(dll_win32_%2)
   154                              <1>         dd RVA_IDATA(iat_win32_%2)
   155                              <1>         %rotate 1
   156                              <1>     %endrep
   157                              <1>         dd 0,0,0,0,0
   158                              <1>     __DIR %+ _end:
   159                              <1>     %undef __DIR
   160                              <1> %endmacro
   161                              <1> 
   162                              <1> ; -----------------------------------------------------------------------------
   163                              <1> ; mini helper ...
   164                              <1> ; -----------------------------------------------------------------------------
   165                              <1> %macro WIN64_PROLOG 0
   166                              <1>     mov rbp, rsp
   167                              <1>     and rsp, -16
   168                              <1>     AddShadow 32         ; Shadow Space
   169                              <1> %endmacro
   170                              <1> 
   171                              <1> %macro CALL_IAT 1        ; CALL_IAT ExitProcess / RegisterClassExW / ...
   172                              <1>     AddShadow
   173                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_%1)
   174                              <1>     call    [rax]
   175                              <1>     DelShadow
   176                              <1> %endmacro
   177                              <1> 
   178                              <1> ; -----------------------------------------------------------------------------
   179                              <1> ; zero register's
   180                              <1> ; -----------------------------------------------------------------------------
   181                              <1> %macro Zero 1
   182                              <1>     xor %1, %1
   183                              <1> %endmacro
   184                              <1> 
   185                              <1> ; -----------------------------------------------------------------------------
   186                              <1> ; UTF-16LE aus ASCII (<=0x7F) schnell schreiben
   187                              <1> ; -----------------------------------------------------------------------------
   188                              <1> %ifndef WSTR_DEBUG
   189                              <1>     %define WSTR_DEBUG 0
   190                              <1> %endif
   191                              <1> 
   192                              <1> ; -----------------------------------------------------------------------------
   193                              <1> ; WSTR <name>, <items...>
   194                              <1> ; items: Strings ("..."), Zahlen (123, 0x41) oder Ausdrücke/Labels
   195                              <1> ; erzeugt:
   196                              <1> ;   _cW_<name>:              dw ... , 0
   197                              <1> ;   _cW_<name>_end:
   198                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   199                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   200                              <1> ; -----------------------------------------------------------------------------
   201                              <1> %macro WSTR 2+
   202                              <1>     %push WSTR
   203                              <1> 
   204                              <1>     ; Namen sichern, damit %rotate keine Probleme macht
   205                              <1>     %define _WSTR_LBL   _cW_%1
   206                              <1>     %define _WSTR_END   _cW_%1_end
   207                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   208                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   209                              <1> 
   210                              <1> _WSTR_LBL:
   211                              <1>     ; restliche Argumente abarbeiten
   212                              <1>     %assign %$nargs %0-1
   213                              <1>     %rotate 1
   214                              <1> 
   215                              <1>     %rep %$nargs
   216                              <1>         %ifstr %1
   217                              <1>             %strlen %$n %1
   218                              <1>             %assign %$i 0
   219                              <1>             %rep %$n
   220                              <1>                 %substr %$c %1 %$i+1,1
   221                              <1>                 dw %$c                      ; eine 16-bit Code Unit 0x00xx
   222                              <1>                 %assign %$i %$i+1
   223                              <1>             %endrep
   224                              <1>         %elifnum %1
   225                              <1>             dw %1                           ; Zahl/Konstante
   226                              <1>         %else
   227                              <1>             dw %1                           ; Label/Equate/Expression
   228                              <1>         %endif
   229                              <1>         %rotate 1
   230                              <1>     %endrep
   231                              <1> 
   232                              <1>     dw 0                                    ; Null-Terminator (1 Word)
   233                              <1> 
   234                              <1> _WSTR_END:
   235                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2) ; Länge in BYTES (ohne Terminator)
   236                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)              ; Länge in WORDS
   237                              <1> 
   238                              <1>     ; Aufräumen
   239                              <1>     %undef _WSTR_LBL
   240                              <1>     %undef _WSTR_END
   241                              <1>     %undef _WSTR_LENB
   242                              <1>     %undef _WSTR_LENW
   243                              <1>     %pop
   244                              <1> %endmacro
   245                              <1> ; -----------------------------------------------------------------------------
   246                              <1> ; WSTRU <name>, <items...>
   247                              <1> ; items:
   248                              <1> ;   - "ASCII/Latin-1-Strings"  -> jedes Zeichen als 16-bit Code Unit 0x00xx
   249                              <1> ;   - Zahlen/Expressions        -> als Unicode-Codepoint interpretiert:
   250                              <1> ;                                 <=0xFFFF (außer Surrogatbereich) -> 1 Word
   251                              <1> ;                                 >0xFFFF -> Surrogatpaar (2 Words)
   252                              <1> ; erzeugt:
   253                              <1> ;   _cW_<name>:              dw ..., 0
   254                              <1> ;   _cW_<name>_end:
   255                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   256                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   257                              <1> ; -----------------------------------------------------------------------------
   258                              <1> ; --- Helper: einen Unicode-Codepoint als UTF-16 ausgeben ---
   259                              <1> ; -----------------------------------------------------------------------------
   260                              <1> %macro __WSTR_EMIT_CP 1
   261                              <1>     %assign __cp (%1)
   262                              <1> 
   263                              <1>     %if __cp < 0
   264                              <1>         %error "WSTR: negativer Codepoint"
   265                              <1>     %elif __cp <= 0xFFFF
   266                              <1>         ; verbiete explizite Surrogat-Codepoints
   267                              <1>         %if __cp >= 0xD800 && __cp <= 0xDFFF
   268                              <1>             %error "WSTR: Codepoint im Surrogatbereich ist ungueltig"
   269                              <1>         %else
   270                              <1>             dw __cp
   271                              <1>         %endif
   272                              <1>     %elif __cp <= 0x10FFFF
   273                              <1>         %assign __tmp (__cp - 0x10000)
   274                              <1>         %assign __hi  (0xD800 + (__tmp >> 10))
   275                              <1>         %assign __lo  (0xDC00 + (__tmp & 0x3FF))
   276                              <1>         dw __hi, __lo
   277                              <1>     %else
   278                              <1>         %error "WSTR: Codepoint > U+10FFFF"
   279                              <1>     %endif
   280                              <1> %endmacro
   281                              <1> 
   282                              <1> ; --- Hauptmakro ---
   283                              <1> %macro WSTRU 2+
   284                              <1>     %push WSTRU
   285                              <1> 
   286                              <1>     %define _WSTR_LBL   _cW_%1
   287                              <1>     %define _WSTR_END   _cW_%1_end
   288                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   289                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   290                              <1> 
   291                              <1> _WSTR_LBL:
   292                              <1>     %assign %$nargs %0-1
   293                              <1>     %rotate 1
   294                              <1> 
   295                              <1>     %rep %$nargs
   296                              <1>         %ifstr %1
   297                              <1>             ; String: byteweise -> 0x00xx
   298                              <1>             %strlen %$n %1
   299                              <1>             %assign %$i 0
   300                              <1>             %rep %$n
   301                              <1>                 %substr %$c %1 %$i+1,1
   302                              <1>                 dw %$c
   303                              <1>                 %assign %$i %$i+1
   304                              <1>             %endrep
   305                              <1>         %elifnum %1
   306                              <1>             ; Zahl/Expression als Unicode-Scalar
   307                              <1>             __WSTR_EMIT_CP %1
   308                              <1>         %else
   309                              <1>             ; Label/Expression, zur Sicherheit ebenfalls als Codepoint behandeln
   310                              <1>             __WSTR_EMIT_CP %1
   311                              <1>         %endif
   312                              <1>         %rotate 1
   313                              <1>     %endrep
   314                              <1> 
   315                              <1>     dw 0
   316                              <1> 
   317                              <1> _WSTR_END:
   318                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2)
   319                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)
   320                              <1> 
   321                              <1>     %undef _WSTR_LBL
   322                              <1>     %undef _WSTR_END
   323                              <1>     %undef _WSTR_LENB
   324                              <1>     %undef _WSTR_LENW
   325                              <1>     %pop
   326                              <1> %endmacro
   327                              <1> 
   328                              <1> ; -----------------------------------------------------------------------------
   329                              <1> ; WSTRUL  <name>, <args...>   -> definiert <name> und <name>_len
   330                              <1> ; (in Codeunits, ohne Null)
   331                              <1> ; -----------------------------------------------------------------------------
   332                              <1> %macro WSTR_AND_LEN 2-*
   333                              <1>     %push WSTRUL
   334                              <1>     %define %$name %1
   335                              <1> %1:
   336                              <1>     WSTRU %2
   337                              <1> %$name %+ _end:
   338                              <1>     %xdefine %$name %+ _len ( ((%$name %+ _end) - (%$name))/2 - 1 )
   339                              <1>     %pop
   340                              <1> %endmacro
   341                              <1> 
   342                              <1> ; -----------------------------------------------------------------------------
   343                              <1> ; Nach JEDEM vorhandenen Stringlabel einfach:
   344                              <1> ;   <label>_end:   (direkt nach dem String)
   345                              <1> ; und dann:
   346                              <1> ; -----------------------------------------------------------------------------
   347                              <1> %macro WSTR_LENGTH 1
   348                              <1>     %xdefine %1_len ( ((%1_end) - (%1))/2 - 1 )
   349                              <1> %endmacro
   350                              <1> 
   351                              <1> %macro AWSTR 1
   352                              <1> %push
   353                              <1> %strlen __n %1
   354                              <1> %assign __i 0
   355                              <1> %rep __n
   356                              <1>     %substr __c %1 __i+1,1
   357                              <1>     dw __c
   358                              <1>     %assign __i __i+1
   359                              <1> %endrep
   360                              <1>     dw 0
   361                              <1> %pop
   362                              <1> %endmacro
   363                              <1> 
   364                              <1> ; -----------------------------------------------------------------------------
   365                              <1> ; \brief String-Definition mit auto *_length (ohne 0-Byte)
   366                              <1> ; \desc  section .data
   367                              <1> ;        ZSTR cap2A, "Hallo", 13, 10
   368                              <1> ;
   369                              <1> ;        ergibt automatisch:
   370                              <1> ;        cap2A          db "Hallo",13,10,0
   371                              <1> ;        cap2A_end:
   372                              <1> ;        %define cap2A_length (cap2A_end - cap2A - 1)
   373                              <1> ; -----------------------------------------------------------------------------
   374                              <1> %macro ASTR 2+                    ; ASTR <name>, <bytes...>
   375                              <1> _cA_%1:       db %2, 0
   376                              <1> _cA_%1_end:
   377                              <1> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   378                              <1> %endmacro
   379                              <1> 
   380                              <1> ; -----------------------------------------------------------------------------
   381                              <1> ; \brief set the string label from %2 to register %1 ...
   382                              <1> ; -----------------------------------------------------------------------------
   383                              <1> %macro GETEXT 2
   384                              <1>     mov     %1, IMAGE_BASE
   385                              <1>     add     %1, RVA_DATA(_cW_%2)
   386                              <1> %endmacro
   387                              <1> 
   388                              <1> ; ------------------------------------------------------------
   389                              <1> ; ---- RVA-Helfer: bleibt wie bei dir ----
   390                              <1> ; %define RVA_DATA(L)   (DATA_VA  + ((L) - data_start))
   391                              <1> ; ------------------------------------------------------------
   392                              <1> ; Optional: einfacher Alias ohne Klammern/EXPR:
   393                              <1> ; ------------------------------------------------------------
   394                              <1> %imacro DATA_ABS 1
   395                              <1>     IMAGE_BASE + RVA_DATA(%1)
   396                              <1> %endmacro
   397                              <1> ; ------------------------------------------------------------
   398                              <1> ; Helfer: absolute VA einer Data-Variable bauen
   399                              <1> ; ------------------------------------------------------------
   400                              <1> %macro DATA_PTR 1
   401                              <1>     (IMAGE_BASE + RVA_DATA(%1))
   402                              <1> %endmacro
   403                              <1> ; ---------------------------------------------------------------------------
   404                              <1> ;; SETDATA <name>, <src> [, <size>]
   405                              <1> ;  - Schreibt <src> an Datenlabel <name>
   406                              <1> ;  - Wenn <size> fehlt, wird die Größe aus <src>-Register abgeleitet
   407                              <1> ;    (al/ax/eax/rax → 8/16/32/64 Bit). Bei Immediate bitte <size> angeben.
   408                              <1> ;  - <size> darf BYTE/WORD/DWORD/QWORD oder 8/16/32/64 sein.
   409                              <1> ; ---------------------------------------------------------------------------
   410                              <1> ;; Beispiele:
   411                              <1> ; last_error: dd 0
   412                              <1> ; orig_attr:  dw 0
   413                              <1> ; flag8:      db 0
   414                              <1> ; ---------------------------------------------------------------------------
   415                              <1> ;; schreiben (Registergröße bestimmt Breite)
   416                              <1> ; mov   eax, 0xDEADBEEF
   417                              <1> ; SETDATA last_error, eax          ; dword write
   418                              <1> ; ---------------------------------------------------------------------------
   419                              <1> ;; schreiben (Immediate -> Größe angeben)
   420                              <1> ; SETDATA orig_attr, 0x000F, WORD  ; word write
   421                              <1> ; SETDATA flag8,     1,      BYTE  ; byte write
   422                              <1> ; ---------------------------------------------------------------------------
   423                              <1> ;; lesen (Registergröße passt)
   424                              <1> ; GETDATA eax, last_error          ; dword read → eax
   425                              <1> ; ---------------------------------------------------------------------------
   426                              <1> ;; lesen (Größe erzwingen)
   427                              <1> ; GETDATA ax,  orig_attr, WORD     ; word read → ax
   428                              <1> ; GETDATA al,  flag8,     BYTE     ; byte read → al
   429                              <1> ; ---------------------------------------------------------------------------
   430                              <1> %macro SET_DATA 1-3
   431                              <1> %if DOS_SHELL == 1
   432                              <1>     %if %0 == 2
   433                              <1>         %ifnum %2
   434                              <1>             section .text
   435                              <1>             lea ax, [PTR16(_cA_%1)]
   436                              <1>             mov ax, %2
   437                              <1>         %endif
   438                              <1>     %elif %0 == 3
   439                              <1>         %ifstr %2
   440                              <1>             %ifndef __var__%1
   441                              <1>                 %define __var__%1 1
   442                              <1>                 section .data
   443                              <1>                 %%__v: db %2, 0
   444                              <1>             %endif
   445                              <1>         %endif
   446                              <1>         section .text
   447                              <1>         lea ax, [PTR16(_cA_%1)]
   448                              <1>         mov ax, %2
   449                              <1>         jmp %3
   450                              <1>     %endif
   451                              <1> %else
   452                              <1>     %error 'tpdo'
   453                              <1> %endif
   454                              <1> %endmacro
   455                              <1> %macro SETDATA 2-3
   456                              <1> %if DOS_SHELL == 1
   457                              <1> %else
   458                              <1>     push    rdx
   459                              <1>     mov     rdx, IMAGE_BASE
   460                              <1>     add     rdx, RVA_DATA(%1)
   461                              <1>     %if %0 = 2
   462                              <1>         mov     [%2], rdx
   463                              <1>         pop     rdx
   464                              <1>     %else
   465                              <1>         pop     rdx
   466                              <1>       %ifidni %3, BYTE
   467                              <1>         mov     byte  [rdx], %2
   468                              <1>       %elifidni %3, WORD
   469                              <1>         mov     word  [rdx], %2
   470                              <1>       %elifidni %3, DWORD
   471                              <1>         mov     dword [rdx], %2
   472                              <1>       %elifidni %3, QWORD
   473                              <1>         mov     qword [rdx], %2
   474                              <1>       %elif %3 = 8
   475                              <1>         mov     byte  [rdx], %2
   476                              <1>       %elif %3 = 16
   477                              <1>         mov     word  [rdx], %2
   478                              <1>       %elif %3 = 32
   479                              <1>         mov     dword [rdx], %2
   480                              <1>       %elif %3 = 64
   481                              <1>         mov     qword [rdx], %2
   482                              <1>       %else
   483                              <1>         %error "SETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   484                              <1>       %endif
   485                              <1>     %endif
   486                              <1> %endif
   487                              <1> %endmacro
   488                              <1> 
   489                              <1> ; ------------------------------------------------------------
   490                              <1> ; GETDATA <dst>, <name> [, <size>]
   491                              <1> ;  - Liest aus Datenlabel <name> in Register <dst>
   492                              <1> ;  - Wenn <size> fehlt, muss <dst> die passende Größe haben
   493                              <1> ;    (al/ax/eax/rax). Sonst <size> angeben (BYTE/WORD/DWORD/QWORD oder 8/16/32/64).
   494                              <1> ; ------------------------------------------------------------
   495                              <1> %macro GETDATA 2-3
   496                              <1>     mov     %1, IMAGE_BASE
   497                              <1>     add     %1, RVA_DATA(%2)
   498                              <1>     %if %0 = 2
   499                              <1>         ;mov     %1, [rdx]
   500                              <1>     %else
   501                              <1>       %ifidni %3, BYTE
   502                              <1>         mov     %1, byte  [rdx]
   503                              <1>       %elifidni %3, WORD
   504                              <1>         mov     %1, word  [rdx]
   505                              <1>       %elifidni %3, DWORD
   506                              <1>         mov     %1, dword [rdx]
   507                              <1>       %elifidni %3, QWORD
   508                              <1>         mov     %1, qword [rdx]
   509                              <1>       %elif %3 = 8
   510                              <1>         mov     %1, byte  [rdx]
   511                              <1>       %elif %3 = 16
   512                              <1>         mov     %1, word  [rdx]
   513                              <1>       %elif %3 = 32
   514                              <1>         mov     %1, dword [rdx]
   515                              <1>       %elif %3 = 64
   516                              <1>         mov     %1, qword [rdx]
   517                              <1>       %else
   518                              <1>         %error "GETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   519                              <1>       %endif
   520                              <1>     %endif
   521                              <1> %endmacro
   522                              <1> 
   523                              <1> %macro Return 0-1
   524                              <1> %if %0 == 1
   525                              <1>     mov eax, %1
   526                              <1> %else
   527                              <1>     ret
   528                              <1> %endif
   529                              <1> %endmacro
   530                              <1> 
   531                              <1> ; -----------------------------------------------------------------------------
   532                              <1> ; condition jump's after function call -> test eax, eax
   533                              <1> ; -----------------------------------------------------------------------------
   534                              <1> %macro CHECK_NZ 1-2
   535                              <1> %if %0 == 2
   536                              <1>     test eax, eax
   537                              <1>     jnz %1
   538                              <1>     jmp %2
   539                              <1> %else
   540                              <1>     test eax, eax
   541                              <1>     jnz %1
   542                              <1> %endif
   543                              <1> %endmacro
   544                              <1> 
   545                              <1> ; -----------------------------------------------------------------------------
   546                              <1> %macro CHECK_NE 1-2
   547                              <1> %if %0 == 2
   548                              <1>     test eax, eax
   549                              <1>     jne %1
   550                              <1>     jmp %2
   551                              <1> %else
   552                              <1>     test eax, eax
   553                              <1>     jne %1
   554                              <1> %endif
   555                              <1> %endmacro
   556                              <1> 
   557                              <1> ; -----------------------------------------------------------------------------
   558                              <1> %macro CHECK_E 1-2
   559                              <1> %if %0 == 2
   560                              <1>     test eax, eax
   561                              <1>     je  %1
   562                              <1>     jmp %2
   563                              <1> %else
   564                              <1>     test eax, eax
   565                              <1>     je  %1
   566                              <1> %endif
   567                              <1> %endmacro
   568                              <1> 
   569                              <1> ; -----------------------------------------------------------------------------
   570                              <1> ; \brief prolog of a assembler routine + 32 Windows 64 Bit shadow
   571                              <1> ; \param optional shadow at start -> int
   572                              <1> ; -----------------------------------------------------------------------------
   573                              <1> %macro FUNC_ENTER 0-1
   574                              <1> %if %0 == 1
   575                              <1>     AddShadow %1
   576                              <1> %else
   577                              <1>     AddShadow
   578                              <1> %endif
   579                              <1>     push    rbp
   580                              <1>     mov     rbp, rsp
   581                              <1> %endmacro
   582                              <1> 
   583                              <1> ; -----------------------------------------------------------------------------
   584                              <1> ; \brief epilog of a assembler routine - 32 Windows 64 Bit shadow
   585                              <1> ; \param optional shadow at end -> int
   586                              <1> ; -----------------------------------------------------------------------------
   587                              <1> %macro FUNC_LEAVE 0-1
   588                              <1> %if %0 == 1
   589                              <1>     DelShadow %1
   590                              <1> %else
   591                              <1>     DelShadow
   592                              <1> %endif
   593                              <1>     pop     rbp
   594                              <1>     ret
   595                              <1> %endmacro
   596                              <1> 
   597                              <1> ; -----------------------------------------------------------------------------
   598                              <1> ; \brief allocate/open a text console window under Windows 11 desktop.
   599                              <1> ; \param ok  -> label
   600                              <1> ; \param err -> label
   601                              <1> ; \since 1.0
   602                              <1> ;
   603                              <1> ; \return bool - 0 no Error; else Error
   604                              <1> ; -----------------------------------------------------------------------------
   605                              <1> %macro call_AllocConsole 2
   606                              <1> %if DOS_SHELL == 1
   607                              <1>     %error ERROR_Win32API
   608                              <1> %else
   609                              <1>     CALL_IAT AllocConsole
   610                              <1>     %if %0 == 2
   611                              <1>         CHECK_NZ %1, %2
   612                              <1>     %endif
   613                              <1> %endif
   614                              <1> %endmacro
   615                              <1> 
   616                              <1> ; -----------------------------------------------------------------------------
   617                              <1> ; \brief call the Windows 10 win32api function ExitProcess, to close the thread
   618                              <1> ; -----------------------------------------------------------------------------
   619                              <1> %macro call_ExitProcess 0-1
   620                              <1> %if DOS_SHELL == 1
   621                              <1>     %error ERROR_Win32API
   622                              <1> %else
   623                              <1>     %if %0 == 1
   624                              <1>         mov rax, %1
   625                              <1>     %else
   626                              <1>         mov rax, 0
   627                              <1>     %endif
   628                              <1>     CALL_IAT ExitProcess
   629                              <1> %endif
   630                              <1> %endmacro
   631                              <1> 
   632                              <1> ; -----------------------------------------------------------------------------
   633                              <1> ; \brief helper function to save source code space for win32api FormatMessageW.
   634                              <1> ; -----------------------------------------------------------------------------
   635                              <1> %macro call_FormatMessageW 0
   636                              <1>     CALL_IAT FormatMessageW
   637                              <1> %endmacro
   638                              <1> 
   639                              <1> ; -----------------------------------------------------------------------------
   640                              <1> ; \brief
   641                              <1> ; -----------------------------------------------------------------------------
   642                              <1> ;macro call_GetConsoleScreenBufferInfo
   643                              <1> ;endmacro
   644                              <1> 
   645                              <1> ; -----------------------------------------------------------------------------
   646                              <1> ; \brief  this macro call the win32api function GetLastError.
   647                              <1> ; \param  nothing
   648                              <1> ; \return ExitCode - int
   649                              <1> ; -----------------------------------------------------------------------------
   650                              <1> %macro call_GetLastError 0
   651                              <1> %if DOS_SHELL == 1
   652                              <1>     %error ERROR_Win32API
   653                              <1> %else
   654                              <1>     CALL_IAT GetLastError
   655                              <1>     test rax, rax
   656                              <1>     jnz  %%ok
   657                              <1>     AddShadow
   658                              <1>     call HandleLastError
   659                              <1>     DelShadow
   660                              <1> %%ok:
   661                              <1> ;ShowMessageW ShowLastW,capW
   662                              <1> %endif
   663                              <1> %endmacro
   664                              <1> 
   665                              <1> ; -----------------------------------------------------------------------------
   666                              <1> ; \brief  get the standard output device.
   667                              <1> ; \param  ok     -> label
   668                              <1> ; \param  error  -> label
   669                              <1> ; \param  handle -> int
   670                              <1> ; \see    AllocConsole
   671                              <1> ; \since  1.0
   672                              <1> ; \return ?
   673                              <1> ; -----------------------------------------------------------------------------
   674                              <1> %macro call_GetStdHandle 3
   675                              <1> %if DOS_SHELL == 1
   676                              <1>     %error ERROR_Win32API
   677                              <1> %else
   678                              <1>     mov ecx, %3
   679                              <1>     CALL_IAT GetStdHandle
   680                              <1>     cmp   rax, -1     ; INVALID_HANDLE_VALUE ?
   681                              <1>     je    %%error     ; yes -> error
   682                              <1>     test  rax, rax    ; 0 ?
   683                              <1>     jz    %%error     ; yes -> error
   684                              <1>     ;
   685                              <1>     mov   r12, rax    ; valid handle in rax
   686                              <1>     jmp   %%ok
   687                              <1> %%error:
   688                              <1>     call HandleLastError
   689                              <1>     jmp  %2
   690                              <1> %%ok:
   691                              <1>     jmp  %1
   692                              <1> %endif
   693                              <1> %endmacro
   694                              <1> 
   695                              <1> %macro call_LoadCursorW 0
   696                              <1> %if DOS_SHELL == 1
   697                              <1>     %error ERROR_Win32API
   698                              <1> %else
   699                              <1>     CALL_IAT LoadCursorW
   700                              <1>     ;ShowMessageW ShowHelloW,capW
   701                              <1>     ;call_GetLastError
   702                              <1> %endif
   703                              <1> %endmacro
   704                              <1> 
   705                              <1> %macro call_LocalFree 0
   706                              <1> %if DOS_SHELL == 1
   707                              <1>     %error ERROR_Win32API
   708                              <1> %else
   709                              <1>     CALL_IAT MessageBoxW
   710                              <1> %endif
   711                              <1> %endmacro
   712                              <1> 
   713                              <1> ; -----------------------------------------------------------------------------
   714                              <1> ; \brief helper macro to shorten code, and call the win32api MessageBox W
   715                              <1> ; -----------------------------------------------------------------------------
   716                              <1> %macro call_MessageBoxW 0
   717                              <1>     CALL_IAT MessageBoxW
   718                              <1> %endmacro
   719                              <1> 
   720                              <1> ; -----------------------------------------------------------------------------
   721                              <1> ; \brief helper macro to shorten code, and call the win32api function wsprintfW
   722                              <1> ; -----------------------------------------------------------------------------
   723                              <1> %macro call_wsprintfW 0
   724                              <1>     CALL_IAT wsprintfW
   725                              <1> %endmacro
   726                              <1> 
   727                              <1> %macro call_WriteConsoleA 0
   728                              <1> %if DOS_SHELL == 1
   729                              <1>     %error ERROR_Win32API
   730                              <1> %else
   731                              <1>     CALL_IAT WriteConsoleA
   732                              <1> %endif
   733                              <1> %endmacro
   734                              <1> 
   735                              <1> ; -----------------------------------------------------------------------------
   736                              <1> ; \brief Write - display text on the Windows Console.
   737                              <1> ; \param 1 -> label -> on error
   738                              <1> ; \param 2 -> label -> text to display
   739                              <1> ; \param 3 -> label -> output handle; default is: STD_OUTPUT_HANDLE
   740                              <1> ; \see   AllocConsole
   741                              <1> ; \since 1.0
   742                              <1> ; -----------------------------------------------------------------------------
   743                              <1> %macro call_User_Write 2-3
   744                              <1> %if DOS_SHELL == 1
   745                              <1>     %error ERROR_Win32API
   746                              <1> %else
   747                              <1> %if %0 == 2
   748                              <1>     call_GetStdHandle %%ok, %1, STD_OUTPUT_HANDLE
   749                              <1> %else
   750                              <1>     call_GetStdHandle %%ok, %1, %3
   751                              <1> %endif
   752                              <1> %%ok:
   753                              <1>     ; --- WriteConsoleA(hOut, fmtHello, hello_len, NULL, NULL) ---
   754                              <1>     mov     rcx, r12                       ; 1. Arg: HANDLE hConsoleOutput
   755                              <1>     mov     rdx, IMAGE_BASE
   756                              <1>     add     rdx, RVA_DATA(%2)              ; 2. Arg: LPCVOID lpBuffer
   757                              <1>     mov     r8d, %2_length                 ; 3. Arg: DWORD nNumberOfCharsToWrite
   758                              <1>     xor     r9d, r9d                       ; lpNumberOfCharsWritten = NULL
   759                              <1>     AddShadow 32 + 8
   760                              <1>     mov     qword [rsp+32], 0              ; 5. Arg: LPVOID lpReserved = NULL
   761                              <1>     call_WriteConsoleA
   762                              <1>     DelShadow 32 + 8
   763                              <1> %endif
   764                              <1> %endmacro
   765                              <1> 
   766                              <1> ; -----------------------------------------------------------------------------
   767                              <1> ; \brief read a string line in console window ...
   768                              <1> ; -----------------------------------------------------------------------------
   769                              <1> %macro call_User_ReadLn 1
   770                              <1>     call user_Console_ReadLn
   771                              <1> %endmacro
   772                              <1> 
   773                              <1> ; -----------------------------------------------------------------------------
   774                              <1> %macro DefWindowProcW 0
   775                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_DefWindowProcW)
   776                              <1> %endmacro
   777                              <1> 
   778                              <1> %macro IAT_CreateWindowExW 0
   779                              <1> %if DOS_SHELL == 1
   780                              <1>     %error ERROR_Win32API
   781                              <1> %else
   782                              <1>     mov     rax, IMAGE_BASE
   783                              <1>     add     rax, RVA_IDATA(IAT_win32_CreateWindowExW)
   784                              <1>     call    [rax]
   785                              <1> %endif
   786                              <1> %endmacro
   787                              <1> ; -----------------------------------------------------------------------------
   788                              <1> 
   789                              <1> ; -----------------------------------------------------------------------------
   790                              <1> ; \brief  DispatchMessageW
   791                              <1> ; \since  1.0
   792                              <1> ; -----------------------------------------------------------------------------
   793                              <1> %macro DispatchMessageW 0
   794                              <1> %if DOS_SHELL == 1
   795                              <1>     %error ERROR_Win32API
   796                              <1> %else
   797                              <1>     mov     rcx, rsi
   798                              <1>     CALL_IAT DispatchMessageW
   799                              <1> %endif
   800                              <1> %endmacro
   801                              <1> 
   802                              <1> ; -----------------------------------------------------------------------------
   803                              <1> ; \brief  ExitProcess terminate the given application thread.
   804                              <1> ; \since  1.0
   805                              <1> ; \param  exitcode -> integer
   806                              <1> ; \return exitcode -> rax
   807                              <1> ; -----------------------------------------------------------------------------
   808                              <1> %macro ExitProcess 0-1 0
   809                              <1> %if DOS_SHELL == 1
   810                              <1>     %error ERROR_Win32API
   811                              <1> %else
   812                              <1>     nop
   813                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   814                              <1>     mov     ecx,%1
   815                              <1>     CALL_IAT ExitProcess
   816                              <1>     ; no return
   817                              <1>     ;DelShadow (32 + 16)
   818                              <1> %endif
   819                              <1> %endmacro
   820                              <1> 
   821                              <1> ; -----------------------------------------------------------------------------
   822                              <1> ; \brief  GetLastError catches the last error that was occured during win32api
   823                              <1> ;         function call.
   824                              <1> ; \since  1.0
   825                              <1> ; \param  nothing
   826                              <1> ; \return ?
   827                              <1> ; -----------------------------------------------------------------------------
   828                              <1> %macro GETLASTERROR 2
   829                              <1>     test    eax, eax
   830                              <1>     %1      %2
   831                              <1> %endmacro
   832                              <1> 
   833                              <1> %macro GetLastError 0
   834                              <1> %if DOS_SHELL == 1
   835                              <1>     %error ERROR_Win32API
   836                              <1> %else
   837                              <1>     CALL_IAT GetLastError
   838                              <1> %endif
   839                              <1> %endmacro
   840                              <1> 
   841                              <1> ; -----------------------------------------------------------------------------
   842                              <1> ; \brief  GetMessageW
   843                              <1> ; -----------------------------------------------------------------------------
   844                              <1> %macro GetMessageW 0
   845                              <1> %if DOS_SHELL == 1
   846                              <1>     %error ERROR_Win32API
   847                              <1> %else
   848                              <1>     mov  rcx, rsi
   849                              <1>     Zero edx
   850                              <1>     Zero r8d
   851                              <1>     Zero r9d
   852                              <1>     CALL_IAT GetMessageW
   853                              <1> %endif
   854                              <1> %endmacro
   855                              <1> 
   856                              <1> ; -----------------------------------------------------------------------------
   857                              <1> ; \brief  LoadCursorW
   858                              <1> ; \since  1.0
   859                              <1> ; \param  id - integer: resource id
   860                              <1> ; -----------------------------------------------------------------------------
   861                              <1> %macro LoadCursorW 1
   862                              <1> %if DOS_SHELL == 1
   863                              <1>     %error ERROR_Win32API
   864                              <1> %else
   865                              <1>     Zero ecx
   866                              <1>     mov  edx, %1
   867                              <1>     CALL_IAT LoadCursorW
   868                              <1> %endif
   869                              <1> %endmacro
   870                              <1> 
   871                              <1> ; -----------------------------------------------------------------------------
   872                              <1> ; \brief  MESSAGE is a style shortner for better read expierences ...
   873                              <1> ; -----------------------------------------------------------------------------
   874                              <1> %macro MESSAGE 2
   875                              <1>     cmp     edx, %1
   876                              <1>     je      .%2
   877                              <1> %endmacro
   878                              <1> 
   879                              <1> ; -----------------------------------------------------------------------------
   880                              <1> ; \brief ShowMessageW display a wide string message on the desktop screen per
   881                              <1> ;        the wn32api.
   882                              <1> ; \since 1.0
   883                              <1> ; \see   ShowMessageA
   884                              <1> ;
   885                              <1> ; \param text_str  -> landet in rdx
   886                              <1> ; \param title_str -> landet in r8
   887                              <1> ;
   888                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
   889                              <1> ; -----------------------------------------------------------------------------
   890                              <1> %macro ShowMessageW 2-3
   891                              <1> %if DOS_SHELL == 1
   892                              <1>     %error ERROR_Win32API
   893                              <1> %else
   894                              <1>     Zero    ecx             ; hWnd = NULL
   895                              <1>     mov     rdx, PTR64(%1)  ; lpText
   896                              <1>     mov     r8,  PTR64(%2)  ; lpCaption    
   897                              <1> %if %0 == 2                 ; %0 = argument count
   898                              <1>     xor     r9d, r9d        ; uType = MB_OK
   899                              <1> %else
   900                              <1>     mov     r9d, %3         ; uType = argument exists
   901                              <1> %endif
   902                              <1>     CALL_IAT MessageBoxW
   903                              <1> %endif
   904                              <1> %endmacro
   905                              <1> 
   906                              <1> ; -----------------------------------------------------------------------------
   907                              <1> ; \brief ShowMessageA display a ansi string message on the desktop screen per
   908                              <1> ;        the wn32api.
   909                              <1> ; \since 1.0
   910                              <1> ; \see   ShowMessageW
   911                              <1> ;
   912                              <1> ; \param text_str  -> landet in rdx
   913                              <1> ; \param title_str -> landet in r8
   914                              <1> ;
   915                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
   916                              <1> ; -----------------------------------------------------------------------------
   917                              <1> %macro ShowMessageA 2-3
   918                              <1> %if DOS_SHELL == 1
   919                              <1>     %error ERROR_Win32API
   920                              <1> %else
   921                              <1>     Zero    ecx
   922                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; "MessageBoxW failed"
   923                              <1>     mov     r8,  IMAGE_BASE + RVA_DATA(_cA_%2)  ; "User32"
   924                              <1> %if %0 == 2                                     ; %0 = argument count
   925                              <1>     xor     r9d, r9d                            ; uType = MB_OK
   926                              <1> %else
   927                              <1>     mov     r9d, %3                             ; uType = argument exists
   928                              <1> %endif
   929                              <1>     CALL_IAT MessageBoxA
   930                              <1> %endif
   931                              <1> %endmacro
   932                              <1> 
   933                              <1> ; -----------------------------------------------------------------------------
   934                              <1> ; \brief  ShowWindow shows the window witht the hwnd id in r13.
   935                              <1> ; \since  1.0
   936                              <1> ; \param  hwnd -> HWND handle window
   937                              <1> ; \param  (optional) flag -> integer: default = SW_SHOWDEFAULT
   938                              <1> ; -----------------------------------------------------------------------------
   939                              <1> %macro ShowWindow 1-2
   940                              <1> %if DOS_SHELL == 1
   941                              <1>     %error ERROR_Win32API
   942                              <1> %else
   943                              <1>     nop
   944                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   945                              <1>     mov     rcx, %1
   946                              <1> %if %0 == 2
   947                              <1>     mov     edx, %2
   948                              <1> %else
   949                              <1>     mov     edx, SW_SHOWDEFAULT
   950                              <1> %endif
   951                              <1>     CALL_IAT ShowWindow
   952                              <1>     ;DelShadow (32 + 16)
   953                              <1> %endif
   954                              <1> %endmacro
   955                              <1> 
   956                              <1> ; -----------------------------------------------------------------------------
   957                              <1> ; \brief display a message box on top of the Windows 11 desktop.
   958                              <1> ; \param text   -> str
   959                              <1> ; \param title  -> str
   960                              <1> ; \param button -> int
   961                              <1> ; -----------------------------------------------------------------------------
   962                              <1> %macro call_ShowMessageW 5
   963                              <1>     ShowMessageW %3, %4, %5
   964                              <1>     CHECK_NZ %1, %2
   965                              <1> %endmacro
   966                              <1> 
   967                              <1> ; -----------------------------------------------------------------------------
   968                              <1> ; \brief  TranslateMessage
   969                              <1> ; \since  1.0
   970                              <1> ; -----------------------------------------------------------------------------
   971                              <1> %macro TranslateMessage 0
   972                              <1> %if DOS_SHELL == 1
   973                              <1>     %error ERROR_Win32API
   974                              <1> %else
   975                              <1>     mov     rcx, rsi
   976                              <1>     CALL_IAT TranslateMessage
   977                              <1> %endif
   978                              <1> %endmacro
   979                              <1> 
   980                              <1> ; -----------------------------------------------------------------------------
   981                              <1> ; \brief  UpdateWindow refresh the window properties and draw.
   982                              <1> ; \since  1.0
   983                              <1> ;
   984                              <1> ; \see    Invalidate
   985                              <1> ; \see    Repaint
   986                              <1> ;
   987                              <1> ; \param  hwnd -> HWND handle of window to update
   988                              <1> ; -----------------------------------------------------------------------------
   989                              <1> %macro UpdateWindow 1
   990                              <1> %if DOS_SHELL == 1
   991                              <1>     %error ERROR_Win32API
   992                              <1> %else
   993                              <1>     mov     rcx, %1
   994                              <1>     CALL_IAT UpdateWindow
   995                              <1> %endif
   996                              <1> %endmacro
   997                              <1> 
   998                              <1> ; -----------------------------------------------------------------------------
   999                              <1> ; \brief set the length of a given ASCII string to register ...
  1000                              <1> ; -----------------------------------------------------------------------------
  1001                              <1> %macro SETLEN 2
  1002                              <1>     mov      %1, %2_length
  1003                              <1> %endmacro
  1004                              <1> 
  1005                              <1> ; -----------------------------------------------------------------------------
  1006                              <1> ; \brief write ASCII text on the text Windows console ...
  1007                              <1> ; -----------------------------------------------------------------------------
  1008                              <1> %macro WRITE_CON_A 1-2
  1009                              <1> %if DOS_SHELL == 1
  1010                              <1>     %if %0 == 2
  1011                              <1>         PUTS_COLOR %1, %2
  1012                              <1>     %else
  1013                              <1>         PUTS_COLOR %1, 0x07
  1014                              <1>     %endif
  1015                              <1> %else
  1016                              <1>     ; prepare
  1017                              <1>     xor      eax, eax
  1018                              <1>     mov      rcx, PTR64(_cA_%1)
  1019                              <1>     call     GET_STR_LEN
  1020                              <1>     mov      r14, rax
  1021                              <1>     GET_CON_O_HANDLE r12
  1022                              <1>     mov      rcx, r12
  1023                              <1>     mov      rdx, PTR64(_cA_%1)
  1024                              <1>     mov      r8 , r14
  1025                              <1>     xor      r9d, r9d
  1026                              <1>     mov      qword [rsp+32], 0
  1027                              <1>     CALL_IAT WriteConsoleA
  1028                              <1> %endif
  1029                              <1> %endmacro
  1030                              <1> 
  1031                              <1> ; -----------------------------------------------------------------------------
  1032                              <1> ; \brief read utf-8 text on the text Windows console ...
  1033                              <1> ; \param dst -> buffer for the "readln" text
  1034                              <1> ; -----------------------------------------------------------------------------
  1035                              <1> %macro READL_CON_A 0-1
  1036                              <1> %if DOS_SHELL == 1
  1037                              <1>     %if  %0 == 1
  1038                              <1>         mov  dx, PTR16(_cA_%1)
  1039                              <1>         call DOSReadLn
  1040                              <1>     %else
  1041                              <1>         mov  dx, PTR16(_cA_dos_buffer)
  1042                              <1>         call DOSReadLn
  1043                              <1>     %endif
  1044                              <1> %else
  1045                              <1>     ; prepare
  1046                              <1>     GET_CON_I_HANDLE  r13
  1047                              <1>     ; ReadConsoleA(hIn, inbuf, maxChars, &read, NULL)
  1048                              <1>     mov      rcx, r13
  1049                              <1>     mov      rdx, PTR64(_cA_%1)
  1050                              <1>     mov      r8d, 127           ; maxChars (Reserviere 1 Byte für NUL)
  1051                              <1>     mov      r9 , PTR64(written)
  1052                              <1>     xor      rax, rax           ; lpReserved = NULL (über Shadow Space)
  1053                              <1>     mov      [rsp+32], rax
  1054                              <1>     CALL_IAT ReadConsoleA
  1055                              <1> %endif
  1056                              <1> %endmacro
  1057                              <1> 
  1058                              <1> ; -----------------------------------------------------------------------------
  1059                              <1> ; \brief integer to string
  1060                              <1> ;
  1061                              <1> ; \param number -> register (number to convert)
  1062                              <1> ; \param buffer -> destination buffer
  1063                              <1> ; -----------------------------------------------------------------------------
  1064                              <1> %macro INT2STR 2
  1065                              <1>     mov     edx, %2                             ; number to convert
  1066                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; destination buffer
  1067                              <1>     call    u32_to_dec                          ; buffer -> "12345",0 ; RAX = 5
  1068                              <1> %endmacro
  1069                              <1> 
  1070                              <1> ; -----------------------------------------------------------------------------
  1071                              <1> ; \brief concatenate two strings (%2, %3) to a given string destionation (%1).
  1072                              <1> ; \param dst  -> string buffer
  1073                              <1> ; \param src1 -> string 0-terminated
  1074                              <1> ; \param src2 -> string 0-terminated
  1075                              <1> ; -----------------------------------------------------------------------------
  1076                              <1> %macro STRCPY_ANSI 3
  1077                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)
  1078                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%2)
  1079                              <1>     mov     r8 , IMAGE_BASE + RVA_DATA(_cA_%3)
  1080                              <1>     call    concat_ansi
  1081                              <1> %endmacro
  1082                              <1> %macro STRCAT_ANSI 2-*
  1083                              <1>     %xdefine __DSTSYM (_cA_%1 + 4)
  1084                              <1> 
  1085                              <1>     %rotate 1                     ; ab hier ist %1 der erste src
  1086                              <1>     %rep %0-1
  1087                              <1>         ; --- Ende von dst finden: RDI zeigt nach REPNZ SCASB auf Byte NACH '\0'
  1088                              <1>         mov     rdi, IMAGE_BASE
  1089                              <1>         add     rdi, RVA_DATA(__DSTSYM)
  1090                              <1>         xor     eax, eax          ; AL = 0
  1091                              <1>         mov     rcx, -1
  1092                              <1>         repne   scasb
  1093                              <1>         lea     rcx, [rdi - 1]    ; RCX -> Position des '\0' (Schreibposition)
  1094                              <1> 
  1095                              <1>         ; einen Source anhängen: (s1 = aktueller, s2 = leer)
  1096                              <1>         mov     rdx, PTR64(_cA_%1)
  1097                              <1>         mov     r8 , PTR64(_cA_empty)
  1098                              <1>         call    concat_ansi
  1099                              <1> 
  1100                              <1>         %rotate 1                 ; nächster src
  1101                              <1>     %endrep
  1102                              <1> %endmacro
  1103                              <1> 
  1104                              <1> ; -----------------------------------------------------------------------------
  1105                              <1> ; \brief get the output handle of allocated/open console ...
  1106                              <1> ; \param register to store output handle
  1107                              <1> ; -----------------------------------------------------------------------------
  1108                              <1> %macro GET_CON_O_HANDLE 1
  1109                              <1> %if DOS_SHELL == 1
  1110                              <1>     %error ERROR_Win32API
  1111                              <1> %else
  1112                              <1>     mov      ecx, STD_OUTPUT_HANDLE
  1113                              <1>     CALL_IAT GetStdHandle
  1114                              <1>     mov      %1, rax         ; hOut
  1115                              <1> %endif
  1116                              <1> %endmacro
  1117                              <1> ; -----------------------------------------------------------------------------
  1118                              <1> ; \brief get the input handle of allocated/open console ...
  1119                              <1> ; \param register to store input handle
  1120                              <1> ; -----------------------------------------------------------------------------
  1121                              <1> %macro GET_CON_I_HANDLE 1
  1122                              <1> %if DOS_SHELL == 1
  1123                              <1>     %error ERROR_Win32API
  1124                              <1> %else
  1125                              <1>     mov      ecx, STD_INPUT_HANDLE
  1126                              <1>     CALL_IAT GetStdHandle
  1127                              <1>     mov      %1, rax         ; hIn
  1128                              <1> %endif
  1129                              <1> %endmacro
  1130                              <1> 
  1131                              <1> %macro SCREEN_CLEAR 0
  1132                              <1> %if DOS_SHELL == 1
  1133                              <1>     call dos_screen_clear
  1134                              <1> %else
  1135                              <1>     GET_CON_O_HANDLE r12
  1136                              <1>     STRCPY_ANSI buffer_B, consoleColor_3, empty
  1137                              <1>     WRITE_CON_A buffer_B
  1138                              <1> %endif
  1139                              <1> %endmacro
  1140                              <1> 
  1141                              <1> ; -----------------------------------------------------------------------------
  1142                              <1> ; \brief set the cursor position in dos console ...
  1143                              <1> ; \param xpos - <imm>
  1144                              <1> ; \param ypos - <imm>
  1145                              <1> ; -----------------------------------------------------------------------------
  1146                              <1> %macro SET_CURSOR 2
  1147                              <1> %if %0 == 0
  1148                              <1>     %error 2 argument missing
  1149                              <1> %endif
  1150                              <1> %if DOS_SHELL == 1
  1151                              <1>     mov  dl, %1         ; column
  1152                              <1>     mov  dh, %2         ; row
  1153                              <1>     call dos_set_cursor
  1154                              <1> %else
  1155                              <1> %endif
  1156                              <1> %endmacro
  1157                              <1> 
  1158                              <1> ; -----------------------------------------------------------------------------
  1159                              <1> ; \brief get the cursor position in dos console ...
  1160                              <1> ; -----------------------------------------------------------------------------
  1161                              <1> %macro GET_CURSOR 0
  1162                              <1> %if DOS_SHELL == 1
  1163                              <1>     call dos_get_cursor
  1164                              <1> %else
  1165                              <1>     %error 'todo: windows'
  1166                              <1> %endif
  1167                              <1> %endmacro
  1168                              <1> 
  1169                              <1> ; -----------------------------------------------------------------------------
  1170                              <1> ; \brief set the color for console window text
  1171                              <1> ; \param 1. background -> int 0..255
  1172                              <1> ; \param 2. foreground -> int 0..255
  1173                              <1> ;
  1174                              <1> ; \desc  color values > 127 == blink chars
  1175                              <1> ; -----------------------------------------------------------------------------
  1176                              <1> %macro SET_COLOR_TO 2
  1177                              <1> %if %0 == 2
  1178                              <1>     STRCPY_ANSI buffer_B, consoleColor_1, empty
  1179                              <1>     STRCAT_ANSI buffer_B,                                     console_color_%1, buffer_semi,                console_color_%2, consoleColor_2
  1182                              <1>     WRITE_CON_A buffer_B
  1183                              <1> %endif
  1184                              <1> %endmacro
  1185                              <1> 
  1186                              <1> ; -----------------------------------------------------------------------------
  1187                              <1> ; \brief 
  1188                              <1> ; -----------------------------------------------------------------------------
  1189                              <1> %macro ARG_CURSOR 2
  1190                              <1> %if DOS_SHELL == 1
  1191                              <1>     GET_ARG  %1             ; save command line argument 1
  1192                              <1>     mov  bl, %2             ; color
  1193                              <1>     call PutStrColor        ; DOS screen
  1194                              <1> %endif
  1195                              <1> %endmacro
  1196                              <1> 
  1197                              <1> ; -----------------------------------------------------------------------------
  1198                              <1> ; \brief macro to put a colored string to the DOS console ...
  1199                              <1> ; -----------------------------------------------------------------------------
  1200                              <1> %macro PUTS_COLOR 2
  1201                              <1> %if DOS_SHELL == 1
  1202                              <1>     GET_CURSOR              ; move cursor to col:row
  1203                              <1>     %ifstr %1
  1204                              <1>         section .data
  1205                              <1>         %%msg: db %1, 0
  1206                              <1>         section .text
  1207                              <1>         mov  bl, %2                 ; color
  1208                              <1>         mov  si, PTR16(%%msg)       ; text 0-terminated
  1209                              <1>         call PutStrColor            ; DOS screen
  1210                              <1>     %else
  1211                              <1>         %ifidni %1, DI
  1212                              <1>             section .text
  1213                              <1>             mov  bl, %2
  1214                              <1>             call PutStrColor        ; DOS screen
  1215                              <1>         %elifidni %1, SI            ; text is already in SI
  1216                              <1>             section .text
  1217                              <1>             mov  bl, %2             ; color
  1218                              <1>             call PutStrColor        ; DOS screen
  1219                              <1>         %else
  1220                              <1>             %assign __count 0
  1221                              <1>             %assign __varg  0
  1222                              <1>             %assign __stop  0
  1223                              <1>             %rep MAX_ARGV
  1224                              <1>                 %if __stop == 0
  1225                              <1>                     %assign __count (__count + 1)
  1226                              <1>                     %ifidni %1, ARGV_%+__count
  1227                              <1>                         %assign __varg __count
  1228                              <1>                         %assign __stop 1
  1229                              <1>                     %endif
  1230                              <1>                 %endif
  1231                              <1>             %endrep
  1232                              <1>             %if __varg > 0
  1233                              <1>                 section .text
  1234                              <1>                 mov  si, PTR16(_cA_cmd_buf)
  1235                              <1>                 mov  bl, __varg
  1236                              <1>                 call getCommandLine_Arg
  1237                              <1>                 call PutStrColor        ; DOS screen
  1238                              <1>             %else
  1239                              <1>                 section .text
  1240                              <1>                 mov  bl, %2             ; color
  1241                              <1>                 mov  si, PTR16(_cA_%1)  ; text 0-terminated
  1242                              <1>                 call PutStrColor        ; DOS screen
  1243                              <1>             %endif
  1244                              <1>             %undef __varg
  1245                              <1>         %endif
  1246                              <1>     %endif
  1247                              <1> %else
  1248                              <1>     %error 'this macro is only for DOS programming.'
  1249                              <1> %endif
  1250                              <1> %endmacro
  1251                              <1> 
  1252                              <1> ; -----------------------------------------------------------------------------
  1253                              <1> ; \brief  get the length of given label string
  1254                              <1> ; \param  1. label name/addr
  1255                              <1> ; \return CX = length of string
  1256                              <1> ; -----------------------------------------------------------------------------
  1257                              <1> %macro STRLEN 1
  1258                              <1> %if %0 == 1
  1259                              <1>     mov  si, PTR16(_cA_%1)
  1260                              <1>     call DOSStrLen
  1261                              <1>     mov  ax, cx             ; AX = length
  1262                              <1>     add  cx, 1              ; CX = length + 1
  1263                              <1> %else
  1264                              <1>     %error 'exactly one argument expected.'
  1265                              <1> %endif
  1266                              <1> %endmacro
  1267                              <1> 
  1268                              <1> ; -----------------------------------------------------------------------------
  1269                              <1> ; \brief  helper macro save code resources.
  1270                              <1> ; \desc   return to DOS with exit code
  1271                              <1> ; \param  1. exit code value (0..255).
  1272                              <1> ; \return nothing
  1273                              <1> ; -----------------------------------------------------------------------------
  1274                              <1> %macro DOS_Exit 1
  1275                              <1> %if DOS_SHELL == 1
  1276                              <1>     %ifidni   %1, ax
  1277                              <1>         %error 'AX not allowed here.'
  1278                              <1>     %elifidni %1, bx
  1279                              <1>         mov ax, 0x4C00
  1280                              <1>         or  ax, bx
  1281                              <1>         SysCall
  1282                              <1>     %elifidni %1, CX
  1283                              <1>         mov ax, 0x4C00
  1284                              <1>         or  ax, cx
  1285                              <1>         SysCall
  1286                              <1>     %elifidni %1, dx
  1287                              <1>         mov ax, 0x4C00
  1288                              <1>         or  ax, dx
  1289                              <1>         SysCall
  1290                              <1>     %elifnum  %1
  1291                              <1>         mov  ax, 0x4C00 | %1
  1292                              <1>         SysCall
  1293                              <1>     %else
  1294                              <1>         %error 'BX, CX, DX or <NUM> expected.'
  1295                              <1>     %endif
  1296                              <1> %endif
  1297                              <1> %endmacro
  1298                              <1> 
  1299                              <1> ; -----------------------------------------------------------------------------
  1300                              <1> ; \brief  print a CRLF on DOS console
  1301                              <1> ; \param  nothing
  1302                              <1> ; \return nothing
  1303                              <1> ; -----------------------------------------------------------------------------
  1304                              <1> %macro DOS_crlf 0
  1305                              <1>     call DOSrncrlf
  1306                              <1> %endmacro
  1307                              <1> 
  1308                              <1> ; -----------------------------------------------------------------------------
  1309                              <1> ; \brief write a string in DX to DOS console without "lf", and no "cr" ...
  1310                              <1> ; \param 1. DX - src label
  1311                              <1> ; \see   DOS_WriteLn
  1312                              <1> ; -----------------------------------------------------------------------------
  1313                              <1> %macro DOS_Write 1
  1314                              <1>     lea  dx, [PTR16(_cA_%1)]
  1315                              <1>     call DOS_ConsoleWrite
  1316                              <1> %endmacro
  1317                              <1> 
  1318                              <1> ; -----------------------------------------------------------------------------
  1319                              <1> ; \brief write a string in DX to DOS console with "lf", and "cr" ...
  1320                              <1> ; \param 1. DX - src label
  1321                              <1> ; \see   DOS_Write
  1322                              <1> ; -----------------------------------------------------------------------------
  1323                              <1> %macro DOS_WriteLn 1
  1324                              <1>     DOS_Write %1
  1325                              <1>     DOS_crlf
  1326                              <1> %endmacro
  1327                              <1> 
  1328                              <1> ; -----------------------------------------------------------------------------
  1329                              <1> ; \brief allocate memory for/in the DOS console ...
  1330                              <1> ; \param 1. count paragraphs
  1331                              <1> ; \note  calculate with: 4096 / 16 = 256 (4096 is a example !)
  1332                              <1> ; -----------------------------------------------------------------------------
  1333                              <1> %macro DOS_AllocMem 1
  1334                              <1> %if DOS_SHELL == 1
  1335                              <1>     mov  ax, 4800h      ; AH = 48h -> Allocate Memory Block
  1336                              <1>     mov  bx, %1         ; Paragraph-Anzahl
  1337                              <1>     SysCall
  1338                              <1>     
  1339                              <1>     sbb  ax, ax
  1340                              <1>     cmp  ax, 0
  1341                              <1>     je   %%.successful
  1342                              <1>     
  1343                              <1>     cmp  ax, 0xFF
  1344                              <1>     je   %%.fail        ; CF = 1 -> error, AX = error code
  1345                              <1>     
  1346                              <1>     jmp  %%.fail
  1347                              <1>     
  1348                              <1>     %%.successful:
  1349                              <1>     ; AX = Segment des Blocks
  1350                              <1>     mov  es, ax
  1351                              <1>     xor  di, di
  1352                              <1>     
  1353                              <1>     ; Block mit 0x00 füllen
  1354                              <1>     mov  cx, 4096
  1355                              <1>     mov  al, 0x00
  1356                              <1>     rep  stosb          ; write to ES:DI
  1357                              <1>     
  1358                              <1>     ; demo read access: AL = ES:[1234]
  1359                              <1>     ;mov  di, 1234
  1360                              <1>     ;mov  al, [es:di]
  1361                              <1>     
  1362                              <1>     jmp   %%.next
  1363                              <1>     
  1364                              <1>     %%.fail:
  1365                              <1>     DOS_WriteLn msg_alloc_error
  1366                              <1>     DOS_Exit    1
  1367                              <1>     
  1368                              <1>     %%.next:
  1369                              <1> %endif
  1370                              <1> %endmacro
  1371                              <1> 
  1372                              <1> %macro DOS_FreeMem 0
  1373                              <1> %if DOS_SHELL == 1
  1374                              <1>     mov es, ax
  1375                              <1>     mov ah, 0x49
  1376                              <1>     SysCall
  1377                              <1> %else
  1378                              <1>     %error 'todo: windows'
  1379                              <1> %endif
  1380                              <1> %endmacro
  1381                              <1> 
  1382                              <1> ; -----------------------------------------------------------------------------
  1383                              <1> ; \brief COMPARE <reg>, <imm>, <label>
  1384                              <1> ; \param 1. <reg>
  1385                              <1> ; \param 2. <imm>
  1386                              <1> ; \param 3. <label>
  1387                              <1> ; \note  example: COMPARE al, 0x0a, printed
  1388                              <1> ;        result:  cmp <reg>, <imm>  /  je <label>
  1389                              <1> ; -----------------------------------------------------------------------------
  1390                              <1> %macro COMPARE 3
  1391                              <1>     cmp %1, %2
  1392                              <1>     je  %3
  1393                              <1> %endmacro
  1394                              <1> 
  1395                              <1> ; -----------------------------------------------------------------------------
  1396                              <1> ; \brief  get the n-th command line, success: jump to %2 ...
  1397                              <1> ; \param  1. <imm>
  1398                              <1> ; \return SI = text (=argument)
  1399                              <1> ; \note   example: GET_ARG 2
  1400                              <1> ;         result:  <text> in SI
  1401                              <1> ; -----------------------------------------------------------------------------
  1402                              <1> %macro GET_ARG 1-2
  1403                              <1> %if DOS_SHELL == 1
  1404                              <1>     lea  si, [PTR16(_cA_cmd_buf)]
  1405                              <1>     mov  bl, %1
  1406                              <1>     call getCommandLine_Arg
  1407                              <1>     %if %0 == 2
  1408                              <1>         jnc  %2
  1409                              <1>     %endif
  1410                              <1> %else
  1411                              <1>     %error 'todo: windows'
  1412                              <1> %endif
  1413                              <1> %endmacro
  1414                              <1> 
  1415                              <1> ; -----------------------------------------------------------------------------
  1416                              <1> ; \brief save the n-th command line argument to the <label>
  1417                              <1> ; \param 1. <imm> -> n-th argument number
  1418                              <1> ; \param 2. <label>
  1419                              <1> ; \note  example: SET_ARG <imm>, <label>
  1420                              <1> ; -----------------------------------------------------------------------------
  1421                              <1> %macro SET_ARG 1-2
  1422                              <1> %if DOS_SHELL == 1
  1423                              <1>     %if %0 == 1
  1424                              <1>         GET_ARG  %1
  1425                              <1>         STR_COPY _cA_cmd_arg_%1
  1426                              <1>     %else
  1427                              <1>         GET_ARG  %1
  1428                              <1>         STR_COPY _cA_%2
  1429                              <1>     %endif
  1430                              <1> %else
  1431                              <1>     %error 'todo: windows'
  1432                              <1> %endif
  1433                              <1> %endmacro
  1434                              <1> 
  1435                              <1> ; -----------------------------------------------------------------------------
  1436                              <1> ; \brief copy a string from source index SI to DI <label>
  1437                              <1> ; \param 1. <label>
  1438                              <1> ; \note  example: STR_COPY <label>
  1439                              <1> ; -----------------------------------------------------------------------------
  1440                              <1> %macro STR_COPY 1
  1441                              <1> %if DOS_SHELL == 1
  1442                              <1>     lea  di, [%1]       ; ES wird in string_copy gesetzt
  1443                              <1>     call string_copy    ; kommt zurück mit SI = Zielstart
  1444                              <1> %else
  1445                              <1>     %error 'todo: windows'
  1446                              <1> %endif
  1447                              <1> %endmacro
  1448                              <1> 
  1449                              <1> ; -----------------------------------------------------------------------------
  1450                              <1> ; \brief short'ner to get the command line arguments given by the user input.
  1451                              <1> ; \brief initialize a console application ...
  1452                              <1> ; \param nothing
  1453                              <1> ; -----------------------------------------------------------------------------
  1454                              <1> %macro INIT_COMMAND_LINE 0
  1455                              <1> %if DOS_SHELL == 1
  1456                              <1>     call dos_get_command_line
  1457                              <1> %else
  1458                              <1>     %error 'todo: windows'
  1459                              <1> %endif
  1460                              <1> %endmacro
  1461                              <1> 
  1462                              <1> ; -----------------------------------------------------------------------------
  1463                              <1> ; \brief call the DOS console initialize routine ...
  1464                              <1> ; -----------------------------------------------------------------------------
  1465                              <1> %macro INIT_CONSOLE 0
  1466                              <1> %if DOS_SHELL == 1
  1467                              <1>     call dos_init_console
  1468                              <1>     SCREEN_CLEAR
  1469                              <1> %else
  1470                              <1>     call init_app
  1471                              <1>     call init_console
  1472                              <1> %endif
  1473                              <1> %endmacro
  1474                              <1> 
  1475                              <1> ; -----------------------------------------------------------------------------
  1476                              <1> ; \brief generischer Handler für einen Fehlercode ...
  1477                              <1> ; -----------------------------------------------------------------------------
  1478                              <1> %macro DEF_ERROR 2
  1479                              <1> _h%1:
  1480                              <1>     PUTS_COLOR %2, ATTR_DOS_ERROR
  1481                              <1>     mov   cx, %1
  1482                              <1>     jmp   _open_exit
  1483                              <1> %endmacro
  1484                              <1> 
  1485                              <1> ; -----------------------------------------------------------------------------
  1486                              <1> ; \brief DOS seek to <origin> in file <handle> ...
  1487                              <1> ; \param 1. <file handle>
  1488                              <1> ; \param 2. <origin> 0 - begin of file, 1 - current position, 2 - end of file
  1489                              <1> ; -----------------------------------------------------------------------------
  1490                              <1> %macro DOS_Seek 2
  1491                              <1> %if DOS_SHELL == 1
  1492                              <1>     mov  bx, [PTR16(_cA_%1)]
  1493                              <1>     xor  cx, cx
  1494                              <1>     xor  dx, dx
  1495                              <1>     mov  ah, 0x42               ; move to ...
  1496                              <1>     mov  al, %2
  1497                              <1>     SysCall
  1498                              <1> %else
  1499                              <1>     %error 'todo: windows'
  1500                              <1> %endif
  1501                              <1> %endmacro
  1502                              <1> 
  1503                              <1> ; -----------------------------------------------------------------------------
  1504                              <1> ; \brief DOS open existing <file name>
  1505                              <1> ; \param 1. <file name>
  1506                              <1> ; \param 2. <open mode> - DOS_READ_ONLY, DOW_WRITE_ONLY, DOS_READWRITE
  1507                              <1> ; -----------------------------------------------------------------------------
  1508                              <1> %macro DOS_Open 2
  1509                              <1> %if DOS_SHELL == 1
  1510                              <1>     mov  dx, PTR16(_cA_%1)
  1511                              <1>     mov  ah, 0x3D               ; open existing file
  1512                              <1>     mov  al, %2                 ; read-only
  1513                              <1>     SysCall
  1514                              <1> %else
  1515                              <1>     %error 'todo: windows'
  1516                              <1> %endif
  1517                              <1> %endmacro
  1518                              <1> 
  1519                              <1> %macro DOS_Close 2
  1520                              <1> %if DOS_SHELL == 1
  1521                              <1>     mov  bx, [PTR16(_cA_%1)]
  1522                              <1>     or   bx, bx
  1523                              <1>     jz   %2
  1524                              <1>     mov  ah, 3Eh
  1525                              <1>     SysCall
  1526                              <1> %else
  1527                              <1>     %error 'todo: windows'
  1528                              <1> %endif
  1529                              <1> %endmacro
  1530                              <1> 
  1531                              <1> ; -----------------------------------------------------------------------------
  1532                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1533                              <1> ; erzeugt für jedes Argument:
  1534                              <1> ; _cA_errn<arg>:
  1535                              <1> ;     PUTS_COLOR open_error_<arg>, ATTR_DOS_ERROR
  1536                              <1> ;     mov cx, <arg>
  1537                              <1> ;     jmp _open_exit
  1538                              <1> ; -----------------------------------------------------------------------------
  1539                              <1> ; Hilfsmakro: Nibble (0..15) -> Hex-Zeichen 0..F
  1540                              <1> %macro _HEXDIG 2
  1541                              <1>   %if %1 < 10
  1542                              <1>     %define %2 %1
  1543                              <1>   %elif %1 = 10
  1544                              <1>     %define %2 A
  1545                              <1>   %elif %1 = 11
  1546                              <1>     %define %2 B
  1547                              <1>   %elif %1 = 12
  1548                              <1>     %define %2 C
  1549                              <1>   %elif %1 = 13
  1550                              <1>     %define %2 D
  1551                              <1>   %elif %1 = 14
  1552                              <1>     %define %2 E
  1553                              <1>   %elif %1 = 15
  1554                              <1>     %define %2 F
  1555                              <1>   %else
  1556                              <1>     %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <1>   %endif
  1558                              <1> %endmacro
  1559                              <1> ; -----------------------------------------------------------------------------
  1560                              <1> ; expr -> zwei Hex-Zeichen OUT_H/OUT_L (ohne 0x/h), 8-bit
  1561                              <1> ; -----------------------------------------------------------------------------
  1562                              <1> %macro _HEX2 3
  1563                              <1>   %assign __v %1
  1564                              <1>   %assign __v __v & 0FFh
  1565                              <1>   %assign __hi (__v >> 4) & 0Fh
  1566                              <1>   %assign __lo  __v       & 0Fh
  1567                              <1>   _HEXDIG __hi, %2
  1568                              <1>   _HEXDIG __lo, %3
  1569                              <1>   %undef __v
  1570                              <1>   %undef __hi
  1571                              <1>   %undef __lo
  1572                              <1> %endmacro
  1573                              <1> ; -----------------------------------------------------------------------------
  1574                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1575                              <1> ; Baut Labels / Namen mit zwei Hex-Ziffern (00..FF), ohne 0x/h.
  1576                              <1> ; -----------------------------------------------------------------------------
  1577                              <1> %macro ERR_HANDLER 1-*
  1578                              <1> %rep %0
  1579                              <1>     ; Ausdruck auswerten (dezimal/hex ok) und auf 8 Bit begrenzen
  1580                              <1>     %assign __v %1
  1581                              <1>     %assign __v __v & 0FFh
  1582                              <1> 
  1583                              <1>     ; zwei Hex-Ziffern bilden
  1584                              <1>     %assign __hi (__v >> 4) & 0Fh
  1585                              <1>     %assign __lo  __v       & 0Fh
  1586                              <1>     _HEXDIG __hi, __H
  1587                              <1>     _HEXDIG __lo, __L
  1588                              <1> 
  1589                              <1> _cA_errh%+__H%+__L:
  1590                              <1>     PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <1>     mov cx, %1
  1592                              <1>     jmp _open_exit
  1593                              <1>     
  1594                              <1>     ; Aufräumen der temporären Namen dieser Iteration
  1595                              <1>     %undef __H
  1596                              <1>     %undef __L
  1597                              <1>     %undef __hi
  1598                              <1>     %undef __lo
  1599                              <1>     %undef __v
  1600                              <1>     
  1601                              <1>     %rotate 1
  1602                              <1> %endrep
  1603                              <1> %endmacro
  1604                              <1> ; -----------------------------------------------------------------------------
  1605                              <1> ; Für jeden Code: Label _cA_errhXX + Body
  1606                              <1> ;
  1607                              <1> ; ---------- Tabelle (Datenbereich) ----------
  1608                              <1> ; ERZEUGT: 
  1609                              <1> ;   _cA_error_dispatch:
  1610                              <1> ;       dw <code>, _cA_errhXX
  1611                              <1> ;       ...
  1612                              <1> ;       dw 00h, _cA_errhnd
  1613                              <1> ; -----------------------------------------------------------------------------
  1614                              <1> %macro ERR_ITEMS 1-*
  1615                              <1> _cA_error_dispatch:
  1616                              <1>   %rep %0
  1617                              <1>     _HEX2 %1, __H, __L
  1618                              <1>     dw %1, _cA_errh%+__H%+__L
  1619                              <1>     %undef __H
  1620                              <1>     %undef __L
  1621                              <1>     %rotate 1
  1622                              <1>   %endrep
  1623                              <1>   dw 00h, _cA_errhnd
  1624                              <1> %endmacro
  1625                              <1> 
  1626                              <1> ; -----------------------------------------------------------------------------
  1627                              <1> ; \brief check a character at the given position in given label string...
  1628                              <1> ; CMP_CHR <label>, <num-position>, <char to check>, <jump label if equal>
  1629                              <1> ; CMP_CHR argvn, 2, '3', is_three
  1630                              <1> ; -----------------------------------------------------------------------------
  1631                              <1> %macro CMP_CHR 4
  1632                              <1>     %ifstr %1
  1633                              <1>         section .data
  1634                              <1>         %%msg: db %1, 0
  1635                              <1>         section .text
  1636                              <1>         lea si, [PTR16(%%msg)]       ; text 0-terminated
  1637                              <1>     %else
  1638                              <1>     section .text
  1639                              <1>         %assign __count 0
  1640                              <1>         %assign __varg  0
  1641                              <1>         %assign __stop  0
  1642                              <1>         %rep MAX_ARGV
  1643                              <1>             %if __stop == 0
  1644                              <1>                 %assign __count (__count + 1)
  1645                              <1>                 %ifidni %1, ARGV_%+__count
  1646                              <1>                     %assign __varg __count
  1647                              <1>                     %assign __stop 1
  1648                              <1>                 %endif
  1649                              <1>             %endif
  1650                              <1>         %endrep
  1651                              <1>         %if __varg > 0
  1652                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1653                              <1>             mov  bl, __varg
  1654                              <1>             call getCommandLine_Arg
  1655                              <1>         %else
  1656                              <1>             lea si, [PTR16(_cA_%1)]
  1657                              <1>         %endif
  1658                              <1>         %undef __stop
  1659                              <1>         %undef __varg
  1660                              <1>     %endif
  1661                              <1>         xor  cl, cl
  1662                              <1>         push si
  1663                              <1>     %%loop:
  1664                              <1>         lodsb
  1665                              <1>         inc cl
  1666                              <1>         cmp cl, %2
  1667                              <1>         je  %%next
  1668                              <1>         jmp %%loop
  1669                              <1>     %%next:
  1670                              <1>         pop si
  1671                              <1>         cmp al, %3
  1672                              <1>         je  %4
  1673                              <1> %endmacro
  1674                              <1> 
  1675                              <1> ; -----------------------------------------------------------------------------
  1676                              <1> ; \brief compare 2 string's ...
  1677                              <1> ; -----------------------------------------------------------------------------
  1678                              <1> %macro STR_SI 1
  1679                              <1>     section .text
  1680                              <1>     lea  si, [PTR16(%1)]
  1681                              <1> %endmacro
  1682                              <1> %macro STR_DI 2
  1683                              <1>     section .text
  1684                              <1>     lea di, [PTR16(%1)]
  1685                              <1>     call string_compare
  1686                              <1>     cmp al, 0
  1687                              <1>     je  %2
  1688                              <1> %endmacro
  1689                              <1> 
  1690                              <1> %macro CMP_STR 3
  1691                              <1>     ; -------------------------
  1692                              <1>     ; argument 1 is a number ?
  1693                              <1>     ; -------------------------
  1694                              <1>     %ifnum %1
  1695                              <1>         section .data
  1696                              <1>         %defstr %%q1 %1
  1697                              <1>         %%partA: db %%q1, 0
  1698                              <1>         STR_SI %%partA
  1699                              <1>     %endif
  1700                              <1>     
  1701                              <1>     ; -------------------------
  1702                              <1>     ; argument 2 is a number ?
  1703                              <1>     ; -------------------------
  1704                              <1>     %ifnum %2
  1705                              <1>         section .data
  1706                              <1>         %defstr %%q2 %2
  1707                              <1>         %%partB: db %%q2, 0
  1708                              <1>         STR_DI %%partB, %3
  1709                              <1>     %endif
  1710                              <1>     
  1711                              <1>     ; -------------------------
  1712                              <1>     ; argument 1 is a string ?
  1713                              <1>     ; -------------------------
  1714                              <1>     %ifstr %1
  1715                              <1>         section .data
  1716                              <1>         %%part1: db %1, 0
  1717                              <1>         STR_SI %%part1
  1718                              <1>     %endif
  1719                              <1>     
  1720                              <1>     ; -------------------------
  1721                              <1>     ; argument 2 is a string ?
  1722                              <1>     ; -------------------------
  1723                              <1>     %ifstr %2
  1724                              <1>         section .data
  1725                              <1>         %%part2: db %2, 0
  1726                              <1>         STR_DI %%part2, %3
  1727                              <1>     %endif
  1728                              <1>     
  1729                              <1>     ; -------------------------
  1730                              <1>     ; argument 1 is a label ?
  1731                              <1>     ; -------------------------
  1732                              <1>     %ifid %1
  1733                              <1>         section .text
  1734                              <1>         %assign __count 0
  1735                              <1>         %assign __varg  0
  1736                              <1>         %assign __stop  0
  1737                              <1>         %rep MAX_ARGV
  1738                              <1>             %if __stop == 0
  1739                              <1>                 %assign __count (__count + 1)
  1740                              <1>                 %ifidni %1, ARGV_%+__count
  1741                              <1>                     %assign __varg __count
  1742                              <1>                     %assign __stop 1
  1743                              <1>                 %endif
  1744                              <1>             %endif
  1745                              <1>         %endrep
  1746                              <1>         %if __varg > 0
  1747                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1748                              <1>             mov  bl, __varg
  1749                              <1>             call getCommandLine_Arg
  1750                              <1>         %else
  1751                              <1>             lea si, [PTR16(_cA_%1)]
  1752                              <1>         %endif
  1753                              <1>         %undef __stop
  1754                              <1>         %undef __varg
  1755                              <1>     %endif
  1756                              <1> %endmacro
    11                                  
    12                                  kernel_start:
    13                                  section .text
    14                                  %include 'code16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  code16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> %define DOS_SHELL 1
     9                              <1> %define MAX_ARGS  7
    10                              <1> bits 16
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; dbfmake.asm  - Create/Append field into dBASE III/IV DBF by INT 21h
    13                              <1> ; Build:  nasm -f bin dbfmake.asm -o DBFMAKE.COM
    14                              <1> ; Run:    DBFMAKE <type> <cmd> <feldtype> <feldname> <feldlaenge>
    15                              <1> ; Example:
    16                              <1> ;   DBFMAKE 3 CREATE C NAME 20
    17                              <1> ;   DBFMAKE 4 APPEND I AGE 3
    18                              <1> ; Type: 3 (dBASE III), 4 (dBASE IV)
    19                              <1> ; Cmd:  CREATE | APPEND
    20                              <1> ; Feldtype: C,I,F,B,D,T  (T only for type 4)
    21                              <1> ; Feldname: max 10 Zeichen (dBASE-Beschränkung, 11. Byte = 0)
    22                              <1> ; Feldlaenge: Dezimal (z.B. 20)
    23                              <1> ; -----------------------------------------------------------------------------
    24                              <1> code16_start:
    25                              <1>     INIT_COMMAND_LINE
  1455                              <2> %if DOS_SHELL == 1
  1456 00000000 E8380E              <2>  call dos_get_command_line
  1457                              <2> %else
  1458                              <2>  %error 'todo: windows'
  1459                              <2> %endif
    26                              <1>     INIT_CONSOLE
  1466                              <2> %if DOS_SHELL == 1
  1467 00000003 E8130E              <2>  call dos_init_console
  1468                              <2>  SCREEN_CLEAR
  1132                              <3> %if DOS_SHELL == 1
  1133 00000006 E8650F              <3>  call dos_screen_clear
  1134                              <3> %else
  1135                              <3>  GET_CON_O_HANDLE r12
  1136                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1137                              <3>  WRITE_CON_A buffer_B
  1138                              <3> %endif
  1469                              <2> %else
  1470                              <2>  call init_app
  1471                              <2>  call init_console
  1472                              <2> %endif
    27                              <1> 
    28                              <1>     SET_DATA db_have_token, 0
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435 00000009 8D06(5506)          <2>  lea ax, [PTR16(_cA_%1)]
   436 0000000D B80000              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447                              <2>  lea ax, [PTR16(_cA_%1)]
   448                              <2>  mov ax, %2
   449                              <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    29                              <1>     
    30                              <1>     CMP_STR ARGV_1, '3', .is_version3
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000000 3300                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000010 8D3E(0001)          <3>  lea di, [PTR16(%1)]
  1685 00000014 E8860F              <3>  call string_compare
  1686 00000017 3C00                <3>  cmp al, 0
  1687 00000019 741E                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000001B BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 0000001E B301                <2>  mov bl, __varg
  1749 00000020 E8F809              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    31                              <1>     CMP_STR ARGV_1, '4', .is_version4
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000002 3400                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000023 8D3E(0201)          <3>  lea di, [PTR16(%1)]
  1685 00000027 E8730F              <3>  call string_compare
  1686 0000002A 3C00                <3>  cmp al, 0
  1687 0000002C 7414                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000002E BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000031 B301                <2>  mov bl, __varg
  1749 00000033 E8E509              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    32 00000036 E99706              <1>     jmp usage
    33                              <1>     
    34                              <1>     .is_version3:  SET_DATA db_version, '3', .next1
    34                              <2>  .is_version3: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443 00000004 3300                <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000039 8D06(5206)          <2>  lea ax, [PTR16(_cA_%1)]
   448 0000003D B83300              <2>  mov ax, %2
   449 00000040 EB09                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    35                              <1>     .is_version4:  SET_DATA db_version, '4', .next1
    35                              <2>  .is_version4: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000042 8D06(5206)          <2>  lea ax, [PTR16(_cA_%1)]
   448 00000046 B83400              <2>  mov ax, %2
   449 00000049 EB00                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    36                              <1>         
    37                              <1>     .next1:
    38                              <1>     SET_DATA db_have_token, 1
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435 0000004B 8D06(5506)          <2>  lea ax, [PTR16(_cA_%1)]
   436 0000004F B80100              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447                              <2>  lea ax, [PTR16(_cA_%1)]
   448                              <2>  mov ax, %2
   449                              <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    39                              <1>     
    40                              <1>     CMP_STR ARGV_2, 'create', .is_okCreate
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000006 63726561746500      <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000052 8D3E(0601)          <3>  lea di, [PTR16(%1)]
  1685 00000056 E8440F              <3>  call string_compare
  1686 00000059 3C00                <3>  cmp al, 0
  1687 0000005B 741B                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000005D BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000060 B302                <2>  mov bl, __varg
  1749 00000062 E8B609              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    41                              <1>     CMP_STR ARGV_2, 'append', .is_okAppend
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 0000000D 617070656E6400      <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000065 8D3E(0D01)          <3>  lea di, [PTR16(%1)]
  1685 00000069 E8310F              <3>  call string_compare
  1686 0000006C 3C00                <3>  cmp al, 0
  1687 0000006E 7411                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 00000070 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000073 B302                <2>  mov bl, __varg
  1749 00000075 E8A309              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    42                              <1>     
    43                              <1>     .is_okCreate:  SET_DATA db_op, 'C', .next2  ; CREATE
    43                              <2>  .is_okCreate: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443 00000014 4300                <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000078 8D06(5306)          <2>  lea ax, [PTR16(_cA_%1)]
   448 0000007C B84300              <2>  mov ax, %2
   449 0000007F EB09                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    44                              <1>     .is_okAppend:  SET_DATA db_op, 'A', .next2  ; APPEND
    44                              <2>  .is_okAppend: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000081 8D06(5306)          <2>  lea ax, [PTR16(_cA_%1)]
   448 00000085 B84100              <2>  mov ax, %2
   449 00000088 EB00                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    45                              <1>     
    46                              <1>     .next2:
    47                              <1>     SET_DATA db_have_token, 2
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435 0000008A 8D06(5506)          <2>  lea ax, [PTR16(_cA_%1)]
   436 0000008E B80200              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447                              <2>  lea ax, [PTR16(_cA_%1)]
   448                              <2>  mov ax, %2
   449                              <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    48                              <1>     
    49                              <1>     CMP_STR ARGV_3, 'c', .is_okTypeC
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000016 6300                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000091 8D3E(1601)          <3>  lea di, [PTR16(%1)]
  1685 00000095 E8050F              <3>  call string_compare
  1686 00000098 3C00                <3>  cmp al, 0
  1687 0000009A 0F84B900            <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000009E BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 000000A1 B303                <2>  mov bl, __varg
  1749 000000A3 E87509              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    50                              <1>     CMP_STR ARGV_3, 'C', .is_okTypeC
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000018 4300                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 000000A6 8D3E(1801)          <3>  lea di, [PTR16(%1)]
  1685 000000AA E8F00E              <3>  call string_compare
  1686 000000AD 3C00                <3>  cmp al, 0
  1687 000000AF 0F84A400            <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 000000B3 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 000000B6 B303                <2>  mov bl, __varg
  1749 000000B8 E86009              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    51                              <1>     
    52                              <1>     CMP_STR ARGV_3, 'i', .is_okTypeI
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 0000001A 6900                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 000000BB 8D3E(1A01)          <3>  lea di, [PTR16(%1)]
  1685 000000BF E8DB0E              <3>  call string_compare
  1686 000000C2 3C00                <3>  cmp al, 0
  1687 000000C4 0F849800            <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 000000C8 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 000000CB B303                <2>  mov bl, __varg
  1749 000000CD E84B09              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    53                              <1>     CMP_STR ARGV_3, 'I', .is_okTypeI
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 0000001C 4900                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 000000D0 8D3E(1C01)          <3>  lea di, [PTR16(%1)]
  1685 000000D4 E8C60E              <3>  call string_compare
  1686 000000D7 3C00                <3>  cmp al, 0
  1687 000000D9 0F848300            <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 000000DD BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 000000E0 B303                <2>  mov bl, __varg
  1749 000000E2 E83609              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    54                              <1>     
    55                              <1>     CMP_STR ARGV_3, 'f', .is_okTypeF
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 0000001E 6600                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 000000E5 8D3E(1E01)          <3>  lea di, [PTR16(%1)]
  1685 000000E9 E8B10E              <3>  call string_compare
  1686 000000EC 3C00                <3>  cmp al, 0
  1687 000000EE 7479                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 000000F0 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 000000F3 B303                <2>  mov bl, __varg
  1749 000000F5 E82309              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    56                              <1>     CMP_STR ARGV_3, 'F', .is_okTypeF
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000020 4600                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 000000F8 8D3E(2001)          <3>  lea di, [PTR16(%1)]
  1685 000000FC E89E0E              <3>  call string_compare
  1686 000000FF 3C00                <3>  cmp al, 0
  1687 00000101 7466                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 00000103 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000106 B303                <2>  mov bl, __varg
  1749 00000108 E81009              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    57                              <1>     
    58                              <1>     CMP_STR ARGV_3, 'b', .is_okTypeB
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000022 6200                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 0000010B 8D3E(2201)          <3>  lea di, [PTR16(%1)]
  1685 0000010F E88B0E              <3>  call string_compare
  1686 00000112 3C00                <3>  cmp al, 0
  1687 00000114 745C                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 00000116 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000119 B303                <2>  mov bl, __varg
  1749 0000011B E8FD08              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    59                              <1>     CMP_STR ARGV_3, 'B', .is_okTypeB
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000024 4200                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 0000011E 8D3E(2401)          <3>  lea di, [PTR16(%1)]
  1685 00000122 E8780E              <3>  call string_compare
  1686 00000125 3C00                <3>  cmp al, 0
  1687 00000127 7449                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 00000129 BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 0000012C B303                <2>  mov bl, __varg
  1749 0000012E E8EA08              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    60                              <1>     
    61                              <1>     CMP_STR ARGV_3, 'd', .is_okTypeD
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000026 6400                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000131 8D3E(2601)          <3>  lea di, [PTR16(%1)]
  1685 00000135 E8650E              <3>  call string_compare
  1686 00000138 3C00                <3>  cmp al, 0
  1687 0000013A 743F                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000013C BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 0000013F B303                <2>  mov bl, __varg
  1749 00000141 E8D708              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    62                              <1>     CMP_STR ARGV_3, 'D', .is_okTypeD
  1691                              <2> 
  1692                              <2> 
  1693                              <2> 
  1694                              <2>  %ifnum %1
  1695                              <2>  section .data
  1696                              <2>  %defstr %%q1 %1
  1697                              <2>  %%partA: db %%q1, 0
  1698                              <2>  STR_SI %%partA
  1699                              <2>  %endif
  1700                              <2> 
  1701                              <2> 
  1702                              <2> 
  1703                              <2> 
  1704                              <2>  %ifnum %2
  1705                              <2>  section .data
  1706                              <2>  %defstr %%q2 %2
  1707                              <2>  %%partB: db %%q2, 0
  1708                              <2>  STR_DI %%partB, %3
  1709                              <2>  %endif
  1710                              <2> 
  1711                              <2> 
  1712                              <2> 
  1713                              <2> 
  1714                              <2>  %ifstr %1
  1715                              <2>  section .data
  1716                              <2>  %%part1: db %1, 0
  1717                              <2>  STR_SI %%part1
  1718                              <2>  %endif
  1719                              <2> 
  1720                              <2> 
  1721                              <2> 
  1722                              <2> 
  1723                              <2>  %ifstr %2
  1724                              <2>  section .data
  1725 00000028 4400                <2>  %%part2: db %2, 0
  1726                              <2>  STR_DI %%part2, %3
  1683                              <3>  section .text
  1684 00000144 8D3E(2801)          <3>  lea di, [PTR16(%1)]
  1685 00000148 E8520E              <3>  call string_compare
  1686 0000014B 3C00                <3>  cmp al, 0
  1687 0000014D 742C                <3>  je %2
  1727                              <2>  %endif
  1728                              <2> 
  1729                              <2> 
  1730                              <2> 
  1731                              <2> 
  1732                              <2>  %ifid %1
  1733                              <2>  section .text
  1734                              <2>  %assign __count 0
  1735                              <2>  %assign __varg 0
  1736                              <2>  %assign __stop 0
  1737                              <2>  %rep MAX_ARGV
  1738                              <2>  %if __stop == 0
  1739                              <2>  %assign __count (__count + 1)
  1740                              <2>  %ifidni %1, ARGV_%+__count
  1741                              <2>  %assign __varg __count
  1742                              <2>  %assign __stop 1
  1743                              <2>  %endif
  1744                              <2>  %endif
  1745                              <2>  %endrep
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1738                              <3>  %if __stop == 0
  1739                              <3>  %assign __count (__count + 1)
  1740                              <3>  %ifidni %1, ARGV_%+__count
  1741                              <3>  %assign __varg __count
  1742                              <3>  %assign __stop 1
  1743                              <3>  %endif
  1744                              <3>  %endif
  1746                              <2>  %if __varg > 0
  1747 0000014F BE(C204)            <2>  mov si, PTR16(_cA_cmd_buf)
  1748 00000152 B303                <2>  mov bl, __varg
  1749 00000154 E8C408              <2>  call getCommandLine_Arg
  1750                              <2>  %else
  1751                              <2>  lea si, [PTR16(_cA_%1)]
  1752                              <2>  %endif
  1753                              <2>  %undef __stop
  1754                              <2>  %undef __varg
  1755                              <2>  %endif
    63                              <1>     
    64                              <1>     .is_okTypeC:  SET_DATA db_type, 'C', .next3
    64                              <2>  .is_okTypeC: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443 0000002A 4300                <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000157 8D06(5406)          <2>  lea ax, [PTR16(_cA_%1)]
   448 0000015B B84300              <2>  mov ax, %2
   449 0000015E EB24                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    65                              <1>     .is_okTypeI:  SET_DATA db_type, 'I', .next3
    65                              <2>  .is_okTypeI: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000160 8D06(5406)          <2>  lea ax, [PTR16(_cA_%1)]
   448 00000164 B84900              <2>  mov ax, %2
   449 00000167 EB1B                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    66                              <1>     .is_okTypeF:  SET_DATA db_type, 'F', .next3
    66                              <2>  .is_okTypeF: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000169 8D06(5406)          <2>  lea ax, [PTR16(_cA_%1)]
   448 0000016D B84600              <2>  mov ax, %2
   449 00000170 EB12                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    67                              <1>     .is_okTypeB:  SET_DATA db_type, 'B', .next3
    67                              <2>  .is_okTypeB: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 00000172 8D06(5406)          <2>  lea ax, [PTR16(_cA_%1)]
   448 00000176 B84200              <2>  mov ax, %2
   449 00000179 EB09                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    68                              <1>     .is_okTypeD:  SET_DATA db_type, 'D', .next3
    68                              <2>  .is_okTypeD: 
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435                              <2>  lea ax, [PTR16(_cA_%1)]
   436                              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447 0000017B 8D06(5406)          <2>  lea ax, [PTR16(_cA_%1)]
   448 0000017F B84400              <2>  mov ax, %2
   449 00000182 EB00                <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    69                              <1>         
    70                              <1>     .next3:
    71                              <1>     SET_DATA db_have_token, 3
   431                              <2> %if DOS_SHELL == 1
   432                              <2>  %if %0 == 2
   433                              <2>  %ifnum %2
   434                              <2>  section .text
   435 00000184 8D06(5506)          <2>  lea ax, [PTR16(_cA_%1)]
   436 00000188 B80300              <2>  mov ax, %2
   437                              <2>  %endif
   438                              <2>  %elif %0 == 3
   439                              <2>  %ifstr %2
   440                              <2>  %ifndef __var__%1
   441                              <2>  %define __var__%1 1
   442                              <2>  section .data
   443                              <2>  %%__v: db %2, 0
   444                              <2>  %endif
   445                              <2>  %endif
   446                              <2>  section .text
   447                              <2>  lea ax, [PTR16(_cA_%1)]
   448                              <2>  mov ax, %2
   449                              <2>  jmp %3
   450                              <2>  %endif
   451                              <2> %else
   452                              <2>  %error 'tpdo'
   453                              <2> %endif
    72                              <1>     
    73                              <1>     is_okk:
    74                              <1>     SET_CURSOR 40, 5
  1147                              <2> %if %0 == 0
  1148                              <2>  %error 2 argument missing
  1149                              <2> %endif
  1150                              <2> %if DOS_SHELL == 1
  1151 0000018B B228                <2>  mov dl, %1
  1152 0000018D B605                <2>  mov dh, %2
  1153 0000018F E8DF08              <2>  call dos_set_cursor
  1154                              <2> %else
  1155                              <2> %endif
    75                              <1>     PUTS_COLOR 'mufti', 0x1C
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 00000192 E8EF08              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205 0000002C 6D7566746900        <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207 00000195 B31C                <2>  mov bl, %2
  1208 00000197 BE(2C01)            <2>  mov si, PTR16(%%msg)
  1209 0000019A E8700D              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240                              <2>  mov bl, %2
  1241                              <2>  mov si, PTR16(_cA_%1)
  1242                              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
    76                              <1>     DOS_Exit   0
  1275                              <2> %if DOS_SHELL == 1
  1276                              <2>  %ifidni %1, ax
  1277                              <2>  %error 'AX not allowed here.'
  1278                              <2>  %elifidni %1, bx
  1279                              <2>  mov ax, 0x4C00
  1280                              <2>  or ax, bx
  1281                              <2>  SysCall
  1282                              <2>  %elifidni %1, CX
  1283                              <2>  mov ax, 0x4C00
  1284                              <2>  or ax, cx
  1285                              <2>  SysCall
  1286                              <2>  %elifidni %1, dx
  1287                              <2>  mov ax, 0x4C00
  1288                              <2>  or ax, dx
  1289                              <2>  SysCall
  1290                              <2>  %elifnum %1
  1291 0000019D B8004C              <2>  mov ax, 0x4C00 | %1
  1292                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000001A0 CD21                <3>  int 0x21
    68                              <3> %endif
  1293                              <2>  %else
  1294                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <2>  %endif
  1296                              <2> %endif
    77                              <1>     ;ret
    78 000001A2 E92B05              <1> jmp usage
    79                              <1>     .token_done:
    80                              <1>     DOS_Exit 0
  1275                              <2> %if DOS_SHELL == 1
  1276                              <2>  %ifidni %1, ax
  1277                              <2>  %error 'AX not allowed here.'
  1278                              <2>  %elifidni %1, bx
  1279                              <2>  mov ax, 0x4C00
  1280                              <2>  or ax, bx
  1281                              <2>  SysCall
  1282                              <2>  %elifidni %1, CX
  1283                              <2>  mov ax, 0x4C00
  1284                              <2>  or ax, cx
  1285                              <2>  SysCall
  1286                              <2>  %elifidni %1, dx
  1287                              <2>  mov ax, 0x4C00
  1288                              <2>  or ax, dx
  1289                              <2>  SysCall
  1290                              <2>  %elifnum %1
  1291 000001A5 B8004C              <2>  mov ax, 0x4C00 | %1
  1292                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 000001A8 CD21                <3>  int 0x21
    68                              <3> %endif
  1293                              <2>  %else
  1294                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <2>  %endif
  1296                              <2> %endif
    81                              <1>         
    82                              <1>     ; -------- <feldname> (max 10) --------
    83 000001AA BF(331F)            <1>     mov di, PTR16(fldname)
    84 000001AD E86603              <1>     call copy_token_max_10
    85 000001B0 0F821C05            <1>     jc  usage
    86 000001B4 C60500              <1>     mov byte [di], 0      ; Nullterminierung (Routine schreibt sie ohnehin)
    87                              <1> 
    88                              <1>     ; -------- <feldlaenge> --------
    89 000001B7 E81503              <1>     call next_token
    90 000001BA 0F821205            <1>     jc  usage
    91 000001BE BA(F31E)            <1>     mov dx, PTR16(tokbuf)
    92 000001C1 E8D103              <1>     call parse_u16
    93 000001C4 0F821505            <1>     jc  badargs
    94 000001C8 A3(F31E)            <1>     mov [PTR16(g_flen)], ax
    95                              <1> 
    96                              <1>     ; --- Feldtyp mappen + Länge validieren ---
    97 000001CB A0(F31E)            <1>     mov al, [PTR16(g_ftype)]
    98 000001CE E81D04              <1>     call map_fieldtype      ; AL=DBF Type, BL=fixedLen(0/const), BH=only4
    99 000001D1 0F820805            <1>     jc  badargs
   100 000001D5 80FF01              <1>     cmp bh, 1
   101 000001D8 7509                <1>     jne .ok_ftyp
   102 000001DA 833E(F31E)04        <1>     cmp word [PTR16(g_type)], 4
   103 000001DF 0F852E05            <1>     jne not_supported
   104                              <1>     .ok_ftyp:
   105 000001E3 80FB00              <1>     cmp bl, 0
   106 000001E6 7409                <1>     je  .keep_len
   107 000001E8 881E(F31E)          <1>     mov byte [PTR16(g_flen)    ], bl   ; fixe Länge erzwingen
   108 000001EC C606(F41E)00        <1>     mov byte [PTR16(g_flen) + 1], 0
   109                              <1>     .keep_len:
   110 000001F1 A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   111 000001F4 8A16(F31E)          <1>     mov dl, [PTR16(g_ftype)]
   112 000001F8 E85104              <1>     call validate_length
   113 000001FB 0F82DE04            <1>     jc  badargs
   114                              <1> 
   115                              <1>     ; Datum für Header holen
   116 000001FF B42A                <1>     mov ah, 2Ah
   117 00000201 CD21                <1>     int 21h
   118 00000203 890E(F31E)          <1>     mov [PTR16(g_year)], cx
   119 00000207 8836(F31E)          <1>     mov [PTR16(g_month)], dh
   120 0000020B 8816(F31E)          <1>     mov [PTR16(g_day)], dl
   121                              <1> 
   122                              <1>     ; --- Dispatch nach CMD ---
   123                              <1> do_dispatch:
   124 0000020F 803E(F31E)01        <1>     cmp byte [PTR16(g_cmd)], 1
   125 00000214 7437                <1>     je  do_create
   126 00000216 EB64                <1>     jmp do_append
   127                              <1> 
   128                              <1> ; --- Hex-Ausgabe (AX -> XXXXh, nutzt int 21h/AH=02h) ---
   129                              <1> print_hex16:
   130 00000218 50                  <1>     push ax
   131 00000219 53                  <1>     push bx
   132 0000021A 51                  <1>     push cx
   133 0000021B 52                  <1>     push dx
   134 0000021C 89C3                <1>     mov  bx, ax
   135 0000021E B90400              <1>     mov  cx, 4
   136                              <1>     .next_nibble:
   137 00000221 C1C304              <1>     rol  bx, 4
   138 00000224 88DA                <1>     mov  dl, bl
   139 00000226 80E20F              <1>     and  dl, 0Fh
   140 00000229 80C230              <1>     add  dl, '0'
   141 0000022C 80FA39              <1>     cmp  dl, '9'
   142 0000022F 7603                <1>     jbe  .out
   143 00000231 80C207              <1>     add  dl, 7          ; 'A'..'F'
   144                              <1>     .out:
   145 00000234 B402                <1>     mov  ah, 02h
   146 00000236 CD21                <1>     int  21h
   147 00000238 E2E7                <1>     loop .next_nibble
   148 0000023A B268                <1>     mov  dl, 'h'
   149 0000023C B402                <1>     mov  ah, 02h
   150 0000023E CD21                <1>     int  21h
   151 00000240 B20D                <1>     mov  dl, 13         ; CR LF
   152 00000242 CD21                <1>     int  21h
   153 00000244 B20A                <1>     mov  dl, 10
   154 00000246 CD21                <1>     int  21h
   155 00000248 5A                  <1>     pop  dx
   156 00000249 59                  <1>     pop  cx
   157 0000024A 5B                  <1>     pop  bx
   158 0000024B 58                  <1>     pop  ax
   159 0000024C C3                  <1>     ret
   160                              <1> ; ---------------- CREATE ----------------
   161                              <1> do_create:
   162                              <1>     ; vorhandene Datei (ignoriert Fehler) löschen
   163 0000024D BA(C801)            <1>     mov dx, PTR16(_cA_DBFNAME)
   164 00000250 B441                <1>     mov ah, 41h
   165 00000252 CD21                <1>     int 21h
   166                              <1> 
   167                              <1>     ; neu anlegen
   168 00000254 BA(C801)            <1>     mov dx, PTR16(_cA_DBFNAME)
   169 00000257 B90000              <1>     mov cx, 0
   170 0000025A B43C                <1>     mov ah, 3Ch
   171 0000025C CD21                <1>     int 21h
   172 0000025E 0F82BC04            <1>     jc  io_error
   173 00000262 A3(F31E)            <1>     mov [PTR16(hFile)], ax
   174                              <1> 
   175                              <1>     ; Header + 1 Feld bauen und schreiben
   176 00000265 E82401              <1>     call build_header_for_new
   177 00000268 E89401              <1>     call write_full_header
   178                              <1> 
   179                              <1>     ; schließen
   180 0000026B 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   181 0000026F B43E                <1>     mov ah, 3Eh
   182 00000271 CD21                <1>     int 21h
   183                              <1>     
   184                              <1> ;todo paule32
   185                              <1> ;    DOS_WriteLn msg_ok_create
   186                              <1> 
   187                              <1>     ;lea dx, PTR16(msg_ok_create)
   188                              <1> 
   189 00000273 E84204              <1>     call print_$
   190                              <1>     DOS_crlf
  1305 00000276 E8520C              <2>  call DOSrncrlf
   191 00000279 E9BC04              <1>     jmp exit0
   192                              <1> 
   193                              <1> ; ---------------- APPEND ----------------
   194                              <1> do_append:
   195                              <1>     ; RDWR öffnen
   196 0000027C BA(C801)            <1>     mov dx, PTR16(_cA_DBFNAME)
   197 0000027F B8023D              <1>     mov ax, 3D02h
   198 00000282 CD21                <1>     int 21h
   199 00000284 0F826204            <1>     jc  open_fail
   200 00000288 A3(F31E)            <1>     mov [PTR16(hFile)], ax
   201                              <1> 
   202                              <1>     ; Header lesen (32)
   203 0000028B 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   204 0000028F BA(3F1F)            <1>     mov dx, PTR16(header)
   205 00000292 B92000              <1>     mov cx, 32
   206 00000295 B43F                <1>     mov ah, 3Fh
   207 00000297 CD21                <1>     int 21h
   208 00000299 0F828104            <1>     jc  io_error
   209 0000029D 83F820              <1>     cmp ax, 32
   210 000002A0 0F857A04            <1>     jne io_error
   211                              <1> 
   212                              <1>     ; Typ prüfen
   213 000002A4 A0(3F1F)            <1>     mov al, [PTR16(header)+0]
   214 000002A7 833E(F31E)03        <1>     cmp word [PTR16(g_type)], 3
   215 000002AC 7508                <1>     jne .chk4
   216 000002AE 3C03                <1>     cmp al, 03h
   217 000002B0 0F854304            <1>     jne ver_mismatch
   218 000002B4 EB06                <1>     jmp .t_ok
   219                              <1>     .chk4:
   220 000002B6 3C04                <1>     cmp al, 04h
   221 000002B8 0F853B04            <1>     jne ver_mismatch
   222                              <1>     .t_ok:
   223                              <1> 
   224                              <1>     ; Records==0?
   225 000002BC A1(431F)            <1>     mov ax, [PTR16(header)+4]
   226 000002BF 8B16(451F)          <1>     mov dx, [PTR16(header)+6]
   227 000002C3 09C0                <1>     or  ax, ax
   228 000002C5 09D2                <1>     or  dx, dx
   229 000002C7 0F853904            <1>     jnz append_with_records_not_supported
   230                              <1> 
   231                              <1>     ; Header-/Recordlänge
   232 000002CB A1(471F)            <1>     mov ax, [PTR16(header)+8]
   233 000002CE A3(A608)            <1>     mov [PTR16(hdr_len)], ax
   234 000002D1 A1(491F)            <1>     mov ax, [PTR16(header)+10]
   235 000002D4 A3(A808)            <1>     mov [PTR16(rec_len)], ax
   236                              <1> 
   237                              <1>     ; Felddeskriptoren laden (hdr_len - 32)
   238 000002D7 A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
   239 000002DA 83E820              <1>     sub ax, 32
   240 000002DD 0F864A04            <1>     jbe bad_header
   241 000002E1 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   242 000002E5 BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   243 000002E8 89C1                <1>     mov cx, ax
   244 000002EA B43F                <1>     mov ah, 3Fh
   245 000002EC CD21                <1>     int 21h
   246 000002EE 0F822C04            <1>     jc  io_error
   247 000002F2 A3(5F1F)            <1>     mov [PTR16(fdbuf_size)], ax
   248                              <1> 
   249                              <1>     ; existiert Feld?
   250 000002F5 E88701              <1>     call field_exists
   251 000002F8 0F82C103            <1>     jc  field_already
   252                              <1> 
   253                              <1>     ; Terminator finden
   254 000002FC BE(5606)            <1>     mov si, PTR16(fdescbuf)
   255 000002FF 8B0E(5F1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   256                              <1>     .find_term:
   257 00000303 83F900              <1>     cmp cx, 0
   258 00000306 0F842104            <1>     je  bad_header
   259 0000030A 803C0D              <1>     cmp byte [si], 0Dh
   260 0000030D 7408                <1>     je  .term_found
   261 0000030F 83C620              <1>     add si, 32
   262 00000312 83E920              <1>     sub cx, 32
   263 00000315 EBEC                <1>     jmp .find_term
   264                              <1>     .term_found:
   265                              <1>     ; neuen FD in tempdesc bauen
   266 00000317 E85E01              <1>     call build_one_descriptor_to_temp
   267                              <1>     ; 32 Byte an Terminatorstelle kopieren
   268 0000031A 56                  <1>     push si
   269 0000031B 89F7                <1>     mov di, si
   270 0000031D BE(5F1F)            <1>     mov si, PTR16(tempdesc)
   271 00000320 B92000              <1>     mov cx, 32
   272 00000323 F3A4                <1>     rep movsb
   273 00000325 5E                  <1>     pop si
   274                              <1>     ; neuen Terminator hinterher
   275 00000326 C6040D              <1>     mov byte [si], 0Dh
   276                              <1> 
   277                              <1>     ; Header anpassen
   278 00000329 A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
   279 0000032C 83C020              <1>     add ax, 32
   280 0000032F A3(A608)            <1>     mov [PTR16(hdr_len)], ax
   281 00000332 A3(471F)            <1>     mov [PTR16(header)+8], ax
   282 00000335 A1(A808)            <1>     mov ax, [PTR16(rec_len)]
   283 00000338 0306(F31E)          <1>     add ax, [PTR16(g_flen)]
   284 0000033C A3(A808)            <1>     mov [PTR16(rec_len)], ax
   285 0000033F A3(491F)            <1>     mov [PTR16(header)+10], ax
   286                              <1> 
   287                              <1>     ; an BOF seeken
   288 00000342 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   289 00000346 31D2                <1>     xor dx, dx
   290 00000348 31C9                <1>     xor cx, cx
   291 0000034A B80042              <1>     mov ax, 4200h
   292 0000034D CD21                <1>     int 21h
   293                              <1> 
   294                              <1>     ; Header schreiben (32)
   295 0000034F 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   296 00000353 BA(3F1F)            <1>     mov dx, PTR16(header)
   297 00000356 B92000              <1>     mov cx, 32
   298 00000359 B440                <1>     mov ah, 40h
   299 0000035B CD21                <1>     int 21h
   300 0000035D 0F82BD03            <1>     jc  io_error
   301                              <1> 
   302                              <1>     ; FD-Region schreiben (hdr_len - 32)
   303 00000361 A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
   304 00000364 83E820              <1>     sub ax, 32
   305 00000367 89C1                <1>     mov cx, ax
   306 00000369 BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   307 0000036C 8B1E[F31D]          <1>     mov bx, [hFile]
   308 00000370 B440                <1>     mov ah, 40h
   309 00000372 CD21                <1>     int 21h
   310 00000374 0F82A603            <1>     jc  io_error
   311                              <1> 
   312                              <1>     ; schließen
   313 00000378 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   314 0000037C B43E                <1>     mov ah, 3Eh
   315 0000037E CD21                <1>     int 21h
   316                              <1> 
   317 00000380 BA(BB04)            <1>     mov dx, PTR16(msg_ok_append)
   318 00000383 E83203              <1>     call print_$
   319                              <1>     DOS_crlf
  1305 00000386 E8420B              <2>  call DOSrncrlf
   320 00000389 E9AC03              <1>     jmp exit0
   321                              <1> 
   322                              <1> ; ---------------- Helper: Build/Write ----------------
   323                              <1> 
   324                              <1> ; build_header_for_new: header + 1 FD in fdescbuf (mit 0Dh) erzeugen
   325                              <1> build_header_for_new:
   326 0000038C 50                  <1>     push ax
   327 0000038D 53                  <1>     push bx
   328 0000038E 51                  <1>     push cx
   329 0000038F 52                  <1>     push dx
   330                              <1> 
   331                              <1>     ; clear header (32) + fdescbuf
   332 00000390 BF(3F1F)            <1>     mov di, PTR16(header)
   333 00000393 B91000              <1>     mov cx, 16
   334 00000396 31C0                <1>     xor ax, ax
   335 00000398 F3AB                <1>     rep stosw
   336 0000039A BF(5606)            <1>     mov di, PTR16(fdescbuf)
   337 0000039D B90008              <1>     mov cx, 2048
   338 000003A0 F3AB                <1>     rep stosw
   339                              <1> 
   340                              <1>     ; version
   341 000003A2 A1(F31E)            <1>     mov ax, [PTR16(g_type)]
   342 000003A5 83F803              <1>     cmp ax, 3
   343 000003A8 7507                <1>     jne .v4
   344 000003AA C606(3F1F)03        <1>     mov byte [PTR16(header)+0], 03h
   345 000003AF EB05                <1>     jmp .v_ok
   346                              <1>     .v4:
   347 000003B1 C606(3F1F)04        <1>     mov byte [PTR16(header)+0], 04h
   348                              <1>     .v_ok:
   349                              <1>     ; date YY,MM,DD
   350 000003B6 A1(F31E)            <1>     mov ax, [PTR16(g_year)]
   351 000003B9 BB6400              <1>     mov bx, 100
   352 000003BC 31D2                <1>     xor dx, dx
   353 000003BE F7F3                <1>     div bx            ; AX=year/100, DX=YY
   354 000003C0 88D0                <1>     mov al, dl
   355 000003C2 A2(401F)            <1>     mov [PTR16(header)+1], al
   356 000003C5 A0(F31E)            <1>     mov al, [PTR16(g_month)]
   357 000003C8 A2(411F)            <1>     mov [PTR16(header)+2], al
   358 000003CB A0(F31E)            <1>     mov al, [PTR16(g_day)]
   359 000003CE A2(421F)            <1>     mov [PTR16(header)+3], al
   360                              <1> 
   361                              <1>     ; num records = 0
   362 000003D1 66C706(431F)000000- <1>     mov dword [PTR16(header)+4], 0
   362 000003D9 00                  <1>
   363                              <1> 
   364                              <1>     ; record length = 1 (delete flag) + field len
   365 000003DA A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   366 000003DD 83C001              <1>     add ax, 1
   367 000003E0 A3(491F)            <1>     mov [PTR16(header)+10], ax
   368 000003E3 A3(A808)            <1>     mov [PTR16(rec_len)], ax
   369                              <1> 
   370                              <1>     ; header length = 32 + 32 (one FD) + 1 (0Dh)
   371 000003E6 B84100              <1>     mov ax, 32+32+1
   372 000003E9 A3(471F)            <1>     mov [PTR16(header)+8], ax
   373 000003EC A3(A608)            <1>     mov [PTR16(hdr_len)], ax
   374                              <1> 
   375                              <1>     ; MDX/langid = 0
   376                              <1> 
   377                              <1>     ; FD in fdescbuf und Terminator
   378 000003EF BF(5606)            <1>     mov di, PTR16(fdescbuf)
   379 000003F2 E84100              <1>     call build_one_descriptor_at_di
   380 000003F5 C606(7606)0D        <1>     mov byte [PTR16(fdescbuf)+32], 0Dh
   381                              <1> 
   382 000003FA 5A                  <1>     pop dx
   383 000003FB 59                  <1>     pop cx
   384 000003FC 5B                  <1>     pop bx
   385 000003FD 58                  <1>     pop ax
   386 000003FE C3                  <1>     ret
   387                              <1> 
   388                              <1> ; write_full_header: schreibt Header (32) + FD-Region (hdr_len-32)
   389                              <1> write_full_header:
   390                              <1>     ; seek BOF
   391 000003FF 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   392 00000403 31D2                <1>     xor dx, dx
   393 00000405 31C9                <1>     xor cx, cx
   394 00000407 B80042              <1>     mov ax, 4200h
   395 0000040A CD21                <1>     int 21h
   396                              <1>     ; header
   397 0000040C 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   398 00000410 BA(3F1F)            <1>     mov dx, PTR16(header)
   399 00000413 B92000              <1>     mov cx, 32
   400 00000416 B440                <1>     mov ah, 40h
   401 00000418 CD21                <1>     int 21h
   402 0000041A 0F820003            <1>     jc  io_error
   403                              <1>     ; FD region
   404 0000041E A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
   405 00000421 83E820              <1>     sub ax, 32
   406 00000424 89C1                <1>     mov cx, ax
   407 00000426 BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   408 00000429 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   409 0000042D B440                <1>     mov ah, 40h
   410 0000042F CD21                <1>     int 21h
   411 00000431 0F82E902            <1>     jc  io_error
   412 00000435 C3                  <1>     ret
   413                              <1> 
   414                              <1> ; build_one_descriptor_at_di: DI->32 Byte Ziel
   415                              <1> build_one_descriptor_at_di:
   416 00000436 56                  <1>     push si
   417 00000437 50                  <1>     push ax
   418 00000438 51                  <1>     push cx
   419                              <1> 
   420                              <1>     ; name (max 10 + 0) in 11 Bytes
   421 00000439 BE(331F)            <1>     mov si, PTR16(fldname)
   422 0000043C B90B00              <1>     mov cx, 11
   423                              <1>     .ncopy:
   424 0000043F AC                  <1>     lodsb
   425 00000440 3C00                <1>     cmp al, 0
   426 00000442 7405                <1>     je  .padz
   427 00000444 AA                  <1>     stosb
   428 00000445 E2F8                <1>     loop .ncopy
   429 00000447 EB08                <1>     jmp .name_done
   430                              <1>     .padz:
   431 00000449 AA                  <1>     stosb
   432 0000044A 49                  <1>     dec cx
   433 0000044B 7404                <1>     jz  .name_done
   434 0000044D B000                <1>     mov al, 0
   435 0000044F F3AA                <1>     rep stosb
   436                              <1>     .name_done:
   437                              <1> 
   438                              <1>     ; type char
   439 00000451 A0(F31E)            <1>     mov al, [PTR16(g_ftype)]
   440 00000454 E8EC01              <1>     call map_fieldtype_char_only
   441 00000457 AA                  <1>     stosb
   442                              <1> 
   443                              <1>     ; data address (4) = 0
   444 00000458 31C0                <1>     xor ax, ax
   445 0000045A B90400              <1>     mov cx, 4
   446 0000045D F3AA                <1>     rep stosb
   447                              <1> 
   448                              <1>     ; length (1)
   449 0000045F A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   450 00000462 88C0                <1>     mov al, al
   451 00000464 AA                  <1>     stosb
   452                              <1> 
   453                              <1>     ; decimals (1) = 0
   454 00000465 B000                <1>     mov al, 0
   455 00000467 AA                  <1>     stosb
   456                              <1> 
   457                              <1>     ; reserved(2)
   458 00000468 AA                  <1>     stosb
   459 00000469 AA                  <1>     stosb
   460                              <1> 
   461                              <1>     ; flags(1)=0
   462 0000046A B000                <1>     mov al, 0
   463 0000046C AA                  <1>     stosb
   464                              <1> 
   465                              <1>     ; autoinc next(4)+step(1)+reserved(6)=0
   466 0000046D B90B00              <1>     mov cx, 11
   467 00000470 B000                <1>     mov al, 0
   468 00000472 F3AA                <1>     rep stosb
   469                              <1> 
   470 00000474 59                  <1>     pop cx
   471 00000475 58                  <1>     pop ax
   472 00000476 5E                  <1>     pop si
   473 00000477 C3                  <1>     ret
   474                              <1> 
   475                              <1> build_one_descriptor_to_temp:
   476 00000478 BF(5F1F)            <1>     mov di, PTR16(tempdesc)
   477 0000047B E8B8FF              <1>     call build_one_descriptor_at_di
   478 0000047E C3                  <1>     ret
   479                              <1> 
   480                              <1> ; field_exists: CF=1 wenn Name bereits vorhanden
   481                              <1> field_exists:
   482 0000047F 56                  <1>     push si
   483 00000480 57                  <1>     push di
   484 00000481 51                  <1>     push cx
   485 00000482 50                  <1>     push ax
   486 00000483 BE(5606)            <1>     mov si, PTR16(fdescbuf)
   487 00000486 8B0E(5F1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   488                              <1>     .floop:
   489 0000048A 83F900              <1>     cmp cx, 0
   490 0000048D 743A                <1>     je  .no
   491 0000048F 803C0D              <1>     cmp byte [si], 0Dh
   492 00000492 7435                <1>     je  .no
   493                              <1>     ; vergleiche 0-term feldname (bis 11)
   494 00000494 56                  <1>     push si
   495 00000495 BF(331F)            <1>     mov di, PTR16(fldname)
   496 00000498 BB0B00              <1>     mov bx, 11
   497 0000049B BA0100              <1>     mov dx, 1          ; assume match
   498                              <1>     .cmpn:
   499 0000049E 8A04                <1>     mov al, [si]
   500 000004A0 8A25                <1>     mov ah, [di]
   501 000004A2 80FC00              <1>     cmp ah, 0
   502 000004A5 7409                <1>     je  .endcmp
   503 000004A7 38E0                <1>     cmp al, ah
   504 000004A9 7507                <1>     jne .not
   505 000004AB 46                  <1>     inc si
   506 000004AC 47                  <1>     inc di
   507 000004AD 4B                  <1>     dec bx
   508 000004AE 75EE                <1>     jnz .cmpn
   509                              <1>     .endcmp:
   510                              <1>     ; wenn bis 0 gleich -> match
   511 000004B0 EB03                <1>     jmp .match
   512                              <1>     .not:
   513 000004B2 BA0000              <1>     mov dx, 0
   514                              <1>     .match:
   515 000004B5 5E                  <1>     pop si
   516 000004B6 83FA01              <1>     cmp dx, 1
   517 000004B9 7408                <1>     je  .yes
   518 000004BB 83C620              <1>     add si, 32
   519 000004BE 83E920              <1>     sub cx, 32
   520 000004C1 EBC7                <1>     jmp .floop
   521                              <1>     .yes:
   522 000004C3 F9                  <1>     stc
   523 000004C4 58                  <1>     pop ax
   524 000004C5 59                  <1>     pop cx
   525 000004C6 5F                  <1>     pop di
   526 000004C7 5E                  <1>     pop si
   527 000004C8 C3                  <1>     ret
   528                              <1>     .no:
   529 000004C9 F8                  <1>     clc
   530 000004CA 58                  <1>     pop ax
   531 000004CB 59                  <1>     pop cx
   532 000004CC 5F                  <1>     pop di
   533 000004CD 5E                  <1>     pop si
   534 000004CE C3                  <1>     ret
   535                              <1> 
   536                              <1> ; ---------------- Token/Parsing ----------------
   537                              <1> 
   538                              <1> ; next_token: PSP tail -> tokbuf, DX=tokbuf, CF=1 wenn keins
   539                              <1> next_token:
   540 000004CF 50                  <1>     push ax
   541 000004D0 57                  <1>     push di
   542                              <1>     ; skip ws
   543                              <1>     .nt_skip:
   544 000004D1 80FB00              <1>     cmp bl, 0
   545 000004D4 743C                <1>     je  .none
   546 000004D6 8A04                <1>     mov al, [si]
   547 000004D8 46                  <1>     inc si
   548 000004D9 FECB                <1>     dec bl
   549 000004DB 3C0D                <1>     cmp al, 13
   550 000004DD 7433                <1>     je  .none
   551 000004DF 3C20                <1>     cmp al, ' '
   552 000004E1 74EE                <1>     je  .nt_skip
   553 000004E3 3C09                <1>     cmp al, 9
   554 000004E5 74EA                <1>     je  .nt_skip
   555 000004E7 4E                  <1>     dec si
   556 000004E8 FEC3                <1>     inc bl
   557                              <1>     ; copy
   558 000004EA BF(C204)            <1>     mov di, PTR16(_cA_cmd_buf)
   559                              <1>     .nt_copy:
   560 000004ED 80FB00              <1>     cmp bl, 0
   561 000004F0 7416                <1>     je  .done
   562 000004F2 8A04                <1>     mov al, [si]
   563 000004F4 3C0D                <1>     cmp al, 13
   564 000004F6 7410                <1>     je  .done
   565 000004F8 3C20                <1>     cmp al, ' '
   566 000004FA 740C                <1>     je  .done
   567 000004FC 3C09                <1>     cmp al, 9
   568 000004FE 7408                <1>     je  .done
   569 00000500 8805                <1>     mov [di], al
   570 00000502 47                  <1>     inc di
   571 00000503 46                  <1>     inc si
   572 00000504 FECB                <1>     dec bl
   573 00000506 EBE5                <1>     jmp .nt_copy
   574                              <1>     .done:
   575 00000508 C60500              <1>     mov byte [di], 0
   576 0000050B BA(C204)            <1>     mov dx, PTR16(_cA_cmd_buf)
   577 0000050E F8                  <1>     clc
   578 0000050F 5F                  <1>     pop di
   579 00000510 58                  <1>     pop ax
   580 00000511 C3                  <1>     ret
   581                              <1>     .none:
   582 00000512 F9                  <1>     stc
   583 00000513 5F                  <1>     pop di
   584 00000514 58                  <1>     pop ax
   585 00000515 C3                  <1>     ret
   586                              <1> 
   587                              <1> ; copy_token_max_10: SI/BL => [DI], max 10, 0-term, CF wie oben
   588                              <1> copy_token_max_10:
   589 00000516 50                  <1>     push ax
   590 00000517 51                  <1>     push cx
   591                              <1>     ; skip ws
   592                              <1>     .ct10_skip:
   593 00000518 80FB00              <1>     cmp bl, 0
   594 0000051B 7451                <1>     je  .none
   595 0000051D 8A04                <1>     mov al, [si]
   596 0000051F 46                  <1>     inc si
   597 00000520 FECB                <1>     dec bl
   598 00000522 3C0D                <1>     cmp al, 13
   599 00000524 7448                <1>     je  .none
   600 00000526 3C20                <1>     cmp al, ' '
   601 00000528 74EE                <1>     je  .ct10_skip
   602 0000052A 3C09                <1>     cmp al, 9
   603 0000052C 74EA                <1>     je  .ct10_skip
   604 0000052E 4E                  <1>     dec si
   605 0000052F FEC3                <1>     inc bl
   606                              <1>     ; copy up to 10
   607 00000531 B90A00              <1>     mov cx, 10
   608                              <1>     .ct10_copy:
   609 00000534 80FB00              <1>     cmp bl, 0
   610 00000537 742E                <1>     je  .end
   611 00000539 8A04                <1>     mov al, [si]
   612 0000053B 3C0D                <1>     cmp al, 13
   613 0000053D 7428                <1>     je  .end
   614 0000053F 3C20                <1>     cmp al, ' '
   615 00000541 7424                <1>     je  .end
   616 00000543 3C09                <1>     cmp al, 9
   617 00000545 7420                <1>     je  .end
   618 00000547 83F900              <1>     cmp cx, 0
   619 0000054A 7409                <1>     je  .skip_rest
   620 0000054C 8805                <1>     mov [di], al
   621 0000054E 47                  <1>     inc di
   622 0000054F 46                  <1>     inc si
   623 00000550 FECB                <1>     dec bl
   624 00000552 49                  <1>     dec cx
   625 00000553 EBDF                <1>     jmp .ct10_copy
   626                              <1>     .skip_rest:
   627 00000555 80FB00              <1>     cmp bl, 0
   628 00000558 740D                <1>     je  .end
   629 0000055A 8A04                <1>     mov al, [si]
   630 0000055C 46                  <1>     inc si
   631 0000055D FECB                <1>     dec bl
   632 0000055F 3C0D                <1>     cmp al, 13
   633 00000561 7404                <1>     je  .end
   634 00000563 3C20                <1>     cmp al, ' '
   635 00000565 75EE                <1>     jne .skip_rest
   636                              <1>     .end:
   637 00000567 C60500              <1>     mov byte [di], 0
   638 0000056A F8                  <1>     clc
   639 0000056B 59                  <1>     pop cx
   640 0000056C 58                  <1>     pop ax
   641 0000056D C3                  <1>     ret
   642                              <1>     .none:
   643 0000056E F9                  <1>     stc
   644 0000056F 59                  <1>     pop cx
   645 00000570 58                  <1>     pop ax
   646 00000571 C3                  <1>     ret
   647                              <1> 
   648                              <1> ; strcmp: SI=str1, DI=str2, AX=0 bei Gleichheit (ZF=1)
   649                              <1> strcmp:
   650 00000572 56                  <1>     push si
   651 00000573 57                  <1>     push di
   652                              <1>     .sc_loop:
   653 00000574 AC                  <1>     lodsb
   654 00000575 8A25                <1>     mov ah, [di]
   655 00000577 47                  <1>     inc di
   656 00000578 E86700              <1>     call to_upper_al
   657 0000057B E86800              <1>     call to_upper_ah
   658 0000057E 38E0                <1>     cmp al, ah
   659 00000580 750B                <1>     jne .ne
   660 00000582 84C0                <1>     test al, al
   661 00000584 75EE                <1>     jnz .sc_loop
   662 00000586 31C0                <1>     xor ax, ax
   663 00000588 09C0                <1>     or  ax, ax
   664 0000058A 5F                  <1>     pop di
   665 0000058B 5E                  <1>     pop si
   666 0000058C C3                  <1>     ret
   667                              <1>     .ne:
   668 0000058D B80100              <1>     mov ax, 1
   669 00000590 09C0                <1>     or  ax, ax
   670 00000592 5F                  <1>     pop di
   671 00000593 5E                  <1>     pop si
   672 00000594 C3                  <1>     ret
   673                              <1> 
   674                              <1> ; parse_u16: DX->zstr, AX=result, CF=1 bei Fehler
   675                              <1> parse_u16:
   676 00000595 53                  <1>     push bx
   677 00000596 56                  <1>     push si
   678 00000597 89D6                <1>     mov si, dx
   679 00000599 31C0                <1>     xor ax, ax
   680                              <1>     .pu_loop:
   681 0000059B AC                  <1>     lodsb
   682 0000059C 84C0                <1>     test al, al
   683 0000059E 741B                <1>     jz  .ok
   684 000005A0 3C30                <1>     cmp al, '0'
   685 000005A2 721B                <1>     jb  .err
   686 000005A4 3C39                <1>     cmp al, '9'
   687 000005A6 7717                <1>     ja  .err
   688 000005A8 2C30                <1>     sub al, '0'         ; digit in AL
   689 000005AA 89C3                <1>     mov bx, ax          ; BX = acc
   690 000005AC D1E0                <1>     shl ax, 1           ; acc*2
   691 000005AE 89C2                <1>     mov dx, ax
   692 000005B0 C1E002              <1>     shl ax, 2           ; acc*8
   693 000005B3 01D0                <1>     add ax, dx          ; acc*10
   694 000005B5 01D8                <1>     add ax, bx          ; +digit
   695 000005B7 7206                <1>     jc  .err
   696 000005B9 EBE0                <1>     jmp .pu_loop
   697                              <1>     .ok:
   698 000005BB F8                  <1>     clc
   699 000005BC 5E                  <1>     pop si
   700 000005BD 5B                  <1>     pop bx
   701 000005BE C3                  <1>     ret
   702                              <1>     .err:
   703 000005BF F9                  <1>     stc
   704 000005C0 5E                  <1>     pop si
   705 000005C1 5B                  <1>     pop bx
   706 000005C2 C3                  <1>     ret
   707                              <1> 
   708                              <1> ; upper_inplace_dx: DX->zstr upper-case
   709                              <1> upper_inplace_dx:
   710 000005C3 50                  <1>     push ax
   711 000005C4 52                  <1>     push dx
   712 000005C5 89D6                <1>     mov si, dx
   713                              <1>     .upl:
   714 000005C7 AC                  <1>     lodsb
   715 000005C8 84C0                <1>     test al, al
   716 000005CA 7408                <1>     jz  .done
   717 000005CC E80800              <1>     call to_upper
   718 000005CF 8844FF              <1>     mov [si-1], al
   719 000005D2 EBF3                <1>     jmp .upl
   720                              <1>     .done:
   721 000005D4 5A                  <1>     pop dx
   722 000005D5 58                  <1>     pop ax
   723 000005D6 C3                  <1>     ret
   724                              <1> 
   725                              <1> ; to_upper helpers
   726                              <1> to_upper:
   727 000005D7 3C61                <1>     cmp al, 'a'
   728 000005D9 7206                <1>     jb  .ret
   729 000005DB 3C7A                <1>     cmp al, 'z'
   730 000005DD 7702                <1>     ja  .ret
   731 000005DF 2C20                <1>     sub al, 32
   732                              <1>     .ret:
   733 000005E1 C3                  <1>     ret
   734                              <1> to_upper_al:
   735 000005E2 E8F2FF              <1>     call to_upper
   736 000005E5 C3                  <1>     ret
   737                              <1> to_upper_ah:
   738 000005E6 86E0                <1>     xchg al, ah
   739 000005E8 E8ECFF              <1>     call to_upper
   740 000005EB 86E0                <1>     xchg al, ah
   741 000005ED C3                  <1>     ret
   742                              <1> 
   743                              <1> ; map_fieldtype: AL=CLI(C/I/F/B/D/T)-> DBF Typ in [g_ftype_mapped]
   744                              <1> ; out: AL=dbfType, BL=fixedLen(0/const), BH=only4(1=T), CF=1 on error
   745                              <1> map_fieldtype:
   746 000005EE 50                  <1>     push ax
   747 000005EF E8F0FF              <1>     call to_upper_al
   748 000005F2 3C43                <1>     cmp al, 'C'
   749 000005F4 7417                <1>     je .C
   750 000005F6 3C49                <1>     cmp al, 'I'
   751 000005F8 741B                <1>     je .I
   752 000005FA 3C46                <1>     cmp al, 'F'
   753 000005FC 741F                <1>     je .F
   754 000005FE 3C42                <1>     cmp al, 'B'
   755 00000600 7423                <1>     je .B
   756 00000602 3C44                <1>     cmp al, 'D'
   757 00000604 7427                <1>     je .D
   758 00000606 3C54                <1>     cmp al, 'T'
   759 00000608 742B                <1>     je .T
   760 0000060A F9                  <1>     stc
   761 0000060B EB34                <1>     jmp .out
   762 0000060D B043                <1>     .C: mov al, 'C'   ; 1..254
   763 0000060F 30DB                <1>     xor bl, bl
   764 00000611 30FF                <1>     xor bh, bh
   765 00000613 EB28                <1>     jmp .ok
   766 00000615 B04E                <1>     .I: mov al, 'N'   ; 1..20
   767 00000617 30DB                <1>     xor bl, bl
   768 00000619 30FF                <1>     xor bh, bh
   769 0000061B EB20                <1>     jmp .ok
   770 0000061D B046                <1>     .F: mov al, 'F'   ; 1..20
   771 0000061F 30DB                <1>     xor bl, bl
   772 00000621 30FF                <1>     xor bh, bh
   773 00000623 EB18                <1>     jmp .ok
   774 00000625 B04C                <1>     .B: mov al, 'L'   ; exakt 1
   775 00000627 B301                <1>     mov bl, 1
   776 00000629 30FF                <1>     xor bh, bh
   777 0000062B EB10                <1>     jmp .ok
   778 0000062D B044                <1>     .D: mov al, 'D'   ; exakt 8
   779 0000062F B308                <1>     mov bl, 8
   780 00000631 30FF                <1>     xor bh, bh
   781 00000633 EB08                <1>     jmp .ok
   782 00000635 B054                <1>     .T: mov al, 'T'   ; exakt 8, nur Typ 4
   783 00000637 B308                <1>     mov bl, 8
   784 00000639 B701                <1>     mov bh, 1
   785 0000063B EB00                <1>     jmp .ok
   786                              <1>     .ok:
   787 0000063D A2(F31E)            <1>     mov [PTR16(g_ftype_mapped)], al
   788 00000640 F8                  <1>     clc
   789                              <1>     .out:
   790 00000641 58                  <1>     pop ax
   791 00000642 C3                  <1>     ret
   792                              <1> 
   793                              <1> map_fieldtype_char_only:
   794 00000643 53                  <1>     push bx
   795 00000644 E8A7FF              <1>     call map_fieldtype
   796 00000647 A0(F31E)            <1>     mov al, [PTR16(g_ftype_mapped)]
   797 0000064A 5B                  <1>     pop bx
   798 0000064B C3                  <1>     ret
   799                              <1> 
   800                              <1> ; validate_length: AX=len, DL=CLI type (upper), CF=1 invalid
   801                              <1> validate_length:
   802 0000064C 50                  <1>     push ax
   803 0000064D 52                  <1>     push dx
   804 0000064E E85F00              <1>     call to_upper_dl
   805 00000651 80FA42              <1>     cmp dl, 'B'       ; 1
   806 00000654 7507                <1>     jne .nB
   807 00000656 83F801              <1>         cmp ax, 1
   808 00000659 7551                <1>         jne .bad
   809 0000065B EB4B                <1>         jmp .ok
   810                              <1>     .nB:
   811 0000065D 80FA44              <1>     cmp dl, 'D'       ; 8
   812 00000660 7507                <1>     jne .nD
   813 00000662 83F808              <1>         cmp ax, 8
   814 00000665 7545                <1>         jne .bad
   815 00000667 EB3F                <1>         jmp .ok
   816                              <1>     .nD:
   817 00000669 80FA54              <1>     cmp dl, 'T'       ; 8
   818 0000066C 7507                <1>     jne .nT
   819 0000066E 83F808              <1>         cmp ax, 8
   820 00000671 7539                <1>         jne .bad
   821 00000673 EB33                <1>         jmp .ok
   822                              <1>     .nT:
   823 00000675 80FA43              <1>     cmp dl, 'C'       ; 1..254
   824 00000678 750C                <1>     jne .nC
   825 0000067A 83F801              <1>         cmp ax, 1
   826 0000067D 722D                <1>         jb .bad
   827 0000067F 3DFE00              <1>         cmp ax, 254
   828 00000682 7728                <1>         ja .bad
   829 00000684 EB22                <1>         jmp .ok
   830                              <1>     .nC:
   831 00000686 80FA49              <1>     cmp dl, 'I'       ; 1..20
   832 00000689 750C                <1>     jne .nI
   833 0000068B 83F801              <1>         cmp ax, 1
   834 0000068E 721C                <1>         jb .bad
   835 00000690 83F814              <1>         cmp ax, 20
   836 00000693 7717                <1>         ja .bad
   837 00000695 EB11                <1>         jmp .ok
   838                              <1>     .nI:
   839 00000697 80FA46              <1>     cmp dl, 'F'       ; 1..20 (konservativ)
   840 0000069A 7510                <1>     jne .bad
   841 0000069C 83F801              <1>         cmp ax, 1
   842 0000069F 720B                <1>         jb .bad
   843 000006A1 83F814              <1>         cmp ax, 20
   844 000006A4 7706                <1>         ja .bad
   845 000006A6 EB00                <1>         jmp .ok
   846                              <1>     .ok:
   847 000006A8 F8                  <1>     clc
   848 000006A9 5A                  <1>     pop dx
   849 000006AA 58                  <1>     pop ax
   850 000006AB C3                  <1>     ret
   851                              <1>     .bad:
   852 000006AC F9                  <1>     stc
   853 000006AD 5A                  <1>     pop dx
   854 000006AE 58                  <1>     pop ax
   855 000006AF C3                  <1>     ret
   856                              <1> 
   857                              <1> to_upper_dl:
   858 000006B0 86D0                <1>     xchg al, dl
   859 000006B2 E822FF              <1>     call to_upper
   860 000006B5 86D0                <1>     xchg al, dl
   861 000006B7 C3                  <1>     ret
   862                              <1> 
   863                              <1> ; --------- Ausgabe & Exit ---------
   864                              <1> print_$:
   865 000006B8 B409                <1>     mov ah, 09h
   866 000006BA CD21                <1>     int 21h
   867 000006BC C3                  <1>     ret
   868                              <1> 
   869                              <1> field_already:
   870                              <1>     ; Datei schließen und Hinweis ausgeben
   871 000006BD 8B1E[F31D]          <1>     mov bx, [hFile]
   872 000006C1 B43E                <1>     mov ah, 3Eh
   873 000006C3 CD21                <1>     int 21h
   874 000006C5 BA(E804)            <1>     mov dx, PTR16(msg_fieldexists)
   875 000006C8 E8EDFF              <1>     call print_$
   876                              <1>     DOS_crlf
  1305 000006CB E8FD07              <2>  call DOSrncrlf
   877 000006CE EB68                <1>     jmp exit0
   878                              <1> 
   879                              <1> usage:
   880                              <1>     PUTS_COLOR msg_usage, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 000006D0 E8B103              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 000006D3 B302                <2>  mov bl, %2
  1241 000006D5 BE(1D03)            <2>  mov si, PTR16(_cA_%1)
  1242 000006D8 E83208              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   881 000006DB EB60                <1>     jmp exit1
   882                              <1> 
   883                              <1> badargs:
   884                              <1>     PUTS_COLOR msg_badargs, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 000006DD E8A403              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 000006E0 B302                <2>  mov bl, %2
  1241 000006E2 BE(6D03)            <2>  mov si, PTR16(_cA_%1)
  1242 000006E5 E82508              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   885                              <1>     ;DOS_crlf
   886 000006E8 EB53                <1>     jmp exit1
   887                              <1> 
   888                              <1> open_fail:
   889                              <1>     PUTS_COLOR msg_openfail, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 000006EA E89703              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 000006ED B302                <2>  mov bl, %2
  1241 000006EF BE(8A03)            <2>  mov si, PTR16(_cA_%1)
  1242 000006F2 E81808              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   890 000006F5 EB46                <1>     jmp exit1
   891                              <1> 
   892                              <1> ver_mismatch:
   893                              <1>     PUTS_COLOR msg_ver_mismatch, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 000006F7 E88A03              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 000006FA B302                <2>  mov bl, %2
  1241 000006FC BE(BE03)            <2>  mov si, PTR16(_cA_%1)
  1242 000006FF E80B08              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   894 00000702 EB39                <1>     jmp exit1
   895                              <1> 
   896                              <1> append_with_records_not_supported:
   897                              <1>     PUTS_COLOR msg_append_recs, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 00000704 E87D03              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 00000707 B302                <2>  mov bl, %2
  1241 00000709 BE(E503)            <2>  mov si, PTR16(_cA_%1)
  1242 0000070C E8FE07              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   898 0000070F EB2C                <1>     jmp exit1
   899                              <1> 
   900                              <1> not_supported:
   901                              <1>     PUTS_COLOR msg_not_supported, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 00000711 E87003              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 00000714 B302                <2>  mov bl, %2
  1241 00000716 BE(5F04)            <2>  mov si, PTR16(_cA_%1)
  1242 00000719 E8F107              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   902 0000071C EB1F                <1>     jmp exit1
   903                              <1> 
   904                              <1> io_error:
   905                              <1>     PUTS_COLOR msg_ioerr, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 0000071E E86303              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 00000721 B302                <2>  mov bl, %2
  1241 00000723 BE(2804)            <2>  mov si, PTR16(_cA_%1)
  1242 00000726 E8E407              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   906 00000729 EB12                <1>     jmp exit1
   907                              <1> 
   908                              <1> bad_header:
   909                              <1>     PUTS_COLOR msg_badheader, 0x02
  1201                              <2> %if DOS_SHELL == 1
  1202                              <2>  GET_CURSOR
  1162                              <3> %if DOS_SHELL == 1
  1163 0000072B E85603              <3>  call dos_get_cursor
  1164                              <3> %else
  1165                              <3>  %error 'todo: windows'
  1166                              <3> %endif
  1203                              <2>  %ifstr %1
  1204                              <2>  section .data
  1205                              <2>  %%msg: db %1, 0
  1206                              <2>  section .text
  1207                              <2>  mov bl, %2
  1208                              <2>  mov si, PTR16(%%msg)
  1209                              <2>  call PutStrColor
  1210                              <2>  %else
  1211                              <2>  %ifidni %1, DI
  1212                              <2>  section .text
  1213                              <2>  mov bl, %2
  1214                              <2>  call PutStrColor
  1215                              <2>  %elifidni %1, SI
  1216                              <2>  section .text
  1217                              <2>  mov bl, %2
  1218                              <2>  call PutStrColor
  1219                              <2>  %else
  1220                              <2>  %assign __count 0
  1221                              <2>  %assign __varg 0
  1222                              <2>  %assign __stop 0
  1223                              <2>  %rep MAX_ARGV
  1224                              <2>  %if __stop == 0
  1225                              <2>  %assign __count (__count + 1)
  1226                              <2>  %ifidni %1, ARGV_%+__count
  1227                              <2>  %assign __varg __count
  1228                              <2>  %assign __stop 1
  1229                              <2>  %endif
  1230                              <2>  %endif
  1231                              <2>  %endrep
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1232                              <2>  %if __varg > 0
  1233                              <2>  section .text
  1234                              <2>  mov si, PTR16(_cA_cmd_buf)
  1235                              <2>  mov bl, __varg
  1236                              <2>  call getCommandLine_Arg
  1237                              <2>  call PutStrColor
  1238                              <2>  %else
  1239                              <2>  section .text
  1240 0000072E B302                <2>  mov bl, %2
  1241 00000730 BE(3404)            <2>  mov si, PTR16(_cA_%1)
  1242 00000733 E8D707              <2>  call PutStrColor
  1243                              <2>  %endif
  1244                              <2>  %undef __varg
  1245                              <2>  %endif
  1246                              <2>  %endif
  1247                              <2> %else
  1248                              <2>  %error 'this macro is only for DOS programming.'
  1249                              <2> %endif
   910 00000736 EB05                <1>     jmp exit1
   911                              <1> 
   912                              <1> exit0:
   913                              <1>     DOS_Exit 0
  1275                              <2> %if DOS_SHELL == 1
  1276                              <2>  %ifidni %1, ax
  1277                              <2>  %error 'AX not allowed here.'
  1278                              <2>  %elifidni %1, bx
  1279                              <2>  mov ax, 0x4C00
  1280                              <2>  or ax, bx
  1281                              <2>  SysCall
  1282                              <2>  %elifidni %1, CX
  1283                              <2>  mov ax, 0x4C00
  1284                              <2>  or ax, cx
  1285                              <2>  SysCall
  1286                              <2>  %elifidni %1, dx
  1287                              <2>  mov ax, 0x4C00
  1288                              <2>  or ax, dx
  1289                              <2>  SysCall
  1290                              <2>  %elifnum %1
  1291 00000738 B8004C              <2>  mov ax, 0x4C00 | %1
  1292                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 0000073B CD21                <3>  int 0x21
    68                              <3> %endif
  1293                              <2>  %else
  1294                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <2>  %endif
  1296                              <2> %endif
   914                              <1> exit1:
   915                              <1>     DOS_Exit 1
  1275                              <2> %if DOS_SHELL == 1
  1276                              <2>  %ifidni %1, ax
  1277                              <2>  %error 'AX not allowed here.'
  1278                              <2>  %elifidni %1, bx
  1279                              <2>  mov ax, 0x4C00
  1280                              <2>  or ax, bx
  1281                              <2>  SysCall
  1282                              <2>  %elifidni %1, CX
  1283                              <2>  mov ax, 0x4C00
  1284                              <2>  or ax, cx
  1285                              <2>  SysCall
  1286                              <2>  %elifidni %1, dx
  1287                              <2>  mov ax, 0x4C00
  1288                              <2>  or ax, dx
  1289                              <2>  SysCall
  1290                              <2>  %elifnum %1
  1291 0000073D B8014C              <2>  mov ax, 0x4C00 | %1
  1292                              <2>  SysCall
    66                              <3> %if DOS_SHELL == 1
    67 00000740 CD21                <3>  int 0x21
    68                              <3> %endif
  1293                              <2>  %else
  1294                              <2>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <2>  %endif
  1296                              <2> %endif
   916                              <1> 
   917                              <1> ;------------------------------------------------------------------------------
   918                              <1> ; dbfhead.asm - dBASE IV DBF-Header anzeigen (DOS .COM)
   919                              <1> ; Assemble: nasm -f bin dbfhead.asm -o DBFHEAD.COM
   920                              <1> ; Lauf:      DBFHEAD TEST.DBF
   921                              <1> ; -----------------------------------------------------------------------------
   922                              <1>     ; Kommandozeile aus PSP:80h holen -> Dateiname parsen
   923 00000742 BE8000              <1>     mov si, 80h            ; PSP:80h = Längenbyte gefolgt vom Tail
   924 00000745 AC                  <1>     lodsb                  ; AL = Länge
   925 00000746 88C3                <1>     mov bl, al             ; BL = verbleibende Zeichen
   926 00000748 0F84AC01            <1>     jz  .usage
   927 0000074C BF(6316)            <1>     mov di, PTR16(filename)
   928 0000074F E83D02              <1>     call skip_spaces_2
   929 00000752 0F82A201            <1>     jc  .usage
   930 00000756 E85202              <1>     call copy_token_to_di_2  ; kopiert bis Space/CR
   931 00000759 C60500              <1>     mov byte [di], 0       ; 0-terminiert
   932                              <1> 
   933                              <1>     ; Datei öffnen (INT 21h, 3Dh)
   934 0000075C BA(6316)            <1>     mov dx, PTR16(filename)
   935 0000075F B8003D              <1>     mov ax, 3D00h          ; AH=3Dh open, AL=0 read-only
   936 00000762 CD21                <1>     int 21h
   937 00000764 0F829801            <1>     jc  .open_fail
   938 00000768 A3(F31E)            <1>     mov [PTR16(hFile)], ax
   939                              <1> 
   940                              <1>     ; 32 Bytes Header lesen
   941 0000076B 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   942 0000076F BA(3F1F)            <1>     mov dx, PTR16(header)
   943 00000772 B92000              <1>     mov cx, 32
   944 00000775 B43F                <1>     mov ah, 3Fh
   945 00000777 CD21                <1>     int 21h
   946 00000779 0F828B01            <1>     jc  .read_fail
   947 0000077D 83F820              <1>     cmp ax, 32
   948 00000780 0F858401            <1>     jne .read_fail
   949                              <1> 
   950                              <1>     ; Headerfelder auswerten
   951                              <1>     ; Version
   952 00000784 A0(3F1F)            <1>     mov al, [PTR16(header) + 0]
   953 00000787 A2(F31E)            <1>     mov [PTR16(verByte)], al
   954                              <1> 
   955                              <1>     ; Datum: YY, MM, DD (Bytes 1..3)
   956 0000078A A0(401F)            <1>     mov al, [PTR16(header) + 1]
   957 0000078D A2(F31E)            <1>     mov [PTR16(yy)], al
   958 00000790 A0(411F)            <1>     mov al, [PTR16(header) + 2]
   959 00000793 A2(F31E)            <1>     mov [PTR16(mm)], al
   960 00000796 A0(421F)            <1>     mov al, [PTR16(header) + 3]
   961 00000799 A2(F31E)            <1>     mov [PTR16(dd)], al
   962                              <1> 
   963                              <1>     ; Anzahl Datensätze (4..7) -> 32-bit LE in regs: DX:AX
   964 0000079C A1(431F)            <1>     mov ax, [PTR16(header) + 4]
   965 0000079F 8B16(451F)          <1>     mov dx, [PTR16(header) + 6]
   966 000007A3 A3(F31E)            <1>     mov [PTR16(rec32) + 0], ax
   967 000007A6 8916(F51E)          <1>     mov [PTR16(rec32) + 2], dx
   968                              <1> 
   969                              <1>     ; Headerlänge (8..9), Satzlänge (10..11)
   970 000007AA A1(471F)            <1>     mov ax, [PTR16(header) +  8]
   971 000007AD A3(A608)            <1>     mov [PTR16(hdr_len)], ax
   972 000007B0 A1(491F)            <1>     mov ax, [PTR16(header) + 10]
   973 000007B3 A3(A808)            <1>     mov [PTR16(rec_len)], ax
   974                              <1> 
   975                              <1>     ; MDX-Flag (28), Languagedriver (29)
   976 000007B6 A0(5B1F)            <1>     mov al, [PTR16(header)+28]
   977 000007B9 A2(F31E)            <1>     mov [PTR16(mdx)], al
   978 000007BC A0(5C1F)            <1>     mov al, [PTR16(header)+29]
   979 000007BF A2(F31E)            <1>     mov [PTR16(lang)], al
   980                              <1> 
   981                              <1>     ; Ausgabe Header-Info
   982 000007C2 BA(D101)            <1>     mov dx, PTR16(msgTitle)
   983 000007C5 E8F0FE              <1>     call print_$
   984                              <1> 
   985 000007C8 BA(5102)            <1>     mov dx, PTR16(msgVer)
   986 000007CB E8EAFE              <1>     call print_$
   987 000007CE A0(F31E)            <1>     mov al, [PTR16(verByte)]
   988 000007D1 E84E01              <1>     call print_hex8
   989                              <1>     DOS_crlf
  1305 000007D4 E8F406              <2>  call DOSrncrlf
   990                              <1> 
   991 000007D7 BA(6102)            <1>     mov dx, PTR16(msgDate)
   992 000007DA E8DBFE              <1>     call print_$
   993 000007DD A0(F31E)            <1>     mov al, [PTR16(yy)]
   994 000007E0 E87301              <1>     call print_dec8
   995 000007E3 B02D                <1>     mov al, '-'
   996 000007E5 E8DA06              <1>     call putc
   997 000007E8 A0(F31E)            <1>     mov al, [PTR16(mm)]
   998 000007EB E86801              <1>     call print_dec8
   999 000007EE B02D                <1>     mov al, '-'
  1000 000007F0 E8CF06              <1>     call putc
  1001 000007F3 A0(F31E)            <1>     mov al, [PTR16(dd)]
  1002 000007F6 E85D01              <1>     call print_dec8
  1003                              <1>     DOS_crlf
  1305 000007F9 E8CF06              <2>  call DOSrncrlf
  1004                              <1> 
  1005 000007FC BA(7402)            <1>     mov dx, PTR16(msgRecs)
  1006 000007FF E8B6FE              <1>     call print_$
  1007                              <1>     ; 32-bit hex ausgeben: DX:AX aus rec32
  1008 00000802 A1(F31E)            <1>     mov ax, [PTR16(rec32) + 0]
  1009 00000805 8B16(F51E)          <1>     mov dx, [PTR16(rec32) + 2]
  1010 00000809 E83D01              <1>     call print_hex32
  1011                              <1>     DOS_crlf
  1305 0000080C E8BC06              <2>  call DOSrncrlf
  1012                              <1> 
  1013 0000080F BA(8F02)            <1>     mov dx, PTR16(msgHdr)
  1014 00000812 E8A3FE              <1>     call print_$
  1015 00000815 A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
  1016 00000818 E84301              <1>     call print_dec16
  1017                              <1>     DOS_crlf
  1305 0000081B E8AD06              <2>  call DOSrncrlf
  1018                              <1> 
  1019 0000081E BA(A602)            <1>     mov dx, PTR16(msgRec)
  1020 00000821 E894FE              <1>     call print_$
  1021 00000824 A1(A808)            <1>     mov ax, [PTR16(rec_len)]
  1022 00000827 E83401              <1>     call print_dec16
  1023                              <1>     DOS_crlf
  1305 0000082A E89E06              <2>  call DOSrncrlf
  1024                              <1> 
  1025 0000082D BA(BB02)            <1>     mov dx, PTR16(msgMDX)
  1026 00000830 E885FE              <1>     call print_$
  1027 00000833 A0(F31E)            <1>     mov al, [PTR16(mdx)]
  1028 00000836 E8E900              <1>     call print_hex8
  1029                              <1>     DOS_crlf
  1305 00000839 E88F06              <2>  call DOSrncrlf
  1030                              <1> 
  1031 0000083C BA(CC02)            <1>     mov dx, PTR16(msgLang)
  1032 0000083F E876FE              <1>     call print_$
  1033 00000842 A0(F31E)            <1>     mov al, [PTR16(lang)]
  1034 00000845 E8DA00              <1>     call print_hex8
  1035                              <1>     DOS_crlf
  1305 00000848 E88006              <2>  call DOSrncrlf
  1036                              <1>     DOS_crlf
  1305 0000084B E87D06              <2>  call DOSrncrlf
  1037                              <1> 
  1038                              <1>     ; Feld-Deskriptoren lesen:
  1039                              <1>     ; Anzahl Bytes bis Terminator = hdr_len - 32
  1040 0000084E A1(A608)            <1>     mov ax, [PTR16(hdr_len)]
  1041 00000851 83E820              <1>     sub ax, 32
  1042 00000854 0F869500            <1>     jbe .no_fields
  1043 00000858 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
  1044 0000085C BA(E316)            <1>     mov dx,  PTR16(fdbuf)
  1045 0000085F 89C1                <1>     mov cx, ax
  1046 00000861 B43F                <1>     mov ah, 3Fh
  1047 00000863 CD21                <1>     int 21h
  1048 00000865 0F829F00            <1>     jc  .read_fail
  1049                              <1>     ; AX = tatsächlich gelesene Bytes
  1050                              <1> 
  1051 00000869 BA(E702)            <1>     mov dx, PTR16(msgFields)
  1052 0000086C E849FE              <1>     call print_$
  1053                              <1>     DOS_crlf
  1305 0000086F E85906              <2>  call DOSrncrlf
  1054                              <1> 
  1055                              <1>     ; Durch fdbuf iterieren: 32-Byte Blöcke bis 0Dh
  1056 00000872 BE(E316)            <1>     mov si, PTR16(fdbuf)
  1057 00000875 89C1                <1>     mov cx, ax           ; CX = bytes available
  1058 00000877 31ED                <1>     xor bp, bp           ; BP = Feldindex
  1059                              <1> 
  1060                              <1>     .next_field:
  1061 00000879 83F900              <1>     cmp cx, 0
  1062 0000087C 766D                <1>     jbe .done_fields
  1063                              <1>     ; Terminator?
  1064 0000087E 803C0D              <1>     cmp byte [si], 0Dh
  1065 00000881 7468                <1>     je  .done_fields
  1066                              <1> 
  1067                              <1>     ; Feldnummer ausgeben
  1068 00000883 45                  <1>     inc bp
  1069 00000884 BA(0A03)            <1>     mov dx, PTR16(msgFieldN)
  1070 00000887 E82EFE              <1>     call print_$
  1071 0000088A 89E8                <1>     mov ax, bp
  1072 0000088C E8CF00              <1>     call print_dec16
  1073 0000088F BA(1303)            <1>     mov dx, PTR16(msgColonSp)
  1074 00000892 E823FE              <1>     call print_$
  1075                              <1> 
  1076                              <1>     ; Feldname (11 Byte, 0-terminiert)
  1077                              <1>     ; Wir kopieren/normalisieren in namebuf
  1078 00000895 56                  <1>     push si
  1079 00000896 BF(E31E)            <1>     mov di, PTR16(_cA_namebuf)
  1080 00000899 BB0B00              <1>     mov bx, 11
  1081                              <1>     .copy_name:
  1082 0000089C 8A04                <1>     mov al, [si]
  1083 0000089E 3C00                <1>     cmp al, 0
  1084 000008A0 7409                <1>     je  .pad_zero
  1085                              <1>     ; Nur druckbare? Einfach übernehmen
  1086 000008A2 8805                <1>     mov [di], al
  1087 000008A4 47                  <1>     inc di
  1088 000008A5 46                  <1>     inc si
  1089 000008A6 4B                  <1>     dec bx
  1090 000008A7 75F3                <1>     jnz .copy_name
  1091 000008A9 EB02                <1>     jmp short .name_done
  1092                              <1>     .pad_zero:
  1093 000008AB 8805                <1>     mov [di], al
  1094                              <1>     .name_done:
  1095 000008AD C60500              <1>     mov byte [di], 0
  1096                              <1>     ; Ausgabe Name
  1097                              <1>     DOS_Write namebuf
  1314 000008B0 8D16(E31E)          <2>  lea dx, [PTR16(_cA_%1)]
  1315 000008B4 E84206              <2>  call DOS_ConsoleWrite
  1098 000008B7 BA(1603)            <1>     mov dx, PTR16(msgCommaSp)
  1099 000008BA E8FBFD              <1>     call print_$
  1100                              <1> 
  1101                              <1>     ; Feldtyp (Byte 11)
  1102 000008BD 5E                  <1>     pop si               ; si zurück auf Start des FD
  1103 000008BE 8A440B              <1>     mov al, [si+11]
  1104 000008C1 E8FE05              <1>     call putc
  1105 000008C4 BA(1603)            <1>     mov dx, PTR16(msgCommaSp)
  1106 000008C7 E8EEFD              <1>     call print_$
  1107                              <1> 
  1108                              <1>     ; Länge (Byte 16), Dezimal (Byte 17)
  1109 000008CA 8A4410              <1>     mov al, [si+16]
  1110 000008CD B400                <1>     mov ah, 0
  1111 000008CF E88C00              <1>     call print_dec16
  1112 000008D2 BA(1903)            <1>     mov dx, PTR16(msgSlash)
  1113 000008D5 E8E0FD              <1>     call print_$
  1114 000008D8 8A4411              <1>     mov al, [si+17]
  1115 000008DB B400                <1>     mov ah, 0
  1116 000008DD E87E00              <1>     call print_dec16
  1117                              <1>     DOS_crlf
  1305 000008E0 E8E805              <2>  call DOSrncrlf
  1118                              <1> 
  1119                              <1>     ; Nächster Descriptor
  1120 000008E3 83C620              <1>     add si, 32
  1121 000008E6 83E920              <1>     sub cx, 32
  1122 000008E9 EB8E                <1>     jmp .next_field
  1123                              <1> 
  1124                              <1>     .done_fields:
  1125 000008EB EB23                <1>     jmp .close_and_exit
  1126                              <1> 
  1127                              <1>     .no_fields:
  1128 000008ED BA(F102)            <1>     mov dx, PTR16(msgNoFields)
  1129 000008F0 E8C5FD              <1>     call print_$
  1130                              <1>     DOS_crlf
  1305 000008F3 E8D505              <2>  call DOSrncrlf
  1131 000008F6 EB18                <1>     jmp .close_and_exit
  1132                              <1> 
  1133                              <1> ; ----- Fehlerpfade & Exit -----
  1134                              <1>     .usage:
  1135 000008F8 BA(E701)            <1>     mov dx, PTR16(msgUsage)
  1136 000008FB E8BAFD              <1>     call print_$
  1137 000008FE EB18                <1>     jmp .exit
  1138                              <1> 
  1139                              <1>     .open_fail:
  1140 00000900 BA(0402)            <1>     mov dx, PTR16(msgOpenErr)
  1141 00000903 E8B2FD              <1>     call print_$
  1142 00000906 EB10                <1>     jmp .exit
  1143                              <1> 
  1144                              <1>     .read_fail:
  1145 00000908 BA(3102)            <1>     mov dx, PTR16(msgReadErr)
  1146 0000090B E8AAFD              <1>     call print_$
  1147 0000090E EB00                <1>     jmp .close_and_exit
  1148                              <1> 
  1149                              <1>     .close_and_exit:
  1150 00000910 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
  1151 00000914 B43E                <1>     mov ah, 3Eh
  1152 00000916 CD21                <1>     int 21h
  1153                              <1>     .exit:
  1154 00000918 B8004C              <1>     mov ax, 4C00h
  1155 0000091B CD21                <1>     int 21h
  1156                              <1> 
  1157                              <1> ; ======== Hilfsroutinen ========
  1158                              <1> ; print_$: DX -> '$'-terminierte Zeichenkette
  1159                              <1> print_$_2:
  1160 0000091D B409                <1>     mov ah, 09h
  1161 0000091F CD21                <1>     int 21h
  1162 00000921 C3                  <1>     ret
  1163                              <1> 
  1164                              <1> ; print_hex8: AL -> 2 HEX
  1165                              <1> print_hex8:
  1166 00000922 50                  <1>     push ax
  1167 00000923 53                  <1>     push bx
  1168 00000924 88C3                <1>     mov bl, al
  1169 00000926 88C7                <1>     mov bh, al
  1170 00000928 C0EB04              <1>     shr bl, 4
  1171 0000092B 80E70F              <1>     and bh, 0Fh
  1172 0000092E 88D8                <1>     mov al, bl
  1173 00000930 E80800              <1>     call hex_nibble
  1174 00000933 88F8                <1>     mov al, bh
  1175 00000935 E80300              <1>     call hex_nibble
  1176 00000938 5B                  <1>     pop bx
  1177 00000939 58                  <1>     pop ax
  1178 0000093A C3                  <1>     ret
  1179                              <1> 
  1180                              <1> hex_nibble:
  1181 0000093B 240F                <1>     and al, 0Fh
  1182 0000093D 3C09                <1>     cmp al, 9
  1183 0000093F 7602                <1>     jbe .digit
  1184 00000941 0407                <1>     add al, 7
  1185                              <1>     .digit:
  1186 00000943 0430                <1>     add al, '0'
  1187 00000945 E87A05              <1>     call putc
  1188 00000948 C3                  <1>     ret
  1189                              <1> 
  1190                              <1> ; print_hex32: DX:AX -> 8 HEX
  1191                              <1> print_hex32:
  1192 00000949 50                  <1>     push ax
  1193 0000094A 52                  <1>     push dx
  1194 0000094B 89D0                <1>     mov ax, dx
  1195 0000094D E8C8F8              <1>     call print_hex16
  1196 00000950 5A                  <1>     pop dx
  1197 00000951 58                  <1>     pop ax
  1198 00000952 E8C3F8              <1>     call print_hex16
  1199 00000955 C3                  <1>     ret
  1200                              <1> 
  1201                              <1> ; print_dec8: AL (0..255) ohne führende Nullen
  1202                              <1> print_dec8:
  1203 00000956 50                  <1>     push ax
  1204 00000957 30E4                <1>     xor ah, ah
  1205 00000959 E80200              <1>     call print_dec16
  1206 0000095C 58                  <1>     pop ax
  1207 0000095D C3                  <1>     ret
  1208                              <1> 
  1209                              <1> ; print_dec16: AX -> dezimal ohne führende Nullen
  1210                              <1> ; einfache Division durch 10
  1211                              <1> print_dec16:
  1212 0000095E 50                  <1>     push ax
  1213 0000095F 53                  <1>     push bx
  1214 00000960 52                  <1>     push dx
  1215 00000961 51                  <1>     push cx
  1216 00000962 B90000              <1>     mov cx, 0          ; Zähler Ziffern im Stack
  1217 00000965 83F800              <1>     cmp ax, 0
  1218 00000968 7507                <1>     jne .pd_loop
  1219 0000096A B030                <1>     mov al, '0'
  1220 0000096C E85305              <1>     call putc
  1221 0000096F EB19                <1>     jmp .pd_done
  1222                              <1>     .pd_loop:
  1223 00000971 31D2                <1>     xor dx, dx
  1224 00000973 BB0A00              <1>     mov bx, 10
  1225 00000976 F7F3                <1>     div bx            ; AX = AX/10, DX = Rest
  1226 00000978 52                  <1>     push dx           ; Rest (Ziffer)
  1227 00000979 41                  <1>     inc cx
  1228 0000097A 83F800              <1>     cmp ax, 0
  1229 0000097D 75F2                <1>     jne .pd_loop
  1230                              <1>     .pd_out:
  1231 0000097F 5A                  <1>     pop dx
  1232 00000980 80C230              <1>     add dl, '0'
  1233 00000983 88D0                <1>     mov al, dl
  1234 00000985 E83A05              <1>     call putc
  1235 00000988 E2F5                <1>     loop .pd_out
  1236                              <1>     .pd_done:
  1237 0000098A 59                  <1>     pop cx
  1238 0000098B 5A                  <1>     pop dx
  1239 0000098C 5B                  <1>     pop bx
  1240 0000098D 58                  <1>     pop ax
  1241 0000098E C3                  <1>     ret
  1242                              <1> 
  1243                              <1> ; --- Kommandozeilen-Parsing ---
  1244                              <1> ; skip_spaces: SI->Tail, BL=Restlänge. Setzt ZF=1 wenn nichts übrig.
  1245                              <1> skip_spaces_2:
  1246 0000098F 50                  <1>     push ax
  1247                              <1>     .ss_loop:
  1248 00000990 80FB00              <1>     cmp bl, 0
  1249 00000993 7413                <1>     jz  .ss_empty
  1250 00000995 8A04                <1>     mov al, [si]
  1251 00000997 46                  <1>     inc si
  1252 00000998 FECB                <1>     dec bl
  1253 0000099A 3C20                <1>     cmp al, ' '
  1254 0000099C 74F2                <1>     jz  .ss_loop
  1255 0000099E 3C09                <1>     cmp al, 9
  1256 000009A0 74EE                <1>     jz  .ss_loop
  1257                              <1>     ; ein Nicht-Leerzeichen gesehen -> SI eine Position zurück
  1258 000009A2 4E                  <1>     dec si
  1259 000009A3 FEC3                <1>     inc bl
  1260 000009A5 F8                  <1>     clc
  1261 000009A6 58                  <1>     pop ax
  1262 000009A7 C3                  <1>     ret
  1263                              <1>     .ss_empty:
  1264 000009A8 F9                  <1>     stc
  1265 000009A9 58                  <1>     pop ax
  1266 000009AA C3                  <1>     ret
  1267                              <1> 
  1268                              <1> ; copy_token_to_di: kopiert ab SI bis Space/CR nach DI, aktualisiert SI/BL
  1269                              <1> copy_token_to_di_2:
  1270 000009AB 50                  <1>     push ax
  1271                              <1>     .ct_loop:
  1272 000009AC 80FB00              <1>     cmp bl, 0
  1273 000009AF 7412                <1>     jz  .ct_done
  1274 000009B1 8A04                <1>     mov al, [si]
  1275 000009B3 3C0D                <1>     cmp al, 13         ; CR
  1276 000009B5 740C                <1>     je  .ct_done
  1277 000009B7 3C20                <1>     cmp al, ' '
  1278 000009B9 7408                <1>     je  .ct_done
  1279 000009BB 8805                <1>     mov [di], al
  1280 000009BD 47                  <1>     inc di
  1281 000009BE 46                  <1>     inc si
  1282 000009BF FECB                <1>     dec bl
  1283 000009C1 EBE9                <1>     jmp .ct_loop
  1284                              <1>     .ct_done:
  1285 000009C3 58                  <1>     pop ax
  1286 000009C4 C3                  <1>     ret
  1287                              <1>     
  1288                              <1> ; ---- Hilfen ---------------------------------------------------
  1289                              <1> MAXLEN equ 63
  1290                              <1> 
  1291                              <1> ; Zeigt "Open error AX=xxxx" (bx enthält Fehlercode)
  1292                              <1> print_err_ax_bx:
  1293 000009C5 50                  <1>     push ax
  1294 000009C6 51                  <1>     push cx
  1295 000009C7 52                  <1>     push dx
  1296 000009C8 BA(5601)            <1>     mov  dx, PTR16(msgErr)
  1297 000009CB B409                <1>     mov  ah, 0x09
  1298 000009CD CD21                <1>     int  0x21
  1299 000009CF 89D8                <1>     mov  ax, bx
  1300 000009D1 E80B00              <1>     call print_ax_hex
  1301 000009D4 BA(8001)            <1>     mov  dx, PTR16(crlf)
  1302 000009D7 B409                <1>     mov  ah, 0x09
  1303 000009D9 CD21                <1>     int  0x21
  1304 000009DB 5A                  <1>     pop  dx
  1305 000009DC 59                  <1>     pop  cx
  1306 000009DD 58                  <1>     pop  ax
  1307 000009DE C3                  <1>     ret
  1308                              <1> 
  1309                              <1> ; AX als 4 hex-Zeichen ausgeben
  1310                              <1> print_ax_hex:
  1311 000009DF 50                  <1>     push ax
  1312 000009E0 53                  <1>     push bx
  1313 000009E1 51                  <1>     push cx
  1314 000009E2 52                  <1>     push dx
  1315 000009E3 89C3                <1>     mov  bx, ax
  1316 000009E5 B90400              <1>     mov  cx, 4
  1317                              <1>     .hexloop:
  1318 000009E8 C1C304              <1>     rol  bx, 4
  1319 000009EB 88D8                <1>     mov  al, bl
  1320 000009ED 240F                <1>     and  al, 0x0F
  1321 000009EF 0430                <1>     add  al, '0'
  1322 000009F1 3C39                <1>     cmp  al, '9'
  1323 000009F3 7602                <1>     jbe  .put
  1324 000009F5 0407                <1>     add  al, 7
  1325                              <1>     .put:
  1326 000009F7 88C2                <1>     mov  dl, al
  1327 000009F9 B402                <1>     mov  ah, 0x02
  1328 000009FB CD21                <1>     int  0x21
  1329 000009FD E2E9                <1>     loop .hexloop
  1330 000009FF 5A                  <1>     pop  dx
  1331 00000A00 59                  <1>     pop  cx
  1332 00000A01 5B                  <1>     pop  bx
  1333 00000A02 58                  <1>     pop  ax
  1334 00000A03 C3                  <1>     ret
  1335                              <1> 
  1336                              <1> ; ------------------------------------------------------------
  1337                              <1> ; Hilfsroutine: ein Zeichen an aktuelles arg_str anhängen,
  1338                              <1> ;               maximal 63 Nutzzeichen. Bei Overflow werden
  1339                              <1> ;               zusätzliche Zeichen bis zum nächsten Separator
  1340                              <1> ;               verworfen (wir schreiben einfach nicht mehr).
  1341                              <1> ; IN:
  1342                              <1> ;   AL = Zeichen
  1343                              <1> ;   DI = Schreibzeiger (zeigt immer auf nächste freie Stelle)
  1344                              <1> ;   CX = aktuelle Länge (0..63)
  1345                              <1> ; OUT:
  1346                              <1> ;   DI/CX aktualisiert
  1347                              <1> ; Zerstört: nichts weiter (AX benutzt)
  1348                              <1> ; ------------------------------------------------------------
  1349                              <1> put_char_maybe:
  1350 00000A04 83F93F              <1>     cmp     cx, 63
  1351 00000A07 7303                <1>     jae     .skip_write
  1352 00000A09 AA                  <1>     stosb                   ; [DI] = AL, DI++
  1353 00000A0A 41                  <1>     inc     cx
  1354 00000A0B C3                  <1>     ret
  1355                              <1> .skip_write:
  1356                              <1>     ; Zeichen verwerfen (nichts schreiben)
  1357 00000A0C C3                  <1>     ret
  1358                              <1> 
  1359                              <1> ; DS:SI -> ASCIIZ
  1360                              <1> print_z0:
  1361                              <1>     .loop:
  1362 00000A0D AC                  <1>     lodsb
  1363 00000A0E 84C0                <1>     test    al, al
  1364 00000A10 7408                <1>     jz      .done
  1365 00000A12 88C2                <1>     mov     dl, al
  1366 00000A14 B402                <1>     mov     ah, 02h
  1367                              <1>     SysCall
    66                              <2> %if DOS_SHELL == 1
    67 00000A16 CD21                <2>  int 0x21
    68                              <2> %endif
  1368 00000A18 EBF3                <1>     jmp     .loop
  1369                              <1>     .done:
  1370 00000A1A C3                  <1>     ret
  1371                              <1> 
  1372                              <1> ; -----------------------------------------------------------------------------
  1373                              <1> ; \brief include DOS 16-bit stdlib function's ...
  1374                              <1> ; -----------------------------------------------------------------------------
  1375                              <1> %include 'CommandLineArg.asm'       ; get command line arguments
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  CommandLineArg.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief  Sucht den n-ten (1-basiert) Token im ASCIIZ-String bei DS:SI,
    11                              <2> ;         ersetzt das erste Leerzeichen NACH dem Token durch 0 und
    12                              <2> ;         liefert SI auf den Tokenstart (C-String).
    13                              <2> ; \param  Eingabe:
    14                              <2> ;         DS:SI -> 0-terminierter String (muss schreibbar sein!)
    15                              <2> ;         BL    = n (1 = erster Token)
    16                              <2> ; \return Ausgabe bei Erfolg (CF=0):
    17                              <2> ;         SI    = Startadresse des Tokens (in DS)
    18                              <2> ;         CX    = Länge des Tokens
    19                              <2> ; \error  Bei Misserfolg (CF=1): CX=0, SI undefiniert
    20                              <2> ; \note   Verändert: AX, CX, DX, SI, DI, FLAGS
    21                              <2> ; -----------------------------------------------------------------------------
    22                              <2> getCommandLine_Arg:
    23                              <2>     ;push di
    24 00000A1B 84DB                <2>     test bl, bl
    25 00000A1D 7503                <2>     jnz .start
    26 00000A1F F9                  <2>     stc
    27 00000A20 EB4E                <2>     jmp .ret
    28                              <2> 
    29                              <2>     .start:
    30                              <2>     ; führende Leerzeichen überspringen
    31                              <2>     .skip_spaces_lead:
    32 00000A22 AC                  <2>     lodsb                      ; AL=[SI], SI++
    33 00000A23 3C20                <2>     cmp  al, ' '
    34 00000A25 74FB                <2>     je   .skip_spaces_lead
    35 00000A27 3C00                <2>     cmp  al, 0
    36 00000A29 7442                <2>     je   .not_found
    37                              <2> 
    38                              <2>     ; AL ist erstes Zeichen eines Tokens
    39 00000A2B 89F2                <2>     mov  dx, si
    40 00000A2D 4A                  <2>     dec  dx                    ; DX = Start dieses Tokens
    41 00000A2E BF0100              <2>     mov  di, 1                 ; di = aktueller Tokenindex (1-basiert)
    42                              <2> 
    43 00000A31 39DF                <2>     cmp  di, bx
    44 00000A33 741C                <2>     je   .measure_this
    45                              <2> 
    46                              <2>     ; aktuellen Token bis zum Leerzeichen/0 überspringen
    47                              <2>     .skip_this_token:
    48 00000A35 AC                  <2>     lodsb
    49 00000A36 3C00                <2>     cmp  al, 0
    50 00000A38 7433                <2>     je   .not_found
    51 00000A3A 3C20                <2>     cmp  al, ' '
    52 00000A3C 75F7                <2>     jne  .skip_this_token
    53                              <2> 
    54                              <2>     ; Folge-Leerzeichen überspringen
    55                              <2>     .skip_spaces_mid:
    56 00000A3E AC                  <2>     lodsb
    57 00000A3F 3C00                <2>     cmp  al, 0
    58 00000A41 742A                <2>     je   .not_found
    59 00000A43 3C20                <2>     cmp  al, ' '
    60 00000A45 74F7                <2>     je   .skip_spaces_mid
    61                              <2> 
    62                              <2>     ; Beginn des nächsten Tokens
    63 00000A47 47                  <2>     inc  di
    64 00000A48 89F2                <2>     mov  dx, si
    65 00000A4A 4A                  <2>     dec  dx
    66 00000A4B 39DF                <2>     cmp  di, bx
    67 00000A4D 7402                <2>     je   .measure_this
    68 00000A4F EBE4                <2>     jmp  .skip_this_token
    69                              <2> 
    70                              <2>     .measure_this:
    71                              <2>     ; SI steht bereits auf 2. Zeichen des Tokens (erstes war in AL)
    72 00000A51 B90100              <2>     mov  cx, 1                 ; bisher 1 Zeichen gezählt
    73                              <2>     .len_loop:
    74 00000A54 AC                  <2>     lodsb
    75 00000A55 3C00                <2>     cmp  al, 0
    76 00000A57 7407                <2>     je   .done_len             ; Token endet am Stringende (bereits 0-terminiert)
    77 00000A59 3C20                <2>     cmp  al, ' '
    78 00000A5B 7403                <2>     je   .done_len             ; Token endet am Leerzeichen
    79 00000A5D 41                  <2>     inc  cx
    80 00000A5E EBF4                <2>     jmp  .len_loop
    81                              <2> 
    82                              <2>     .done_len:
    83                              <2>     ; Wenn das Ende durch Leerzeichen kam, dieses in 0 verwandeln.
    84 00000A60 3C20                <2>     cmp  al, ' '
    85 00000A62 7504                <2>     jne  .keep_zt              ; AL==0 -> bereits 0-terminiert
    86 00000A64 C644FF00            <2>     mov  byte [si-1], 0        ; letztes gelesenes Zeichen (Leerzeichen) überschreiben
    87                              <2>     .keep_zt:
    88 00000A68 89D6                <2>     mov  si, dx                ; SI = Start des Tokens
    89 00000A6A F8                  <2>     clc
    90 00000A6B EB03                <2>     jmp  .ret
    91                              <2> 
    92                              <2>     .not_found:
    93 00000A6D 31C9                <2>     xor  cx, cx
    94 00000A6F F9                  <2>     stc
    95                              <2> 
    96                              <2>     .ret:
    97                              <2>     ;pop  di
    98 00000A70 C3                  <2>     ret
  1376                              <1> %include 'ConsoleCursor.asm'        ; set the teletype video text cursor
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ConsoleCursor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> dos_set_cursor:
    11 00000A71 8816(C501)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    12 00000A75 8836(C601)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    13                              <2>     ;---
    14 00000A79 B700                <2>     mov  bh, 0                   ; todo
    15 00000A7B 883E(C701)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    16                              <2>     ;---
    17 00000A7F B402                <2>     mov  ah, 02h
    18                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000A81 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    19 00000A83 C3                  <2>     ret
    20                              <2> 
    21                              <2> dos_get_cursor:
    22 00000A84 57                  <2>     push di
    23 00000A85 56                  <2>     push si
    24 00000A86 53                  <2>     push bx
    25 00000A87 52                  <2>     push dx
    26                              <2>     
    27 00000A88 B700                <2>     mov  bh, 0                   ; todo
    28 00000A8A B403                <2>     mov  ah, 0x03
    29                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000A8C CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    30 00000A8E 8816(C501)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    31 00000A92 8836(C601)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    32 00000A96 883E(C701)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    33                              <2>     
    34 00000A9A 5A                  <2>     pop  dx
    35 00000A9B 5B                  <2>     pop  bx
    36 00000A9C 5E                  <2>     pop  si
    37 00000A9D 5F                  <2>     pop  di
    38 00000A9E C3                  <2>     ret
  1377                              <1> %include 'ErrorCodes.asm'           ; get last error
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ErrorCodes.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief dispatch: search the handler and jump to it ...
    11                              <2> ; -----------------------------------------------------------------------------
    12                              <2> DOS_handle_error_code:
    13                              <2>     ; AX enthält den DOS-Fehlercode
    14 00000A9F 89C3                <2>     mov   bx, ax             ; bx = gesuchter Code
    15 00000AA1 BE[2407]            <2>     mov   si, _cA_error_dispatch
    16                              <2>     .next:
    17 00000AA4 AD                  <2>     lodsw                    ; ax = Tabellencode, si zeigt nun auf Handler-Wort
    18 00000AA5 85C0                <2>     test  ax, ax
    19 00000AA7 740B                <2>     jz    .default           ; 0 -> Ende: Default
    20 00000AA9 39D8                <2>     cmp   ax, bx
    21 00000AAB 7405                <2>     je    .match
    22 00000AAD 83C602              <2>     add   si, 2              ; Handlerwort überspringen
    23 00000AB0 EBF2                <2>     jmp   .next
    24                              <2>     .match:
    25 00000AB2 FF24                <2>     jmp   word [si]          ; indirekter Sprung zum Handler
    26                              <2>     .default:
    27 00000AB4 E9(6D04)            <2>     jmp   _cA_open_error_nd
    28                              <2>     
    29                              <2>     ; ----------------------------------------
    30                              <2>     ; Handler minimal & einheitlich per Makro
    31                              <2>     ; ----------------------------------------
    32                              <2>     DEF_ERROR 01h, open_error_01    ; ungültige Funktiob
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000AB7 E8CAFF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000ABA B31E                <4>  mov bl, %2
  1241 00000ABC BE(7C05)            <4>  mov si, PTR16(_cA_%1)
  1242 00000ABF E84B04              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000AC2 B90100              <3>  mov cx, %1
  1482 00000AC5 E94A03              <3>  jmp _open_exit
    33                              <2>     DEF_ERROR 02h, open_error_02
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000AC8 E8B9FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000ACB B31E                <4>  mov bl, %2
  1241 00000ACD BE(9E05)            <4>  mov si, PTR16(_cA_%1)
  1242 00000AD0 E83A04              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000AD3 B90200              <3>  mov cx, %1
  1482 00000AD6 E93903              <3>  jmp _open_exit
    34                              <2>     DEF_ERROR 03h, open_error_03
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000AD9 E8A8FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000ADC B31E                <4>  mov bl, %2
  1241 00000ADE BE(AE05)            <4>  mov si, PTR16(_cA_%1)
  1242 00000AE1 E82904              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000AE4 B90300              <3>  mov cx, %1
  1482 00000AE7 E92803              <3>  jmp _open_exit
    35                              <2>     DEF_ERROR 04h, open_error_04
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000AEA E897FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000AED B31E                <4>  mov bl, %2
  1241 00000AEF BE(BE05)            <4>  mov si, PTR16(_cA_%1)
  1242 00000AF2 E81804              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000AF5 B90400              <3>  mov cx, %1
  1482 00000AF8 E91703              <3>  jmp _open_exit
    36                              <2>     DEF_ERROR 05h, open_error_05
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000AFB E886FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000AFE B31E                <4>  mov bl, %2
  1241 00000B00 BE(D305)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B03 E80704              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B06 B90500              <3>  mov cx, %1
  1482 00000B09 E90603              <3>  jmp _open_exit
    37                              <2>     DEF_ERROR 06h, open_error_06    ; ungültiger Handle
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B0C E875FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B0F B31E                <4>  mov bl, %2
  1241 00000B11 BE(E205)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B14 E8F603              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B17 B90600              <3>  mov cx, %1
  1482 00000B1A E9F502              <3>  jmp _open_exit
    38                              <2>     DEF_ERROR 07h, open_error_07    ; korrupte Speicherverwaltung
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B1D E864FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B20 B31E                <4>  mov bl, %2
  1241 00000B22 BE(F605)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B25 E8E503              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B28 B90700              <3>  mov cx, %1
  1482 00000B2B E9E402              <3>  jmp _open_exit
    39                              <2>     DEF_ERROR 08h, open_error_08    ; nicht genügend Speicher
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B2E E853FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B31 B31E                <4>  mov bl, %2
  1241 00000B33 BE(0B06)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B36 E8D403              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B39 B90800              <3>  mov cx, %1
  1482 00000B3C E9D302              <3>  jmp _open_exit
    40                              <2>     DEF_ERROR 09h, open_error_09
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B3F E842FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B42 B31E                <4>  mov bl, %2
  1241 00000B44 BE(1B06)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B47 E8C303              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B4A B90900              <3>  mov cx, %1
  1482 00000B4D E9C202              <3>  jmp _open_exit
    41                              <2>     DEF_ERROR 0Ah, open_error_0A
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B50 E831FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B53 B31E                <4>  mov bl, %2
  1241 00000B55 BE(3306)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B58 E8B203              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B5B B90A00              <3>  mov cx, %1
  1482 00000B5E E9B102              <3>  jmp _open_exit
    42                              <2>     DEF_ERROR 0Bh, open_error_0B
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B61 E820FF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B64 B31E                <4>  mov bl, %2
  1241 00000B66 BE(4806)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B69 E8A103              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B6C B90B00              <3>  mov cx, %1
  1482 00000B6F E9A002              <3>  jmp _open_exit
    43                              <2>     DEF_ERROR 0Ch, open_error_0C
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B72 E80FFF              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B75 B31E                <4>  mov bl, %2
  1241 00000B77 BE(5F06)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B7A E89003              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B7D B90C00              <3>  mov cx, %1
  1482 00000B80 E98F02              <3>  jmp _open_exit
    44                              <2>     DEF_ERROR 0Dh, open_error_0D
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B83 E8FEFE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B86 B31E                <4>  mov bl, %2
  1241 00000B88 BE(7506)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B8B E87F03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B8E B90D00              <3>  mov cx, %1
  1482 00000B91 E97E02              <3>  jmp _open_exit
    45                              <2>     DEF_ERROR 0Eh, open_error_0E
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000B94 E8EDFE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000B97 B31E                <4>  mov bl, %2
  1241 00000B99 BE(9406)            <4>  mov si, PTR16(_cA_%1)
  1242 00000B9C E86E03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000B9F B90E00              <3>  mov cx, %1
  1482 00000BA2 E96D02              <3>  jmp _open_exit
    46                              <2>     DEF_ERROR 0Fh, open_error_0F
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BA5 E8DCFE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BA8 B31E                <4>  mov bl, %2
  1241 00000BAA BE(AA06)            <4>  mov si, PTR16(_cA_%1)
  1242 00000BAD E85D03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000BB0 B90F00              <3>  mov cx, %1
  1482 00000BB3 E95C02              <3>  jmp _open_exit
    47                              <2>     DEF_ERROR 10h, open_error_10
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BB6 E8CBFE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BB9 B31E                <4>  mov bl, %2
  1241 00000BBB BE(B906)            <4>  mov si, PTR16(_cA_%1)
  1242 00000BBE E84C03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000BC1 B91000              <3>  mov cx, %1
  1482 00000BC4 E94B02              <3>  jmp _open_exit
    48                              <2>     DEF_ERROR 11h, open_error_11
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BC7 E8BAFE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BCA B31E                <4>  mov bl, %2
  1241 00000BCC BE(DC06)            <4>  mov si, PTR16(_cA_%1)
  1242 00000BCF E83B03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000BD2 B91100              <3>  mov cx, %1
  1482 00000BD5 E93A02              <3>  jmp _open_exit
    49                              <2>     DEF_ERROR 12h, open_error_12
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BD8 E8A9FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BDB B31E                <4>  mov bl, %2
  1241 00000BDD BE(F106)            <4>  mov si, PTR16(_cA_%1)
  1242 00000BE0 E82A03              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000BE3 B91200              <3>  mov cx, %1
  1482 00000BE6 E92902              <3>  jmp _open_exit
    50                              <2>     DEF_ERROR 15h, open_error_15
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BE9 E898FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BEC B31E                <4>  mov bl, %2
  1241 00000BEE BE(1407)            <4>  mov si, PTR16(_cA_%1)
  1242 00000BF1 E81903              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000BF4 B91500              <3>  mov cx, %1
  1482 00000BF7 E91802              <3>  jmp _open_exit
    51                              <2>     DEF_ERROR 1Dh, open_error_1D    ; Seek-Fehler
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000BFA E887FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000BFD B31E                <4>  mov bl, %2
  1241 00000BFF BE(2507)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C02 E80803              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C05 B91D00              <3>  mov cx, %1
  1482 00000C08 E90702              <3>  jmp _open_exit
    52                              <2>     DEF_ERROR 1Eh, open_error_1E    ; kein DOS-Datenträger
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000C0B E876FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000C0E B31E                <4>  mov bl, %2
  1241 00000C10 BE(4207)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C13 E8F702              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C16 B91E00              <3>  mov cx, %1
  1482 00000C19 E9F601              <3>  jmp _open_exit
    53                              <2>     DEF_ERROR 1Fh, open_error_1F
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000C1C E865FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000C1F B31E                <4>  mov bl, %2
  1241 00000C21 BE(4E07)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C24 E8E602              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C27 B91F00              <3>  mov cx, %1
  1482 00000C2A E9E501              <3>  jmp _open_exit
    54                              <2>     DEF_ERROR 20h, open_error_20
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000C2D E854FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000C30 B31E                <4>  mov bl, %2
  1241 00000C32 BE(6307)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C35 E8D502              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C38 B92000              <3>  mov cx, %1
  1482 00000C3B E9D401              <3>  jmp _open_exit
    55                              <2>     DEF_ERROR 21h, open_error_21
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000C3E E843FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000C41 B31E                <4>  mov bl, %2
  1241 00000C43 BE(7B07)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C46 E8C402              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C49 B92100              <3>  mov cx, %1
  1482 00000C4C E9C301              <3>  jmp _open_exit
    56                              <2>     DEF_ERROR 27h, open_error_27
  1479                              <3> _h%1:
  1480                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1201                              <4> %if DOS_SHELL == 1
  1202                              <4>  GET_CURSOR
  1162                              <5> %if DOS_SHELL == 1
  1163 00000C4F E832FE              <5>  call dos_get_cursor
  1164                              <5> %else
  1165                              <5>  %error 'todo: windows'
  1166                              <5> %endif
  1203                              <4>  %ifstr %1
  1204                              <4>  section .data
  1205                              <4>  %%msg: db %1, 0
  1206                              <4>  section .text
  1207                              <4>  mov bl, %2
  1208                              <4>  mov si, PTR16(%%msg)
  1209                              <4>  call PutStrColor
  1210                              <4>  %else
  1211                              <4>  %ifidni %1, DI
  1212                              <4>  section .text
  1213                              <4>  mov bl, %2
  1214                              <4>  call PutStrColor
  1215                              <4>  %elifidni %1, SI
  1216                              <4>  section .text
  1217                              <4>  mov bl, %2
  1218                              <4>  call PutStrColor
  1219                              <4>  %else
  1220                              <4>  %assign __count 0
  1221                              <4>  %assign __varg 0
  1222                              <4>  %assign __stop 0
  1223                              <4>  %rep MAX_ARGV
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1231                              <4>  %endrep
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1232                              <4>  %if __varg > 0
  1233                              <4>  section .text
  1234                              <4>  mov si, PTR16(_cA_cmd_buf)
  1235                              <4>  mov bl, __varg
  1236                              <4>  call getCommandLine_Arg
  1237                              <4>  call PutStrColor
  1238                              <4>  %else
  1239                              <4>  section .text
  1240 00000C52 B31E                <4>  mov bl, %2
  1241 00000C54 BE(8C07)            <4>  mov si, PTR16(_cA_%1)
  1242 00000C57 E8B302              <4>  call PutStrColor
  1243                              <4>  %endif
  1244                              <4>  %undef __varg
  1245                              <4>  %endif
  1246                              <4>  %endif
  1247                              <4> %else
  1248                              <4>  %error 'this macro is only for DOS programming.'
  1249                              <4> %endif
  1481 00000C5A B92700              <3>  mov cx, %1
  1482 00000C5D E9B201              <3>  jmp _open_exit
    57                              <2> 
    58                              <2>     ERR_HANDLER 0x01, 0x02, 0x03, 0x04
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000C60 E821FE              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000C63 B31E                <5>  mov bl, %2
  1241 00000C65 BE(7C05)            <5>  mov si, PTR16(_cA_%1)
  1242 00000C68 E8A202              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000C6B B90100              <4>  mov cx, %1
  1592 00000C6E E9A101              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000C71 E810FE              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000C74 B31E                <5>  mov bl, %2
  1241 00000C76 BE(9E05)            <5>  mov si, PTR16(_cA_%1)
  1242 00000C79 E89102              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000C7C B90200              <4>  mov cx, %1
  1592 00000C7F E99001              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000C82 E8FFFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000C85 B31E                <5>  mov bl, %2
  1241 00000C87 BE(AE05)            <5>  mov si, PTR16(_cA_%1)
  1242 00000C8A E88002              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000C8D B90300              <4>  mov cx, %1
  1592 00000C90 E97F01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000C93 E8EEFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000C96 B31E                <5>  mov bl, %2
  1241 00000C98 BE(BE05)            <5>  mov si, PTR16(_cA_%1)
  1242 00000C9B E86F02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000C9E B90400              <4>  mov cx, %1
  1592 00000CA1 E96E01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    59                              <2>     ERR_HANDLER 0x05, 0x06, 0x07, 0x08
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CA4 E8DDFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CA7 B31E                <5>  mov bl, %2
  1241 00000CA9 BE(D305)            <5>  mov si, PTR16(_cA_%1)
  1242 00000CAC E85E02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000CAF B90500              <4>  mov cx, %1
  1592 00000CB2 E95D01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CB5 E8CCFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CB8 B31E                <5>  mov bl, %2
  1241 00000CBA BE(E205)            <5>  mov si, PTR16(_cA_%1)
  1242 00000CBD E84D02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000CC0 B90600              <4>  mov cx, %1
  1592 00000CC3 E94C01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CC6 E8BBFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CC9 B31E                <5>  mov bl, %2
  1241 00000CCB BE(F605)            <5>  mov si, PTR16(_cA_%1)
  1242 00000CCE E83C02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000CD1 B90700              <4>  mov cx, %1
  1592 00000CD4 E93B01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CD7 E8AAFD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CDA B31E                <5>  mov bl, %2
  1241 00000CDC BE(0B06)            <5>  mov si, PTR16(_cA_%1)
  1242 00000CDF E82B02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000CE2 B90800              <4>  mov cx, %1
  1592 00000CE5 E92A01              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    60                              <2>     ERR_HANDLER 0x09, 0x0A, 0x0B, 0x0C
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CE8 E899FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CEB B31E                <5>  mov bl, %2
  1241 00000CED BE(1B06)            <5>  mov si, PTR16(_cA_%1)
  1242 00000CF0 E81A02              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000CF3 B90900              <4>  mov cx, %1
  1592 00000CF6 E91901              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000CF9 E888FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000CFC B31E                <5>  mov bl, %2
  1241 00000CFE BE(3306)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D01 E80902              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D04 B90A00              <4>  mov cx, %1
  1592 00000D07 E90801              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D0A E877FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D0D B31E                <5>  mov bl, %2
  1241 00000D0F BE(4806)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D12 E8F801              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D15 B90B00              <4>  mov cx, %1
  1592 00000D18 E9F700              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D1B E866FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D1E B31E                <5>  mov bl, %2
  1241 00000D20 BE(5F06)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D23 E8E701              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D26 B90C00              <4>  mov cx, %1
  1592 00000D29 E9E600              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    61                              <2>     ERR_HANDLER 0x0D, 0x0E, 0x0F, 0x10
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D2C E855FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D2F B31E                <5>  mov bl, %2
  1241 00000D31 BE(7506)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D34 E8D601              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D37 B90D00              <4>  mov cx, %1
  1592 00000D3A E9D500              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D3D E844FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D40 B31E                <5>  mov bl, %2
  1241 00000D42 BE(9406)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D45 E8C501              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D48 B90E00              <4>  mov cx, %1
  1592 00000D4B E9C400              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D4E E833FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D51 B31E                <5>  mov bl, %2
  1241 00000D53 BE(AA06)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D56 E8B401              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D59 B90F00              <4>  mov cx, %1
  1592 00000D5C E9B300              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D5F E822FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D62 B31E                <5>  mov bl, %2
  1241 00000D64 BE(B906)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D67 E8A301              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D6A B91000              <4>  mov cx, %1
  1592 00000D6D E9A200              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    62                              <2>     ERR_HANDLER 0x11, 0x12, 0x15
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D70 E811FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D73 B31E                <5>  mov bl, %2
  1241 00000D75 BE(DC06)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D78 E89201              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D7B B91100              <4>  mov cx, %1
  1592 00000D7E E99100              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D81 E800FD              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D84 B31E                <5>  mov bl, %2
  1241 00000D86 BE(F106)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D89 E88101              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D8C B91200              <4>  mov cx, %1
  1592 00000D8F E98000              <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000D92 E8EFFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000D95 B31E                <5>  mov bl, %2
  1241 00000D97 BE(1407)            <5>  mov si, PTR16(_cA_%1)
  1242 00000D9A E87001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000D9D B91500              <4>  mov cx, %1
  1592 00000DA0 EB70                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    63                              <2>     ERR_HANDLER 0x1D, 0x1E, 0x1F, 0x20
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DA2 E8DFFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DA5 B31E                <5>  mov bl, %2
  1241 00000DA7 BE(2507)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DAA E86001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DAD B91D00              <4>  mov cx, %1
  1592 00000DB0 EB60                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DB2 E8CFFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DB5 B31E                <5>  mov bl, %2
  1241 00000DB7 BE(4207)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DBA E85001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DBD B91E00              <4>  mov cx, %1
  1592 00000DC0 EB50                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DC2 E8BFFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DC5 B31E                <5>  mov bl, %2
  1241 00000DC7 BE(4E07)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DCA E84001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DCD B91F00              <4>  mov cx, %1
  1592 00000DD0 EB40                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DD2 E8AFFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DD5 B31E                <5>  mov bl, %2
  1241 00000DD7 BE(6307)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DDA E83001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DDD B92000              <4>  mov cx, %1
  1592 00000DE0 EB30                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    64                              <2>     ERR_HANDLER 0x21
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DE2 E89FFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DE5 B31E                <5>  mov bl, %2
  1241 00000DE7 BE(7B07)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DEA E82001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DED B92100              <4>  mov cx, %1
  1592 00000DF0 EB20                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    65                              <2>     ERR_HANDLER 0x27
  1578                              <3> %rep %0
  1579                              <3> 
  1580                              <3>  %assign __v %1
  1581                              <3>  %assign __v __v & 0FFh
  1582                              <3> 
  1583                              <3> 
  1584                              <3>  %assign __hi (__v >> 4) & 0Fh
  1585                              <3>  %assign __lo __v & 0Fh
  1586                              <3>  _HEXDIG __hi, __H
  1587                              <3>  _HEXDIG __lo, __L
  1588                              <3> 
  1589                              <3> _cA_errh%+__H%+__L:
  1590                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1591                              <3>  mov cx, %1
  1592                              <3>  jmp _open_exit
  1593                              <3> 
  1594                              <3> 
  1595                              <3>  %undef __H
  1596                              <3>  %undef __L
  1597                              <3>  %undef __hi
  1598                              <3>  %undef __lo
  1599                              <3>  %undef __v
  1600                              <3> 
  1601                              <3>  %rotate 1
  1602                              <3> %endrep
  1579                              <4> 
  1580                              <4>  %assign __v %1
  1581                              <4>  %assign __v __v & 0FFh
  1582                              <4> 
  1583                              <4> 
  1584                              <4>  %assign __hi (__v >> 4) & 0Fh
  1585                              <4>  %assign __lo __v & 0Fh
  1586                              <4>  _HEXDIG __hi, __H
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1587                              <4>  _HEXDIG __lo, __L
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1588                              <4> 
  1589                              <4> _cA_errh%+__H%+__L:
  1590                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1201                              <5> %if DOS_SHELL == 1
  1202                              <5>  GET_CURSOR
  1162                              <6> %if DOS_SHELL == 1
  1163 00000DF2 E88FFC              <6>  call dos_get_cursor
  1164                              <6> %else
  1165                              <6>  %error 'todo: windows'
  1166                              <6> %endif
  1203                              <5>  %ifstr %1
  1204                              <5>  section .data
  1205                              <5>  %%msg: db %1, 0
  1206                              <5>  section .text
  1207                              <5>  mov bl, %2
  1208                              <5>  mov si, PTR16(%%msg)
  1209                              <5>  call PutStrColor
  1210                              <5>  %else
  1211                              <5>  %ifidni %1, DI
  1212                              <5>  section .text
  1213                              <5>  mov bl, %2
  1214                              <5>  call PutStrColor
  1215                              <5>  %elifidni %1, SI
  1216                              <5>  section .text
  1217                              <5>  mov bl, %2
  1218                              <5>  call PutStrColor
  1219                              <5>  %else
  1220                              <5>  %assign __count 0
  1221                              <5>  %assign __varg 0
  1222                              <5>  %assign __stop 0
  1223                              <5>  %rep MAX_ARGV
  1224                              <5>  %if __stop == 0
  1225                              <5>  %assign __count (__count + 1)
  1226                              <5>  %ifidni %1, ARGV_%+__count
  1227                              <5>  %assign __varg __count
  1228                              <5>  %assign __stop 1
  1229                              <5>  %endif
  1230                              <5>  %endif
  1231                              <5>  %endrep
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1224                              <6>  %if __stop == 0
  1225                              <6>  %assign __count (__count + 1)
  1226                              <6>  %ifidni %1, ARGV_%+__count
  1227                              <6>  %assign __varg __count
  1228                              <6>  %assign __stop 1
  1229                              <6>  %endif
  1230                              <6>  %endif
  1232                              <5>  %if __varg > 0
  1233                              <5>  section .text
  1234                              <5>  mov si, PTR16(_cA_cmd_buf)
  1235                              <5>  mov bl, __varg
  1236                              <5>  call getCommandLine_Arg
  1237                              <5>  call PutStrColor
  1238                              <5>  %else
  1239                              <5>  section .text
  1240 00000DF5 B31E                <5>  mov bl, %2
  1241 00000DF7 BE(8C07)            <5>  mov si, PTR16(_cA_%1)
  1242 00000DFA E81001              <5>  call PutStrColor
  1243                              <5>  %endif
  1244                              <5>  %undef __varg
  1245                              <5>  %endif
  1246                              <5>  %endif
  1247                              <5> %else
  1248                              <5>  %error 'this macro is only for DOS programming.'
  1249                              <5> %endif
  1591 00000DFD B92700              <4>  mov cx, %1
  1592 00000E00 EB10                <4>  jmp _open_exit
  1593                              <4> 
  1594                              <4> 
  1595                              <4>  %undef __H
  1596                              <4>  %undef __L
  1597                              <4>  %undef __hi
  1598                              <4>  %undef __lo
  1599                              <4>  %undef __v
  1600                              <4> 
  1601                              <4>  %rotate 1
    66                              <2> 
    67                              <2> _cA_errhnd:
    68                              <2>     PUTS_COLOR open_error_nd, ATTR_DOS_ERROR
  1201                              <3> %if DOS_SHELL == 1
  1202                              <3>  GET_CURSOR
  1162                              <4> %if DOS_SHELL == 1
  1163 00000E02 E87FFC              <4>  call dos_get_cursor
  1164                              <4> %else
  1165                              <4>  %error 'todo: windows'
  1166                              <4> %endif
  1203                              <3>  %ifstr %1
  1204                              <3>  section .data
  1205                              <3>  %%msg: db %1, 0
  1206                              <3>  section .text
  1207                              <3>  mov bl, %2
  1208                              <3>  mov si, PTR16(%%msg)
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  %ifidni %1, DI
  1212                              <3>  section .text
  1213                              <3>  mov bl, %2
  1214                              <3>  call PutStrColor
  1215                              <3>  %elifidni %1, SI
  1216                              <3>  section .text
  1217                              <3>  mov bl, %2
  1218                              <3>  call PutStrColor
  1219                              <3>  %else
  1220                              <3>  %assign __count 0
  1221                              <3>  %assign __varg 0
  1222                              <3>  %assign __stop 0
  1223                              <3>  %rep MAX_ARGV
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1231                              <3>  %endrep
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1232                              <3>  %if __varg > 0
  1233                              <3>  section .text
  1234                              <3>  mov si, PTR16(_cA_cmd_buf)
  1235                              <3>  mov bl, __varg
  1236                              <3>  call getCommandLine_Arg
  1237                              <3>  call PutStrColor
  1238                              <3>  %else
  1239                              <3>  section .text
  1240 00000E05 B31E                <3>  mov bl, %2
  1241 00000E07 BE(6D05)            <3>  mov si, PTR16(_cA_%1)
  1242 00000E0A E80001              <3>  call PutStrColor
  1243                              <3>  %endif
  1244                              <3>  %undef __varg
  1245                              <3>  %endif
  1246                              <3>  %endif
  1247                              <3> %else
  1248                              <3>  %error 'this macro is only for DOS programming.'
  1249                              <3> %endif
    69 00000E0D B92000              <2>     mov   cx, 32
    70 00000E10 EB00                <2>     jmp _open_exit
    71                              <2> 
    72                              <2> _open_exit:
    73                              <2>     DOS_Exit cx
  1275                              <3> %if DOS_SHELL == 1
  1276                              <3>  %ifidni %1, ax
  1277                              <3>  %error 'AX not allowed here.'
  1278                              <3>  %elifidni %1, bx
  1279                              <3>  mov ax, 0x4C00
  1280                              <3>  or ax, bx
  1281                              <3>  SysCall
  1282                              <3>  %elifidni %1, CX
  1283 00000E12 B8004C              <3>  mov ax, 0x4C00
  1284 00000E15 09C8                <3>  or ax, cx
  1285                              <3>  SysCall
    66                              <4> %if DOS_SHELL == 1
    67 00000E17 CD21                <4>  int 0x21
    68                              <4> %endif
  1286                              <3>  %elifidni %1, dx
  1287                              <3>  mov ax, 0x4C00
  1288                              <3>  or ax, dx
  1289                              <3>  SysCall
  1290                              <3>  %elifnum %1
  1291                              <3>  mov ax, 0x4C00 | %1
  1292                              <3>  SysCall
  1293                              <3>  %else
  1294                              <3>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <3>  %endif
  1296                              <3> %endif
  1378                              <1> %include 'InitConsole.asm'          ; initialize the DOS console
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  InitConsole.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> dos_init_console:
    10 00000E19 E80A00              <2>     call dos_get_cols               ; get DOS screen columns
    11 00000E1C E80E00              <2>     call dos_get_rows               ; get DOS screen rows
    12                              <2>     
    13                              <2>     SCREEN_CLEAR
  1132                              <3> %if DOS_SHELL == 1
  1133 00000E1F E84C01              <3>  call dos_screen_clear
  1134                              <3> %else
  1135                              <3>  GET_CON_O_HANDLE r12
  1136                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1137                              <3>  WRITE_CON_A buffer_B
  1138                              <3> %endif
    14                              <2>     
    15 00000E22 E81600              <2>     call dos_get_command_line
    16 00000E25 C3                  <2>     ret
    17                              <2> 
    18                              <2> ; -----------------------------------------------------------------------------
    19                              <2> ; \brief get DOS screen columns
    20                              <2> ; -----------------------------------------------------------------------------
    21                              <2> dos_get_cols:
    22 00000E26 B40F                <2>     mov  ah, 0Fh
    23                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000E28 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    24                              <2>     ; AL = aktueller Videomodus
    25                              <2>     ; AH = Spaltenzahl
    26                              <2>     ; BH = aktive Seite
    27 00000E2A 88E3                <2>     mov  bl, ah           ; BL = Spalten
    28 00000E2C C3                  <2>     ret
    29                              <2> 
    30                              <2> ; -----------------------------------------------------------------------------
    31                              <2> ; \brief get DOS screen rows
    32                              <2> ; -----------------------------------------------------------------------------
    33                              <2> dos_get_rows:
    34 00000E2D B83011              <2>     mov  ax, 1130h
    35 00000E30 B700                <2>     mov  bh, 00h          ; aktuelle Font/Block
    36                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000E32 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    37 00000E34 88D2                <2>     mov  dl, dl           ; DL = Zeilen-1
    38 00000E36 FEC2                <2>     inc  dl               ; DL = Zeilen
    39 00000E38 88D7                <2>     mov  bh, dl           ; BH = Zeilen
    40 00000E3A C3                  <2>     ret
    41                              <2> 
    42                              <2> ; -----------------------------------------------------------------------------
    43                              <2> ; \brief DOS - get command line arguments from PSP ...
    44                              <2> ; -----------------------------------------------------------------------------
    45                              <2> dos_get_command_line:
    46 00000E3B 31C0                <2>     xor  ax, ax
    47 00000E3D BE8100              <2>     mov  si, 81h          ; SI -> Beginn der Kommandozeile im PSP
    48 00000E40 8A0E8000            <2>     mov  cl, [80h]        ; CL = Länge
    49 00000E44 30ED                <2>     xor  ch, ch           ; CX = Länge
    50                              <2> 
    51 00000E46 E320                <2>     jcxz .no_args       ; nichts übergeben?
    52                              <2>     ; Zielpuffer vorbereiten
    53 00000E48 BF(C204)            <2>     mov  di, PTR16(_cA_cmd_buf) ; DI -> Ziel
    54                              <2>     .copy:
    55 00000E4B AC                  <2>     lodsb                 ; AL = [DS:SI], SI++
    56 00000E4C 3C0D                <2>     cmp   al, 0x0D        ; CR markiert das Ende (Sicherheit)
    57 00000E4E 7403                <2>     je   .done_copy
    58 00000E50 AA                  <2>     stosb                 ; [ES:DI]=AL (ES=DS in .COM), DI++
    59 00000E51 E2F8                <2>     loop .copy
    60                              <2> 
    61                              <2>     .done_copy:
    62 00000E53 B000                <2>     mov  al, 0
    63 00000E55 AA                  <2>     stosb
    64                              <2>     
    65                              <2>     ; Trim: nachlaufende Spaces entfernen
    66                              <2>     .trim:
    67 00000E56 81FF(C204)          <2>     cmp  di, PTR16(_cA_cmd_buf)
    68 00000E5A 7607                <2>     jbe  .make_dos_str
    69 00000E5C 4F                  <2>     dec  di
    70 00000E5D 803D20              <2>     cmp  byte [di], ' '
    71 00000E60 74F4                <2>     je   .trim
    72 00000E62 47                  <2>     inc  di
    73                              <2> 
    74                              <2>     .make_dos_str:
    75 00000E63 C60500              <2>     mov  byte [di], 0     ; für DOS-Funktion 09h Stringabschluss
    76 00000E66 EB21                <2>     jmp  .next
    77                              <2>     
    78                              <2>     .no_args:
    79                              <2>     SCREEN_CLEAR
  1132                              <3> %if DOS_SHELL == 1
  1133 00000E68 E80301              <3>  call dos_screen_clear
  1134                              <3> %else
  1135                              <3>  GET_CON_O_HANDLE r12
  1136                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1137                              <3>  WRITE_CON_A buffer_B
  1138                              <3> %endif
    80                              <2>     SET_CURSOR 0, 1
  1147                              <3> %if %0 == 0
  1148                              <3>  %error 2 argument missing
  1149                              <3> %endif
  1150                              <3> %if DOS_SHELL == 1
  1151 00000E6B B200                <3>  mov dl, %1
  1152 00000E6D B601                <3>  mov dh, %2
  1153 00000E6F E8FFFB              <3>  call dos_set_cursor
  1154                              <3> %else
  1155                              <3> %endif
    81                              <2>     PUTS_COLOR noargs_msg, 0x02 | 0x10
  1201                              <3> %if DOS_SHELL == 1
  1202                              <3>  GET_CURSOR
  1162                              <4> %if DOS_SHELL == 1
  1163 00000E72 E80FFC              <4>  call dos_get_cursor
  1164                              <4> %else
  1165                              <4>  %error 'todo: windows'
  1166                              <4> %endif
  1203                              <3>  %ifstr %1
  1204                              <3>  section .data
  1205                              <3>  %%msg: db %1, 0
  1206                              <3>  section .text
  1207                              <3>  mov bl, %2
  1208                              <3>  mov si, PTR16(%%msg)
  1209                              <3>  call PutStrColor
  1210                              <3>  %else
  1211                              <3>  %ifidni %1, DI
  1212                              <3>  section .text
  1213                              <3>  mov bl, %2
  1214                              <3>  call PutStrColor
  1215                              <3>  %elifidni %1, SI
  1216                              <3>  section .text
  1217                              <3>  mov bl, %2
  1218                              <3>  call PutStrColor
  1219                              <3>  %else
  1220                              <3>  %assign __count 0
  1221                              <3>  %assign __varg 0
  1222                              <3>  %assign __stop 0
  1223                              <3>  %rep MAX_ARGV
  1224                              <3>  %if __stop == 0
  1225                              <3>  %assign __count (__count + 1)
  1226                              <3>  %ifidni %1, ARGV_%+__count
  1227                              <3>  %assign __varg __count
  1228                              <3>  %assign __stop 1
  1229                              <3>  %endif
  1230                              <3>  %endif
  1231                              <3>  %endrep
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1224                              <4>  %if __stop == 0
  1225                              <4>  %assign __count (__count + 1)
  1226                              <4>  %ifidni %1, ARGV_%+__count
  1227                              <4>  %assign __varg __count
  1228                              <4>  %assign __stop 1
  1229                              <4>  %endif
  1230                              <4>  %endif
  1232                              <3>  %if __varg > 0
  1233                              <3>  section .text
  1234                              <3>  mov si, PTR16(_cA_cmd_buf)
  1235                              <3>  mov bl, __varg
  1236                              <3>  call getCommandLine_Arg
  1237                              <3>  call PutStrColor
  1238                              <3>  %else
  1239                              <3>  section .text
  1240 00000E75 B312                <3>  mov bl, %2
  1241 00000E77 BE(3405)            <3>  mov si, PTR16(_cA_%1)
  1242 00000E7A E89000              <3>  call PutStrColor
  1243                              <3>  %endif
  1244                              <3>  %undef __varg
  1245                              <3>  %endif
  1246                              <3>  %endif
  1247                              <3> %else
  1248                              <3>  %error 'this macro is only for DOS programming.'
  1249                              <3> %endif
    82                              <2>     SET_CURSOR 0, 2
  1147                              <3> %if %0 == 0
  1148                              <3>  %error 2 argument missing
  1149                              <3> %endif
  1150                              <3> %if DOS_SHELL == 1
  1151 00000E7D B200                <3>  mov dl, %1
  1152 00000E7F B602                <3>  mov dh, %2
  1153 00000E81 E8EDFB              <3>  call dos_set_cursor
  1154                              <3> %else
  1155                              <3> %endif
    83                              <2>     DOS_Exit   0          ; exit - no args.
  1275                              <3> %if DOS_SHELL == 1
  1276                              <3>  %ifidni %1, ax
  1277                              <3>  %error 'AX not allowed here.'
  1278                              <3>  %elifidni %1, bx
  1279                              <3>  mov ax, 0x4C00
  1280                              <3>  or ax, bx
  1281                              <3>  SysCall
  1282                              <3>  %elifidni %1, CX
  1283                              <3>  mov ax, 0x4C00
  1284                              <3>  or ax, cx
  1285                              <3>  SysCall
  1286                              <3>  %elifidni %1, dx
  1287                              <3>  mov ax, 0x4C00
  1288                              <3>  or ax, dx
  1289                              <3>  SysCall
  1290                              <3>  %elifnum %1
  1291 00000E84 B8004C              <3>  mov ax, 0x4C00 | %1
  1292                              <3>  SysCall
    66                              <4> %if DOS_SHELL == 1
    67 00000E87 CD21                <4>  int 0x21
    68                              <4> %endif
  1293                              <3>  %else
  1294                              <3>  %error 'BX, CX, DX or <NUM> expected.'
  1295                              <3>  %endif
  1296                              <3> %endif
    84                              <2>     
    85                              <2>     .next:
    86                              <2>     SET_CURSOR 0, 0
  1147                              <3> %if %0 == 0
  1148                              <3>  %error 2 argument missing
  1149                              <3> %endif
  1150                              <3> %if DOS_SHELL == 1
  1151 00000E89 B200                <3>  mov dl, %1
  1152 00000E8B B600                <3>  mov dh, %2
  1153 00000E8D E8E1FB              <3>  call dos_set_cursor
  1154                              <3> %else
  1155                              <3> %endif
    87 00000E90 C3                  <2>     ret
  1379                              <1> %include 'Int16ToStr.asm'           ; convert integer number to string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Int16ToStr.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; ----------------------------------------------------------------------------
    11                              <2> ; \brief  convert number from AX register to a string.
    12                              <2> ; \param  AX: 16-Bit value
    13                              <2> ; \param  DI: destination buffer
    14                              <2> ; \return ASCII-decimal without trailing zeros.
    15                              <2> ;         (min. onr digit, and '0' at end.
    16                              <2> ;
    17                              <2> ; \note   destroy's: AX,BX,CX,DX (internal saved)
    18                              <2> ; \note   buffer: max. 5 digits + '$' => min. 6 bytes
    19                              <2> ; ----------------------------------------------------------------------------
    20                              <2> DOSIntToStr:
    21 00000E91 50                  <2>     push ax
    22 00000E92 53                  <2>     push bx
    23 00000E93 51                  <2>     push cx
    24 00000E94 52                  <2>     push dx
    25 00000E95 57                  <2>     push di
    26                              <2> 
    27 00000E96 BB0A00              <2>     mov bx, 10
    28 00000E99 31C9                <2>     xor cx, cx                 ; Zähler für gepushte Reste
    29                              <2> 
    30 00000E9B 83F800              <2>     cmp ax, 0
    31 00000E9E 7506                <2>     jne .div_loop
    32 00000EA0 C60530              <2>     mov byte [di], '0'
    33 00000EA3 47                  <2>     inc di
    34 00000EA4 EB13                <2>     jmp short .finish
    35                              <2> 
    36                              <2>     .div_loop:
    37 00000EA6 31D2                <2>     xor dx, dx                 ; DX:AX / 10
    38 00000EA8 F7F3                <2>     div bx                     ; AX = Quotient, DX = Rest (0..9)
    39 00000EAA 52                  <2>     push dx
    40 00000EAB 41                  <2>     inc cx
    41 00000EAC 85C0                <2>     test ax, ax
    42 00000EAE 75F6                <2>     jne .div_loop
    43                              <2> 
    44                              <2>     .write_loop:
    45 00000EB0 5A                  <2>     pop dx
    46 00000EB1 80C230              <2>     add dl, '0'
    47 00000EB4 8815                <2>     mov [di], dl
    48 00000EB6 47                  <2>     inc di
    49 00000EB7 E2F7                <2>     loop .write_loop
    50                              <2> 
    51                              <2>     .finish:
    52 00000EB9 C60500              <2>     mov byte [di], 0x00
    53                              <2> 
    54 00000EBC 5F                  <2>     pop di
    55 00000EBD 5A                  <2>     pop dx
    56 00000EBE 59                  <2>     pop cx
    57 00000EBF 5B                  <2>     pop bx
    58 00000EC0 58                  <2>     pop ax
    59 00000EC1 C3                  <2>     ret
  1380                              <1> %include 'PutStrColor.asm'          ; put colored text onto the DOS screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  PutStrColor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; --- String per BIOS-Teletype (AH=0Eh) ausgeben ---
    11                              <2> ; putc: AL -> Zeichen ausgeben
    12                              <2> putc:
    13 00000EC2 52                  <2>     push dx
    14 00000EC3 88C2                <2>     mov dl, al
    15 00000EC5 B402                <2>     mov ah, 02h
    16                              <2>     SysCall
    66                              <3> %if DOS_SHELL == 1
    67 00000EC7 CD21                <3>  int 0x21
    68                              <3> %endif
    17 00000EC9 5A                  <2>     pop dx
    18 00000ECA C3                  <2>     ret
    19                              <2> 
    20                              <2> ; crlf: \r\n
    21                              <2> DOSrncrlf:
    22 00000ECB B00D                <2>     mov al, 13
    23 00000ECD E8F2FF              <2>     call putc
    24 00000ED0 B00A                <2>     mov al, 10
    25 00000ED2 E8EDFF              <2>     call putc
    26 00000ED5 C3                  <2>     ret
    27                              <2> 
    28                              <2> DOSPutStrColor:
    29 00000ED6 B409                <2>     mov  ah, 09h
    30                              <2>     SysCall
    66                              <3> %if DOS_SHELL == 1
    67 00000ED8 CD21                <3>  int 0x21
    68                              <3> %endif
    31 00000EDA C3                  <2>     ret
    32                              <2> 
    33                              <2> print_z:
    34 00000EDB 52                  <2>     push dx             ; save DX
    35 00000EDC 89D6                <2>     mov si, dx
    36                              <2>     .find_end:
    37 00000EDE AC                  <2>     lodsb               ; AL = [SI], SI++
    38 00000EDF 3C00                <2>     cmp  al, 0
    39 00000EE1 75FB                <2>     jne .find_end       ; repeat, till 0x00 is found
    40 00000EE3 4E                  <2>     dec si              ; SI points to 0x00
    41                              <2>     
    42 00000EE4 B024                <2>     mov al, '$'         ; set DOS String end mark
    43 00000EE6 8804                <2>     mov [si], al        ; append AL
    44 00000EE8 46                  <2>     inc si
    45 00000EE9 C60400              <2>     mov byte [si], 0    ; end of C-String
    46                              <2>     
    47 00000EEC 8936(E316)          <2>     mov [PTR16(fdbuf)], si
    48                              <2>     DOS_Write fdbuf
  1314 00000EF0 8D16(E316)          <3>  lea dx, [PTR16(_cA_%1)]
  1315 00000EF4 E80200              <3>  call DOS_ConsoleWrite
    49 00000EF7 5A                  <2>     pop dx              ; restore DX
    50 00000EF8 C3                  <2>     ret
    51                              <2> 
    52                              <2> ; DX -> 0-terminierte Zeichenkette
    53                              <2> DOS_ConsoleWrite:
    54 00000EF9 50                  <2>     push ax
    55 00000EFA 52                  <2>     push dx
    56 00000EFB 56                  <2>     push si
    57 00000EFC 89D6                <2>     mov si, dx
    58                              <2>     .print_z_loop:
    59 00000EFE AC                  <2>     lodsb
    60 00000EFF 3C24                <2>     cmp al, '$'
    61 00000F01 7406                <2>     je .pe_done
    62 00000F03 E8BCFF              <2>     call putc
    63 00000F06 46                  <2>     inc si
    64 00000F07 EBF5                <2>     jmp .print_z_loop
    65                              <2>     .pe_done:
    66 00000F09 5E                  <2>     pop si
    67 00000F0A 5A                  <2>     pop dx
    68 00000F0B 58                  <2>     pop ax
    69 00000F0C C3                  <2>     ret
    70                              <2> 
    71                              <2> PutStrColor:
    72 00000F0D 53                  <2>     push bx
    73 00000F0E 8A3E(C401)          <2>     mov  bh, [PTR16(dos_readln_flag)]
    74 00000F12 80FF00              <2>     cmp  bh, 0
    75 00000F15 7409                <2>     je   .no_length
    76 00000F17 83C602              <2>     add  si, 2
    77 00000F1A B700                <2>     mov  bh, 0
    78 00000F1C 883E(C401)          <2>     mov  [PTR16(dos_readln_flag)], bh
    79                              <2>     .no_length:
    80 00000F20 5B                  <2>     pop  bx
    81                              <2>     
    82 00000F21 8B16(C501)          <2>     mov  dx, [PTR16(dos_xpos)]
    83                              <2>     ; -------------------
    84                              <2>     .print_loop:
    85 00000F25 AC                  <2>     lodsb                ; AL := [SI], SI++
    86                              <2>     
    87                              <2>     COMPARE al, 0x00, .printed  ; reach end  ?
  1391 00000F26 3C00                <3>  cmp %1, %2
  1392 00000F28 741E                <3>  je %3
    88                              <2>     COMPARE al, 0x0d, .printed
  1391 00000F2A 3C0D                <3>  cmp %1, %2
  1392 00000F2C 741A                <3>  je %3
    89                              <2>     COMPARE al, 0x0a, .printed
  1391 00000F2E 3C0A                <3>  cmp %1, %2
  1392 00000F30 7416                <3>  je %3
    90                              <2>     
    91 00000F32 84C0                <2>     test al, al
    92 00000F34 7412                <2>     jz   .printed
    93 00000F36 B409                <2>     mov  ah, 09h         ; Teletype-Ausgabe
    94 00000F38 B700                <2>     mov  bh, 0           ; page 0 todo
    95 00000F3A B90100              <2>     mov  cx, 1           ; mim
    96                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000F3D CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
    97                              <2>     
    98 00000F3F B402                <2>     mov ah, 0x02
    99 00000F41 B700                <2>     mov bh, 0
   100 00000F43 42                  <2>     inc dx
   101                              <2>     VideoCall
    71                              <3> %if DOS_SHELL == 1
    72 00000F44 CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
   102                              <2>     
   103 00000F46 EBDD                <2>     jmp  .print_loop
   104                              <2> 
   105                              <2>     .printed:
   106                              <2>     ;call  DOS_getCursor
   107 00000F48 C3                  <2>     ret
   108                              <2>     
   109                              <2> ; --- Cursorposition lesen (AH=03h) ---
   110                              <2> DOS_getCursor:
   111 00000F49 B403                <2>     mov  ah, 03h         ; Read Cursor Position
   112 00000F4B B700                <2>     mov  bh, 0           ; Videoseite 0
   113                              <2>     VideoCall            ; Rückgabe: DH=Zeile, DL=Spalte (0-basiert)
    71                              <3> %if DOS_SHELL == 1
    72 00000F4D CD10                <3>  int 0x10
    73                              <3> %else
    74                              <3>  %error 'only DOS supports interrupts.'
    75                              <3> %endif
   114 00000F4F 8836(C601)          <2>     mov  [PTR16(dos_ypos)], dh
   115 00000F53 8816(C501)          <2>     mov  [PTR16(dos_xpos)], dl
   116                              <2> 
   117 00000F57 C3                  <2>     ret
  1381                              <1> %include 'ReadLn16.asm'             ; read a line of text
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ReadLn16.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief Eingabe holen (DOS Zeileneingabe, mit eigenem Editor/Echo)
    12                              <2> ; \param DX - buffer
    13                              <2> ; -----------------------------------------------------------------------------
    14                              <2> DOSReadLn:
    15 00000F58 B40A                <2>     mov ah, 0Ah
    16 00000F5A CD21                <2>     int 21h              ; Rückkehr nach ENTER; [buf+1]=len, [buf+2..]=Text, [buf+2+len]=0Dh
    17                              <2> 
    18                              <2>     ; SI = &Textanfang, BL = len
    19 00000F5C 89D3                <2>     mov bx, dx
    20 00000F5E 8D7702              <2>     lea si, [bx + 2]
    21 00000F61 8A5F01              <2>     mov bl, [bx + 1]
    22                              <2> 
    23                              <2>     ; CR hinter dem Text durch 0x00 ersetzen -> sauber terminierter String
    24 00000F64 C60000              <2>     mov byte [si + bx], 0x00
    25                              <2>     
    26                              <2>     ; set flag for puts_color
    27 00000F67 B701                <2>     mov bh, 1
    28 00000F69 883E(C401)          <2>     mov [PTR16(dos_readln_flag)], bh
    29                              <2> 
    30                              <2>     ; neue Zeile
    31                              <2>     ;mov dx, PTR16(crlf)
    32                              <2>     ;mov ah, 09h
    33                              <2>     ;int 21h
    34                              <2>     
    35 00000F6D C3                  <2>     ret
    36                              <2>  
  1382                              <1> %include 'ScreenClear.asm'          ; clear the screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ScreenClear.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define TEXT_VRAM 0B800h
     9                              <2> 
    10                              <2> dos_screen_clear:
    11 00000F6E 1E                  <2>     push ds
    12 00000F6F B800B8              <2>     mov  ax, TEXT_VRAM
    13 00000F72 8EC0                <2>     mov  es, ax
    14                              <2> 
    15 00000F74 31FF                <2>     xor  di, di         ; Offset 0
    16                              <2>     
    17                              <2>     ; default size is:  80x25
    18 00000F76 88D8                <2>     mov  al, bl         ; AL = 25
    19 00000F78 F6E7                <2>     mul  bh             ; AX = AL * BH = 25 * 80 = 2000 (0x07D0)
    20 00000F7A 89C1                <2>     mov  cx, ax         ; 2000 chars
    21                              <2>     
    22                              <2>     ; color
    23 00000F7C B82007              <2>     mov  ax, 0x0720     ; AL=' ' (20h), AH=07h (hellgrau auf schwarz)
    24                              <2> 
    25                              <2>     .fill:
    26 00000F7F AB                  <2>     stosw               ; schreibt AX -> ES:[DI], DI+=2
    27 00000F80 E2FD                <2>     loop .fill
    28                              <2> 
    29 00000F82 1F                  <2>     pop  ds
    30                              <2> 
    31                              <2>     SET_CURSOR 0, 0
  1147                              <3> %if %0 == 0
  1148                              <3>  %error 2 argument missing
  1149                              <3> %endif
  1150                              <3> %if DOS_SHELL == 1
  1151 00000F83 B200                <3>  mov dl, %1
  1152 00000F85 B600                <3>  mov dh, %2
  1153 00000F87 E8E7FA              <3>  call dos_set_cursor
  1154                              <3> %else
  1155                              <3> %endif
    32                              <2>     
    33 00000F8A C3                  <2>     ret
    34                              <2>  
  1383                              <1> %include 'Str16Len.asm'             ; get the length of a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Str16Len.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief  get the 16 bit length of a 0-terminated string
    12                              <2> ; \param  Input:  ES:SI -> "0"-terminierter String
    13                              <2> ; \return Output: AX = Länge (ohne '0')
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> DOSStrLen:
    16 00000F8B 57                  <2>     push di             ; save DI
    17 00000F8C 89F7                <2>     mov  di, si         ; DI = SI
    18 00000F8E B80000              <2>     mov  ax, 0          ; reset counter
    19                              <2>     
    20                              <2>     next:
    21 00000F91 8A04                <2>     mov  al, [si]       ; get character
    22 00000F93 3C00                <2>     cmp  al, 0          ; found 0-terminator ?
    23 00000F95 7404                <2>     je   done           ; yes -> .done
    24                              <2>     
    25 00000F97 46                  <2>     inc  si
    26 00000F98 40                  <2>     inc  ax
    27 00000F99 EBF6                <2>     jmp  next
    28                              <2>     
    29                              <2>     done:
    30 00000F9B 5F                  <2>     pop     di
    31 00000F9C C3                  <2>     ret
  1384                              <1> %include 'StrCompare.asm'           ; string compare
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCompare.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief strcmp - compares two 0-terminated strings: DS:SI vs. ES:DI.
    11                              <2> ; \param 1. dst > DI
    12                              <2> ; \param 2. src > SI
    13                              <2> ; \return AL = 1 (found/same)
    14                              <2> ;         AL = 0 (not same)
    15                              <2> ; -----------------------------------------------------------------------------
    16                              <2> string_compare:
    17 00000F9D 56                  <2>     push si             ; save src > si
    18                              <2>     
    19                              <2>     .next:
    20 00000F9E 8A04                <2>     mov  al, [si]       ; get src byte
    21 00000FA0 8A1D                <2>     mov  bl, [di]       ; get dst byte
    22                              <2>     
    23 00000FA2 3A05                <2>     cmp  al, [di]       ; dst == src ?
    24 00000FA4 750A                <2>     jne  .not_equal     ; no ?
    25                              <2> 
    26 00000FA6 46                  <2>     inc  si             ; next src pos.
    27 00000FA7 47                  <2>     inc  di             ; next dst pos.
    28                              <2>     
    29 00000FA8 84C0                <2>     test al, al
    30 00000FAA 75F2                <2>     jnz  .next          ; check
    31                              <2>     
    32                              <2>     .term:
    33 00000FAC B000                <2>     mov  al, 0          ; found/same, ret
    34 00000FAE 5E                  <2>     pop  si             ; restore si
    35 00000FAF C3                  <2>     ret                 ; return to caller
    36                              <2>     
    37                              <2>     .not_equal:
    38 00000FB0 B001                <2>     mov  al, 1          ; not found, ret
    39 00000FB2 5E                  <2>     pop  si             ; restore < si
    40 00000FB3 C3                  <2>     ret                 ; return to caller
  1385                              <1> %include 'StrCopy.asm'              ; copy a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCopy.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; Quelle: DS:SI (ASCIIZ)
    11                              <2> ; Ziel:   ES:DI   (hier setzen wir ES=DS für Daten im selben Segment)
    12                              <2> ; Rückgabe: SI = Zielstart (damit PUTS_COLOR direkt funktioniert)
    13                              <2> ; Clobbers: AX, CX, DI, ES, BX, FLAGS
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> string_copy:
    16 00000FB4 53                  <2>     push    bx
    17 00000FB5 56                  <2>     push    si
    18                              <2> 
    19                              <2>     ; ES = DS (falls Ziel im selben Segment)
    20 00000FB6 1E                  <2>     push    ds
    21 00000FB7 07                  <2>     pop     es
    22                              <2> 
    23 00000FB8 89FB                <2>     mov     bx, di          ; Zielstart merken
    24 00000FBA B93F00              <2>     mov     cx, 63          ; (optional) max. 63 Zeichen + 0
    25                              <2> 
    26                              <2>     .copy:
    27 00000FBD AC                  <2>     lodsb
    28 00000FBE AA                  <2>     stosb
    29 00000FBF 84C0                <2>     test    al, al
    30 00000FC1 7406                <2>     jz      .done
    31 00000FC3 E2F8                <2>     loop    .copy
    32 00000FC5 26C60500            <2>     mov     byte [es:di], 0
    33                              <2> 
    34                              <2>     .done:
    35 00000FC9 89DE                <2>     mov     si, bx          ; <- WICHTIG: SI auf Zielstart setzen
    36 00000FCB 5B                  <2>     pop     bx              ; ursprüngliches SI verwerfen (gewollt)
    37 00000FCC 5B                  <2>     pop     bx              ; wiederherstellen von BX
    38 00000FCD C3                  <2>     ret
  1386                              <1> 
  1387                              <1> code16_end:
    15                                  
    16                                  section .data
    17                                  %include 'data16.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  data16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> data16_start:
     9                              <1> 
    10 00000032 546869732070726F67- <1> msg:            db "This program requieres MS-Windows.$",0
    10 0000003B 72616D207265717569- <1>
    10 00000044 65726573204D532D57- <1>
    10 0000004D 696E646F77732E2400  <1>
    11 00000056 4F70656E206572726F- <1> msgErr:         db 'Open error AX=', '$'
    11 0000005F 722041583D24        <1>
    12                              <1> 
    13                              <1> 
    14                              <1> ASTR dos_cap2A,  "ein Text", 0
   375 00000065 65696E205465787400- <2> _cA_%1: db %2, 0
   375 0000006E 00                  <2>
   376                              <2> _cA_%1_end:
   377                              <2> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
    15                              <1> ASTR dos_prompt, "Eingabe:       ", 0
   375 0000006F 45696E676162653A20- <2> _cA_%1: db %2, 0
   375 00000078 2020202020200000    <2>
   376                              <2> _cA_%1_end:
   377                              <2> _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
    16                              <1> 
    17 00000080 0D0A24              <1> crlf:            db 13,10,'$'
    18 00000083 07                  <1> dos_color:       db 0x07
    19                              <1> 
    20                              <1> ; -----------------------------------------------------------------------------
    21                              <1> ; Buffer-Struktur für AH=0Ah:
    22                              <1> ; [0] = maxlen, [1] = len(out), [2..] = Text, danach CR
    23                              <1> ; -----------------------------------------------------------------------------
    24                              <1> BUFSZ            equ 64
    25 00000084 3E                  <1> _cA_dos_buffer:  db BUFSZ-2       ; Max. Eingabezeichen (ohne die 2 Verwaltungsbytes)
    26 00000085 00                  <1>                  db 0             ; tatsächliche Länge (OUT)
    27 00000086 00<rep 3Eh>         <1>                  times BUFSZ-2 db 0
    28 000000C4 00                  <1> dos_readln_flag: db 0
    29                              <1> 
    30                              <1> ; -----------------------------------------------------------------------------
    31                              <1> ; \brief DOS console settings ...
    32                              <1> ; -----------------------------------------------------------------------------
    33 000000C5 00                  <1> dos_xpos:           db 0      ; current text cursor column
    34 000000C6 00                  <1> dos_ypos:           db 0      ; current text cursor row
    35 000000C7 00                  <1> dos_page:           db 0      ; current video page
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; dBASE data ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 000000C8 444154412E44424600  <1> _cA_DBFNAME:        db 'DATA.DBF',0
    41                              <1> 
    42 000000D1 644241534520495620- <1> msgTitle:           db 'dBASE IV DBF Header',13,10,'$'
    42 000000DA 444246204865616465- <1>
    42 000000E3 720D0A24            <1>
    43 000000E7 55736167653A204442- <1> msgUsage:           db 'Usage: DBFHEAD <datei.dbf>',13,10,'$'
    43 000000F0 4648454144203C6461- <1>
    43 000000F9 7465692E6462663E0D- <1>
    43 00000102 0A24                <1>
    44 00000104 4665686C65723A2044- <1> msgOpenErr:         db 'Fehler: Datei kann nicht geoeffnet werden.',13,10,'$'
    44 0000010D 61746569206B616E6E- <1>
    44 00000116 206E69636874206765- <1>
    44 0000011F 6F6566666E65742077- <1>
    44 00000128 657264656E2E0D0A24  <1>
    45 00000131 4665686C65723A204C- <1> msgReadErr:         db 'Fehler: Lesen fehlgeschlagen.',13,10,'$'
    45 0000013A 6573656E206665686C- <1>
    45 00000143 67657363686C616765- <1>
    45 0000014C 6E2E0D0A24          <1>
    46 00000151 56657273696F6E2028- <1> msgVer:             db 'Version (hex): $'
    46 0000015A 686578293A2024      <1>
    47 00000161 446174756D20285959- <1> msgDate:            db 'Datum (YY-MM-DD): $'
    47 0000016A 2D4D4D2D4444293A20- <1>
    47 00000173 24                  <1>
    48 00000174 416E7A61686C204461- <1> msgRecs:            db 'Anzahl Datensaetze (hex): $'
    48 0000017D 74656E736165747A65- <1>
    48 00000186 2028686578293A2024  <1>
    49 0000018F 4865616465726C6165- <1> msgHdr:             db 'Headerlaenge (bytes): $'
    49 00000198 6E6765202862797465- <1>
    49 000001A1 73293A2024          <1>
    50 000001A6 5361747A6C61656E67- <1> msgRec:             db 'Satzlaenge (bytes): $'
    50 000001AF 652028627974657329- <1>
    50 000001B8 3A2024              <1>
    51 000001BB 4D44582D466C616720- <1> msgMDX:             db 'MDX-Flag (hex): $'
    51 000001C4 28686578293A2024    <1>
    52 000001CC 4C616E677561676520- <1> msgLang:            db 'Language Driver ID (hex): $'
    52 000001D5 447269766572204944- <1>
    52 000001DE 2028686578293A2024  <1>
    53 000001E7 46656C6465723A0D0A- <1> msgFields:          db 'Felder:',13,10,'$'
    53 000001F0 24                  <1>
    54 000001F1 4B65696E652046656C- <1> msgNoFields:        db 'Keine Felder gefunden.',13,10,'$'
    54 000001FA 64657220676566756E- <1>
    54 00000203 64656E2E0D0A24      <1>
    55 0000020A 202046656C64202324  <1> msgFieldN:          db '  Feld #$'
    56 00000213 3A2024              <1> msgColonSp:         db ': $'
    57 00000216 2C2024              <1> msgCommaSp:         db ', $'
    58 00000219 202F2024            <1> msgSlash:           db ' / $'
    59                              <1> 
    60 0000021D 55736167653A204442- <1> _cA_msg_usage:          db 'Usage: DBFMAKE <type:3|4> <CREATE|APPEND> <C|I|F|B|D|T> <feldname> <feldlaenge>', 0
    60 00000226 464D414B45203C7479- <1>
    60 0000022F 70653A337C343E203C- <1>
    60 00000238 4352454154457C4150- <1>
    60 00000241 50454E443E203C437C- <1>
    60 0000024A 497C467C427C447C54- <1>
    60 00000253 3E203C66656C646E61- <1>
    60 0000025C 6D653E203C66656C64- <1>
    60 00000265 6C61656E67653E00    <1>
    61 0000026D 4665686C65723A2041- <1> _cA_msg_badargs:        db 'Fehler: Argumente ungueltig.',0
    61 00000276 7267756D656E746520- <1>
    61 0000027F 756E6775656C746967- <1>
    61 00000288 2E00                <1>
    62 0000028A 4665686C65723A2044- <1> _cA_msg_openfail:       db 'Fehler: Datei kann nicht geoeffnet/erstellt werden.',0
    62 00000293 61746569206B616E6E- <1>
    62 0000029C 206E69636874206765- <1>
    62 000002A5 6F6566666E65742F65- <1>
    62 000002AE 727374656C6C742077- <1>
    62 000002B7 657264656E2E00      <1>
    63 000002BE 4665686C65723A2044- <1> _cA_msg_ver_mismatch:   db 'Fehler: DBF-Typ passt nicht zur Datei.',0
    63 000002C7 42462D547970207061- <1>
    63 000002D0 737374206E69636874- <1>
    63 000002D9 207A75722044617465- <1>
    63 000002E2 692E00              <1>
    64 000002E5 415050454E44206162- <1> _cA_msg_append_recs:    db 'APPEND abgelehnt: Datei enthaelt Datensaetze (nicht unterstuetzt).',0
    64 000002EE 67656C65686E743A20- <1>
    64 000002F7 446174656920656E74- <1>
    64 00000300 6861656C7420446174- <1>
    64 00000309 656E736165747A6520- <1>
    64 00000312 286E6963687420756E- <1>
    64 0000031B 74657273747565747A- <1>
    64 00000324 74292E00            <1>
    65 00000328 492F4F2D4665686C65- <1> _cA_msg_ioerr:          db 'I/O-Fehler.',0
    65 00000331 722E00              <1>
    66 00000334 4665686C65723A2075- <1> _cA_msg_badheader:      db 'Fehler: ungueltiger Header/Felddeskriptor.',0
    66 0000033D 6E6775656C74696765- <1>
    66 00000346 72204865616465722F- <1>
    66 0000034F 46656C646465736B72- <1>
    66 00000358 6970746F722E00      <1>
    67 0000035F 4E6963687420756E74- <1> _cA_msg_not_supported:  db 'Nicht unterstuetzt: Feldtyp nur mit Typ 4.',0
    67 00000368 657273747565747A74- <1>
    67 00000371 3A2046656C64747970- <1>
    67 0000037A 206E7572206D697420- <1>
    67 00000383 54797020342E00      <1>
    68 0000038A 4F4B3A204E65756520- <1> _cA_msg_ok_create:      db 'OK: Neue DBF mit einem Feld erstellt (DATA.DBF).',0
    68 00000393 444246206D69742065- <1>
    68 0000039C 696E656D2046656C64- <1>
    68 000003A5 2065727374656C6C74- <1>
    68 000003AE 2028444154412E4442- <1>
    68 000003B7 46292E00            <1>
    69 000003BB 4F4B3A2046656C6420- <1> msg_ok_append:      db 'OK: Feld an bestehende leere DBF angehaengt.',0
    69 000003C4 616E20626573746568- <1>
    69 000003CD 656E6465206C656572- <1>
    69 000003D6 652044424620616E67- <1>
    69 000003DF 656861656E67742E00  <1>
    70 000003E8 48696E776569733A20- <1> msg_fieldexists:    db 'Hinweis: Feld bereits vorhanden; keine Aenderung vorgenommen.',0
    70 000003F1 46656C642062657265- <1>
    70 000003FA 69747320766F726861- <1>
    70 00000403 6E64656E3B206B6569- <1>
    70 0000040C 6E652041656E646572- <1>
    70 00000415 756E6720766F726765- <1>
    70 0000041E 6E6F6D6D656E2E00    <1>
    71                              <1> 
    72 00000426 43524541544500      <1> str_CREATE:         db 'CREATE',0
    73 0000042D 415050454E4400      <1> str_APPEND:         db 'APPEND',0
    74                              <1> 
    75                              <1> ; ---- Daten ----
    76 00000434 6E6F20617267732E00  <1> _cA_noargs_msg:     db 'no args.', 0
    77 0000043D 475A2E45584500      <1> _cA_GzipAppName:    db 'GZ.EXE', 0
    78 00000444 65786563206F662067- <1> _cA_GzipErrorMsg:   db 'exec of gzip.exe failed.', 0
    78 0000044D 7A69702E6578652066- <1>
    78 00000456 61696C65642E00      <1>
    79                              <1> 
    80                              <1> ; Kommandozeile im PSP-Format:
    81                              <1> ; Byte 0: Länge (Anzahl Zeichen)
    82                              <1> ; Danach die Zeichen, abgeschlossen mit 0Dh (CR).
    83                              <1> ; Üblicherweise beginnt die Tail mit einem Leerzeichen vor dem ersten Argument.
    84                              <1> 
    85                              <1> GzipCmdTail:
    86 0000045D 0E                  <1>     db GzipCmdTextEnd - GzipCmdText          ; Länge
    87                              <1> GzipCmdText:
    88 0000045E 202D64206D6F64756C- <1>     db ' -d modul1.biz'
    88 00000467 312E62697A          <1>
    89                              <1> GzipCmdTextEnd:
    90 0000046C 0D                  <1>     db 13
    91                              <1> 
    92                              <1> ; -----------------------------------------------------------------------------
    93                              <1> ; \brief DOS error code messages for int 0x21 function 0x3D (open file)
    94                              <1> ; -----------------------------------------------------------------------------
    95 0000046D 756E6B6E6F776E2065- <1> _cA_open_error_nd:  db 'unknown error.',0
    95 00000476 72726F722E00        <1>
    96 0000047C 696E76616C69642066- <1> _cA_open_error_01:  db 'invalid function / wrong AH code.', 0
    96 00000485 756E6374696F6E202F- <1>
    96 0000048E 2077726F6E67204148- <1>
    96 00000497 20636F64652E00      <1>
    97 0000049E 66696C65206E6F7420- <1> _cA_open_error_02:  db 'file not found.', 0
    97 000004A7 666F756E642E00      <1>
    98 000004AE 70617468206E6F7420- <1> _cA_open_error_03:  db 'path not found.', 0
    98 000004B7 666F756E642E00      <1>
    99 000004BE 746F6F206D616E7920- <1> _cA_open_error_04:  db 'too many open files.', 0
    99 000004C7 6F70656E2066696C65- <1>
    99 000004D0 732E00              <1>
   100 000004D3 616363657373206465- <1> _cA_open_error_05:  db 'access denied.', 0
   100 000004DC 6E6965642E00        <1>
   101 000004E2 696E76616C69642066- <1> _cA_open_error_06:  db 'invalid file handle', 0
   101 000004EB 696C652068616E646C- <1>
   101 000004F4 6500                <1>
   102 000004F6 6D63622F6172656E61- <1> _cA_open_error_07:  db 'mcb/arena corrupted.', 0
   102 000004FF 20636F727275707465- <1>
   102 00000508 642E00              <1>
   103 0000050B 6E6F206D6F7265206D- <1> _cA_open_error_08:  db 'no more memory.', 0
   103 00000514 656D6F72792E00      <1>
   104 0000051B 696E76616C6964206D- <1> _cA_open_error_09:  db 'invalid memory address.', 0
   104 00000524 656D6F727920616464- <1>
   104 0000052D 726573732E00        <1>
   105 00000533 696E76616C69642065- <1> _cA_open_error_0A:  db 'invalid environment.', 0
   105 0000053C 6E7669726F6E6D656E- <1>
   105 00000545 742E00              <1>
   106 00000548 6578652F636F6D2066- <1> _cA_open_error_0B:  db 'exe/com format error..', 0
   106 00000551 6F726D617420657272- <1>
   106 0000055A 6F722E2E00          <1>
   107 0000055F 696E76616C69642061- <1> _cA_open_error_0C:  db 'invalid access token.', 0
   107 00000568 636365737320746F6B- <1>
   107 00000571 656E2E00            <1>
   108 00000575 6461746120696E666F- <1> _cA_open_error_0D:  db 'data informations are invalid.', 0
   108 0000057E 726D6174696F6E7320- <1>
   108 00000587 61726520696E76616C- <1>
   108 00000590 69642E00            <1>
   109 00000594 696E76616C6964206D- <1> _cA_open_error_0E:  db 'invalid memory block.', 0
   109 0000059D 656D6F727920626C6F- <1>
   109 000005A6 636B2E00            <1>
   110 000005AA 696E76616C69642064- <1> _cA_open_error_0F:  db 'invalid drive.', 0
   110 000005B3 726976652E00        <1>
   111 000005B9 747269656420746F20- <1> _cA_open_error_10:  db 'tried to delete current directory.', 0
   111 000005C2 64656C657465206375- <1>
   111 000005CB 7272656E7420646972- <1>
   111 000005D4 6563746F72792E00    <1>
   112 000005DC 66696C65206F6E206F- <1> _cA_open_error_11:  db 'file on other drive.', 0
   112 000005E5 746865722064726976- <1>
   112 000005EE 652E00              <1>
   113 000005F1 6E6F206D6F72652066- <1> _cA_open_error_12:  db 'no more files/file already exists.', 0
   113 000005FA 696C65732F66696C65- <1>
   113 00000603 20616C726561647920- <1>
   113 0000060C 6578697374732E00    <1>
   114 00000614 6472697665206E6F74- <1> _cA_open_error_15:  db 'drive not ready.', 0
   114 0000061D 2072656164792E00    <1>
   115 00000625 6D6564696120646F65- <1> _cA_open_error_1D:  db 'media does not support seek.', 0
   115 0000062E 73206E6F7420737570- <1>
   115 00000637 706F7274207365656B- <1>
   115 00000640 2E00                <1>
   116 00000642 7365656B206572726F- <1> _cA_open_error_1E:  db 'seek error.', 0
   116 0000064B 722E00              <1>
   117 0000064E 6472697665206E6F74- <1> _cA_open_error_1F:  db 'drive not available.', 0
   117 00000657 20617661696C61626C- <1>
   117 00000660 652E00              <1>
   118 00000663 66696C652063616E20- <1> _cA_open_error_20:  db 'file can not overwrite.', 0
   118 0000066C 6E6F74206F76657277- <1>
   118 00000675 726974652E00        <1>
   119 0000067B 6472697665206E6F74- <1> _cA_open_error_21:  db 'drive not ready.', 0
   119 00000684 2072656164792E00    <1>
   120 0000068C 6E6F20646973632063- <1> _cA_open_error_27:  db 'no disc capacities.', 0
   120 00000695 617061636974696573- <1>
   120 0000069E 2E00                <1>
   121                              <1> 
   122                              <1> ; --- Daten ---
   123 000006A0 4D4F44554C312E4249- <1> _cA_mod_filename:       db 'MODUL1.BIN',0
   123 000006A9 4E00                <1>
   124                              <1> 
   125 000006AB 6D6F64756C65206669- <1> _cA_mod_read_error:     db 'module file not found.',0
   125 000006B4 6C65206E6F7420666F- <1>
   125 000006BD 756E642E00          <1>
   126 000006C2 6F70656E2066696C65- <1> _cA_mod_file_error:     db 'open file error.',0
   126 000006CB 206572726F722E00    <1>
   127 000006D3 66726565206572726F- <1> _cA_mod_free_error:     db 'free error.',0
   127 000006DC 722E00              <1>
   128 000006DF 6D656D6F7279206E6F- <1> _cA_mod_free_error_no:  db 'memory not freed.',0
   128 000006E8 742066726565642E00  <1>
   129 000006F1 636C6F736520657272- <1> _cA_mod_clos_error:     db 'close error.',0
   129 000006FA 6F722E00            <1>
   130 000006FE 66696C65206E6F7420- <1> _cA_mod_clos_error_no:  db 'file not close error.',0
   130 00000707 636C6F736520657272- <1>
   130 00000710 6F722E00            <1>
   131 00000714 6E6F206572726F7220- <1> _cA_mod_have_error_no:  db 'no error found.',0
   131 0000071D 666F756E642E00      <1>
   132                              <1> 
   133                              <1> ; -----------------------------------------------------------------------------
   134                              <1> ; --- Tabelle: [Fehlercode, Handler] ... 0 = Ende ---
   135                              <1> ; -----------------------------------------------------------------------------
   136                              <1> ERR_ITEMS   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,             0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,                   0x10, 0x11, 0x12, 0x15, 0x1D, 0x1E, 0x1F,                   0x20, 0x21, 0x27
  1615                              <2> _cA_error_dispatch:
  1616                              <2>  %rep %0
  1617                              <2>  _HEX2 %1, __H, __L
  1618                              <2>  dw %1, _cA_errh%+__H%+__L
  1619                              <2>  %undef __H
  1620                              <2>  %undef __L
  1621                              <2>  %rotate 1
  1622                              <2>  %endrep
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000724 0100[600C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000728 0200[710C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000072C 0300[820C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000730 0400[930C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000734 0500[A40C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000738 0600[B50C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000073C 0700[C60C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000740 0800[D70C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000744 0900[E80C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000748 0A00[F90C]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000074C 0B00[0A0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000750 0C00[1B0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000754 0D00[2C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000758 0E00[3D0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000075C 0F00[4E0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000760 1000[5F0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000764 1100[700D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000768 1200[810D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000076C 1500[920D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000770 1D00[A20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000774 1E00[B20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000778 1F00[C20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 0000077C 2000[D20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000780 2100[E20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1617                              <3>  _HEX2 %1, __H, __L
  1563                              <4>  %assign __v %1
  1564                              <4>  %assign __v __v & 0FFh
  1565                              <4>  %assign __hi (__v >> 4) & 0Fh
  1566                              <4>  %assign __lo __v & 0Fh
  1567                              <4>  _HEXDIG __hi, %2
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1568                              <4>  _HEXDIG __lo, %3
  1541                              <5>  %if %1 < 10
  1542                              <5>  %define %2 %1
  1543                              <5>  %elif %1 = 10
  1544                              <5>  %define %2 A
  1545                              <5>  %elif %1 = 11
  1546                              <5>  %define %2 B
  1547                              <5>  %elif %1 = 12
  1548                              <5>  %define %2 C
  1549                              <5>  %elif %1 = 13
  1550                              <5>  %define %2 D
  1551                              <5>  %elif %1 = 14
  1552                              <5>  %define %2 E
  1553                              <5>  %elif %1 = 15
  1554                              <5>  %define %2 F
  1555                              <5>  %else
  1556                              <5>  %error "_HEXDIG: Nibble ausserhalb 0..15"
  1557                              <5>  %endif
  1569                              <4>  %undef __v
  1570                              <4>  %undef __hi
  1571                              <4>  %undef __lo
  1618 00000784 2700[F20D]          <3>  dw %1, _cA_errh%+__H%+__L
  1619                              <3>  %undef __H
  1620                              <3>  %undef __L
  1621                              <3>  %rotate 1
  1623 00000788 0000[020E]          <2>  dw 00h, _cA_errhnd
   140                              <1> 
   141 0000078C 0000                <1> _cA_mod_hFile:   dw 0
   142 0000078E 0000                <1> mod_seg_ovl:     dw 0
   143 00000790 0000                <1> mod_fsize_lo:    dw 0
   144 00000792 0000                <1> mod_fsize_hi:    dw 0
   145                              <1> 
   146 00000794 48616C6C6F20766F6D- <1> mod_msg:         db 'Hallo vom Loader!$'
   146 0000079D 204C6F616465722124  <1>
   147                              <1> mod_msg_len:     equ ($ - msg)
   148                              <1> 
   149 000007A6 0000                <1> hdr_len:            dw 0
   150 000007A8 0000                <1> rec_len:            dw 0
   151                              <1> 
   152                              <1> data16_end:
    18                                  
    19                                  section .bss
    20                                  %include 'bss16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  bss16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> bss16_start:
    10                              <1> 
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief hold DOS command line argument information's ...
    13                              <1> ; -----------------------------------------------------------------------------
    14                              <1> %define MAX_ARGS    7
    15                              <1> struc _cA_COMMAND_LINE
    16 00000000 ??                  <1>     .arg_count      resb 1            ; max. 255 arguments
    17 00000001 <res 40h>           <1>     .arg_str        resb 64           ; max. length = 64 bytes
    18                              <1> endstruc
    19 00000000 <res 1C0h>          <1> _cA_command_args:   resb 64 * MAX_ARGS
    20 000001C0 <res 40h>           <1> _cA_command_arglen: resb 64
    21 00000200 ????                <1> arg_total:          resw 1
    22                              <1> 
    23 00000202 <res 40h>           <1> _cA_cmd_arg_1:      resb 64
    24 00000242 <res 40h>           <1> _cA_cmd_arg_2:      resb 64
    25 00000282 <res 40h>           <1> _cA_cmd_arg_3:      resb 64
    26 000002C2 <res 40h>           <1> _cA_cmd_arg_4:      resb 64
    27 00000302 <res 40h>           <1> _cA_cmd_arg_5:      resb 64
    28 00000342 <res 40h>           <1> _cA_cmd_arg_6:      resb 64
    29 00000382 <res 40h>           <1> _cA_cmd_arg_7:      resb 64
    30                              <1> 
    31 000003C2 <res 100h>          <1> _cA_cmd_buf:        resb 256          ; CMD string
    32 000004C2 <res 82h>           <1> _cA_cmd_buffer:     resb 130
    33                              <1> 
    34                              <1> ; EXEC-Parameterblock (14 Bytes)
    35 00000544 <res Eh>            <1> _cA_ExecBlk:        resb 14
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; command line holders ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 00000552 ??                  <1> _cA_db_version:     resb 1   ; 3 -> dBase3, 4 -> dBase4
    41 00000553 ??                  <1> _cA_db_op:          resb 1   ; 0 -> CREATE, 1 -> APPEND
    42 00000554 ??                  <1> _cA_db_type:        resb 1   ; C|I|F|B|D
    43 00000555 ??                  <1> _cA_db_have_token:  resb 1
    44                              <1> 
    45 00000556 <res 1000h>         <1> fdescbuf:           resb 4096
    46                              <1> 
    47 00001556 ????????????        <1> buf_hex:            resb 6            ; 4 Hex-Zeichen + '$' + Reserve
    48 0000155C ??????????????      <1> buf_dec:            resb 7            ; 5 Dezimal-Zeichen + '$' + Reserve
    49                              <1> 
    50 00001563 <res 80h>           <1> filename:           resb 128
    51                              <1> _cA_fdbuf:
    52 000015E3 <res 800h>          <1> fdbuf:              resb 2048
    53 00001DE3 <res 10h>           <1> _cA_namebuf:        resb 16
    54                              <1> 
    55                              <1> hFile:              resw 0
    56                              <1> ; -----------------------------------------------------------------------------
    57                              <1> g_type:             resw 0
    58                              <1> g_cmd:              resb 0
    59                              <1> g_ftype:            resb 0
    60                              <1> g_ftype_mapped:     resb 0
    61                              <1> g_flen:             resw 0
    62                              <1> g_year:             resw 0
    63                              <1> g_month:            resb 0
    64                              <1> g_day:              resb 0
    65                              <1> ; -----------------------------------------------------------------------------
    66                              <1> verByte:            resb 0
    67                              <1> yy:                 resb 0
    68                              <1> mm:                 resb 0
    69                              <1> dd:                 resb 0
    70                              <1> mdx:                resb 0
    71                              <1> lang:               resb 0
    72                              <1> rec32:              resd 0
    73                              <1> 
    74 00001DF3 <res 40h>           <1> tokbuf:             resb 64
    75 00001E33 <res Ch>            <1> fldname:            resb 12
    76                              <1> 
    77 00001E3F <res 20h>           <1> header:             resb 32
    78                              <1> fdbuf_size:         resw 0
    79 00001E5F <res 20h>           <1> tempdesc:           resb 32
    80                              <1> 
    81                              <1> ; -----------------------------------------------------------------------------
    82                              <1> 
    83                              <1> buf_seg:            resw 0
    84                              <1> size_lo:            resw 0
    85                              <1> size_hi:            resw 0
    86                              <1> 
    87                              <1> bss16_end:
    21                                  kernel_end:
