     1                                  ;---------------------------------------------------
     2                                  ; \file  kernel.asm
     3                                  ; \note  (c) 2025 by Jens Kallup - paule32
     4                                  ;        all rights reserved.
     5                                  ;
     6                                  ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                                  ;---------------------------------------------------
     8                                  bits 16
     9                                  org 0
    10                                  %include 'macros.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  macros.inc
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> ; -----------------------------------------------------------------------------
    10                              <1> ; \brief some pre-defines, to make maintain easier ...
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> %define ERROR_Win32API 'this macro can only be use with win32api (Windows).'
    13                              <1> 
    14                              <1> ; -----------------------------------------------------------------------------
    15                              <1> ; \brief DOS error codes for int 0x21 - 3Dh
    16                              <1> ; -----------------------------------------------------------------------------
    17                              <1> %define ERROR_INVALID_FUNCTION      0x01
    18                              <1> %define ERROR_FILE_NOT_FOUND        0x02
    19                              <1> %define ERROR_PATH_NOT_FOUND        0x03
    20                              <1> %define ERROR_TOO_MANY_OPEN_FILES   0x04
    21                              <1> %define ERROR_ACCESS_DENIED         0x05
    22                              <1> %define ERROR_INVALID_HANDLE        0x06
    23                              <1> %define ERROR_ARENA_TRASHED         0x07
    24                              <1> %define ERROR_NOT_ENOUGH_MEMORY     0x08
    25                              <1> %define ERROR_INVALID_ACCESS        0x0C
    26                              <1> %define ERROR_INVALID_DRIVE         0x0F
    27                              <1> %define ERROR_CURRENT_DIRECTORY     0x10
    28                              <1> %define ERROR_NOT_SAME_DEVICE       0x11
    29                              <1> %define ERROR_NO_MORE_FILES         0x12
    30                              <1> %define ERROR_SEEK                  0x1D
    31                              <1> %define ERROR_NOT_DOS_DISK          0x1E
    32                              <1> 
    33                              <1> ; -----------------------------------------------------------------------------
    34                              <1> ; \brief DOS file open modes ...
    35                              <1> ; -----------------------------------------------------------------------------
    36                              <1> %define DOS_READ_ONLY   0x00    ; read  only
    37                              <1> %define DOS_WRITE_ONLY  0x01    ; write only
    38                              <1> %define DOS_READWRITE   0x02    ; read/write
    39                              <1> 
    40                              <1> ; -----------------------------------------------------------------------------
    41                              <1> ; \brief DOS file seek constants ...
    42                              <1> ; -----------------------------------------------------------------------------
    43                              <1> %define SEEK_BEGIN      0x00    ; begin of file
    44                              <1> %define SEEK_SET        0x01    ; current position
    45                              <1> %define SEEK_END        0x02    ; file end
    46                              <1> 
    47                              <1> ; -----------------------------------------------------------------------------
    48                              <1> ; \brief DOS console settings ...
    49                              <1> ; -----------------------------------------------------------------------------
    50                              <1> %define ATTR_DOS_ERROR              0x0E | 0x10     ; yeloow on blue bakcground
    51                              <1> 
    52                              <1> %define MAX_ARGV        32      ; maximum count of command line arguments
    53                              <1> 
    54                              <1> ; -----------------------------------------------------------------------------
    55                              <1> ; \brief DOS 16-Bit applications handles the offsets of symbols otherwise as
    56                              <1> ;        Windows 32 or 64-Bit.
    57                              <1> ; -----------------------------------------------------------------------------
    58                              <1> %ifndef PTR16
    59                              <1> %define PTR16(sym) (sym-code16_start+0x100)
    60                              <1> %endif
    61                              <1> 
    62                              <1> ; -----------------------------------------------------------------------------
    63                              <1> ; \brief Windows 32 or 64-Bit applications handles the offsets of symbols other
    64                              <1> ;        wise as DOS 16-Bit programs.
    65                              <1> ; -----------------------------------------------------------------------------
    66                              <1> %ifndef PTR64
    67                              <1> %define PTR64(sym) (IMAGE_BASE + RVA_DATA(sym))
    68                              <1> %endif
    69                              <1> 
    70                              <1> ; -----------------------------------------------------------------------------
    71                              <1> ; \brief pre-processor variables and constants ...
    72                              <1> ; \note  __pre_stop -> nasm does not have a return or exit directive to stop
    73                              <1> ;                      the pre-processing. But, we can tell nasm, to use a var
    74                              <1> ;                      to sign: "stop pre-processing, and handle all following
    75                              <1> ;                      directives as rejected."
    76                              <1> ; -----------------------------------------------------------------------------
    77                              <1> %assign __pre_stop 0        ; only display one error, if __pre_stop == 1 !
    78                              <1> %assign __vargs    0        ; number of command line arguments
    79                              <1> 
    80                              <1> ; -----------------------------------------------------------------------------
    81                              <1> ; \brief  get the positional argument of a command line parameter in console.
    82                              <1> ; \param  1. <id> -> ARGV_n where n can be 1..32 (MAX_ARGV == 32).
    83                              <1> ; \return __vargs <imm> -> the number of the parameter > 0
    84                              <1> ; -----------------------------------------------------------------------------
    85                              <1> %macro GET_VARGS 2
    86                              <1>     %if __pre_stop == 0
    87                              <1>         %assign __count 0
    88                              <1>         %assign __vargs 0
    89                              <1>         %assign __stop  0
    90                              <1>         %rep MAX_ARGV
    91                              <1>             %if __stop == 0
    92                              <1>                 %assign __count (__count + 1)
    93                              <1>                 %ifidni %1,  ARGV_%+__count
    94                              <1>                     %assign __vargs __count
    95                              <1>                     %assign __stop 1
    96                              <1>                     %assign _%2 __count
    97                              <1>                 %endif
    98                              <1>             %endif
    99                              <1>         %endrep
   100                              <1>         %undef __count
   101                              <1>         %undef __stop
   102                              <1>     %endif
   103                              <1> %endmacro
   104                              <1> 
   105                              <1> ; -----------------------------------------------------------------------------
   106                              <1> ; \brief display a nasm error message with macro argument %1. Then the
   107                              <1> ;        __pre_stop pre-processor variable will set to 1.
   108                              <1> ;        (1 -> ignore all next macros)
   109                              <1> ; -----------------------------------------------------------------------------
   110                              <1> %macro EMIT_ERROR 1
   111                              <1>     %if __pre_stop == 0
   112                              <1>         EMIT_ERROR 1
   113                              <1>         %assign __pre_stop 1
   114                              <1>     %endif
   115                              <1> %endmacro
   116                              <1> 
   117                              <1> ; -----------------------------------------------------------------------------
   118                              <1> ; \brief display a nasm warning message with macro argument %1. Then the
   119                              <1> ;        __pre_stop pre-processor variable will set to 1.
   120                              <1> ;        (1 -> ignore all next macros)
   121                              <1> ; -----------------------------------------------------------------------------
   122                              <1> %macro EMIT_WARN 1
   123                              <1>     %if __pre_stop == 0
   124                              <1>         EMIT_ERROR 1
   125                              <1>         %assign __pre_stop 1
   126                              <1>     %endif
   127                              <1> %endmacro
   128                              <1> 
   129                              <1> ; -----------------------------------------------------------------------------
   130                              <1> ; \brief perform a system call (in this case a DOS int 0x21 call)
   131                              <1> ; -----------------------------------------------------------------------------
   132                              <1> %macro SysCall 0
   133                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134                              <1>     int 0x21        ; DOS interrupt 0x21
   135                              <1> %else
   136                              <1>     EMIT_ERROR 'todo: windows'
   137                              <1> %endif
   138                              <1> %endmacro
   139                              <1> 
   140                              <1> ; -----------------------------------------------------------------------------
   141                              <1> ; \brief perform a video call. It is only used in DOS 16-Bit applications.
   142                              <1> ; -----------------------------------------------------------------------------
   143                              <1> %macro VideoCall 0
   144                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145                              <1>     int 0x10
   146                              <1> %else
   147                              <1>     EMIT_ERROR 'only DOS supports interrupts.'
   148                              <1> %endif
   149                              <1> %endmacro
   150                              <1> 
   151                              <1> ; -----------------------------------------------------------------------------
   152                              <1> ; add win64 abi shadow ...
   153                              <1> ; -----------------------------------------------------------------------------
   154                              <1> %macro AddShadow 0-1
   155                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   156                              <1>     EMIT_ERROR 'AddShadow is only used for Windows 10+ 64-Bit development.'
   157                              <1> %else
   158                              <1>     %if __pre_stop == 0
   159                              <1>         %if %0 == 1
   160                              <1>             sub rsp, %1
   161                              <1>         %else
   162                              <1>             sub rsp, SW_SHADOW
   163                              <1>         %endif
   164                              <1>     %endif
   165                              <1> %endif
   166                              <1> %endmacro
   167                              <1> 
   168                              <1> ; -----------------------------------------------------------------------------
   169                              <1> ; delete added win64 abi shadow ...
   170                              <1> ; -----------------------------------------------------------------------------
   171                              <1> %macro DelShadow 0-1
   172                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   173                              <1>     EMIT_ERROR 'DelShadow is only used for Windows 10+ 64-Bit development.'
   174                              <1> %else
   175                              <1>     %if __pre_stop == 0
   176                              <1>         %if %0 == 1
   177                              <1>             add rsp, %1
   178                              <1>         %else
   179                              <1>             add rsp, SW_SHADOW
   180                              <1>         %endif
   181                              <1>     %endif
   182                              <1> %endif
   183                              <1> %endmacro
   184                              <1> 
   185                              <1> ; -----------------------------------------------------------------------------
   186                              <1> ; MAKE_INT <Label>, <Func1>, <Func2>, ...
   187                              <1> ; -----------------------------------------------------------------------------
   188                              <1> %macro MAKE_INT 2-*
   189                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   190                              <1>     EMIT_ERROR 'MAKE_INT is only used for Windows 10+ 64-Bit development.'
   191                              <1> %else
   192                              <1>     %if __pre_stop == 0
   193                              <1>     %1:
   194                              <1>         %assign __n %0-1
   195                              <1>         %rep __n
   196                              <1>             dq RVA_IDATA(HN_win32_%2)
   197                              <1>             %rotate 1
   198                              <1>         %endrep
   199                              <1>         dq 0
   200                              <1>     %endif
   201                              <1> %endif
   202                              <1> %endmacro
   203                              <1> 
   204                              <1> ; -----------------------------------------------------------------------------
   205                              <1> ; MAKE_IAT <Label>, <Func1>, <Func2>, ...
   206                              <1> ; -----------------------------------------------------------------------------
   207                              <1> %macro MAKE_IAT 2-*
   208                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   209                              <1>     EMIT_ERROR 'MAKE_IAT is only used for Windows 10+ 64-Bit development.'
   210                              <1> %else
   211                              <1>     %if __pre_stop == 0
   212                              <1>         iat_win32_%1:
   213                              <1>         %assign __n %0-1
   214                              <1>         %rep __n
   215                              <1>             IAT_win32_%2: dq RVA_IDATA(HN_win32_%2)
   216                              <1>             %rotate 1
   217                              <1>         %endrep
   218                              <1>         dq 0
   219                              <1>     %endif
   220                              <1> %endif
   221                              <1> %endmacro
   222                              <1> 
   223                              <1> ; -----------------------------------------------------------------------------
   224                              <1> ; HNSTR <Func1>, <Func2>, ...
   225                              <1> ; -----------------------------------------------------------------------------
   226                              <1> %macro HNSTR 1-*
   227                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   228                              <1>     EMIT_ERROR 'HNSTR is only used for Windows 10+ 64-Bit development.'
   229                              <1> %else
   230                              <1>     %if __pre_stop == 0
   231                              <1>         %assign __n %0
   232                              <1>         %rep __n
   233                              <1>             HN_win32_%1: dw 0
   234                              <1>             db %str(%1), 0
   235                              <1>             %rotate 1
   236                              <1>         %endrep
   237                              <1>     %endif
   238                              <1> %endif
   239                              <1> %endmacro
   240                              <1> 
   241                              <1> ; -----------------------------------------------------------------------------
   242                              <1> ; MAKE_IMPORT <dir_label>, <mod1>, <mod2>, ...
   243                              <1> ; erzeugt:
   244                              <1> ; dir_label:
   245                              <1> ;   dd RVA_IDATA(INT_<mod>), 0,0, RVA_IDATA(dll_<mod>), RVA_IDATA(iat_<mod>) ...
   246                              <1> ;   dd 0,0,0,0,0
   247                              <1> ; dir_label_end:
   248                              <1> ; -----------------------------------------------------------------------------
   249                              <1> %macro MAKE_IMPORT 1-*
   250                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   251                              <1>     EMIT_ERROR 'MAKE_IMPORT is only used for Windows 10+ 64-Bit development.'
   252                              <1> %else
   253                              <1>     %if __pre_stop == 0
   254                              <1>         %define __DIR %1
   255                              <1>         %1:
   256                              <1>         %assign __n %0-1
   257                              <1>         %rep __n
   258                              <1>             dd RVA_IDATA(INT_win32_%2)
   259                              <1>             dd 0,0
   260                              <1>             dd RVA_IDATA(dll_win32_%2)
   261                              <1>             dd RVA_IDATA(iat_win32_%2)
   262                              <1>             %rotate 1
   263                              <1>         %endrep
   264                              <1>             dd 0,0,0,0,0
   265                              <1>         __DIR %+ _end:
   266                              <1>         %undef __DIR
   267                              <1>     %endif
   268                              <1> %endif
   269                              <1> %endmacro
   270                              <1> 
   271                              <1> ; -----------------------------------------------------------------------------
   272                              <1> ; mini helper ...
   273                              <1> ; -----------------------------------------------------------------------------
   274                              <1> %macro WIN64_PROLOG 0
   275                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   276                              <1>     EMIT_ERROR 'This macro is only used for Windows 10+ 64-Bit development.'
   277                              <1> %else
   278                              <1>     %if __pre_stop == 0
   279                              <1>         mov rbp, rsp
   280                              <1>         and rsp, -16
   281                              <1>         AddShadow 32         ; Shadow Space
   282                              <1>     %endif
   283                              <1> %endif
   284                              <1> %endmacro
   285                              <1> 
   286                              <1> %macro CALL_IAT 1        ; CALL_IAT ExitProcess / RegisterClassExW / ...
   287                              <1> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   288                              <1>     EMIT_ERROR 'MAKE_IMPORT is only used for Windows 10+ 64-Bit development.'
   289                              <1> %else
   290                              <1>     %if __pre_stop == 0
   291                              <1>         AddShadow
   292                              <1>         mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_%1)
   293                              <1>         call    [rax]
   294                              <1>         DelShadow
   295                              <1>     %endif
   296                              <1> %endif
   297                              <1> %endmacro
   298                              <1> 
   299                              <1> ; -----------------------------------------------------------------------------
   300                              <1> ; zero register's
   301                              <1> ; -----------------------------------------------------------------------------
   302                              <1> %macro Zero 1
   303                              <1>     %if __pre_stop == 0
   304                              <1>         xor %1, %1
   305                              <1>     %endif
   306                              <1> %endmacro
   307                              <1> 
   308                              <1> ; -----------------------------------------------------------------------------
   309                              <1> ; UTF-16LE aus ASCII (<=0x7F) schnell schreiben
   310                              <1> ; -----------------------------------------------------------------------------
   311                              <1> %ifndef WSTR_DEBUG
   312                              <1>     %if __pre_stop == 0
   313                              <1>         %define WSTR_DEBUG 0
   314                              <1>     %endif
   315                              <1> %endif
   316                              <1> 
   317                              <1> ; -----------------------------------------------------------------------------
   318                              <1> ; WSTR <name>, <items...>
   319                              <1> ; items: Strings ("..."), Zahlen (123, 0x41) oder Ausdrücke/Labels
   320                              <1> ; erzeugt:
   321                              <1> ;   _cW_<name>:              dw ... , 0
   322                              <1> ;   _cW_<name>_end:
   323                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   324                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   325                              <1> ; -----------------------------------------------------------------------------
   326                              <1> %macro WSTR 2+
   327                              <1>     %if __pre_stop == 0
   328                              <1>     %push WSTR
   329                              <1> 
   330                              <1>     ; Namen sichern, damit %rotate keine Probleme macht
   331                              <1>     %define _WSTR_LBL   _cW_%1
   332                              <1>     %define _WSTR_END   _cW_%1_end
   333                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   334                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   335                              <1> 
   336                              <1> _WSTR_LBL:
   337                              <1>     ; restliche Argumente abarbeiten
   338                              <1>     %assign %$nargs %0-1
   339                              <1>     %rotate 1
   340                              <1> 
   341                              <1>     %rep %$nargs
   342                              <1>         %ifstr %1
   343                              <1>             %strlen %$n %1
   344                              <1>             %assign %$i 0
   345                              <1>             %rep %$n
   346                              <1>                 %substr %$c %1 %$i+1,1
   347                              <1>                 dw %$c                      ; eine 16-bit Code Unit 0x00xx
   348                              <1>                 %assign %$i %$i+1
   349                              <1>             %endrep
   350                              <1>         %elifnum %1
   351                              <1>             dw %1                           ; Zahl/Konstante
   352                              <1>         %else
   353                              <1>             dw %1                           ; Label/Equate/Expression
   354                              <1>         %endif
   355                              <1>         %rotate 1
   356                              <1>     %endrep
   357                              <1> 
   358                              <1>     dw 0                                    ; Null-Terminator (1 Word)
   359                              <1> 
   360                              <1> _WSTR_END:
   361                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2) ; Länge in BYTES (ohne Terminator)
   362                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)              ; Länge in WORDS
   363                              <1> 
   364                              <1>     ; Aufräumen
   365                              <1>     %undef _WSTR_LBL
   366                              <1>     %undef _WSTR_END
   367                              <1>     %undef _WSTR_LENB
   368                              <1>     %undef _WSTR_LENW
   369                              <1>     %pop
   370                              <1>     %endif      ; __pre_stop
   371                              <1> %endmacro
   372                              <1> ; -----------------------------------------------------------------------------
   373                              <1> ; WSTRU <name>, <items...>
   374                              <1> ; items:
   375                              <1> ;   - "ASCII/Latin-1-Strings"  -> jedes Zeichen als 16-bit Code Unit 0x00xx
   376                              <1> ;   - Zahlen/Expressions        -> als Unicode-Codepoint interpretiert:
   377                              <1> ;                                 <=0xFFFF (außer Surrogatbereich) -> 1 Word
   378                              <1> ;                                 >0xFFFF -> Surrogatpaar (2 Words)
   379                              <1> ; erzeugt:
   380                              <1> ;   _cW_<name>:              dw ..., 0
   381                              <1> ;   _cW_<name>_end:
   382                              <1> ;   _cW_<name>_length_bytes  equ (_cW_<name>_end - _cW_<name> - 2) ; ohne Terminator
   383                              <1> ;   _cW_<name>_length_words  equ (_cW_<name>_length_bytes/2)
   384                              <1> ; -----------------------------------------------------------------------------
   385                              <1> ; --- Helper: einen Unicode-Codepoint als UTF-16 ausgeben ---
   386                              <1> ; -----------------------------------------------------------------------------
   387                              <1> %macro __WSTR_EMIT_CP 1
   388                              <1>     %if __pre_stop == 0
   389                              <1>         %assign __cp (%1)
   390                              <1> 
   391                              <1>         %if __cp < 0
   392                              <1>             EMIT_ERROR "WSTR: negativer Codepoint"
   393                              <1>         %elif __cp <= 0xFFFF
   394                              <1>             ; verbiete explizite Surrogat-Codepoints
   395                              <1>             %if __cp >= 0xD800 && __cp <= 0xDFFF
   396                              <1>                 EMIT_ERROR "WSTR: Codepoint im Surrogatbereich ist ungueltig"
   397                              <1>             %else
   398                              <1>                 dw __cp
   399                              <1>             %endif
   400                              <1>         %elif __cp <= 0x10FFFF
   401                              <1>             %assign __tmp (__cp - 0x10000)
   402                              <1>             %assign __hi  (0xD800 + (__tmp >> 10))
   403                              <1>             %assign __lo  (0xDC00 + (__tmp & 0x3FF))
   404                              <1>             dw __hi, __lo
   405                              <1>         %else
   406                              <1>             EMIT_ERROR "WSTR: Codepoint > U+10FFFF"
   407                              <1>         %endif
   408                              <1>     %endif
   409                              <1> %endmacro
   410                              <1> 
   411                              <1> ; --- Hauptmakro ---
   412                              <1> %macro WSTRU 2+
   413                              <1>     %if __pre_stop == 0
   414                              <1>     %push WSTRU
   415                              <1> 
   416                              <1>     %define _WSTR_LBL   _cW_%1
   417                              <1>     %define _WSTR_END   _cW_%1_end
   418                              <1>     %define _WSTR_LENB  _cW_%1_length_bytes
   419                              <1>     %define _WSTR_LENW  _cW_%1_length_words
   420                              <1> 
   421                              <1> _WSTR_LBL:
   422                              <1>     %assign %$nargs %0-1
   423                              <1>     %rotate 1
   424                              <1> 
   425                              <1>     %rep %$nargs
   426                              <1>         %ifstr %1
   427                              <1>             ; String: byteweise -> 0x00xx
   428                              <1>             %strlen %$n %1
   429                              <1>             %assign %$i 0
   430                              <1>             %rep %$n
   431                              <1>                 %substr %$c %1 %$i+1,1
   432                              <1>                 dw %$c
   433                              <1>                 %assign %$i %$i+1
   434                              <1>             %endrep
   435                              <1>         %elifnum %1
   436                              <1>             ; Zahl/Expression als Unicode-Scalar
   437                              <1>             __WSTR_EMIT_CP %1
   438                              <1>         %else
   439                              <1>             ; Label/Expression, zur Sicherheit ebenfalls als Codepoint behandeln
   440                              <1>             __WSTR_EMIT_CP %1
   441                              <1>         %endif
   442                              <1>         %rotate 1
   443                              <1>     %endrep
   444                              <1> 
   445                              <1>     dw 0
   446                              <1> 
   447                              <1> _WSTR_END:
   448                              <1> _WSTR_LENB  equ (_WSTR_END - _WSTR_LBL - 2)
   449                              <1> _WSTR_LENW  equ (_WSTR_LENB/2)
   450                              <1> 
   451                              <1>     %undef _WSTR_LBL
   452                              <1>     %undef _WSTR_END
   453                              <1>     %undef _WSTR_LENB
   454                              <1>     %undef _WSTR_LENW
   455                              <1>     %pop
   456                              <1>     %endif      ; __pre_stop
   457                              <1> %endmacro
   458                              <1> 
   459                              <1> ; -----------------------------------------------------------------------------
   460                              <1> ; WSTRUL  <name>, <args...>   -> definiert <name> und <name>_len
   461                              <1> ; (in Codeunits, ohne Null)
   462                              <1> ; -----------------------------------------------------------------------------
   463                              <1> %macro WSTR_AND_LEN 2-*
   464                              <1>     %if __pre_stop == 0
   465                              <1>     %push WSTRUL
   466                              <1>     %define %$name %1
   467                              <1> %1:
   468                              <1>     WSTRU %2
   469                              <1> %$name %+ _end:
   470                              <1>     %xdefine %$name %+ _len ( ((%$name %+ _end) - (%$name))/2 - 1 )
   471                              <1>     %pop
   472                              <1>     %endif
   473                              <1> %endmacro
   474                              <1> 
   475                              <1> ; -----------------------------------------------------------------------------
   476                              <1> ; Nach JEDEM vorhandenen Stringlabel einfach:
   477                              <1> ;   <label>_end:   (direkt nach dem String)
   478                              <1> ; und dann:
   479                              <1> ; -----------------------------------------------------------------------------
   480                              <1> %macro WSTR_LENGTH 1
   481                              <1>     %if __pre_stop == 0
   482                              <1>         %xdefine %1_len ( ((%1_end) - (%1))/2 - 1 )
   483                              <1>     %endif
   484                              <1> %endmacro
   485                              <1> 
   486                              <1> %macro AWSTR 1
   487                              <1> %if __pre_stop == 0
   488                              <1>     %push
   489                              <1>     %strlen __n %1
   490                              <1>     %assign __i 0
   491                              <1>     %rep __n
   492                              <1>         %substr __c %1 __i+1,1
   493                              <1>         dw __c
   494                              <1>         %assign __i __i+1
   495                              <1>     %endrep
   496                              <1>         dw 0
   497                              <1>     %pop
   498                              <1> %endif
   499                              <1> %endmacro
   500                              <1> 
   501                              <1> ; -----------------------------------------------------------------------------
   502                              <1> ; \brief String-Definition mit auto *_length (ohne 0-Byte)
   503                              <1> ; \desc  section .data
   504                              <1> ;        ZSTR cap2A, "Hallo", 13, 10
   505                              <1> ;
   506                              <1> ;        ergibt automatisch:
   507                              <1> ;        cap2A          db "Hallo",13,10,0
   508                              <1> ;        cap2A_end:
   509                              <1> ;        %define cap2A_length (cap2A_end - cap2A - 1)
   510                              <1> ; -----------------------------------------------------------------------------
   511                              <1> %macro ASTR 2+                    ; ASTR <name>, <bytes...>
   512                              <1> %if __pre_stop == 0
   513                              <1>     _cA_%1:       db %2, 0
   514                              <1>     _cA_%1_end:
   515                              <1>     _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <1> %endif
   517                              <1> %endmacro
   518                              <1> 
   519                              <1> ; -----------------------------------------------------------------------------
   520                              <1> ; \brief set the string label from %2 to register %1 ...
   521                              <1> ; -----------------------------------------------------------------------------
   522                              <1> %macro GETEXT 2
   523                              <1> %if __pre_stop == 0
   524                              <1>     mov     %1, IMAGE_BASE
   525                              <1>     add     %1, RVA_DATA(_cW_%2)
   526                              <1> %endif
   527                              <1> %endmacro
   528                              <1> 
   529                              <1> ; ------------------------------------------------------------
   530                              <1> ; ---- RVA-Helfer: bleibt wie bei dir ----
   531                              <1> ; %define RVA_DATA(L)   (DATA_VA  + ((L) - data_start))
   532                              <1> ; ------------------------------------------------------------
   533                              <1> ; Optional: einfacher Alias ohne Klammern/EXPR:
   534                              <1> ; ------------------------------------------------------------
   535                              <1> %imacro DATA_ABS 1
   536                              <1> %if __pre_stop == 0
   537                              <1>     IMAGE_BASE + RVA_DATA(%1)
   538                              <1> %endif
   539                              <1> %endmacro
   540                              <1> ; ------------------------------------------------------------
   541                              <1> ; Helfer: absolute VA einer Data-Variable bauen
   542                              <1> ; ------------------------------------------------------------
   543                              <1> %macro DATA_PTR 1
   544                              <1> %if __pre_stop == 0
   545                              <1>     (IMAGE_BASE + RVA_DATA(%1))
   546                              <1> %endif
   547                              <1> %endmacro
   548                              <1> ; ---------------------------------------------------------------------------
   549                              <1> ;; SETDATA <name>, <src> [, <size>]
   550                              <1> ;  - Schreibt <src> an Datenlabel <name>
   551                              <1> ;  - Wenn <size> fehlt, wird die Größe aus <src>-Register abgeleitet
   552                              <1> ;    (al/ax/eax/rax → 8/16/32/64 Bit). Bei Immediate bitte <size> angeben.
   553                              <1> ;  - <size> darf BYTE/WORD/DWORD/QWORD oder 8/16/32/64 sein.
   554                              <1> ; ---------------------------------------------------------------------------
   555                              <1> ;; Beispiele:
   556                              <1> ; last_error: dd 0
   557                              <1> ; orig_attr:  dw 0
   558                              <1> ; flag8:      db 0
   559                              <1> ; ---------------------------------------------------------------------------
   560                              <1> ;; schreiben (Registergröße bestimmt Breite)
   561                              <1> ; mov   eax, 0xDEADBEEF
   562                              <1> ; SETDATA last_error, eax          ; dword write
   563                              <1> ; ---------------------------------------------------------------------------
   564                              <1> ;; schreiben (Immediate -> Größe angeben)
   565                              <1> ; SETDATA orig_attr, 0x000F, WORD  ; word write
   566                              <1> ; SETDATA flag8,     1,      BYTE  ; byte write
   567                              <1> ; ---------------------------------------------------------------------------
   568                              <1> ;; lesen (Registergröße passt)
   569                              <1> ; GETDATA eax, last_error          ; dword read → eax
   570                              <1> ; ---------------------------------------------------------------------------
   571                              <1> ;; lesen (Größe erzwingen)
   572                              <1> ; GETDATA ax,  orig_attr, WORD     ; word read → ax
   573                              <1> ; GETDATA al,  flag8,     BYTE     ; byte read → al
   574                              <1> ; ---------------------------------------------------------------------------
   575                              <1> %macro SET_DATA 1-3
   576                              <1> %if DOS_SHELL == 1
   577                              <1>     %if __pre_stop == 0
   578                              <1>         %if %0 == 2
   579                              <1>             %ifnum %2
   580                              <1>                 section .text
   581                              <1>                 lea ax, [PTR16(_cA_%1)]
   582                              <1>                 mov ax, %2
   583                              <1>             %endif
   584                              <1>         %elif %0 == 3
   585                              <1>             %ifstr %2
   586                              <1>                 %ifndef __var__%1
   587                              <1>                     %define __var__%1 1
   588                              <1>                     section .data
   589                              <1>                     %%__v: db %2, 0
   590                              <1>                 %endif
   591                              <1>             %endif
   592                              <1>             section .text
   593                              <1>             lea ax, [PTR16(_cA_%1)]
   594                              <1>             mov ax, %2
   595                              <1>             jmp %3
   596                              <1>         %endif
   597                              <1>     %endif
   598                              <1> %else
   599                              <1>     %if __pre_stop == 0
   600                              <1>         EMIT_ERROR 'todo'
   601                              <1>     %endif
   602                              <1> %endif
   603                              <1> %endmacro
   604                              <1> %macro SETDATA 2-3
   605                              <1> %if DOS_SHELL == 1
   606                              <1> %else
   607                              <1>     push    rdx
   608                              <1>     mov     rdx, IMAGE_BASE
   609                              <1>     add     rdx, RVA_DATA(%1)
   610                              <1>     %if %0 = 2
   611                              <1>         mov     [%2], rdx
   612                              <1>         pop     rdx
   613                              <1>     %else
   614                              <1>         pop     rdx
   615                              <1>       %ifidni %3, BYTE
   616                              <1>         mov     byte  [rdx], %2
   617                              <1>       %elifidni %3, WORD
   618                              <1>         mov     word  [rdx], %2
   619                              <1>       %elifidni %3, DWORD
   620                              <1>         mov     dword [rdx], %2
   621                              <1>       %elifidni %3, QWORD
   622                              <1>         mov     qword [rdx], %2
   623                              <1>       %elif %3 = 8
   624                              <1>         mov     byte  [rdx], %2
   625                              <1>       %elif %3 = 16
   626                              <1>         mov     word  [rdx], %2
   627                              <1>       %elif %3 = 32
   628                              <1>         mov     dword [rdx], %2
   629                              <1>       %elif %3 = 64
   630                              <1>         mov     qword [rdx], %2
   631                              <1>       %else
   632                              <1>         EMIT_ERROR "SETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   633                              <1>       %endif
   634                              <1>     %endif
   635                              <1> %endif
   636                              <1> %endmacro
   637                              <1> 
   638                              <1> ; ------------------------------------------------------------
   639                              <1> ; GETDATA <dst>, <name> [, <size>]
   640                              <1> ;  - Liest aus Datenlabel <name> in Register <dst>
   641                              <1> ;  - Wenn <size> fehlt, muss <dst> die passende Größe haben
   642                              <1> ;    (al/ax/eax/rax). Sonst <size> angeben (BYTE/WORD/DWORD/QWORD oder 8/16/32/64).
   643                              <1> ; ------------------------------------------------------------
   644                              <1> %macro GETDATA 2-3
   645                              <1>     mov     %1, IMAGE_BASE
   646                              <1>     add     %1, RVA_DATA(%2)
   647                              <1>     %if %0 = 2
   648                              <1>         ;mov     %1, [rdx]
   649                              <1>     %else
   650                              <1>       %ifidni %3, BYTE
   651                              <1>         mov     %1, byte  [rdx]
   652                              <1>       %elifidni %3, WORD
   653                              <1>         mov     %1, word  [rdx]
   654                              <1>       %elifidni %3, DWORD
   655                              <1>         mov     %1, dword [rdx]
   656                              <1>       %elifidni %3, QWORD
   657                              <1>         mov     %1, qword [rdx]
   658                              <1>       %elif %3 = 8
   659                              <1>         mov     %1, byte  [rdx]
   660                              <1>       %elif %3 = 16
   661                              <1>         mov     %1, word  [rdx]
   662                              <1>       %elif %3 = 32
   663                              <1>         mov     %1, dword [rdx]
   664                              <1>       %elif %3 = 64
   665                              <1>         mov     %1, qword [rdx]
   666                              <1>       %else
   667                              <1>         EMIT_ERROR "GETDATA: 3rd arg must be BYTE/WORD/DWORD/QWORD or 8/16/32/64"
   668                              <1>       %endif
   669                              <1>     %endif
   670                              <1> %endmacro
   671                              <1> 
   672                              <1> %macro Return 0-1
   673                              <1> %if %0 == 1
   674                              <1>     mov eax, %1
   675                              <1> %else
   676                              <1>     ret
   677                              <1> %endif
   678                              <1> %endmacro
   679                              <1> 
   680                              <1> ; -----------------------------------------------------------------------------
   681                              <1> ; condition jump's after function call -> test eax, eax
   682                              <1> ; -----------------------------------------------------------------------------
   683                              <1> %macro CHECK_NZ 1-2
   684                              <1> %if %0 == 2
   685                              <1>     test eax, eax
   686                              <1>     jnz %1
   687                              <1>     jmp %2
   688                              <1> %else
   689                              <1>     test eax, eax
   690                              <1>     jnz %1
   691                              <1> %endif
   692                              <1> %endmacro
   693                              <1> 
   694                              <1> ; -----------------------------------------------------------------------------
   695                              <1> %macro CHECK_NE 1-2
   696                              <1> %if %0 == 2
   697                              <1>     test eax, eax
   698                              <1>     jne %1
   699                              <1>     jmp %2
   700                              <1> %else
   701                              <1>     test eax, eax
   702                              <1>     jne %1
   703                              <1> %endif
   704                              <1> %endmacro
   705                              <1> 
   706                              <1> ; -----------------------------------------------------------------------------
   707                              <1> %macro CHECK_E 1-2
   708                              <1> %if %0 == 2
   709                              <1>     test eax, eax
   710                              <1>     je  %1
   711                              <1>     jmp %2
   712                              <1> %else
   713                              <1>     test eax, eax
   714                              <1>     je  %1
   715                              <1> %endif
   716                              <1> %endmacro
   717                              <1> 
   718                              <1> ; -----------------------------------------------------------------------------
   719                              <1> ; \brief prolog of a assembler routine + 32 Windows 64 Bit shadow
   720                              <1> ; \param optional shadow at start -> int
   721                              <1> ; -----------------------------------------------------------------------------
   722                              <1> %macro FUNC_ENTER 0-1
   723                              <1> %if %0 == 1
   724                              <1>     AddShadow %1
   725                              <1> %else
   726                              <1>     AddShadow
   727                              <1> %endif
   728                              <1>     push    rbp
   729                              <1>     mov     rbp, rsp
   730                              <1> %endmacro
   731                              <1> 
   732                              <1> ; -----------------------------------------------------------------------------
   733                              <1> ; \brief epilog of a assembler routine - 32 Windows 64 Bit shadow
   734                              <1> ; \param optional shadow at end -> int
   735                              <1> ; -----------------------------------------------------------------------------
   736                              <1> %macro FUNC_LEAVE 0-1
   737                              <1> %if %0 == 1
   738                              <1>     DelShadow %1
   739                              <1> %else
   740                              <1>     DelShadow
   741                              <1> %endif
   742                              <1>     pop     rbp
   743                              <1>     ret
   744                              <1> %endmacro
   745                              <1> 
   746                              <1> ; -----------------------------------------------------------------------------
   747                              <1> ; \brief allocate/open a text console window under Windows 11 desktop.
   748                              <1> ; \param ok  -> label
   749                              <1> ; \param err -> label
   750                              <1> ; \since 1.0
   751                              <1> ;
   752                              <1> ; \return bool - 0 no Error; else Error
   753                              <1> ; -----------------------------------------------------------------------------
   754                              <1> %macro call_AllocConsole 2
   755                              <1> %if DOS_SHELL == 1
   756                              <1>     EMIT_ERROR ERROR_Win32API
   757                              <1> %else
   758                              <1>     CALL_IAT AllocConsole
   759                              <1>     %if %0 == 2
   760                              <1>         CHECK_NZ %1, %2
   761                              <1>     %endif
   762                              <1> %endif
   763                              <1> %endmacro
   764                              <1> 
   765                              <1> ; -----------------------------------------------------------------------------
   766                              <1> ; \brief call the Windows 10 win32api function ExitProcess, to close the thread
   767                              <1> ; -----------------------------------------------------------------------------
   768                              <1> %macro call_ExitProcess 0-1
   769                              <1> %if DOS_SHELL == 1
   770                              <1>     EMIT_ERROR ERROR_Win32API
   771                              <1> %else
   772                              <1>     %if %0 == 1
   773                              <1>         mov rax, %1
   774                              <1>     %else
   775                              <1>         mov rax, 0
   776                              <1>     %endif
   777                              <1>     CALL_IAT ExitProcess
   778                              <1> %endif
   779                              <1> %endmacro
   780                              <1> 
   781                              <1> ; -----------------------------------------------------------------------------
   782                              <1> ; \brief helper function to save source code space for win32api FormatMessageW.
   783                              <1> ; -----------------------------------------------------------------------------
   784                              <1> %macro call_FormatMessageW 0
   785                              <1>     CALL_IAT FormatMessageW
   786                              <1> %endmacro
   787                              <1> 
   788                              <1> ; -----------------------------------------------------------------------------
   789                              <1> ; \brief
   790                              <1> ; -----------------------------------------------------------------------------
   791                              <1> ;macro call_GetConsoleScreenBufferInfo
   792                              <1> ;endmacro
   793                              <1> 
   794                              <1> ; -----------------------------------------------------------------------------
   795                              <1> ; \brief  this macro call the win32api function GetLastError.
   796                              <1> ; \param  nothing
   797                              <1> ; \return ExitCode - int
   798                              <1> ; -----------------------------------------------------------------------------
   799                              <1> %macro call_GetLastError 0
   800                              <1> %if DOS_SHELL == 1
   801                              <1>     EMIT_ERROR ERROR_Win32API
   802                              <1> %else
   803                              <1>     CALL_IAT GetLastError
   804                              <1>     test rax, rax
   805                              <1>     jnz  %%ok
   806                              <1>     AddShadow
   807                              <1>     call HandleLastError
   808                              <1>     DelShadow
   809                              <1> %%ok:
   810                              <1> ;ShowMessageW ShowLastW,capW
   811                              <1> %endif
   812                              <1> %endmacro
   813                              <1> 
   814                              <1> ; -----------------------------------------------------------------------------
   815                              <1> ; \brief  get the standard output device.
   816                              <1> ; \param  ok     -> label
   817                              <1> ; \param  error  -> label
   818                              <1> ; \param  handle -> int
   819                              <1> ; \see    AllocConsole
   820                              <1> ; \since  1.0
   821                              <1> ; \return ?
   822                              <1> ; -----------------------------------------------------------------------------
   823                              <1> %macro call_GetStdHandle 3
   824                              <1> %if DOS_SHELL == 1
   825                              <1>     EMIT_ERROR ERROR_Win32API
   826                              <1> %else
   827                              <1>     mov ecx, %3
   828                              <1>     CALL_IAT GetStdHandle
   829                              <1>     cmp   rax, -1     ; INVALID_HANDLE_VALUE ?
   830                              <1>     je    %%error     ; yes -> error
   831                              <1>     test  rax, rax    ; 0 ?
   832                              <1>     jz    %%error     ; yes -> error
   833                              <1>     ;
   834                              <1>     mov   r12, rax    ; valid handle in rax
   835                              <1>     jmp   %%ok
   836                              <1> %%error:
   837                              <1>     call HandleLastError
   838                              <1>     jmp  %2
   839                              <1> %%ok:
   840                              <1>     jmp  %1
   841                              <1> %endif
   842                              <1> %endmacro
   843                              <1> 
   844                              <1> %macro call_LoadCursorW 0
   845                              <1> %if DOS_SHELL == 1
   846                              <1>     EMIT_ERROR ERROR_Win32API
   847                              <1> %else
   848                              <1>     CALL_IAT LoadCursorW
   849                              <1>     ;ShowMessageW ShowHelloW,capW
   850                              <1>     ;call_GetLastError
   851                              <1> %endif
   852                              <1> %endmacro
   853                              <1> 
   854                              <1> %macro call_LocalFree 0
   855                              <1> %if DOS_SHELL == 1
   856                              <1>     EMIT_ERROR ERROR_Win32API
   857                              <1> %else
   858                              <1>     CALL_IAT MessageBoxW
   859                              <1> %endif
   860                              <1> %endmacro
   861                              <1> 
   862                              <1> ; -----------------------------------------------------------------------------
   863                              <1> ; \brief helper macro to shorten code, and call the win32api MessageBox W
   864                              <1> ; -----------------------------------------------------------------------------
   865                              <1> %macro call_MessageBoxW 0
   866                              <1>     CALL_IAT MessageBoxW
   867                              <1> %endmacro
   868                              <1> 
   869                              <1> ; -----------------------------------------------------------------------------
   870                              <1> ; \brief helper macro to shorten code, and call the win32api function wsprintfW
   871                              <1> ; -----------------------------------------------------------------------------
   872                              <1> %macro call_wsprintfW 0
   873                              <1>     CALL_IAT wsprintfW
   874                              <1> %endmacro
   875                              <1> 
   876                              <1> %macro call_WriteConsoleA 0
   877                              <1> %if DOS_SHELL == 1
   878                              <1>     EMIT_ERROR ERROR_Win32API
   879                              <1> %else
   880                              <1>     CALL_IAT WriteConsoleA
   881                              <1> %endif
   882                              <1> %endmacro
   883                              <1> 
   884                              <1> ; -----------------------------------------------------------------------------
   885                              <1> ; \brief Write - display text on the Windows Console.
   886                              <1> ; \param 1 -> label -> on error
   887                              <1> ; \param 2 -> label -> text to display
   888                              <1> ; \param 3 -> label -> output handle; default is: STD_OUTPUT_HANDLE
   889                              <1> ; \see   AllocConsole
   890                              <1> ; \since 1.0
   891                              <1> ; -----------------------------------------------------------------------------
   892                              <1> %macro call_User_Write 2-3
   893                              <1> %if DOS_SHELL == 1
   894                              <1>     EMIT_ERROR ERROR_Win32API
   895                              <1> %else
   896                              <1> %if %0 == 2
   897                              <1>     call_GetStdHandle %%ok, %1, STD_OUTPUT_HANDLE
   898                              <1> %else
   899                              <1>     call_GetStdHandle %%ok, %1, %3
   900                              <1> %endif
   901                              <1> %%ok:
   902                              <1>     ; --- WriteConsoleA(hOut, fmtHello, hello_len, NULL, NULL) ---
   903                              <1>     mov     rcx, r12                       ; 1. Arg: HANDLE hConsoleOutput
   904                              <1>     mov     rdx, IMAGE_BASE
   905                              <1>     add     rdx, RVA_DATA(%2)              ; 2. Arg: LPCVOID lpBuffer
   906                              <1>     mov     r8d, %2_length                 ; 3. Arg: DWORD nNumberOfCharsToWrite
   907                              <1>     xor     r9d, r9d                       ; lpNumberOfCharsWritten = NULL
   908                              <1>     AddShadow 32 + 8
   909                              <1>     mov     qword [rsp+32], 0              ; 5. Arg: LPVOID lpReserved = NULL
   910                              <1>     call_WriteConsoleA
   911                              <1>     DelShadow 32 + 8
   912                              <1> %endif
   913                              <1> %endmacro
   914                              <1> 
   915                              <1> ; -----------------------------------------------------------------------------
   916                              <1> ; \brief read a string line in console window ...
   917                              <1> ; -----------------------------------------------------------------------------
   918                              <1> %macro call_User_ReadLn 1
   919                              <1>     call user_Console_ReadLn
   920                              <1> %endmacro
   921                              <1> 
   922                              <1> ; -----------------------------------------------------------------------------
   923                              <1> %macro DefWindowProcW 0
   924                              <1>     mov     rax, IMAGE_BASE + RVA_IDATA(IAT_win32_DefWindowProcW)
   925                              <1> %endmacro
   926                              <1> 
   927                              <1> %macro IAT_CreateWindowExW 0
   928                              <1> %if DOS_SHELL == 1
   929                              <1>     EMIT_ERROR ERROR_Win32API
   930                              <1> %else
   931                              <1>     mov     rax, IMAGE_BASE
   932                              <1>     add     rax, RVA_IDATA(IAT_win32_CreateWindowExW)
   933                              <1>     call    [rax]
   934                              <1> %endif
   935                              <1> %endmacro
   936                              <1> ; -----------------------------------------------------------------------------
   937                              <1> 
   938                              <1> ; -----------------------------------------------------------------------------
   939                              <1> ; \brief  DispatchMessageW
   940                              <1> ; \since  1.0
   941                              <1> ; -----------------------------------------------------------------------------
   942                              <1> %macro DispatchMessageW 0
   943                              <1> %if DOS_SHELL == 1
   944                              <1>     EMIT_ERROR ERROR_Win32API
   945                              <1> %else
   946                              <1>     mov     rcx, rsi
   947                              <1>     CALL_IAT DispatchMessageW
   948                              <1> %endif
   949                              <1> %endmacro
   950                              <1> 
   951                              <1> ; -----------------------------------------------------------------------------
   952                              <1> ; \brief  ExitProcess terminate the given application thread.
   953                              <1> ; \since  1.0
   954                              <1> ; \param  exitcode -> integer
   955                              <1> ; \return exitcode -> rax
   956                              <1> ; -----------------------------------------------------------------------------
   957                              <1> %macro ExitProcess 0-1 0
   958                              <1> %if DOS_SHELL == 1
   959                              <1>     EMIT_ERROR ERROR_Win32API
   960                              <1> %else
   961                              <1>     nop
   962                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
   963                              <1>     mov     ecx,%1
   964                              <1>     CALL_IAT ExitProcess
   965                              <1>     ; no return
   966                              <1>     ;DelShadow (32 + 16)
   967                              <1> %endif
   968                              <1> %endmacro
   969                              <1> 
   970                              <1> ; -----------------------------------------------------------------------------
   971                              <1> ; \brief  GetLastError catches the last error that was occured during win32api
   972                              <1> ;         function call.
   973                              <1> ; \since  1.0
   974                              <1> ; \param  nothing
   975                              <1> ; \return ?
   976                              <1> ; -----------------------------------------------------------------------------
   977                              <1> %macro GETLASTERROR 2
   978                              <1>     test    eax, eax
   979                              <1>     %1      %2
   980                              <1> %endmacro
   981                              <1> 
   982                              <1> %macro GetLastError 0
   983                              <1> %if DOS_SHELL == 1
   984                              <1>     EMIT_ERROR ERROR_Win32API
   985                              <1> %else
   986                              <1>     CALL_IAT GetLastError
   987                              <1> %endif
   988                              <1> %endmacro
   989                              <1> 
   990                              <1> ; -----------------------------------------------------------------------------
   991                              <1> ; \brief  GetMessageW
   992                              <1> ; -----------------------------------------------------------------------------
   993                              <1> %macro GetMessageW 0
   994                              <1> %if DOS_SHELL == 1
   995                              <1>     EMIT_ERROR ERROR_Win32API
   996                              <1> %else
   997                              <1>     mov  rcx, rsi
   998                              <1>     Zero edx
   999                              <1>     Zero r8d
  1000                              <1>     Zero r9d
  1001                              <1>     CALL_IAT GetMessageW
  1002                              <1> %endif
  1003                              <1> %endmacro
  1004                              <1> 
  1005                              <1> ; -----------------------------------------------------------------------------
  1006                              <1> ; \brief  LoadCursorW
  1007                              <1> ; \since  1.0
  1008                              <1> ; \param  id - integer: resource id
  1009                              <1> ; -----------------------------------------------------------------------------
  1010                              <1> %macro LoadCursorW 1
  1011                              <1> %if DOS_SHELL == 1
  1012                              <1>     EMIT_ERROR ERROR_Win32API
  1013                              <1> %else
  1014                              <1>     Zero ecx
  1015                              <1>     mov  edx, %1
  1016                              <1>     CALL_IAT LoadCursorW
  1017                              <1> %endif
  1018                              <1> %endmacro
  1019                              <1> 
  1020                              <1> ; -----------------------------------------------------------------------------
  1021                              <1> ; \brief  MESSAGE is a style shortner for better read expierences ...
  1022                              <1> ; -----------------------------------------------------------------------------
  1023                              <1> %macro MESSAGE 2
  1024                              <1>     cmp     edx, %1
  1025                              <1>     je      .%2
  1026                              <1> %endmacro
  1027                              <1> 
  1028                              <1> ; -----------------------------------------------------------------------------
  1029                              <1> ; \brief ShowMessageW display a wide string message on the desktop screen per
  1030                              <1> ;        the wn32api.
  1031                              <1> ; \since 1.0
  1032                              <1> ; \see   ShowMessageA
  1033                              <1> ;
  1034                              <1> ; \param text_str  -> landet in rdx
  1035                              <1> ; \param title_str -> landet in r8
  1036                              <1> ;
  1037                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
  1038                              <1> ; -----------------------------------------------------------------------------
  1039                              <1> %macro ShowMessageW 2-3
  1040                              <1> %if DOS_SHELL == 1
  1041                              <1>     EMIT_ERROR ERROR_Win32API
  1042                              <1> %else
  1043                              <1>     Zero    ecx             ; hWnd = NULL
  1044                              <1>     mov     rdx, PTR64(%1)  ; lpText
  1045                              <1>     mov     r8,  PTR64(%2)  ; lpCaption    
  1046                              <1> %if %0 == 2                 ; %0 = argument count
  1047                              <1>     xor     r9d, r9d        ; uType = MB_OK
  1048                              <1> %else
  1049                              <1>     mov     r9d, %3         ; uType = argument exists
  1050                              <1> %endif
  1051                              <1>     CALL_IAT MessageBoxW
  1052                              <1> %endif
  1053                              <1> %endmacro
  1054                              <1> 
  1055                              <1> ; -----------------------------------------------------------------------------
  1056                              <1> ; \brief ShowMessageA display a ansi string message on the desktop screen per
  1057                              <1> ;        the wn32api.
  1058                              <1> ; \since 1.0
  1059                              <1> ; \see   ShowMessageW
  1060                              <1> ;
  1061                              <1> ; \param text_str  -> landet in rdx
  1062                              <1> ; \param title_str -> landet in r8
  1063                              <1> ;
  1064                              <1> ; \param mb_flags  -> optional ( r9d ), default: 0 (MB_OK)
  1065                              <1> ; -----------------------------------------------------------------------------
  1066                              <1> %macro ShowMessageA 2-3
  1067                              <1> %if DOS_SHELL == 1
  1068                              <1>     EMIT_ERROR ERROR_Win32API
  1069                              <1> %else
  1070                              <1>     Zero    ecx
  1071                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; "MessageBoxW failed"
  1072                              <1>     mov     r8,  IMAGE_BASE + RVA_DATA(_cA_%2)  ; "User32"
  1073                              <1> %if %0 == 2                                     ; %0 = argument count
  1074                              <1>     xor     r9d, r9d                            ; uType = MB_OK
  1075                              <1> %else
  1076                              <1>     mov     r9d, %3                             ; uType = argument exists
  1077                              <1> %endif
  1078                              <1>     CALL_IAT MessageBoxA
  1079                              <1> %endif
  1080                              <1> %endmacro
  1081                              <1> 
  1082                              <1> ; -----------------------------------------------------------------------------
  1083                              <1> ; \brief  ShowWindow shows the window witht the hwnd id in r13.
  1084                              <1> ; \since  1.0
  1085                              <1> ; \param  hwnd -> HWND handle window
  1086                              <1> ; \param  (optional) flag -> integer: default = SW_SHOWDEFAULT
  1087                              <1> ; -----------------------------------------------------------------------------
  1088                              <1> %macro ShowWindow 1-2
  1089                              <1> %if DOS_SHELL == 1
  1090                              <1>     EMIT_ERROR ERROR_Win32API
  1091                              <1> %else
  1092                              <1>     nop
  1093                              <1>     ;AddShadow (32 + 16)           ; Shadow Space + 16 B Align
  1094                              <1>     mov     rcx, %1
  1095                              <1> %if %0 == 2
  1096                              <1>     mov     edx, %2
  1097                              <1> %else
  1098                              <1>     mov     edx, SW_SHOWDEFAULT
  1099                              <1> %endif
  1100                              <1>     CALL_IAT ShowWindow
  1101                              <1>     ;DelShadow (32 + 16)
  1102                              <1> %endif
  1103                              <1> %endmacro
  1104                              <1> 
  1105                              <1> ; -----------------------------------------------------------------------------
  1106                              <1> ; \brief display a message box on top of the Windows 11 desktop.
  1107                              <1> ; \param text   -> str
  1108                              <1> ; \param title  -> str
  1109                              <1> ; \param button -> int
  1110                              <1> ; -----------------------------------------------------------------------------
  1111                              <1> %macro call_ShowMessageW 5
  1112                              <1>     ShowMessageW %3, %4, %5
  1113                              <1>     CHECK_NZ %1, %2
  1114                              <1> %endmacro
  1115                              <1> 
  1116                              <1> ; -----------------------------------------------------------------------------
  1117                              <1> ; \brief  TranslateMessage
  1118                              <1> ; \since  1.0
  1119                              <1> ; -----------------------------------------------------------------------------
  1120                              <1> %macro TranslateMessage 0
  1121                              <1> %if DOS_SHELL == 1
  1122                              <1>     EMIT_ERROR ERROR_Win32API
  1123                              <1> %else
  1124                              <1>     mov     rcx, rsi
  1125                              <1>     CALL_IAT TranslateMessage
  1126                              <1> %endif
  1127                              <1> %endmacro
  1128                              <1> 
  1129                              <1> ; -----------------------------------------------------------------------------
  1130                              <1> ; \brief  UpdateWindow refresh the window properties and draw.
  1131                              <1> ; \since  1.0
  1132                              <1> ;
  1133                              <1> ; \see    Invalidate
  1134                              <1> ; \see    Repaint
  1135                              <1> ;
  1136                              <1> ; \param  hwnd -> HWND handle of window to update
  1137                              <1> ; -----------------------------------------------------------------------------
  1138                              <1> %macro UpdateWindow 1
  1139                              <1> %if DOS_SHELL == 1
  1140                              <1>     EMIT_ERROR ERROR_Win32API
  1141                              <1> %else
  1142                              <1>     mov     rcx, %1
  1143                              <1>     CALL_IAT UpdateWindow
  1144                              <1> %endif
  1145                              <1> %endmacro
  1146                              <1> 
  1147                              <1> ; -----------------------------------------------------------------------------
  1148                              <1> ; \brief set the length of a given ASCII string to register ...
  1149                              <1> ; -----------------------------------------------------------------------------
  1150                              <1> %macro SETLEN 2
  1151                              <1>     mov      %1, %2_length
  1152                              <1> %endmacro
  1153                              <1> 
  1154                              <1> ; -----------------------------------------------------------------------------
  1155                              <1> ; \brief write ASCII text on the text Windows console ...
  1156                              <1> ; -----------------------------------------------------------------------------
  1157                              <1> %macro WRITE_CON_A 1-2
  1158                              <1> %if DOS_SHELL == 1
  1159                              <1>     %if %0 == 2
  1160                              <1>         PUTS_COLOR %1, %2
  1161                              <1>     %else
  1162                              <1>         PUTS_COLOR %1, 0x07
  1163                              <1>     %endif
  1164                              <1> %else
  1165                              <1>     ; prepare
  1166                              <1>     xor      eax, eax
  1167                              <1>     mov      rcx, PTR64(_cA_%1)
  1168                              <1>     call     GET_STR_LEN
  1169                              <1>     mov      r14, rax
  1170                              <1>     GET_CON_O_HANDLE r12
  1171                              <1>     mov      rcx, r12
  1172                              <1>     mov      rdx, PTR64(_cA_%1)
  1173                              <1>     mov      r8 , r14
  1174                              <1>     xor      r9d, r9d
  1175                              <1>     mov      qword [rsp+32], 0
  1176                              <1>     CALL_IAT WriteConsoleA
  1177                              <1> %endif
  1178                              <1> %endmacro
  1179                              <1> 
  1180                              <1> ; -----------------------------------------------------------------------------
  1181                              <1> ; \brief read utf-8 text on the text Windows console ...
  1182                              <1> ; \param dst -> buffer for the "readln" text
  1183                              <1> ; -----------------------------------------------------------------------------
  1184                              <1> %macro READL_CON_A 0-1
  1185                              <1> %if DOS_SHELL == 1
  1186                              <1>     %if  %0 == 1
  1187                              <1>         mov  dx, PTR16(_cA_%1)
  1188                              <1>         call DOSReadLn
  1189                              <1>     %else
  1190                              <1>         mov  dx, PTR16(_cA_dos_buffer)
  1191                              <1>         call DOSReadLn
  1192                              <1>     %endif
  1193                              <1> %else
  1194                              <1>     ; prepare
  1195                              <1>     GET_CON_I_HANDLE  r13
  1196                              <1>     ; ReadConsoleA(hIn, inbuf, maxChars, &read, NULL)
  1197                              <1>     mov      rcx, r13
  1198                              <1>     mov      rdx, PTR64(_cA_%1)
  1199                              <1>     mov      r8d, 127           ; maxChars (Reserviere 1 Byte für NUL)
  1200                              <1>     mov      r9 , PTR64(written)
  1201                              <1>     xor      rax, rax           ; lpReserved = NULL (über Shadow Space)
  1202                              <1>     mov      [rsp+32], rax
  1203                              <1>     CALL_IAT ReadConsoleA
  1204                              <1> %endif
  1205                              <1> %endmacro
  1206                              <1> 
  1207                              <1> ; -----------------------------------------------------------------------------
  1208                              <1> ; \brief integer to string
  1209                              <1> ;
  1210                              <1> ; \param number -> register (number to convert)
  1211                              <1> ; \param buffer -> destination buffer
  1212                              <1> ; -----------------------------------------------------------------------------
  1213                              <1> %macro INT2STR 2
  1214                              <1>     mov     edx, %2                             ; number to convert
  1215                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)  ; destination buffer
  1216                              <1>     call    u32_to_dec                          ; buffer -> "12345",0 ; RAX = 5
  1217                              <1> %endmacro
  1218                              <1> 
  1219                              <1> ; -----------------------------------------------------------------------------
  1220                              <1> ; \brief concatenate two strings (%2, %3) to a given string destionation (%1).
  1221                              <1> ; \param dst  -> string buffer
  1222                              <1> ; \param src1 -> string 0-terminated
  1223                              <1> ; \param src2 -> string 0-terminated
  1224                              <1> ; -----------------------------------------------------------------------------
  1225                              <1> %macro STRCPY_ANSI 3
  1226                              <1>     mov     rcx, IMAGE_BASE + RVA_DATA(_cA_%1)
  1227                              <1>     mov     rdx, IMAGE_BASE + RVA_DATA(_cA_%2)
  1228                              <1>     mov     r8 , IMAGE_BASE + RVA_DATA(_cA_%3)
  1229                              <1>     call    concat_ansi
  1230                              <1> %endmacro
  1231                              <1> %macro STRCAT_ANSI 2-*
  1232                              <1>     %xdefine __DSTSYM (_cA_%1 + 4)
  1233                              <1> 
  1234                              <1>     %rotate 1                     ; ab hier ist %1 der erste src
  1235                              <1>     %rep %0-1
  1236                              <1>         ; --- Ende von dst finden: RDI zeigt nach REPNZ SCASB auf Byte NACH '\0'
  1237                              <1>         mov     rdi, IMAGE_BASE
  1238                              <1>         add     rdi, RVA_DATA(__DSTSYM)
  1239                              <1>         xor     eax, eax          ; AL = 0
  1240                              <1>         mov     rcx, -1
  1241                              <1>         repne   scasb
  1242                              <1>         lea     rcx, [rdi - 1]    ; RCX -> Position des '\0' (Schreibposition)
  1243                              <1> 
  1244                              <1>         ; einen Source anhängen: (s1 = aktueller, s2 = leer)
  1245                              <1>         mov     rdx, PTR64(_cA_%1)
  1246                              <1>         mov     r8 , PTR64(_cA_empty)
  1247                              <1>         call    concat_ansi
  1248                              <1> 
  1249                              <1>         %rotate 1                 ; nächster src
  1250                              <1>     %endrep
  1251                              <1> %endmacro
  1252                              <1> 
  1253                              <1> ; -----------------------------------------------------------------------------
  1254                              <1> ; \brief get the output handle of allocated/open console ...
  1255                              <1> ; \param register to store output handle
  1256                              <1> ; -----------------------------------------------------------------------------
  1257                              <1> %macro GET_CON_O_HANDLE 1
  1258                              <1> %if DOS_SHELL == 1
  1259                              <1>     EMIT_ERROR ERROR_Win32API
  1260                              <1> %else
  1261                              <1>     mov      ecx, STD_OUTPUT_HANDLE
  1262                              <1>     CALL_IAT GetStdHandle
  1263                              <1>     mov      %1, rax         ; hOut
  1264                              <1> %endif
  1265                              <1> %endmacro
  1266                              <1> ; -----------------------------------------------------------------------------
  1267                              <1> ; \brief get the input handle of allocated/open console ...
  1268                              <1> ; \param register to store input handle
  1269                              <1> ; -----------------------------------------------------------------------------
  1270                              <1> %macro GET_CON_I_HANDLE 1
  1271                              <1> %if DOS_SHELL == 1
  1272                              <1>     EMIT_ERROR ERROR_Win32API
  1273                              <1> %else
  1274                              <1>     mov      ecx, STD_INPUT_HANDLE
  1275                              <1>     CALL_IAT GetStdHandle
  1276                              <1>     mov      %1, rax         ; hIn
  1277                              <1> %endif
  1278                              <1> %endmacro
  1279                              <1> 
  1280                              <1> %macro SCREEN_CLEAR 0
  1281                              <1> %if DOS_SHELL == 1
  1282                              <1>     call dos_screen_clear
  1283                              <1> %else
  1284                              <1>     GET_CON_O_HANDLE r12
  1285                              <1>     STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <1>     WRITE_CON_A buffer_B
  1287                              <1> %endif
  1288                              <1> %endmacro
  1289                              <1> 
  1290                              <1> ; -----------------------------------------------------------------------------
  1291                              <1> ; \brief set the cursor position in dos console ...
  1292                              <1> ; \param xpos - <imm>
  1293                              <1> ; \param ypos - <imm>
  1294                              <1> ; -----------------------------------------------------------------------------
  1295                              <1> %macro SET_CURSOR 2
  1296                              <1> %if %0 == 0
  1297                              <1>     EMIT_ERROR 2 argument missing
  1298                              <1> %endif
  1299                              <1> %if DOS_SHELL == 1
  1300                              <1>     mov  dl, %1         ; column
  1301                              <1>     mov  dh, %2         ; row
  1302                              <1>     call dos_set_cursor
  1303                              <1> %else
  1304                              <1> %endif
  1305                              <1> %endmacro
  1306                              <1> 
  1307                              <1> ; -----------------------------------------------------------------------------
  1308                              <1> ; \brief get the cursor position in dos console ...
  1309                              <1> ; -----------------------------------------------------------------------------
  1310                              <1> %macro GET_CURSOR 0
  1311                              <1> %if DOS_SHELL == 1
  1312                              <1>     call dos_get_cursor
  1313                              <1> %else
  1314                              <1>     EMIT_ERROR 'todo: windows'
  1315                              <1> %endif
  1316                              <1> %endmacro
  1317                              <1> 
  1318                              <1> ; -----------------------------------------------------------------------------
  1319                              <1> ; \brief set the color for console window text
  1320                              <1> ; \param 1. background -> int 0..255
  1321                              <1> ; \param 2. foreground -> int 0..255
  1322                              <1> ;
  1323                              <1> ; \desc  color values > 127 == blink chars
  1324                              <1> ; -----------------------------------------------------------------------------
  1325                              <1> %macro SET_COLOR_TO 2
  1326                              <1> %if %0 == 2
  1327                              <1>     STRCPY_ANSI buffer_B, consoleColor_1, empty
  1328                              <1>     STRCAT_ANSI buffer_B,                                     console_color_%1, buffer_semi,                console_color_%2, consoleColor_2
  1331                              <1>     WRITE_CON_A buffer_B
  1332                              <1> %endif
  1333                              <1> %endmacro
  1334                              <1> 
  1335                              <1> ; -----------------------------------------------------------------------------
  1336                              <1> ; \brief 
  1337                              <1> ; -----------------------------------------------------------------------------
  1338                              <1> %macro ARG_CURSOR 2
  1339                              <1> %if DOS_SHELL == 1
  1340                              <1>     GET_ARG  %1             ; save command line argument 1
  1341                              <1>     mov  bl, %2             ; color
  1342                              <1>     call PutStrColor        ; DOS screen
  1343                              <1> %endif
  1344                              <1> %endmacro
  1345                              <1> 
  1346                              <1> ; -----------------------------------------------------------------------------
  1347                              <1> ; \brief macro to put a colored string to the DOS console ...
  1348                              <1> ; -----------------------------------------------------------------------------
  1349                              <1> %macro PUTS_COLOR 2
  1350                              <1> %if DOS_SHELL == 1
  1351                              <1>     ;GET_CURSOR              ; move cursor to col:row
  1352                              <1>     %ifstr %1
  1353                              <1>         section .data
  1354                              <1>         %%msg: db %1, 0
  1355                              <1>         section .text
  1356                              <1>         xor  bx, bx
  1357                              <1>         mov  bl, %2                 ; color
  1358                              <1>         mov  si, PTR16(%%msg)       ; text 0-terminated
  1359                              <1>         call PutStrColor            ; DOS screen
  1360                              <1>     %elifidni %1, SI            ; text is already in SI
  1361                              <1>         section .text
  1362                              <1>         mov  bl, %2
  1363                              <1>         call PutStrColor        ; DOS screen
  1364                              <1>     %elifidni %1, DI            ; text is already in DI
  1365                              <1>         section .text
  1366                              <1>         mov  bl, %2             ; color
  1367                              <1>         call PutStrColor        ; DOS screen
  1368                              <1>     %else
  1369                              <1>         %assign __count 0
  1370                              <1>         %assign __varg  0
  1371                              <1>         %assign __stop  0
  1372                              <1>         %rep MAX_ARGV
  1373                              <1>             %if __stop == 0
  1374                              <1>                 %assign __count (__count + 1)
  1375                              <1>                 %ifidni %1, ARGV_%+__count
  1376                              <1>                     %assign __varg __count
  1377                              <1>                     %assign __stop 1
  1378                              <1>                 %endif
  1379                              <1>             %endif
  1380                              <1>         %endrep
  1381                              <1>         %if __varg > 0
  1382                              <1>             section .text
  1383                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1384                              <1>             mov  bl, __varg
  1385                              <1>             call getCommandLine_Arg
  1386                              <1>             call PutStrColor        ; DOS screen
  1387                              <1>         %else
  1388                              <1>             section .text
  1389                              <1>             mov  bl, %2             ; color
  1390                              <1>             mov  ax, PTR16(_cA_%1)  ; text 0-terminated
  1391                              <1>             mov  si, ax
  1392                              <1>             call PutStrColor        ; DOS screen
  1393                              <1>         %endif
  1394                              <1>         %undef __varg
  1395                              <1>     %endif
  1396                              <1> %else
  1397                              <1>     EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <1> %endif
  1399                              <1> %endmacro
  1400                              <1> 
  1401                              <1> ; -----------------------------------------------------------------------------
  1402                              <1> ; \brief  get the length of given label string
  1403                              <1> ; \param  1. label name/addr
  1404                              <1> ; \return CX = length of string
  1405                              <1> ; -----------------------------------------------------------------------------
  1406                              <1> %macro STRLEN 1
  1407                              <1> %if %0 == 1
  1408                              <1>     mov  si, PTR16(_cA_%1)
  1409                              <1>     call DOSStrLen
  1410                              <1>     mov  ax, cx             ; AX = length
  1411                              <1>     add  cx, 1              ; CX = length + 1
  1412                              <1> %else
  1413                              <1>     EMIT_ERROR 'exactly one argument expected.'
  1414                              <1> %endif
  1415                              <1> %endmacro
  1416                              <1> 
  1417                              <1> ; -----------------------------------------------------------------------------
  1418                              <1> ; \brief  helper macro save code resources.
  1419                              <1> ; \desc   return to DOS with exit code
  1420                              <1> ; \param  1. exit code value (0..255).
  1421                              <1> ; \return nothing
  1422                              <1> ; -----------------------------------------------------------------------------
  1423                              <1> %macro DOS_Exit 1
  1424                              <1> %if DOS_SHELL == 1
  1425                              <1>     %ifidni   %1, ax
  1426                              <1>         EMIT_ERROR 'AX not allowed here.'
  1427                              <1>     %elifidni %1, bx
  1428                              <1>         mov ax, 0x4C00
  1429                              <1>         or  ax, bx
  1430                              <1>         SysCall
  1431                              <1>     %elifidni %1, CX
  1432                              <1>         mov ax, 0x4C00
  1433                              <1>         or  ax, cx
  1434                              <1>         SysCall
  1435                              <1>     %elifidni %1, dx
  1436                              <1>         mov ax, 0x4C00
  1437                              <1>         or  ax, dx
  1438                              <1>         SysCall
  1439                              <1>     %elifnum  %1
  1440                              <1>         mov  ax, 0x4C00 | %1
  1441                              <1>         SysCall
  1442                              <1>     %else
  1443                              <1>         EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <1>     %endif
  1445                              <1> %endif
  1446                              <1> %endmacro
  1447                              <1> 
  1448                              <1> ; -----------------------------------------------------------------------------
  1449                              <1> ; \brief  print a CRLF on DOS console
  1450                              <1> ; \param  nothing
  1451                              <1> ; \return nothing
  1452                              <1> ; -----------------------------------------------------------------------------
  1453                              <1> %macro DOS_crlf 0
  1454                              <1>     call DOSrncrlf
  1455                              <1> %endmacro
  1456                              <1> 
  1457                              <1> ; -----------------------------------------------------------------------------
  1458                              <1> ; \brief write a string in DX to DOS console without "lf", and no "cr" ...
  1459                              <1> ; \param 1. DX - src label
  1460                              <1> ; \see   DOS_WriteLn
  1461                              <1> ; -----------------------------------------------------------------------------
  1462                              <1> %macro DOS_Write 1
  1463                              <1>     lea  dx, [PTR16(_cA_%1)]
  1464                              <1>     call DOS_ConsoleWrite
  1465                              <1> %endmacro
  1466                              <1> 
  1467                              <1> ; -----------------------------------------------------------------------------
  1468                              <1> ; \brief write a string in DX to DOS console with "lf", and "cr" ...
  1469                              <1> ; \param 1. DX - src label
  1470                              <1> ; \see   DOS_Write
  1471                              <1> ; -----------------------------------------------------------------------------
  1472                              <1> %macro DOS_WriteLn 1
  1473                              <1>     DOS_Write %1
  1474                              <1>     DOS_crlf
  1475                              <1> %endmacro
  1476                              <1> 
  1477                              <1> ; -----------------------------------------------------------------------------
  1478                              <1> ; \brief allocate memory for/in the DOS console ...
  1479                              <1> ; \param 1. count paragraphs
  1480                              <1> ; \note  calculate with: 4096 / 16 = 256 (4096 is a example !)
  1481                              <1> ; -----------------------------------------------------------------------------
  1482                              <1> %macro DOS_AllocMem 1
  1483                              <1> %if DOS_SHELL == 1
  1484                              <1>     mov  ax, 4800h      ; AH = 48h -> Allocate Memory Block
  1485                              <1>     mov  bx, %1         ; Paragraph-Anzahl
  1486                              <1>     SysCall
  1487                              <1>     
  1488                              <1>     sbb  ax, ax
  1489                              <1>     cmp  ax, 0
  1490                              <1>     je   %%.successful
  1491                              <1>     
  1492                              <1>     cmp  ax, 0xFF
  1493                              <1>     je   %%.fail        ; CF = 1 -> error, AX = error code
  1494                              <1>     
  1495                              <1>     jmp  %%.fail
  1496                              <1>     
  1497                              <1>     %%.successful:
  1498                              <1>     ; AX = Segment des Blocks
  1499                              <1>     mov  es, ax
  1500                              <1>     xor  di, di
  1501                              <1>     
  1502                              <1>     ; Block mit 0x00 füllen
  1503                              <1>     mov  cx, 4096
  1504                              <1>     mov  al, 0x00
  1505                              <1>     rep  stosb          ; write to ES:DI
  1506                              <1>     
  1507                              <1>     ; demo read access: AL = ES:[1234]
  1508                              <1>     ;mov  di, 1234
  1509                              <1>     ;mov  al, [es:di]
  1510                              <1>     
  1511                              <1>     jmp   %%.next
  1512                              <1>     
  1513                              <1>     %%.fail:
  1514                              <1>     DOS_WriteLn msg_alloc_error
  1515                              <1>     DOS_Exit    1
  1516                              <1>     
  1517                              <1>     %%.next:
  1518                              <1> %endif
  1519                              <1> %endmacro
  1520                              <1> 
  1521                              <1> %macro DOS_FreeMem 0
  1522                              <1> %if DOS_SHELL == 1
  1523                              <1>     mov es, ax
  1524                              <1>     mov ah, 0x49
  1525                              <1>     SysCall
  1526                              <1> %else
  1527                              <1>     EMIT_ERROR 'todo: windows'
  1528                              <1> %endif
  1529                              <1> %endmacro
  1530                              <1> 
  1531                              <1> ; -----------------------------------------------------------------------------
  1532                              <1> ; \brief COMPARE <reg>, <imm>, <label>
  1533                              <1> ; \param 1. <reg>
  1534                              <1> ; \param 2. <imm>
  1535                              <1> ; \param 3. <label>
  1536                              <1> ; \note  example: COMPARE al, 0x0a, printed
  1537                              <1> ;        result:  cmp <reg>, <imm>  /  je <label>
  1538                              <1> ; -----------------------------------------------------------------------------
  1539                              <1> %macro COMPARE 3
  1540                              <1>     cmp %1, %2
  1541                              <1>     je  %3
  1542                              <1> %endmacro
  1543                              <1> 
  1544                              <1> ; -----------------------------------------------------------------------------
  1545                              <1> ; \brief  get the n-th command line, success: jump to %2 ...
  1546                              <1> ; \param  1. <imm>
  1547                              <1> ; \return SI = text (=argument)
  1548                              <1> ; \note   example: GET_ARG 2
  1549                              <1> ;         result:  <text> in SI
  1550                              <1> ; -----------------------------------------------------------------------------
  1551                              <1> %macro GET_ARG 1-2
  1552                              <1> %if DOS_SHELL == 1
  1553                              <1>     lea  si, [PTR16(_cA_cmd_buf)]
  1554                              <1>     mov  bl, %1
  1555                              <1>     call getCommandLine_Arg
  1556                              <1>     %if %0 == 2
  1557                              <1>         jnc  %2
  1558                              <1>     %endif
  1559                              <1> %else
  1560                              <1>     EMIT_ERROR 'todo: windows'
  1561                              <1> %endif
  1562                              <1> %endmacro
  1563                              <1> 
  1564                              <1> ; -----------------------------------------------------------------------------
  1565                              <1> ; \brief save the n-th command line argument to the <label>
  1566                              <1> ; \param 1. <imm> -> n-th argument number
  1567                              <1> ; \param 2. <label>
  1568                              <1> ; \note  example: SET_ARG <imm>, <label>
  1569                              <1> ; -----------------------------------------------------------------------------
  1570                              <1> %macro SET_ARG 1-2
  1571                              <1> %if DOS_SHELL == 1
  1572                              <1>     %if %0 == 1
  1573                              <1>         GET_ARG  %1
  1574                              <1>         STR_COPY _cA_cmd_arg_%1
  1575                              <1>     %else
  1576                              <1>         GET_ARG  %1
  1577                              <1>         STR_COPY _cA_%2
  1578                              <1>     %endif
  1579                              <1> %else
  1580                              <1>     EMIT_ERROR 'todo: windows'
  1581                              <1> %endif
  1582                              <1> %endmacro
  1583                              <1> 
  1584                              <1> ; -----------------------------------------------------------------------------
  1585                              <1> ; \brief copy a string from source index SI to DI <label>
  1586                              <1> ; \param 1. <label>
  1587                              <1> ; \note  example: STR_COPY <label>
  1588                              <1> ; -----------------------------------------------------------------------------
  1589                              <1> %macro STR_COPY 1
  1590                              <1> %if DOS_SHELL == 1
  1591                              <1>     lea  di, [%1]       ; ES wird in string_copy gesetzt
  1592                              <1>     call string_copy    ; kommt zurück mit SI = Zielstart
  1593                              <1> %else
  1594                              <1>     EMIT_ERROR 'todo: windows'
  1595                              <1> %endif
  1596                              <1> %endmacro
  1597                              <1> 
  1598                              <1> ; -----------------------------------------------------------------------------
  1599                              <1> ; \brief short'ner to get the command line arguments given by the user input.
  1600                              <1> ; \brief initialize a console application ...
  1601                              <1> ; \param nothing
  1602                              <1> ; -----------------------------------------------------------------------------
  1603                              <1> %macro INIT_COMMAND_LINE 0
  1604                              <1> %if DOS_SHELL == 1
  1605                              <1>     call dos_get_command_line
  1606                              <1> %else
  1607                              <1>     EMIT_ERROR 'todo: windows'
  1608                              <1> %endif
  1609                              <1> %endmacro
  1610                              <1> 
  1611                              <1> ; -----------------------------------------------------------------------------
  1612                              <1> ; \brief call the DOS console initialize routine ...
  1613                              <1> ; -----------------------------------------------------------------------------
  1614                              <1> %macro INIT_CONSOLE 0
  1615                              <1> %if DOS_SHELL == 1
  1616                              <1>     call dos_init_console
  1617                              <1>     SCREEN_CLEAR
  1618                              <1> %else
  1619                              <1>     call init_app
  1620                              <1>     call init_console
  1621                              <1> %endif
  1622                              <1> %endmacro
  1623                              <1> 
  1624                              <1> ; -----------------------------------------------------------------------------
  1625                              <1> ; \brief generischer Handler für einen Fehlercode ...
  1626                              <1> ; -----------------------------------------------------------------------------
  1627                              <1> %macro DEF_ERROR 2
  1628                              <1> _h%1:
  1629                              <1>     PUTS_COLOR %2, ATTR_DOS_ERROR
  1630                              <1>     mov   cx, %1
  1631                              <1>     jmp   _open_exit
  1632                              <1> %endmacro
  1633                              <1> 
  1634                              <1> ; -----------------------------------------------------------------------------
  1635                              <1> ; \brief DOS seek to <origin> in file <handle> ...
  1636                              <1> ; \param 1. <file handle>
  1637                              <1> ; \param 2. <origin> 0 - begin of file, 1 - current position, 2 - end of file
  1638                              <1> ; -----------------------------------------------------------------------------
  1639                              <1> %macro DOS_Seek 2
  1640                              <1> %if DOS_SHELL == 1
  1641                              <1>     mov  bx, [PTR16(_cA_%1)]
  1642                              <1>     xor  cx, cx
  1643                              <1>     xor  dx, dx
  1644                              <1>     mov  ah, 0x42               ; move to ...
  1645                              <1>     mov  al, %2
  1646                              <1>     SysCall
  1647                              <1> %else
  1648                              <1>     EMIT_ERROR 'todo: windows'
  1649                              <1> %endif
  1650                              <1> %endmacro
  1651                              <1> 
  1652                              <1> ; -----------------------------------------------------------------------------
  1653                              <1> ; \brief DOS open existing <file name>
  1654                              <1> ; \param 1. <file name>
  1655                              <1> ; \param 2. <open mode> - DOS_READ_ONLY, DOW_WRITE_ONLY, DOS_READWRITE
  1656                              <1> ; -----------------------------------------------------------------------------
  1657                              <1> %macro DOS_Open 2
  1658                              <1> %if DOS_SHELL == 1
  1659                              <1>     mov  dx, PTR16(_cA_%1)
  1660                              <1>     mov  ah, 0x3D               ; open existing file
  1661                              <1>     mov  al, %2                 ; read-only
  1662                              <1>     SysCall
  1663                              <1> %else
  1664                              <1>     EMIT_ERROR 'todo: windows'
  1665                              <1> %endif
  1666                              <1> %endmacro
  1667                              <1> 
  1668                              <1> %macro DOS_Close 2
  1669                              <1> %if DOS_SHELL == 1
  1670                              <1>     mov  bx, [PTR16(_cA_%1)]
  1671                              <1>     or   bx, bx
  1672                              <1>     jz   %2
  1673                              <1>     mov  ah, 3Eh
  1674                              <1>     SysCall
  1675                              <1> %else
  1676                              <1>     EMIT_ERROR 'todo: windows'
  1677                              <1> %endif
  1678                              <1> %endmacro
  1679                              <1> 
  1680                              <1> ; -----------------------------------------------------------------------------
  1681                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1682                              <1> ; erzeugt für jedes Argument:
  1683                              <1> ; _cA_errn<arg>:
  1684                              <1> ;     PUTS_COLOR open_error_<arg>, ATTR_DOS_ERROR
  1685                              <1> ;     mov cx, <arg>
  1686                              <1> ;     jmp _open_exit
  1687                              <1> ; -----------------------------------------------------------------------------
  1688                              <1> ; Hilfsmakro: Nibble (0..15) -> Hex-Zeichen 0..F
  1689                              <1> %macro _HEXDIG 2
  1690                              <1>   %if %1 < 10
  1691                              <1>     %define %2 %1
  1692                              <1>   %elif %1 = 10
  1693                              <1>     %define %2 A
  1694                              <1>   %elif %1 = 11
  1695                              <1>     %define %2 B
  1696                              <1>   %elif %1 = 12
  1697                              <1>     %define %2 C
  1698                              <1>   %elif %1 = 13
  1699                              <1>     %define %2 D
  1700                              <1>   %elif %1 = 14
  1701                              <1>     %define %2 E
  1702                              <1>   %elif %1 = 15
  1703                              <1>     %define %2 F
  1704                              <1>   %else
  1705                              <1>     EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <1>   %endif
  1707                              <1> %endmacro
  1708                              <1> ; -----------------------------------------------------------------------------
  1709                              <1> ; expr -> zwei Hex-Zeichen OUT_H/OUT_L (ohne 0x/h), 8-bit
  1710                              <1> ; -----------------------------------------------------------------------------
  1711                              <1> %macro _HEX2 3
  1712                              <1>   %assign __v %1
  1713                              <1>   %assign __v __v & 0FFh
  1714                              <1>   %assign __hi (__v >> 4) & 0Fh
  1715                              <1>   %assign __lo  __v       & 0Fh
  1716                              <1>   _HEXDIG __hi, %2
  1717                              <1>   _HEXDIG __lo, %3
  1718                              <1>   %undef __v
  1719                              <1>   %undef __hi
  1720                              <1>   %undef __lo
  1721                              <1> %endmacro
  1722                              <1> ; -----------------------------------------------------------------------------
  1723                              <1> ; ERR_HANDLER <err1>[, <err2>, ...]
  1724                              <1> ; Baut Labels / Namen mit zwei Hex-Ziffern (00..FF), ohne 0x/h.
  1725                              <1> ; -----------------------------------------------------------------------------
  1726                              <1> %macro ERR_HANDLER 1-*
  1727                              <1> %rep %0
  1728                              <1>     ; Ausdruck auswerten (dezimal/hex ok) und auf 8 Bit begrenzen
  1729                              <1>     %assign __v %1
  1730                              <1>     %assign __v __v & 0FFh
  1731                              <1> 
  1732                              <1>     ; zwei Hex-Ziffern bilden
  1733                              <1>     %assign __hi (__v >> 4) & 0Fh
  1734                              <1>     %assign __lo  __v       & 0Fh
  1735                              <1>     _HEXDIG __hi, __H
  1736                              <1>     _HEXDIG __lo, __L
  1737                              <1> 
  1738                              <1> _cA_errh%+__H%+__L:
  1739                              <1>     PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <1>     mov cx, %1
  1741                              <1>     jmp _open_exit
  1742                              <1>     
  1743                              <1>     ; Aufräumen der temporären Namen dieser Iteration
  1744                              <1>     %undef __H
  1745                              <1>     %undef __L
  1746                              <1>     %undef __hi
  1747                              <1>     %undef __lo
  1748                              <1>     %undef __v
  1749                              <1>     
  1750                              <1>     %rotate 1
  1751                              <1> %endrep
  1752                              <1> %endmacro
  1753                              <1> ; -----------------------------------------------------------------------------
  1754                              <1> ; Für jeden Code: Label _cA_errhXX + Body
  1755                              <1> ;
  1756                              <1> ; ---------- Tabelle (Datenbereich) ----------
  1757                              <1> ; ERZEUGT: 
  1758                              <1> ;   _cA_error_dispatch:
  1759                              <1> ;       dw <code>, _cA_errhXX
  1760                              <1> ;       ...
  1761                              <1> ;       dw 00h, _cA_errhnd
  1762                              <1> ; -----------------------------------------------------------------------------
  1763                              <1> %macro ERR_ITEMS 1-*
  1764                              <1> _cA_error_dispatch:
  1765                              <1>   %rep %0
  1766                              <1>     _HEX2 %1, __H, __L
  1767                              <1>     dw %1, _cA_errh%+__H%+__L
  1768                              <1>     %undef __H
  1769                              <1>     %undef __L
  1770                              <1>     %rotate 1
  1771                              <1>   %endrep
  1772                              <1>   dw 00h, _cA_errhnd
  1773                              <1> %endmacro
  1774                              <1> 
  1775                              <1> ; -----------------------------------------------------------------------------
  1776                              <1> ; \brief check a character at the given position in given label string...
  1777                              <1> ; CMP_CHR <label>, <num-position>, <char to check>, <jump label if equal>
  1778                              <1> ; CMP_CHR argvn, 2, '3', is_three
  1779                              <1> ; -----------------------------------------------------------------------------
  1780                              <1> %macro CMP_CHR 4
  1781                              <1>     %ifstr %1
  1782                              <1>         section .data
  1783                              <1>         %%msg: db %1, 0
  1784                              <1>         section .text
  1785                              <1>         lea si, [PTR16(%%msg)]       ; text 0-terminated
  1786                              <1>     %else
  1787                              <1>     section .text
  1788                              <1>         %assign __count 0
  1789                              <1>         %assign __varg  0
  1790                              <1>         %assign __stop  0
  1791                              <1>         %rep MAX_ARGV
  1792                              <1>             %if __stop == 0
  1793                              <1>                 %assign __count (__count + 1)
  1794                              <1>                 %ifidni %1, ARGV_%+__count
  1795                              <1>                     %assign __varg __count
  1796                              <1>                     %assign __stop 1
  1797                              <1>                 %endif
  1798                              <1>             %endif
  1799                              <1>         %endrep
  1800                              <1>         %if __varg > 0
  1801                              <1>             mov  si, PTR16(_cA_cmd_buf)
  1802                              <1>             mov  bl, __varg
  1803                              <1>             call getCommandLine_Arg
  1804                              <1>         %else
  1805                              <1>             lea si, [PTR16(_cA_%1)]
  1806                              <1>         %endif
  1807                              <1>         %undef __stop
  1808                              <1>         %undef __varg
  1809                              <1>     %endif
  1810                              <1>         xor  cl, cl
  1811                              <1>         push si
  1812                              <1>     %%loop:
  1813                              <1>         lodsb
  1814                              <1>         inc cl
  1815                              <1>         cmp cl, %2
  1816                              <1>         je  %%next
  1817                              <1>         jmp %%loop
  1818                              <1>     %%next:
  1819                              <1>         pop si
  1820                              <1>         cmp al, %3
  1821                              <1>         je  %4
  1822                              <1> %endmacro
  1823                              <1> 
  1824                              <1> %macro SAVE 1
  1825                              <1>     %if __pre_stop == 0
  1826                              <1>         push %1
  1827                              <1>     %endif
  1828                              <1> %endmacro
  1829                              <1> %macro RESTORE 1
  1830                              <1>     %if __pre_stop == 0
  1831                              <1>         pop  %1
  1832                              <1>     %endif
  1833                              <1> %endmacro
  1834                              <1> 
  1835                              <1> ; -----------------------------------------------------------------------------
  1836                              <1> ; \brief LEA.w introduce a 16-Bit (word) LEA - load effective address.
  1837                              <1> ; \note  With this directive, you dont need anymore to give the IMNAGE BASE to
  1838                              <1> ;        the addressing mode. It use the %macro  PTR16(<label>).
  1839                              <1> ; \note  This macro is case-insensitive
  1840                              <1> ; \see   %macro PTR16
  1841                              <1> ; -----------------------------------------------------------------------------
  1842                              <1> %imacro lea.w 2
  1843                              <1> %if DOS_SHELL == 1      ; compilation for DOS 16-Bit ?
  1844                              <1>     %if __pre_stop == 0
  1845                              <1>         %undef __prefix     ; reset
  1846                              <1>         %undef __suffix     ; ...
  1847                              <1>         %ifidni %1, SI
  1848                              <1>             %define __prefix si
  1849                              <1>         %elifidni %1, DI
  1850                              <1>             %define __prefix di
  1851                              <1>         %else
  1852                              <1>             EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <1>         %endif
  1854                              <1>         %ifndef __prefix
  1855                              <1>             %assign __pre_stop 1
  1856                              <1>         %endif
  1857                              <1>         %if __pre_stop == 0
  1858                              <1>             %xdefine __s %str(%2)
  1859                              <1>             %xdefine __n %strlen(__s)
  1860                              <1>             %if __n >= 2
  1861                              <1>                 %xdefine __fst %substr(__s,0,1)
  1862                              <1>                 %xdefine __lst %substr(__s,__n,1)
  1863                              <1>                 %ifidn __fst, '['
  1864                              <1>                     %ifidn __lst, ']'
  1865                              <1>                         %xdefine __inner %substr(__s,2,__n-2)
  1866                              <1>                         %xdefine __tok   %tok(__inner)
  1867                              <1>                         %define __suffix [PTR16(__tok)]
  1868                              <1>                             lea __prefix, __suffix
  1869                              <1>                     %else
  1870                              <1>                         EMIT_ERROR 'closed bracket missing.'
  1871                              <1>                     %endif
  1872                              <1>                 %else
  1873                              <1>                     EMIT_ERROR 'missing brackets.'
  1874                              <1>                     ; todo
  1875                              <1>                 %endif
  1876                              <1>             %else
  1877                              <1>                 EMIT_ERROR 'directive too short.'
  1878                              <1>             %endif
  1879                              <1>         %endif
  1880                              <1>     %endif
  1881                              <1> %else
  1882                              <1>     EMIT_ERROR 'todo: windows'
  1883                              <1> %endif
  1884                              <1> %endmacro
  1885                              <1> 
  1886                              <1> ; -----------------------------------------------------------------------------
  1887                              <1> ; \brief MOV.w introduce a 16-Bit (word) MOV.
  1888                              <1> ; \note  With this directive, you dont need anymore to give the IMNAGE BASE to
  1889                              <1> ;        the addressing mode. It use the %macro  PTR16(<label>).
  1890                              <1> ; \note  This macro is case-insensitive
  1891                              <1> ; \see   %macro PTR16
  1892                              <1> ; -----------------------------------------------------------------------------
  1893                              <1> %imacro mov.w 2
  1894                              <1> %if DOS_SHELL == 1
  1895                              <1>     %if __pre_stop == 0
  1896                              <1>         %ifidni %1, BL
  1897                              <1>             %ifid %2
  1898                              <1>                 mov bl, PTR16(_cA_%2)
  1899                              <1>             %endif
  1900                              <1>         %endif
  1901                              <1>     %endif
  1902                              <1> %else
  1903                              <1>     %if __pre_stop == 0
  1904                              <1>         EMIT_ERROR 'todo: windows'
  1905                              <1>     %endif
  1906                              <1> %endif
  1907                              <1> %endmacro
  1908                              <1> 
  1909                              <1> ; -----------------------------------------------------------------------------
  1910                              <1> ; \brief STR_CMP - compare 2 string's ...
  1911                              <1> ; \note  Examples:
  1912                              <1> ;            STR_CMP ARGV_1, ARGV_2, is_version_2
  1913                              <1> ;            STR_CMP ARGV_1, 'abcd', is_version_3
  1914                              <1> ;            STR_CMP ARGV_2, '1234', is_version_4
  1915                              <1> ;            STR_CMP "abcd", "abcd", is_version_5
  1916                              <1> ; -----------------------------------------------------------------------------
  1917                              <1> %macro STR_STR_HELPER 1
  1918                              <1>     %if __pre_stop == 0
  1919                              <1>         section .text
  1920                              <1>         call string_compare
  1921                              <1>         cmp  al, 0
  1922                              <1>         jne  %%jum4
  1923                              <1>         call %1
  1924                              <1>         %%jum4:
  1925                              <1>     %endif
  1926                              <1> %endmacro
  1927                              <1> %macro STR_ARG_HELPER 1-2
  1928                              <1>     %if __pre_stop == 0
  1929                              <1>         section  .text
  1930                              <1>         SAVE si
  1931                              <1>         %if %0 == 2
  1932                              <1>             lea.w si, [_cA_%1]
  1933                              <1>             mov  bl, %2
  1934                              <1>         %elif %0 == 1
  1935                              <1>             lea.w si, [_cA_cmd_buf]
  1936                              <1>             mov  bl, %1
  1937                              <1>         %else
  1938                              <1>             EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <1>             %assign __pre_stop 1
  1940                              <1>         %endif
  1941                              <1>         call getCommandLine_Arg
  1942                              <1>         mov  di, si
  1943                              <1>         RESTORE  si
  1944                              <1>     %endif
  1945                              <1> %endmacro
  1946                              <1> %macro STR_CMP 3
  1947                              <1>     %if __pre_stop == 0
  1948                              <1>         %ifnum %1                           ; argument 1 is a number ?
  1949                              <1>             EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <1>             %assign __pre_stop 1
  1951                              <1>         %elifstr %1                         ; argument 1 is a string ?
  1952                              <1>             section .data
  1953                              <1>             %%part1: db %1, 0
  1954                              <1>             section .text
  1955                              <1>             lea.w si, [%%part1]
  1956                              <1>             %ifid %2
  1957                              <1>                 GET_VARGS %2, __vargs
  1958                              <1>                 %if __vargs > 0
  1959                              <1>                     STR_ARG_HELPER __vargs
  1960                              <1>                     STR_STR_HELPER %3
  1961                              <1>                 %endif
  1962                              <1>             %elifstr %2                     ; argument 2 is a string ?
  1963                              <1>                 section .data
  1964                              <1>                 %%part2: db %1, 0
  1965                              <1>                 section .text
  1966                              <1>                 LEA.w  DI, [%%part2]        ; dst
  1967                              <1>                 STR_STR_HELPER %3
  1968                              <1>             %elifnum %2                     ; argument 2 is a number ?
  1969                              <1>                 EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <1>                 %assign __pre_stop 1
  1971                              <1>             %else
  1972                              <1>                 EMIT_ERROR 'todo'
  1973                              <1>                 %assign __pre_stop 1
  1974                              <1>             %endif
  1975                              <1>         %elifid %1
  1976                              <1>             %assign __varg1 0
  1977                              <1>             %assign __varg2 0
  1978                              <1>             GET_VARGS %1, _varg1
  1979                              <1>             %ifid %2
  1980                              <1>                 GET_VARGS %2, _varg2
  1981                              <1>                 %if __varg1 > 0
  1982                              <1>                     %if __varg2 > 0
  1983                              <1>                         STR_ARG_HELPER __varg1
  1984                              <1>                         STR_ARG_HELPER __varg2
  1985                              <1>                         STR_STR_HELPER %3
  1986                              <1>                     %else
  1987                              <1>                         LEA.w DI, [_cA_%2]
  1988                              <1>                     %endif
  1989                              <1>                 %else
  1990                              <1>                     LEA.w SI, [_cA_%1]
  1991                              <1>                 %endif
  1992                              <1>             %elifstr %2                     ; argument 2 is a string ?
  1993                              <1>                 section .data
  1994                              <1>                 %%part3: db %2, 0
  1995                              <1>                 section .text
  1996                              <1>                 LEA.w si, [%%part3]
  1997                              <1>                 STR_ARG_HELPER __varg1
  1998                              <1>                 STR_STR_HELPER %3
  1999                              <1>             %elifnum %2                     ; argument 2 is a number ?
  2000                              <1>                 EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <1>             %else
  2002                              <1>                 EMIT_ERROR 'todo'
  2003                              <1>             %endif
  2004                              <1>         %endif
  2005                              <1>         %undef __stop
  2006                              <1>         %undef __varg
  2007                              <1>     %endif
  2008                              <1> %endmacro
    11                                  
    12                                  kernel_start:
    13                                  section .text
    14                                  %include 'code16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  code16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> %define DOS_SHELL 1
     9                              <1> %define MAX_ARGS  7
    10                              <1> bits 16
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief  Create/Append field into dBASE III/IV DBF by INT 21h
    13                              <1> ; \note   Build:  nasm -f bin dbfmake.asm -o DBFMAKE.COM
    14                              <1> ;         Run:    DBFMAKE <type> <cmd> <fieldtype> <feldname> <feldlength>
    15                              <1> ;         Example:
    16                              <1> ;             DBFMAKE 3 CREATE C NAME 20
    17                              <1> ;             DBFMAKE 4 APPEND I AGE 3
    18                              <1> ;
    19                              <1> ; \note   Type: 3 (dBASE III), 4 (dBASE IV)
    20                              <1> ; \note   Cmd:  CREATE | APPEND
    21                              <1> ; \note   Fieldtype: C,I,F,B,D,T  (T only for type 4)
    22                              <1> ; \note   Fieldname: max 10 chars (dBASE-limit, 11. Byte = 0)
    23                              <1> ; \note   Fiedlength: decimal (e.g.. 20)
    24                              <1> ; -----------------------------------------------------------------------------
    25                              <1> code16_start:
    26                              <1>     INIT_COMMAND_LINE
  1604                              <2> %if DOS_SHELL == 1
  1605 00000000 E8600D              <2>  call dos_get_command_line
  1606                              <2> %else
  1607                              <2>  EMIT_ERROR 'todo: windows'
  1608                              <2> %endif
    27                              <1>     INIT_CONSOLE
  1615                              <2> %if DOS_SHELL == 1
  1616 00000003 E83B0D              <2>  call dos_init_console
  1617                              <2>  SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 00000006 E8920E              <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
  1618                              <2> %else
  1619                              <2>  call init_app
  1620                              <2>  call init_console
  1621                              <2> %endif
    28                              <1> 
    29                              <1>     SET_CURSOR 1,2
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 00000009 B201                <2>  mov dl, %1
  1301 0000000B B602                <2>  mov dh, %2
  1302 0000000D E8BD09              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
    30                              <1>     PUTS_COLOR "123", 0x0F
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 00000000 31323300            <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356 00000010 31DB                <2>  xor bx, bx
  1357 00000012 B30F                <2>  mov bl, %2
  1358 00000014 BE(0001)            <2>  mov si, PTR16(%%msg)
  1359 00000017 E81A0E              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
    31                              <1>     
    32                              <1>     STR_CMP ARGV_1, ARGV_2, is_version_2
  1947                              <2>  %if __pre_stop == 0
  1948                              <2>  %ifnum %1
  1949                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <2>  %assign __pre_stop 1
  1951                              <2>  %elifstr %1
  1952                              <2>  section .data
  1953                              <2>  %%part1: db %1, 0
  1954                              <2>  section .text
  1955                              <2>  lea.w si, [%%part1]
  1956                              <2>  %ifid %2
  1957                              <2>  GET_VARGS %2, __vargs
  1958                              <2>  %if __vargs > 0
  1959                              <2>  STR_ARG_HELPER __vargs
  1960                              <2>  STR_STR_HELPER %3
  1961                              <2>  %endif
  1962                              <2>  %elifstr %2
  1963                              <2>  section .data
  1964                              <2>  %%part2: db %1, 0
  1965                              <2>  section .text
  1966                              <2>  LEA.w DI, [%%part2]
  1967                              <2>  STR_STR_HELPER %3
  1968                              <2>  %elifnum %2
  1969                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <2>  %assign __pre_stop 1
  1971                              <2>  %else
  1972                              <2>  EMIT_ERROR 'todo'
  1973                              <2>  %assign __pre_stop 1
  1974                              <2>  %endif
  1975                              <2>  %elifid %1
  1976                              <2>  %assign __varg1 0
  1977                              <2>  %assign __varg2 0
  1978                              <2>  GET_VARGS %1, _varg1
    86                              <3>  %if __pre_stop == 0
    87                              <3>  %assign __count 0
    88                              <3>  %assign __vargs 0
    89                              <3>  %assign __stop 0
    90                              <3>  %rep MAX_ARGV
    91                              <3>  %if __stop == 0
    92                              <3>  %assign __count (__count + 1)
    93                              <3>  %ifidni %1, ARGV_%+__count
    94                              <3>  %assign __vargs __count
    95                              <3>  %assign __stop 1
    96                              <3>  %assign _%2 __count
    97                              <3>  %endif
    98                              <3>  %endif
    99                              <3>  %endrep
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
   100                              <3>  %undef __count
   101                              <3>  %undef __stop
   102                              <3>  %endif
  1979                              <2>  %ifid %2
  1980                              <2>  GET_VARGS %2, _varg2
    86                              <3>  %if __pre_stop == 0
    87                              <3>  %assign __count 0
    88                              <3>  %assign __vargs 0
    89                              <3>  %assign __stop 0
    90                              <3>  %rep MAX_ARGV
    91                              <3>  %if __stop == 0
    92                              <3>  %assign __count (__count + 1)
    93                              <3>  %ifidni %1, ARGV_%+__count
    94                              <3>  %assign __vargs __count
    95                              <3>  %assign __stop 1
    96                              <3>  %assign _%2 __count
    97                              <3>  %endif
    98                              <3>  %endif
    99                              <3>  %endrep
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
   100                              <3>  %undef __count
   101                              <3>  %undef __stop
   102                              <3>  %endif
  1981                              <2>  %if __varg1 > 0
  1982                              <2>  %if __varg2 > 0
  1983                              <2>  STR_ARG_HELPER __varg1
  1928                              <3>  %if __pre_stop == 0
  1929                              <3>  section .text
  1930                              <3>  SAVE si
  1825                              <4>  %if __pre_stop == 0
  1826 0000001A 56                  <4>  push %1
  1827                              <4>  %endif
  1931                              <3>  %if %0 == 2
  1932                              <3>  lea.w si, [_cA_%1]
  1933                              <3>  mov bl, %2
  1934                              <3>  %elif %0 == 1
  1935                              <3>  lea.w si, [_cA_cmd_buf]
  1843                              <4> %if DOS_SHELL == 1
  1844                              <4>  %if __pre_stop == 0
  1845                              <4>  %undef __prefix
  1846                              <4>  %undef __suffix
  1847                              <4>  %ifidni %1, SI
  1848                              <4>  %define __prefix si
  1849                              <4>  %elifidni %1, DI
  1850                              <4>  %define __prefix di
  1851                              <4>  %else
  1852                              <4>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <4>  %endif
  1854                              <4>  %ifndef __prefix
  1855                              <4>  %assign __pre_stop 1
  1856                              <4>  %endif
  1857                              <4>  %if __pre_stop == 0
  1858                              <4>  %xdefine __s %str(%2)
  1859                              <4>  %xdefine __n %strlen(__s)
  1860                              <4>  %if __n >= 2
  1861                              <4>  %xdefine __fst %substr(__s,0,1)
  1862                              <4>  %xdefine __lst %substr(__s,__n,1)
  1863                              <4>  %ifidn __fst, '['
  1864                              <4>  %ifidn __lst, ']'
  1865                              <4>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <4>  %xdefine __tok %tok(__inner)
  1867                              <4>  %define __suffix [PTR16(__tok)]
  1868 0000001B 8D36(C204)          <4>  lea __prefix, __suffix
  1869                              <4>  %else
  1870                              <4>  EMIT_ERROR 'closed bracket missing.'
  1871                              <4>  %endif
  1872                              <4>  %else
  1873                              <4>  EMIT_ERROR 'missing brackets.'
  1874                              <4> 
  1875                              <4>  %endif
  1876                              <4>  %else
  1877                              <4>  EMIT_ERROR 'directive too short.'
  1878                              <4>  %endif
  1879                              <4>  %endif
  1880                              <4>  %endif
  1881                              <4> %else
  1882                              <4>  EMIT_ERROR 'todo: windows'
  1883                              <4> %endif
  1936 0000001F B301                <3>  mov bl, %1
  1937                              <3>  %else
  1938                              <3>  EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <3>  %assign __pre_stop 1
  1940                              <3>  %endif
  1941 00000021 E85309              <3>  call getCommandLine_Arg
  1942 00000024 89F7                <3>  mov di, si
  1943                              <3>  RESTORE si
  1830                              <4>  %if __pre_stop == 0
  1831 00000026 5E                  <4>  pop %1
  1832                              <4>  %endif
  1944                              <3>  %endif
  1984                              <2>  STR_ARG_HELPER __varg2
  1928                              <3>  %if __pre_stop == 0
  1929                              <3>  section .text
  1930                              <3>  SAVE si
  1825                              <4>  %if __pre_stop == 0
  1826 00000027 56                  <4>  push %1
  1827                              <4>  %endif
  1931                              <3>  %if %0 == 2
  1932                              <3>  lea.w si, [_cA_%1]
  1933                              <3>  mov bl, %2
  1934                              <3>  %elif %0 == 1
  1935                              <3>  lea.w si, [_cA_cmd_buf]
  1843                              <4> %if DOS_SHELL == 1
  1844                              <4>  %if __pre_stop == 0
  1845                              <4>  %undef __prefix
  1846                              <4>  %undef __suffix
  1847                              <4>  %ifidni %1, SI
  1848                              <4>  %define __prefix si
  1849                              <4>  %elifidni %1, DI
  1850                              <4>  %define __prefix di
  1851                              <4>  %else
  1852                              <4>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <4>  %endif
  1854                              <4>  %ifndef __prefix
  1855                              <4>  %assign __pre_stop 1
  1856                              <4>  %endif
  1857                              <4>  %if __pre_stop == 0
  1858                              <4>  %xdefine __s %str(%2)
  1859                              <4>  %xdefine __n %strlen(__s)
  1860                              <4>  %if __n >= 2
  1861                              <4>  %xdefine __fst %substr(__s,0,1)
  1862                              <4>  %xdefine __lst %substr(__s,__n,1)
  1863                              <4>  %ifidn __fst, '['
  1864                              <4>  %ifidn __lst, ']'
  1865                              <4>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <4>  %xdefine __tok %tok(__inner)
  1867                              <4>  %define __suffix [PTR16(__tok)]
  1868 00000028 8D36(C204)          <4>  lea __prefix, __suffix
  1869                              <4>  %else
  1870                              <4>  EMIT_ERROR 'closed bracket missing.'
  1871                              <4>  %endif
  1872                              <4>  %else
  1873                              <4>  EMIT_ERROR 'missing brackets.'
  1874                              <4> 
  1875                              <4>  %endif
  1876                              <4>  %else
  1877                              <4>  EMIT_ERROR 'directive too short.'
  1878                              <4>  %endif
  1879                              <4>  %endif
  1880                              <4>  %endif
  1881                              <4> %else
  1882                              <4>  EMIT_ERROR 'todo: windows'
  1883                              <4> %endif
  1936 0000002C B302                <3>  mov bl, %1
  1937                              <3>  %else
  1938                              <3>  EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <3>  %assign __pre_stop 1
  1940                              <3>  %endif
  1941 0000002E E84609              <3>  call getCommandLine_Arg
  1942 00000031 89F7                <3>  mov di, si
  1943                              <3>  RESTORE si
  1830                              <4>  %if __pre_stop == 0
  1831 00000033 5E                  <4>  pop %1
  1832                              <4>  %endif
  1944                              <3>  %endif
  1985                              <2>  STR_STR_HELPER %3
  1918                              <3>  %if __pre_stop == 0
  1919                              <3>  section .text
  1920 00000034 E8930E              <3>  call string_compare
  1921 00000037 3C00                <3>  cmp al, 0
  1922 00000039 7503                <3>  jne %%jum4
  1923 0000003B E87600              <3>  call %1
  1924                              <3>  %%jum4:
  1925                              <3>  %endif
  1986                              <2>  %else
  1987                              <2>  LEA.w DI, [_cA_%2]
  1988                              <2>  %endif
  1989                              <2>  %else
  1990                              <2>  LEA.w SI, [_cA_%1]
  1991                              <2>  %endif
  1992                              <2>  %elifstr %2
  1993                              <2>  section .data
  1994                              <2>  %%part3: db %2, 0
  1995                              <2>  section .text
  1996                              <2>  LEA.w si, [%%part3]
  1997                              <2>  STR_ARG_HELPER __varg1
  1998                              <2>  STR_STR_HELPER %3
  1999                              <2>  %elifnum %2
  2000                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <2>  %else
  2002                              <2>  EMIT_ERROR 'todo'
  2003                              <2>  %endif
  2004                              <2>  %endif
  2005                              <2>  %undef __stop
  2006                              <2>  %undef __varg
  2007                              <2>  %endif
    33                              <1>     STR_CMP ARGV_1, 'abcd', is_version_3
  1947                              <2>  %if __pre_stop == 0
  1948                              <2>  %ifnum %1
  1949                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <2>  %assign __pre_stop 1
  1951                              <2>  %elifstr %1
  1952                              <2>  section .data
  1953                              <2>  %%part1: db %1, 0
  1954                              <2>  section .text
  1955                              <2>  lea.w si, [%%part1]
  1956                              <2>  %ifid %2
  1957                              <2>  GET_VARGS %2, __vargs
  1958                              <2>  %if __vargs > 0
  1959                              <2>  STR_ARG_HELPER __vargs
  1960                              <2>  STR_STR_HELPER %3
  1961                              <2>  %endif
  1962                              <2>  %elifstr %2
  1963                              <2>  section .data
  1964                              <2>  %%part2: db %1, 0
  1965                              <2>  section .text
  1966                              <2>  LEA.w DI, [%%part2]
  1967                              <2>  STR_STR_HELPER %3
  1968                              <2>  %elifnum %2
  1969                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <2>  %assign __pre_stop 1
  1971                              <2>  %else
  1972                              <2>  EMIT_ERROR 'todo'
  1973                              <2>  %assign __pre_stop 1
  1974                              <2>  %endif
  1975                              <2>  %elifid %1
  1976                              <2>  %assign __varg1 0
  1977                              <2>  %assign __varg2 0
  1978                              <2>  GET_VARGS %1, _varg1
    86                              <3>  %if __pre_stop == 0
    87                              <3>  %assign __count 0
    88                              <3>  %assign __vargs 0
    89                              <3>  %assign __stop 0
    90                              <3>  %rep MAX_ARGV
    91                              <3>  %if __stop == 0
    92                              <3>  %assign __count (__count + 1)
    93                              <3>  %ifidni %1, ARGV_%+__count
    94                              <3>  %assign __vargs __count
    95                              <3>  %assign __stop 1
    96                              <3>  %assign _%2 __count
    97                              <3>  %endif
    98                              <3>  %endif
    99                              <3>  %endrep
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
   100                              <3>  %undef __count
   101                              <3>  %undef __stop
   102                              <3>  %endif
  1979                              <2>  %ifid %2
  1980                              <2>  GET_VARGS %2, _varg2
  1981                              <2>  %if __varg1 > 0
  1982                              <2>  %if __varg2 > 0
  1983                              <2>  STR_ARG_HELPER __varg1
  1984                              <2>  STR_ARG_HELPER __varg2
  1985                              <2>  STR_STR_HELPER %3
  1986                              <2>  %else
  1987                              <2>  LEA.w DI, [_cA_%2]
  1988                              <2>  %endif
  1989                              <2>  %else
  1990                              <2>  LEA.w SI, [_cA_%1]
  1991                              <2>  %endif
  1992                              <2>  %elifstr %2
  1993                              <2>  section .data
  1994 00000004 6162636400          <2>  %%part3: db %2, 0
  1995                              <2>  section .text
  1996                              <2>  LEA.w si, [%%part3]
  1843                              <3> %if DOS_SHELL == 1
  1844                              <3>  %if __pre_stop == 0
  1845                              <3>  %undef __prefix
  1846                              <3>  %undef __suffix
  1847                              <3>  %ifidni %1, SI
  1848                              <3>  %define __prefix si
  1849                              <3>  %elifidni %1, DI
  1850                              <3>  %define __prefix di
  1851                              <3>  %else
  1852                              <3>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <3>  %endif
  1854                              <3>  %ifndef __prefix
  1855                              <3>  %assign __pre_stop 1
  1856                              <3>  %endif
  1857                              <3>  %if __pre_stop == 0
  1858                              <3>  %xdefine __s %str(%2)
  1859                              <3>  %xdefine __n %strlen(__s)
  1860                              <3>  %if __n >= 2
  1861                              <3>  %xdefine __fst %substr(__s,0,1)
  1862                              <3>  %xdefine __lst %substr(__s,__n,1)
  1863                              <3>  %ifidn __fst, '['
  1864                              <3>  %ifidn __lst, ']'
  1865                              <3>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <3>  %xdefine __tok %tok(__inner)
  1867                              <3>  %define __suffix [PTR16(__tok)]
  1868 0000003E 8D36(0401)          <3>  lea __prefix, __suffix
  1869                              <3>  %else
  1870                              <3>  EMIT_ERROR 'closed bracket missing.'
  1871                              <3>  %endif
  1872                              <3>  %else
  1873                              <3>  EMIT_ERROR 'missing brackets.'
  1874                              <3> 
  1875                              <3>  %endif
  1876                              <3>  %else
  1877                              <3>  EMIT_ERROR 'directive too short.'
  1878                              <3>  %endif
  1879                              <3>  %endif
  1880                              <3>  %endif
  1881                              <3> %else
  1882                              <3>  EMIT_ERROR 'todo: windows'
  1883                              <3> %endif
  1997                              <2>  STR_ARG_HELPER __varg1
  1928                              <3>  %if __pre_stop == 0
  1929                              <3>  section .text
  1930                              <3>  SAVE si
  1825                              <4>  %if __pre_stop == 0
  1826 00000042 56                  <4>  push %1
  1827                              <4>  %endif
  1931                              <3>  %if %0 == 2
  1932                              <3>  lea.w si, [_cA_%1]
  1933                              <3>  mov bl, %2
  1934                              <3>  %elif %0 == 1
  1935                              <3>  lea.w si, [_cA_cmd_buf]
  1843                              <4> %if DOS_SHELL == 1
  1844                              <4>  %if __pre_stop == 0
  1845                              <4>  %undef __prefix
  1846                              <4>  %undef __suffix
  1847                              <4>  %ifidni %1, SI
  1848                              <4>  %define __prefix si
  1849                              <4>  %elifidni %1, DI
  1850                              <4>  %define __prefix di
  1851                              <4>  %else
  1852                              <4>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <4>  %endif
  1854                              <4>  %ifndef __prefix
  1855                              <4>  %assign __pre_stop 1
  1856                              <4>  %endif
  1857                              <4>  %if __pre_stop == 0
  1858                              <4>  %xdefine __s %str(%2)
  1859                              <4>  %xdefine __n %strlen(__s)
  1860                              <4>  %if __n >= 2
  1861                              <4>  %xdefine __fst %substr(__s,0,1)
  1862                              <4>  %xdefine __lst %substr(__s,__n,1)
  1863                              <4>  %ifidn __fst, '['
  1864                              <4>  %ifidn __lst, ']'
  1865                              <4>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <4>  %xdefine __tok %tok(__inner)
  1867                              <4>  %define __suffix [PTR16(__tok)]
  1868 00000043 8D36(C204)          <4>  lea __prefix, __suffix
  1869                              <4>  %else
  1870                              <4>  EMIT_ERROR 'closed bracket missing.'
  1871                              <4>  %endif
  1872                              <4>  %else
  1873                              <4>  EMIT_ERROR 'missing brackets.'
  1874                              <4> 
  1875                              <4>  %endif
  1876                              <4>  %else
  1877                              <4>  EMIT_ERROR 'directive too short.'
  1878                              <4>  %endif
  1879                              <4>  %endif
  1880                              <4>  %endif
  1881                              <4> %else
  1882                              <4>  EMIT_ERROR 'todo: windows'
  1883                              <4> %endif
  1936 00000047 B301                <3>  mov bl, %1
  1937                              <3>  %else
  1938                              <3>  EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <3>  %assign __pre_stop 1
  1940                              <3>  %endif
  1941 00000049 E82B09              <3>  call getCommandLine_Arg
  1942 0000004C 89F7                <3>  mov di, si
  1943                              <3>  RESTORE si
  1830                              <4>  %if __pre_stop == 0
  1831 0000004E 5E                  <4>  pop %1
  1832                              <4>  %endif
  1944                              <3>  %endif
  1998                              <2>  STR_STR_HELPER %3
  1918                              <3>  %if __pre_stop == 0
  1919                              <3>  section .text
  1920 0000004F E8780E              <3>  call string_compare
  1921 00000052 3C00                <3>  cmp al, 0
  1922 00000054 7503                <3>  jne %%jum4
  1923 00000056 E86D00              <3>  call %1
  1924                              <3>  %%jum4:
  1925                              <3>  %endif
  1999                              <2>  %elifnum %2
  2000                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <2>  %else
  2002                              <2>  EMIT_ERROR 'todo'
  2003                              <2>  %endif
  2004                              <2>  %endif
  2005                              <2>  %undef __stop
  2006                              <2>  %undef __varg
  2007                              <2>  %endif
    34                              <1>     STR_CMP ARGV_2, '1234', is_version_4
  1947                              <2>  %if __pre_stop == 0
  1948                              <2>  %ifnum %1
  1949                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <2>  %assign __pre_stop 1
  1951                              <2>  %elifstr %1
  1952                              <2>  section .data
  1953                              <2>  %%part1: db %1, 0
  1954                              <2>  section .text
  1955                              <2>  lea.w si, [%%part1]
  1956                              <2>  %ifid %2
  1957                              <2>  GET_VARGS %2, __vargs
  1958                              <2>  %if __vargs > 0
  1959                              <2>  STR_ARG_HELPER __vargs
  1960                              <2>  STR_STR_HELPER %3
  1961                              <2>  %endif
  1962                              <2>  %elifstr %2
  1963                              <2>  section .data
  1964                              <2>  %%part2: db %1, 0
  1965                              <2>  section .text
  1966                              <2>  LEA.w DI, [%%part2]
  1967                              <2>  STR_STR_HELPER %3
  1968                              <2>  %elifnum %2
  1969                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <2>  %assign __pre_stop 1
  1971                              <2>  %else
  1972                              <2>  EMIT_ERROR 'todo'
  1973                              <2>  %assign __pre_stop 1
  1974                              <2>  %endif
  1975                              <2>  %elifid %1
  1976                              <2>  %assign __varg1 0
  1977                              <2>  %assign __varg2 0
  1978                              <2>  GET_VARGS %1, _varg1
    86                              <3>  %if __pre_stop == 0
    87                              <3>  %assign __count 0
    88                              <3>  %assign __vargs 0
    89                              <3>  %assign __stop 0
    90                              <3>  %rep MAX_ARGV
    91                              <3>  %if __stop == 0
    92                              <3>  %assign __count (__count + 1)
    93                              <3>  %ifidni %1, ARGV_%+__count
    94                              <3>  %assign __vargs __count
    95                              <3>  %assign __stop 1
    96                              <3>  %assign _%2 __count
    97                              <3>  %endif
    98                              <3>  %endif
    99                              <3>  %endrep
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
    91                              <4>  %if __stop == 0
    92                              <4>  %assign __count (__count + 1)
    93                              <4>  %ifidni %1, ARGV_%+__count
    94                              <4>  %assign __vargs __count
    95                              <4>  %assign __stop 1
    96                              <4>  %assign _%2 __count
    97                              <4>  %endif
    98                              <4>  %endif
   100                              <3>  %undef __count
   101                              <3>  %undef __stop
   102                              <3>  %endif
  1979                              <2>  %ifid %2
  1980                              <2>  GET_VARGS %2, _varg2
  1981                              <2>  %if __varg1 > 0
  1982                              <2>  %if __varg2 > 0
  1983                              <2>  STR_ARG_HELPER __varg1
  1984                              <2>  STR_ARG_HELPER __varg2
  1985                              <2>  STR_STR_HELPER %3
  1986                              <2>  %else
  1987                              <2>  LEA.w DI, [_cA_%2]
  1988                              <2>  %endif
  1989                              <2>  %else
  1990                              <2>  LEA.w SI, [_cA_%1]
  1991                              <2>  %endif
  1992                              <2>  %elifstr %2
  1993                              <2>  section .data
  1994 00000009 3132333400          <2>  %%part3: db %2, 0
  1995                              <2>  section .text
  1996                              <2>  LEA.w si, [%%part3]
  1843                              <3> %if DOS_SHELL == 1
  1844                              <3>  %if __pre_stop == 0
  1845                              <3>  %undef __prefix
  1846                              <3>  %undef __suffix
  1847                              <3>  %ifidni %1, SI
  1848                              <3>  %define __prefix si
  1849                              <3>  %elifidni %1, DI
  1850                              <3>  %define __prefix di
  1851                              <3>  %else
  1852                              <3>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <3>  %endif
  1854                              <3>  %ifndef __prefix
  1855                              <3>  %assign __pre_stop 1
  1856                              <3>  %endif
  1857                              <3>  %if __pre_stop == 0
  1858                              <3>  %xdefine __s %str(%2)
  1859                              <3>  %xdefine __n %strlen(__s)
  1860                              <3>  %if __n >= 2
  1861                              <3>  %xdefine __fst %substr(__s,0,1)
  1862                              <3>  %xdefine __lst %substr(__s,__n,1)
  1863                              <3>  %ifidn __fst, '['
  1864                              <3>  %ifidn __lst, ']'
  1865                              <3>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <3>  %xdefine __tok %tok(__inner)
  1867                              <3>  %define __suffix [PTR16(__tok)]
  1868 00000059 8D36(0901)          <3>  lea __prefix, __suffix
  1869                              <3>  %else
  1870                              <3>  EMIT_ERROR 'closed bracket missing.'
  1871                              <3>  %endif
  1872                              <3>  %else
  1873                              <3>  EMIT_ERROR 'missing brackets.'
  1874                              <3> 
  1875                              <3>  %endif
  1876                              <3>  %else
  1877                              <3>  EMIT_ERROR 'directive too short.'
  1878                              <3>  %endif
  1879                              <3>  %endif
  1880                              <3>  %endif
  1881                              <3> %else
  1882                              <3>  EMIT_ERROR 'todo: windows'
  1883                              <3> %endif
  1997                              <2>  STR_ARG_HELPER __varg1
  1928                              <3>  %if __pre_stop == 0
  1929                              <3>  section .text
  1930                              <3>  SAVE si
  1825                              <4>  %if __pre_stop == 0
  1826 0000005D 56                  <4>  push %1
  1827                              <4>  %endif
  1931                              <3>  %if %0 == 2
  1932                              <3>  lea.w si, [_cA_%1]
  1933                              <3>  mov bl, %2
  1934                              <3>  %elif %0 == 1
  1935                              <3>  lea.w si, [_cA_cmd_buf]
  1843                              <4> %if DOS_SHELL == 1
  1844                              <4>  %if __pre_stop == 0
  1845                              <4>  %undef __prefix
  1846                              <4>  %undef __suffix
  1847                              <4>  %ifidni %1, SI
  1848                              <4>  %define __prefix si
  1849                              <4>  %elifidni %1, DI
  1850                              <4>  %define __prefix di
  1851                              <4>  %else
  1852                              <4>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <4>  %endif
  1854                              <4>  %ifndef __prefix
  1855                              <4>  %assign __pre_stop 1
  1856                              <4>  %endif
  1857                              <4>  %if __pre_stop == 0
  1858                              <4>  %xdefine __s %str(%2)
  1859                              <4>  %xdefine __n %strlen(__s)
  1860                              <4>  %if __n >= 2
  1861                              <4>  %xdefine __fst %substr(__s,0,1)
  1862                              <4>  %xdefine __lst %substr(__s,__n,1)
  1863                              <4>  %ifidn __fst, '['
  1864                              <4>  %ifidn __lst, ']'
  1865                              <4>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <4>  %xdefine __tok %tok(__inner)
  1867                              <4>  %define __suffix [PTR16(__tok)]
  1868 0000005E 8D36(C204)          <4>  lea __prefix, __suffix
  1869                              <4>  %else
  1870                              <4>  EMIT_ERROR 'closed bracket missing.'
  1871                              <4>  %endif
  1872                              <4>  %else
  1873                              <4>  EMIT_ERROR 'missing brackets.'
  1874                              <4> 
  1875                              <4>  %endif
  1876                              <4>  %else
  1877                              <4>  EMIT_ERROR 'directive too short.'
  1878                              <4>  %endif
  1879                              <4>  %endif
  1880                              <4>  %endif
  1881                              <4> %else
  1882                              <4>  EMIT_ERROR 'todo: windows'
  1883                              <4> %endif
  1936 00000062 B302                <3>  mov bl, %1
  1937                              <3>  %else
  1938                              <3>  EMIT_ERROR 'this macro excepted 2 arguments.'
  1939                              <3>  %assign __pre_stop 1
  1940                              <3>  %endif
  1941 00000064 E81009              <3>  call getCommandLine_Arg
  1942 00000067 89F7                <3>  mov di, si
  1943                              <3>  RESTORE si
  1830                              <4>  %if __pre_stop == 0
  1831 00000069 5E                  <4>  pop %1
  1832                              <4>  %endif
  1944                              <3>  %endif
  1998                              <2>  STR_STR_HELPER %3
  1918                              <3>  %if __pre_stop == 0
  1919                              <3>  section .text
  1920 0000006A E85D0E              <3>  call string_compare
  1921 0000006D 3C00                <3>  cmp al, 0
  1922 0000006F 7503                <3>  jne %%jum4
  1923 00000071 E86400              <3>  call %1
  1924                              <3>  %%jum4:
  1925                              <3>  %endif
  1999                              <2>  %elifnum %2
  2000                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <2>  %else
  2002                              <2>  EMIT_ERROR 'todo'
  2003                              <2>  %endif
  2004                              <2>  %endif
  2005                              <2>  %undef __stop
  2006                              <2>  %undef __varg
  2007                              <2>  %endif
    35                              <1>     STR_CMP "abcd", "abcd", is_version_5
  1947                              <2>  %if __pre_stop == 0
  1948                              <2>  %ifnum %1
  1949                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1950                              <2>  %assign __pre_stop 1
  1951                              <2>  %elifstr %1
  1952                              <2>  section .data
  1953 0000000E 6162636400          <2>  %%part1: db %1, 0
  1954                              <2>  section .text
  1955                              <2>  lea.w si, [%%part1]
  1843                              <3> %if DOS_SHELL == 1
  1844                              <3>  %if __pre_stop == 0
  1845                              <3>  %undef __prefix
  1846                              <3>  %undef __suffix
  1847                              <3>  %ifidni %1, SI
  1848                              <3>  %define __prefix si
  1849                              <3>  %elifidni %1, DI
  1850                              <3>  %define __prefix di
  1851                              <3>  %else
  1852                              <3>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <3>  %endif
  1854                              <3>  %ifndef __prefix
  1855                              <3>  %assign __pre_stop 1
  1856                              <3>  %endif
  1857                              <3>  %if __pre_stop == 0
  1858                              <3>  %xdefine __s %str(%2)
  1859                              <3>  %xdefine __n %strlen(__s)
  1860                              <3>  %if __n >= 2
  1861                              <3>  %xdefine __fst %substr(__s,0,1)
  1862                              <3>  %xdefine __lst %substr(__s,__n,1)
  1863                              <3>  %ifidn __fst, '['
  1864                              <3>  %ifidn __lst, ']'
  1865                              <3>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <3>  %xdefine __tok %tok(__inner)
  1867                              <3>  %define __suffix [PTR16(__tok)]
  1868 00000074 8D36(0E01)          <3>  lea __prefix, __suffix
  1869                              <3>  %else
  1870                              <3>  EMIT_ERROR 'closed bracket missing.'
  1871                              <3>  %endif
  1872                              <3>  %else
  1873                              <3>  EMIT_ERROR 'missing brackets.'
  1874                              <3> 
  1875                              <3>  %endif
  1876                              <3>  %else
  1877                              <3>  EMIT_ERROR 'directive too short.'
  1878                              <3>  %endif
  1879                              <3>  %endif
  1880                              <3>  %endif
  1881                              <3> %else
  1882                              <3>  EMIT_ERROR 'todo: windows'
  1883                              <3> %endif
  1956                              <2>  %ifid %2
  1957                              <2>  GET_VARGS %2, __vargs
  1958                              <2>  %if __vargs > 0
  1959                              <2>  STR_ARG_HELPER __vargs
  1960                              <2>  STR_STR_HELPER %3
  1961                              <2>  %endif
  1962                              <2>  %elifstr %2
  1963                              <2>  section .data
  1964 00000013 6162636400          <2>  %%part2: db %1, 0
  1965                              <2>  section .text
  1966                              <2>  LEA.w DI, [%%part2]
  1843                              <3> %if DOS_SHELL == 1
  1844                              <3>  %if __pre_stop == 0
  1845                              <3>  %undef __prefix
  1846                              <3>  %undef __suffix
  1847                              <3>  %ifidni %1, SI
  1848                              <3>  %define __prefix si
  1849                              <3>  %elifidni %1, DI
  1850                              <3>  %define __prefix di
  1851                              <3>  %else
  1852                              <3>  EMIT_ERROR 'invalide prefix for LEA.W'
  1853                              <3>  %endif
  1854                              <3>  %ifndef __prefix
  1855                              <3>  %assign __pre_stop 1
  1856                              <3>  %endif
  1857                              <3>  %if __pre_stop == 0
  1858                              <3>  %xdefine __s %str(%2)
  1859                              <3>  %xdefine __n %strlen(__s)
  1860                              <3>  %if __n >= 2
  1861                              <3>  %xdefine __fst %substr(__s,0,1)
  1862                              <3>  %xdefine __lst %substr(__s,__n,1)
  1863                              <3>  %ifidn __fst, '['
  1864                              <3>  %ifidn __lst, ']'
  1865                              <3>  %xdefine __inner %substr(__s,2,__n-2)
  1866                              <3>  %xdefine __tok %tok(__inner)
  1867                              <3>  %define __suffix [PTR16(__tok)]
  1868 00000078 8D3E(1301)          <3>  lea __prefix, __suffix
  1869                              <3>  %else
  1870                              <3>  EMIT_ERROR 'closed bracket missing.'
  1871                              <3>  %endif
  1872                              <3>  %else
  1873                              <3>  EMIT_ERROR 'missing brackets.'
  1874                              <3> 
  1875                              <3>  %endif
  1876                              <3>  %else
  1877                              <3>  EMIT_ERROR 'directive too short.'
  1878                              <3>  %endif
  1879                              <3>  %endif
  1880                              <3>  %endif
  1881                              <3> %else
  1882                              <3>  EMIT_ERROR 'todo: windows'
  1883                              <3> %endif
  1967                              <2>  STR_STR_HELPER %3
  1918                              <3>  %if __pre_stop == 0
  1919                              <3>  section .text
  1920 0000007C E84B0E              <3>  call string_compare
  1921 0000007F 3C00                <3>  cmp al, 0
  1922 00000081 7503                <3>  jne %%jum4
  1923 00000083 E86400              <3>  call %1
  1924                              <3>  %%jum4:
  1925                              <3>  %endif
  1968                              <2>  %elifnum %2
  1969                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  1970                              <2>  %assign __pre_stop 1
  1971                              <2>  %else
  1972                              <2>  EMIT_ERROR 'todo'
  1973                              <2>  %assign __pre_stop 1
  1974                              <2>  %endif
  1975                              <2>  %elifid %1
  1976                              <2>  %assign __varg1 0
  1977                              <2>  %assign __varg2 0
  1978                              <2>  GET_VARGS %1, _varg1
  1979                              <2>  %ifid %2
  1980                              <2>  GET_VARGS %2, _varg2
  1981                              <2>  %if __varg1 > 0
  1982                              <2>  %if __varg2 > 0
  1983                              <2>  STR_ARG_HELPER __varg1
  1984                              <2>  STR_ARG_HELPER __varg2
  1985                              <2>  STR_STR_HELPER %3
  1986                              <2>  %else
  1987                              <2>  LEA.w DI, [_cA_%2]
  1988                              <2>  %endif
  1989                              <2>  %else
  1990                              <2>  LEA.w SI, [_cA_%1]
  1991                              <2>  %endif
  1992                              <2>  %elifstr %2
  1993                              <2>  section .data
  1994                              <2>  %%part3: db %2, 0
  1995                              <2>  section .text
  1996                              <2>  LEA.w si, [%%part3]
  1997                              <2>  STR_ARG_HELPER __varg1
  1998                              <2>  STR_STR_HELPER %3
  1999                              <2>  %elifnum %2
  2000                              <2>  EMIT_ERROR 'numbers can not be handled as string.'
  2001                              <2>  %else
  2002                              <2>  EMIT_ERROR 'todo'
  2003                              <2>  %endif
  2004                              <2>  %endif
  2005                              <2>  %undef __stop
  2006                              <2>  %undef __varg
  2007                              <2>  %endif
    36                              <1>     
    37                              <1>     ;jmp  usage
    38                              <1>     
    39                              <1>     DOS_Exit 0
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 00000086 B8004C              <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000089 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
    40                              <1>     
    41                              <1>     
    42                              <1>     
    43                              <1>     .next1:
    44                              <1> ;    SET_DATA db_have_token, 1
    45                              <1>     
    46                              <1> ;    CMP_STR ARGV_2, 'create', .is_okCreate
    47                              <1> ;    CMP_STR ARGV_2, 'append', .is_okAppend
    48                              <1>     
    49                              <1> ;    .is_okCreate:  SET_DATA db_op, 'C', .next2  ; CREATE
    50                              <1> ;    .is_okAppend:  SET_DATA db_op, 'A', .next2  ; APPEND
    51                              <1>     
    52                              <1>     .next2:
    53                              <1> ;    SET_DATA db_have_token, 2
    54                              <1>     
    55                              <1> ;    CMP_STR ARGV_3, 'c', .is_okTypeC
    56                              <1> ;    CMP_STR ARGV_3, 'C', .is_okTypeC
    57                              <1>     
    58                              <1> ;    CMP_STR ARGV_3, 'i', .is_okTypeI
    59                              <1> ;    CMP_STR ARGV_3, 'I', .is_okTypeI
    60                              <1>     
    61                              <1> ;    CMP_STR ARGV_3, 'f', .is_okTypeF
    62                              <1> ;    CMP_STR ARGV_3, 'F', .is_okTypeF
    63                              <1>     
    64                              <1> ;    CMP_STR ARGV_3, 'b', .is_okTypeB
    65                              <1> ;    CMP_STR ARGV_3, 'B', .is_okTypeB
    66                              <1>     
    67                              <1> ;    CMP_STR ARGV_3, 'd', .is_okTypeD
    68                              <1> ;    CMP_STR ARGV_3, 'D', .is_okTypeD
    69                              <1>     
    70                              <1> ;    .is_okTypeC:  SET_DATA db_type, 'C', .next3
    71                              <1> ;    .is_okTypeI:  SET_DATA db_type, 'I', .next3
    72                              <1> ;    .is_okTypeF:  SET_DATA db_type, 'F', .next3
    73                              <1> ;    .is_okTypeB:  SET_DATA db_type, 'B', .next3
    74                              <1> ;    .is_okTypeD:  SET_DATA db_type, 'D', .next3
    75                              <1>         
    76                              <1>     .next3:
    77                              <1> ;    SET_DATA db_have_token, 3
    78                              <1>     
    79                              <1>     .is_okk:
    80                              <1>     SET_CURSOR 40, 5
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 0000008B B228                <2>  mov dl, %1
  1301 0000008D B605                <2>  mov dh, %2
  1302 0000008F E83B09              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
    81                              <1>     PUTS_COLOR 'mufti', 0x1C
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 00000018 6D7566746900        <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356 00000092 31DB                <2>  xor bx, bx
  1357 00000094 B31C                <2>  mov bl, %2
  1358 00000096 BE(1801)            <2>  mov si, PTR16(%%msg)
  1359 00000099 E8980D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
    82                              <1>     DOS_Exit   0
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 0000009C B8004C              <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 0000009F CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
    83 000000A1 C3                  <1>     ret
    84                              <1>     
    85                              <1>     
    86                              <1> is_version_1:
    87                              <1>     ;mov [PTR16(_cA_db_version)], byte 3
    88                              <1>     SET_CURSOR 10, 1
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000A2 B20A                <2>  mov dl, %1
  1301 000000A4 B601                <2>  mov dh, %2
  1302 000000A6 E82409              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
    89                              <1>     PUTS_COLOR 'argv1 == argv1', 0x0F
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000001E 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000027 617267763100        <2>
  1355                              <2>  section .text
  1356 000000A9 31DB                <2>  xor bx, bx
  1357 000000AB B30F                <2>  mov bl, %2
  1358 000000AD BE(1E01)            <2>  mov si, PTR16(%%msg)
  1359 000000B0 E8810D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
    90 000000B3 C3                  <1>     ret
    91                              <1> is_version_2:
    92                              <1>     ;mov [PTR16(_cA_db_version)], byte 4
    93                              <1>     SET_CURSOR 10, 2
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000B4 B20A                <2>  mov dl, %1
  1301 000000B6 B602                <2>  mov dh, %2
  1302 000000B8 E81209              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
    94                              <1>     PUTS_COLOR 'argv1 == argv2', 0x0E
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000002D 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000036 617267763200        <2>
  1355                              <2>  section .text
  1356 000000BB 31DB                <2>  xor bx, bx
  1357 000000BD B30E                <2>  mov bl, %2
  1358 000000BF BE(2D01)            <2>  mov si, PTR16(%%msg)
  1359 000000C2 E86F0D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
    95 000000C5 C3                  <1>     ret
    96                              <1> is_version_3:
    97                              <1>     ;mov [PTR16(_cA_db_version)], byte 5
    98                              <1>     SET_CURSOR 10, 3
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000C6 B20A                <2>  mov dl, %1
  1301 000000C8 B603                <2>  mov dh, %2
  1302 000000CA E80009              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
    99                              <1>     PUTS_COLOR 'argv1 == "abcd"', 0x0F
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000003C 6172677631203D3D20- <2>  %%msg: db %1, 0
  1354 00000045 22616263642200      <2>
  1355                              <2>  section .text
  1356 000000CD 31DB                <2>  xor bx, bx
  1357 000000CF B30F                <2>  mov bl, %2
  1358 000000D1 BE(3C01)            <2>  mov si, PTR16(%%msg)
  1359 000000D4 E85D0D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   100 000000D7 C3                  <1>     ret
   101                              <1> is_version_4:
   102                              <1>     ;mov [PTR16(_cA_db_version)], byte 6
   103                              <1>     SET_CURSOR 10, 4
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000D8 B20A                <2>  mov dl, %1
  1301 000000DA B604                <2>  mov dh, %2
  1302 000000DC E8EE08              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   104                              <1>     PUTS_COLOR 'argv2 == 1234', 0xF
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000004C 6172677632203D3D20- <2>  %%msg: db %1, 0
  1354 00000055 3132333400          <2>
  1355                              <2>  section .text
  1356 000000DF 31DB                <2>  xor bx, bx
  1357 000000E1 B30F                <2>  mov bl, %2
  1358 000000E3 BE(4C01)            <2>  mov si, PTR16(%%msg)
  1359 000000E6 E84B0D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   105 000000E9 C3                  <1>     ret
   106                              <1> is_version_5:    
   107                              <1>     ;mov [PTR16(_cA_db_version)], byte 6
   108                              <1>     SET_CURSOR 10, 5
  1296                              <2> %if %0 == 0
  1297                              <2>  EMIT_ERROR 2 argument missing
  1298                              <2> %endif
  1299                              <2> %if DOS_SHELL == 1
  1300 000000EA B20A                <2>  mov dl, %1
  1301 000000EC B605                <2>  mov dh, %2
  1302 000000EE E8DC08              <2>  call dos_set_cursor
  1303                              <2> %else
  1304                              <2> %endif
   109                              <1>     PUTS_COLOR '"abcd" == "abcd"', 0xF
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000005A 226162636422203D3D- <2>  %%msg: db %1, 0
  1354 00000063 2022616263642200    <2>
  1355                              <2>  section .text
  1356 000000F1 31DB                <2>  xor bx, bx
  1357 000000F3 B30F                <2>  mov bl, %2
  1358 000000F5 BE(5A01)            <2>  mov si, PTR16(%%msg)
  1359 000000F8 E8390D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   110 000000FB C3                  <1>     ret
   111                              <1>     
   112                              <1>     
   113                              <1>     
   114                              <1>     
   115                              <1>     
   116                              <1>     
   117                              <1>     
   118                              <1>     
   119                              <1>     
   120                              <1>     
   121                              <1>     
   122                              <1>     
   123 000000FC E93505              <1> jmp usage
   124                              <1>     _done:
   125                              <1>     PUTS_COLOR 'ddd', 0x1C
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354 0000006B 64646400            <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356 000000FF 31DB                <2>  xor bx, bx
  1357 00000101 B31C                <2>  mov bl, %2
  1358 00000103 BE(6B01)            <2>  mov si, PTR16(%%msg)
  1359 00000106 E82B0D              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389                              <2>  mov bl, %2
  1390                              <2>  mov ax, PTR16(_cA_%1)
  1391                              <2>  mov si, ax
  1392                              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   126                              <1>     .token_done:
   127                              <1>     DOS_Exit 0
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 00000109 B8004C              <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 0000010C CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
   128                              <1>         
   129                              <1>     ; -------- <feldname> (max 10) --------
   130 0000010E BF(331F)            <1>     mov di, PTR16(fldname)
   131 00000111 E86603              <1>     call copy_token_max_10
   132 00000114 0F821C05            <1>     jc  usage
   133 00000118 C60500              <1>     mov byte [di], 0      ; Nullterminierung (Routine schreibt sie ohnehin)
   134                              <1> 
   135                              <1>     ; -------- <feldlaenge> --------
   136 0000011B E81503              <1>     call next_token
   137 0000011E 0F821205            <1>     jc  usage
   138 00000122 BA(F31E)            <1>     mov dx, PTR16(tokbuf)
   139 00000125 E8D103              <1>     call parse_u16
   140 00000128 0F821405            <1>     jc  badargs
   141 0000012C A3(F31E)            <1>     mov [PTR16(g_flen)], ax
   142                              <1> 
   143                              <1>     ; --- Feldtyp mappen + Länge validieren ---
   144 0000012F A0(F31E)            <1>     mov al, [PTR16(g_ftype)]
   145 00000132 E81D04              <1>     call map_fieldtype      ; AL=DBF Type, BL=fixedLen(0/const), BH=only4
   146 00000135 0F820705            <1>     jc  badargs
   147 00000139 80FF01              <1>     cmp bh, 1
   148 0000013C 7509                <1>     jne .ok_ftyp
   149 0000013E 833E(F31E)04        <1>     cmp word [PTR16(g_type)], 4
   150 00000143 0F852905            <1>     jne not_supported
   151                              <1>     .ok_ftyp:
   152 00000147 80FB00              <1>     cmp bl, 0
   153 0000014A 7409                <1>     je  .keep_len
   154 0000014C 881E(F31E)          <1>     mov byte [PTR16(g_flen)    ], bl   ; fixe Länge erzwingen
   155 00000150 C606(F41E)00        <1>     mov byte [PTR16(g_flen) + 1], 0
   156                              <1>     .keep_len:
   157 00000155 A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   158 00000158 8A16(F31E)          <1>     mov dl, [PTR16(g_ftype)]
   159 0000015C E85104              <1>     call validate_length
   160 0000015F 0F82DD04            <1>     jc  badargs
   161                              <1> 
   162                              <1>     ; Datum für Header holen
   163 00000163 B42A                <1>     mov ah, 2Ah
   164 00000165 CD21                <1>     int 21h
   165 00000167 890E(F31E)          <1>     mov [PTR16(g_year)], cx
   166 0000016B 8836(F31E)          <1>     mov [PTR16(g_month)], dh
   167 0000016F 8816(F31E)          <1>     mov [PTR16(g_day)], dl
   168                              <1> 
   169                              <1>     ; --- Dispatch nach CMD ---
   170                              <1> do_dispatch:
   171 00000173 803E(F31E)01        <1>     cmp byte [PTR16(g_cmd)], 1
   172 00000178 7437                <1>     je  do_create
   173 0000017A EB64                <1>     jmp do_append
   174                              <1> 
   175                              <1> ; --- Hex-Ausgabe (AX -> XXXXh, nutzt int 21h/AH=02h) ---
   176                              <1> print_hex16:
   177 0000017C 50                  <1>     push ax
   178 0000017D 53                  <1>     push bx
   179 0000017E 51                  <1>     push cx
   180 0000017F 52                  <1>     push dx
   181 00000180 89C3                <1>     mov  bx, ax
   182 00000182 B90400              <1>     mov  cx, 4
   183                              <1>     .next_nibble:
   184 00000185 C1C304              <1>     rol  bx, 4
   185 00000188 88DA                <1>     mov  dl, bl
   186 0000018A 80E20F              <1>     and  dl, 0Fh
   187 0000018D 80C230              <1>     add  dl, '0'
   188 00000190 80FA39              <1>     cmp  dl, '9'
   189 00000193 7603                <1>     jbe  .out
   190 00000195 80C207              <1>     add  dl, 7          ; 'A'..'F'
   191                              <1>     .out:
   192 00000198 B402                <1>     mov  ah, 02h
   193 0000019A CD21                <1>     int  21h
   194 0000019C E2E7                <1>     loop .next_nibble
   195 0000019E B268                <1>     mov  dl, 'h'
   196 000001A0 B402                <1>     mov  ah, 02h
   197 000001A2 CD21                <1>     int  21h
   198 000001A4 B20D                <1>     mov  dl, 13         ; CR LF
   199 000001A6 CD21                <1>     int  21h
   200 000001A8 B20A                <1>     mov  dl, 10
   201 000001AA CD21                <1>     int  21h
   202 000001AC 5A                  <1>     pop  dx
   203 000001AD 59                  <1>     pop  cx
   204 000001AE 5B                  <1>     pop  bx
   205 000001AF 58                  <1>     pop  ax
   206 000001B0 C3                  <1>     ret
   207                              <1> ; ---------------- CREATE ----------------
   208                              <1> do_create:
   209                              <1>     ; vorhandene Datei (ignoriert Fehler) löschen
   210 000001B1 BA(0502)            <1>     mov dx, PTR16(_cA_DBFNAME)
   211 000001B4 B441                <1>     mov ah, 41h
   212 000001B6 CD21                <1>     int 21h
   213                              <1> 
   214                              <1>     ; neu anlegen
   215 000001B8 BA(0502)            <1>     mov dx, PTR16(_cA_DBFNAME)
   216 000001BB B90000              <1>     mov cx, 0
   217 000001BE B43C                <1>     mov ah, 3Ch
   218 000001C0 CD21                <1>     int 21h
   219 000001C2 0F82B604            <1>     jc  io_error
   220 000001C6 A3(F31E)            <1>     mov [PTR16(hFile)], ax
   221                              <1> 
   222                              <1>     ; Header + 1 Feld bauen und schreiben
   223 000001C9 E82401              <1>     call build_header_for_new
   224 000001CC E89401              <1>     call write_full_header
   225                              <1> 
   226                              <1>     ; schließen
   227 000001CF 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   228 000001D3 B43E                <1>     mov ah, 3Eh
   229 000001D5 CD21                <1>     int 21h
   230                              <1>     
   231                              <1> ;todo paule32
   232                              <1> ;    DOS_WriteLn msg_ok_create
   233                              <1> 
   234                              <1>     ;lea dx, PTR16(msg_ok_create)
   235                              <1> 
   236 000001D7 E84204              <1>     call print_$
   237                              <1>     DOS_crlf
  1454 000001DA E8150C              <2>  call DOSrncrlf
   238 000001DD E9B404              <1>     jmp exit0
   239                              <1> 
   240                              <1> ; ---------------- APPEND ----------------
   241                              <1> do_append:
   242                              <1>     ; RDWR öffnen
   243 000001E0 BA(0502)            <1>     mov dx, PTR16(_cA_DBFNAME)
   244 000001E3 B8023D              <1>     mov ax, 3D02h
   245 000001E6 CD21                <1>     int 21h
   246 000001E8 0F826004            <1>     jc  open_fail
   247 000001EC A3(F31E)            <1>     mov [PTR16(hFile)], ax
   248                              <1> 
   249                              <1>     ; Header lesen (32)
   250 000001EF 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   251 000001F3 BA(3F1F)            <1>     mov dx, PTR16(header)
   252 000001F6 B92000              <1>     mov cx, 32
   253 000001F9 B43F                <1>     mov ah, 3Fh
   254 000001FB CD21                <1>     int 21h
   255 000001FD 0F827B04            <1>     jc  io_error
   256 00000201 83F820              <1>     cmp ax, 32
   257 00000204 0F857404            <1>     jne io_error
   258                              <1> 
   259                              <1>     ; Typ prüfen
   260 00000208 A0(3F1F)            <1>     mov al, [PTR16(header)+0]
   261 0000020B 833E(F31E)03        <1>     cmp word [PTR16(g_type)], 3
   262 00000210 7508                <1>     jne .chk4
   263 00000212 3C03                <1>     cmp al, 03h
   264 00000214 0F854004            <1>     jne ver_mismatch
   265 00000218 EB06                <1>     jmp .t_ok
   266                              <1>     .chk4:
   267 0000021A 3C04                <1>     cmp al, 04h
   268 0000021C 0F853804            <1>     jne ver_mismatch
   269                              <1>     .t_ok:
   270                              <1> 
   271                              <1>     ; Records==0?
   272 00000220 A1(431F)            <1>     mov ax, [PTR16(header)+4]
   273 00000223 8B16(451F)          <1>     mov dx, [PTR16(header)+6]
   274 00000227 09C0                <1>     or  ax, ax
   275 00000229 09D2                <1>     or  dx, dx
   276 0000022B 0F853504            <1>     jnz append_with_records_not_supported
   277                              <1> 
   278                              <1>     ; Header-/Recordlänge
   279 0000022F A1(471F)            <1>     mov ax, [PTR16(header)+8]
   280 00000232 A3(E308)            <1>     mov [PTR16(hdr_len)], ax
   281 00000235 A1(491F)            <1>     mov ax, [PTR16(header)+10]
   282 00000238 A3(E508)            <1>     mov [PTR16(rec_len)], ax
   283                              <1> 
   284                              <1>     ; Felddeskriptoren laden (hdr_len - 32)
   285 0000023B A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
   286 0000023E 83E820              <1>     sub ax, 32
   287 00000241 0F864304            <1>     jbe bad_header
   288 00000245 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   289 00000249 BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   290 0000024C 89C1                <1>     mov cx, ax
   291 0000024E B43F                <1>     mov ah, 3Fh
   292 00000250 CD21                <1>     int 21h
   293 00000252 0F822604            <1>     jc  io_error
   294 00000256 A3(5F1F)            <1>     mov [PTR16(fdbuf_size)], ax
   295                              <1> 
   296                              <1>     ; existiert Feld?
   297 00000259 E88701              <1>     call field_exists
   298 0000025C 0F82C103            <1>     jc  field_already
   299                              <1> 
   300                              <1>     ; Terminator finden
   301 00000260 BE(5606)            <1>     mov si, PTR16(fdescbuf)
   302 00000263 8B0E(5F1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   303                              <1>     .find_term:
   304 00000267 83F900              <1>     cmp cx, 0
   305 0000026A 0F841A04            <1>     je  bad_header
   306 0000026E 803C0D              <1>     cmp byte [si], 0Dh
   307 00000271 7408                <1>     je  .term_found
   308 00000273 83C620              <1>     add si, 32
   309 00000276 83E920              <1>     sub cx, 32
   310 00000279 EBEC                <1>     jmp .find_term
   311                              <1>     .term_found:
   312                              <1>     ; neuen FD in tempdesc bauen
   313 0000027B E85E01              <1>     call build_one_descriptor_to_temp
   314                              <1>     ; 32 Byte an Terminatorstelle kopieren
   315 0000027E 56                  <1>     push si
   316 0000027F 89F7                <1>     mov di, si
   317 00000281 BE(5F1F)            <1>     mov si, PTR16(tempdesc)
   318 00000284 B92000              <1>     mov cx, 32
   319 00000287 F3A4                <1>     rep movsb
   320 00000289 5E                  <1>     pop si
   321                              <1>     ; neuen Terminator hinterher
   322 0000028A C6040D              <1>     mov byte [si], 0Dh
   323                              <1> 
   324                              <1>     ; Header anpassen
   325 0000028D A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
   326 00000290 83C020              <1>     add ax, 32
   327 00000293 A3(E308)            <1>     mov [PTR16(hdr_len)], ax
   328 00000296 A3(471F)            <1>     mov [PTR16(header)+8], ax
   329 00000299 A1(E508)            <1>     mov ax, [PTR16(rec_len)]
   330 0000029C 0306(F31E)          <1>     add ax, [PTR16(g_flen)]
   331 000002A0 A3(E508)            <1>     mov [PTR16(rec_len)], ax
   332 000002A3 A3(491F)            <1>     mov [PTR16(header)+10], ax
   333                              <1> 
   334                              <1>     ; an BOF seeken
   335 000002A6 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   336 000002AA 31D2                <1>     xor dx, dx
   337 000002AC 31C9                <1>     xor cx, cx
   338 000002AE B80042              <1>     mov ax, 4200h
   339 000002B1 CD21                <1>     int 21h
   340                              <1> 
   341                              <1>     ; Header schreiben (32)
   342 000002B3 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   343 000002B7 BA(3F1F)            <1>     mov dx, PTR16(header)
   344 000002BA B92000              <1>     mov cx, 32
   345 000002BD B440                <1>     mov ah, 40h
   346 000002BF CD21                <1>     int 21h
   347 000002C1 0F82B703            <1>     jc  io_error
   348                              <1> 
   349                              <1>     ; FD-Region schreiben (hdr_len - 32)
   350 000002C5 A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
   351 000002C8 83E820              <1>     sub ax, 32
   352 000002CB 89C1                <1>     mov cx, ax
   353 000002CD BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   354 000002D0 8B1E[F31D]          <1>     mov bx, [hFile]
   355 000002D4 B440                <1>     mov ah, 40h
   356 000002D6 CD21                <1>     int 21h
   357 000002D8 0F82A003            <1>     jc  io_error
   358                              <1> 
   359                              <1>     ; schließen
   360 000002DC 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   361 000002E0 B43E                <1>     mov ah, 3Eh
   362 000002E2 CD21                <1>     int 21h
   363                              <1> 
   364 000002E4 BA(F804)            <1>     mov dx, PTR16(msg_ok_append)
   365 000002E7 E83203              <1>     call print_$
   366                              <1>     DOS_crlf
  1454 000002EA E8050B              <2>  call DOSrncrlf
   367 000002ED E9A403              <1>     jmp exit0
   368                              <1> 
   369                              <1> ; ---------------- Helper: Build/Write ----------------
   370                              <1> 
   371                              <1> ; build_header_for_new: header + 1 FD in fdescbuf (mit 0Dh) erzeugen
   372                              <1> build_header_for_new:
   373 000002F0 50                  <1>     push ax
   374 000002F1 53                  <1>     push bx
   375 000002F2 51                  <1>     push cx
   376 000002F3 52                  <1>     push dx
   377                              <1> 
   378                              <1>     ; clear header (32) + fdescbuf
   379 000002F4 BF(3F1F)            <1>     mov di, PTR16(header)
   380 000002F7 B91000              <1>     mov cx, 16
   381 000002FA 31C0                <1>     xor ax, ax
   382 000002FC F3AB                <1>     rep stosw
   383 000002FE BF(5606)            <1>     mov di, PTR16(fdescbuf)
   384 00000301 B90008              <1>     mov cx, 2048
   385 00000304 F3AB                <1>     rep stosw
   386                              <1> 
   387                              <1>     ; version
   388 00000306 A1(F31E)            <1>     mov ax, [PTR16(g_type)]
   389 00000309 83F803              <1>     cmp ax, 3
   390 0000030C 7507                <1>     jne .v4
   391 0000030E C606(3F1F)03        <1>     mov byte [PTR16(header)+0], 03h
   392 00000313 EB05                <1>     jmp .v_ok
   393                              <1>     .v4:
   394 00000315 C606(3F1F)04        <1>     mov byte [PTR16(header)+0], 04h
   395                              <1>     .v_ok:
   396                              <1>     ; date YY,MM,DD
   397 0000031A A1(F31E)            <1>     mov ax, [PTR16(g_year)]
   398 0000031D BB6400              <1>     mov bx, 100
   399 00000320 31D2                <1>     xor dx, dx
   400 00000322 F7F3                <1>     div bx            ; AX=year/100, DX=YY
   401 00000324 88D0                <1>     mov al, dl
   402 00000326 A2(401F)            <1>     mov [PTR16(header)+1], al
   403 00000329 A0(F31E)            <1>     mov al, [PTR16(g_month)]
   404 0000032C A2(411F)            <1>     mov [PTR16(header)+2], al
   405 0000032F A0(F31E)            <1>     mov al, [PTR16(g_day)]
   406 00000332 A2(421F)            <1>     mov [PTR16(header)+3], al
   407                              <1> 
   408                              <1>     ; num records = 0
   409 00000335 66C706(431F)000000- <1>     mov dword [PTR16(header)+4], 0
   409 0000033D 00                  <1>
   410                              <1> 
   411                              <1>     ; record length = 1 (delete flag) + field len
   412 0000033E A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   413 00000341 83C001              <1>     add ax, 1
   414 00000344 A3(491F)            <1>     mov [PTR16(header)+10], ax
   415 00000347 A3(E508)            <1>     mov [PTR16(rec_len)], ax
   416                              <1> 
   417                              <1>     ; header length = 32 + 32 (one FD) + 1 (0Dh)
   418 0000034A B84100              <1>     mov ax, 32+32+1
   419 0000034D A3(471F)            <1>     mov [PTR16(header)+8], ax
   420 00000350 A3(E308)            <1>     mov [PTR16(hdr_len)], ax
   421                              <1> 
   422                              <1>     ; MDX/langid = 0
   423                              <1> 
   424                              <1>     ; FD in fdescbuf und Terminator
   425 00000353 BF(5606)            <1>     mov di, PTR16(fdescbuf)
   426 00000356 E84100              <1>     call build_one_descriptor_at_di
   427 00000359 C606(7606)0D        <1>     mov byte [PTR16(fdescbuf)+32], 0Dh
   428                              <1> 
   429 0000035E 5A                  <1>     pop dx
   430 0000035F 59                  <1>     pop cx
   431 00000360 5B                  <1>     pop bx
   432 00000361 58                  <1>     pop ax
   433 00000362 C3                  <1>     ret
   434                              <1> 
   435                              <1> ; write_full_header: schreibt Header (32) + FD-Region (hdr_len-32)
   436                              <1> write_full_header:
   437                              <1>     ; seek BOF
   438 00000363 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   439 00000367 31D2                <1>     xor dx, dx
   440 00000369 31C9                <1>     xor cx, cx
   441 0000036B B80042              <1>     mov ax, 4200h
   442 0000036E CD21                <1>     int 21h
   443                              <1>     ; header
   444 00000370 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   445 00000374 BA(3F1F)            <1>     mov dx, PTR16(header)
   446 00000377 B92000              <1>     mov cx, 32
   447 0000037A B440                <1>     mov ah, 40h
   448 0000037C CD21                <1>     int 21h
   449 0000037E 0F82FA02            <1>     jc  io_error
   450                              <1>     ; FD region
   451 00000382 A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
   452 00000385 83E820              <1>     sub ax, 32
   453 00000388 89C1                <1>     mov cx, ax
   454 0000038A BA(5606)            <1>     mov dx, PTR16(fdescbuf)
   455 0000038D 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   456 00000391 B440                <1>     mov ah, 40h
   457 00000393 CD21                <1>     int 21h
   458 00000395 0F82E302            <1>     jc  io_error
   459 00000399 C3                  <1>     ret
   460                              <1> 
   461                              <1> ; build_one_descriptor_at_di: DI->32 Byte Ziel
   462                              <1> build_one_descriptor_at_di:
   463 0000039A 56                  <1>     push si
   464 0000039B 50                  <1>     push ax
   465 0000039C 51                  <1>     push cx
   466                              <1> 
   467                              <1>     ; name (max 10 + 0) in 11 Bytes
   468 0000039D BE(331F)            <1>     mov si, PTR16(fldname)
   469 000003A0 B90B00              <1>     mov cx, 11
   470                              <1>     .ncopy:
   471 000003A3 AC                  <1>     lodsb
   472 000003A4 3C00                <1>     cmp al, 0
   473 000003A6 7405                <1>     je  .padz
   474 000003A8 AA                  <1>     stosb
   475 000003A9 E2F8                <1>     loop .ncopy
   476 000003AB EB08                <1>     jmp .name_done
   477                              <1>     .padz:
   478 000003AD AA                  <1>     stosb
   479 000003AE 49                  <1>     dec cx
   480 000003AF 7404                <1>     jz  .name_done
   481 000003B1 B000                <1>     mov al, 0
   482 000003B3 F3AA                <1>     rep stosb
   483                              <1>     .name_done:
   484                              <1> 
   485                              <1>     ; type char
   486 000003B5 A0(F31E)            <1>     mov al, [PTR16(g_ftype)]
   487 000003B8 E8EC01              <1>     call map_fieldtype_char_only
   488 000003BB AA                  <1>     stosb
   489                              <1> 
   490                              <1>     ; data address (4) = 0
   491 000003BC 31C0                <1>     xor ax, ax
   492 000003BE B90400              <1>     mov cx, 4
   493 000003C1 F3AA                <1>     rep stosb
   494                              <1> 
   495                              <1>     ; length (1)
   496 000003C3 A1(F31E)            <1>     mov ax, [PTR16(g_flen)]
   497 000003C6 88C0                <1>     mov al, al
   498 000003C8 AA                  <1>     stosb
   499                              <1> 
   500                              <1>     ; decimals (1) = 0
   501 000003C9 B000                <1>     mov al, 0
   502 000003CB AA                  <1>     stosb
   503                              <1> 
   504                              <1>     ; reserved(2)
   505 000003CC AA                  <1>     stosb
   506 000003CD AA                  <1>     stosb
   507                              <1> 
   508                              <1>     ; flags(1)=0
   509 000003CE B000                <1>     mov al, 0
   510 000003D0 AA                  <1>     stosb
   511                              <1> 
   512                              <1>     ; autoinc next(4)+step(1)+reserved(6)=0
   513 000003D1 B90B00              <1>     mov cx, 11
   514 000003D4 B000                <1>     mov al, 0
   515 000003D6 F3AA                <1>     rep stosb
   516                              <1> 
   517 000003D8 59                  <1>     pop cx
   518 000003D9 58                  <1>     pop ax
   519 000003DA 5E                  <1>     pop si
   520 000003DB C3                  <1>     ret
   521                              <1> 
   522                              <1> build_one_descriptor_to_temp:
   523 000003DC BF(5F1F)            <1>     mov di, PTR16(tempdesc)
   524 000003DF E8B8FF              <1>     call build_one_descriptor_at_di
   525 000003E2 C3                  <1>     ret
   526                              <1> 
   527                              <1> ; field_exists: CF=1 wenn Name bereits vorhanden
   528                              <1> field_exists:
   529 000003E3 56                  <1>     push si
   530 000003E4 57                  <1>     push di
   531 000003E5 51                  <1>     push cx
   532 000003E6 50                  <1>     push ax
   533 000003E7 BE(5606)            <1>     mov si, PTR16(fdescbuf)
   534 000003EA 8B0E(5F1F)          <1>     mov cx, [PTR16(fdbuf_size)]
   535                              <1>     .floop:
   536 000003EE 83F900              <1>     cmp cx, 0
   537 000003F1 743A                <1>     je  .no
   538 000003F3 803C0D              <1>     cmp byte [si], 0Dh
   539 000003F6 7435                <1>     je  .no
   540                              <1>     ; vergleiche 0-term feldname (bis 11)
   541 000003F8 56                  <1>     push si
   542 000003F9 BF(331F)            <1>     mov di, PTR16(fldname)
   543 000003FC BB0B00              <1>     mov bx, 11
   544 000003FF BA0100              <1>     mov dx, 1          ; assume match
   545                              <1>     .cmpn:
   546 00000402 8A04                <1>     mov al, [si]
   547 00000404 8A25                <1>     mov ah, [di]
   548 00000406 80FC00              <1>     cmp ah, 0
   549 00000409 7409                <1>     je  .endcmp
   550 0000040B 38E0                <1>     cmp al, ah
   551 0000040D 7507                <1>     jne .not
   552 0000040F 46                  <1>     inc si
   553 00000410 47                  <1>     inc di
   554 00000411 4B                  <1>     dec bx
   555 00000412 75EE                <1>     jnz .cmpn
   556                              <1>     .endcmp:
   557                              <1>     ; wenn bis 0 gleich -> match
   558 00000414 EB03                <1>     jmp .match
   559                              <1>     .not:
   560 00000416 BA0000              <1>     mov dx, 0
   561                              <1>     .match:
   562 00000419 5E                  <1>     pop si
   563 0000041A 83FA01              <1>     cmp dx, 1
   564 0000041D 7408                <1>     je  .yes
   565 0000041F 83C620              <1>     add si, 32
   566 00000422 83E920              <1>     sub cx, 32
   567 00000425 EBC7                <1>     jmp .floop
   568                              <1>     .yes:
   569 00000427 F9                  <1>     stc
   570 00000428 58                  <1>     pop ax
   571 00000429 59                  <1>     pop cx
   572 0000042A 5F                  <1>     pop di
   573 0000042B 5E                  <1>     pop si
   574 0000042C C3                  <1>     ret
   575                              <1>     .no:
   576 0000042D F8                  <1>     clc
   577 0000042E 58                  <1>     pop ax
   578 0000042F 59                  <1>     pop cx
   579 00000430 5F                  <1>     pop di
   580 00000431 5E                  <1>     pop si
   581 00000432 C3                  <1>     ret
   582                              <1> 
   583                              <1> ; ---------------- Token/Parsing ----------------
   584                              <1> 
   585                              <1> ; next_token: PSP tail -> tokbuf, DX=tokbuf, CF=1 wenn keins
   586                              <1> next_token:
   587 00000433 50                  <1>     push ax
   588 00000434 57                  <1>     push di
   589                              <1>     ; skip ws
   590                              <1>     .nt_skip:
   591 00000435 80FB00              <1>     cmp bl, 0
   592 00000438 743C                <1>     je  .none
   593 0000043A 8A04                <1>     mov al, [si]
   594 0000043C 46                  <1>     inc si
   595 0000043D FECB                <1>     dec bl
   596 0000043F 3C0D                <1>     cmp al, 13
   597 00000441 7433                <1>     je  .none
   598 00000443 3C20                <1>     cmp al, ' '
   599 00000445 74EE                <1>     je  .nt_skip
   600 00000447 3C09                <1>     cmp al, 9
   601 00000449 74EA                <1>     je  .nt_skip
   602 0000044B 4E                  <1>     dec si
   603 0000044C FEC3                <1>     inc bl
   604                              <1>     ; copy
   605 0000044E BF(C204)            <1>     mov di, PTR16(_cA_cmd_buf)
   606                              <1>     .nt_copy:
   607 00000451 80FB00              <1>     cmp bl, 0
   608 00000454 7416                <1>     je  .done
   609 00000456 8A04                <1>     mov al, [si]
   610 00000458 3C0D                <1>     cmp al, 13
   611 0000045A 7410                <1>     je  .done
   612 0000045C 3C20                <1>     cmp al, ' '
   613 0000045E 740C                <1>     je  .done
   614 00000460 3C09                <1>     cmp al, 9
   615 00000462 7408                <1>     je  .done
   616 00000464 8805                <1>     mov [di], al
   617 00000466 47                  <1>     inc di
   618 00000467 46                  <1>     inc si
   619 00000468 FECB                <1>     dec bl
   620 0000046A EBE5                <1>     jmp .nt_copy
   621                              <1>     .done:
   622 0000046C C60500              <1>     mov byte [di], 0
   623 0000046F BA(C204)            <1>     mov dx, PTR16(_cA_cmd_buf)
   624 00000472 F8                  <1>     clc
   625 00000473 5F                  <1>     pop di
   626 00000474 58                  <1>     pop ax
   627 00000475 C3                  <1>     ret
   628                              <1>     .none:
   629 00000476 F9                  <1>     stc
   630 00000477 5F                  <1>     pop di
   631 00000478 58                  <1>     pop ax
   632 00000479 C3                  <1>     ret
   633                              <1> 
   634                              <1> ; copy_token_max_10: SI/BL => [DI], max 10, 0-term, CF wie oben
   635                              <1> copy_token_max_10:
   636 0000047A 50                  <1>     push ax
   637 0000047B 51                  <1>     push cx
   638                              <1>     ; skip ws
   639                              <1>     .ct10_skip:
   640 0000047C 80FB00              <1>     cmp bl, 0
   641 0000047F 7451                <1>     je  .none
   642 00000481 8A04                <1>     mov al, [si]
   643 00000483 46                  <1>     inc si
   644 00000484 FECB                <1>     dec bl
   645 00000486 3C0D                <1>     cmp al, 13
   646 00000488 7448                <1>     je  .none
   647 0000048A 3C20                <1>     cmp al, ' '
   648 0000048C 74EE                <1>     je  .ct10_skip
   649 0000048E 3C09                <1>     cmp al, 9
   650 00000490 74EA                <1>     je  .ct10_skip
   651 00000492 4E                  <1>     dec si
   652 00000493 FEC3                <1>     inc bl
   653                              <1>     ; copy up to 10
   654 00000495 B90A00              <1>     mov cx, 10
   655                              <1>     .ct10_copy:
   656 00000498 80FB00              <1>     cmp bl, 0
   657 0000049B 742E                <1>     je  .end
   658 0000049D 8A04                <1>     mov al, [si]
   659 0000049F 3C0D                <1>     cmp al, 13
   660 000004A1 7428                <1>     je  .end
   661 000004A3 3C20                <1>     cmp al, ' '
   662 000004A5 7424                <1>     je  .end
   663 000004A7 3C09                <1>     cmp al, 9
   664 000004A9 7420                <1>     je  .end
   665 000004AB 83F900              <1>     cmp cx, 0
   666 000004AE 7409                <1>     je  .skip_rest
   667 000004B0 8805                <1>     mov [di], al
   668 000004B2 47                  <1>     inc di
   669 000004B3 46                  <1>     inc si
   670 000004B4 FECB                <1>     dec bl
   671 000004B6 49                  <1>     dec cx
   672 000004B7 EBDF                <1>     jmp .ct10_copy
   673                              <1>     .skip_rest:
   674 000004B9 80FB00              <1>     cmp bl, 0
   675 000004BC 740D                <1>     je  .end
   676 000004BE 8A04                <1>     mov al, [si]
   677 000004C0 46                  <1>     inc si
   678 000004C1 FECB                <1>     dec bl
   679 000004C3 3C0D                <1>     cmp al, 13
   680 000004C5 7404                <1>     je  .end
   681 000004C7 3C20                <1>     cmp al, ' '
   682 000004C9 75EE                <1>     jne .skip_rest
   683                              <1>     .end:
   684 000004CB C60500              <1>     mov byte [di], 0
   685 000004CE F8                  <1>     clc
   686 000004CF 59                  <1>     pop cx
   687 000004D0 58                  <1>     pop ax
   688 000004D1 C3                  <1>     ret
   689                              <1>     .none:
   690 000004D2 F9                  <1>     stc
   691 000004D3 59                  <1>     pop cx
   692 000004D4 58                  <1>     pop ax
   693 000004D5 C3                  <1>     ret
   694                              <1> 
   695                              <1> ; strcmp: SI=str1, DI=str2, AX=0 bei Gleichheit (ZF=1)
   696                              <1> strcmp:
   697 000004D6 56                  <1>     push si
   698 000004D7 57                  <1>     push di
   699                              <1>     .sc_loop:
   700 000004D8 AC                  <1>     lodsb
   701 000004D9 8A25                <1>     mov ah, [di]
   702 000004DB 47                  <1>     inc di
   703 000004DC E86700              <1>     call to_upper_al
   704 000004DF E86800              <1>     call to_upper_ah
   705 000004E2 38E0                <1>     cmp al, ah
   706 000004E4 750B                <1>     jne .ne
   707 000004E6 84C0                <1>     test al, al
   708 000004E8 75EE                <1>     jnz .sc_loop
   709 000004EA 31C0                <1>     xor ax, ax
   710 000004EC 09C0                <1>     or  ax, ax
   711 000004EE 5F                  <1>     pop di
   712 000004EF 5E                  <1>     pop si
   713 000004F0 C3                  <1>     ret
   714                              <1>     .ne:
   715 000004F1 B80100              <1>     mov ax, 1
   716 000004F4 09C0                <1>     or  ax, ax
   717 000004F6 5F                  <1>     pop di
   718 000004F7 5E                  <1>     pop si
   719 000004F8 C3                  <1>     ret
   720                              <1> 
   721                              <1> ; parse_u16: DX->zstr, AX=result, CF=1 bei Fehler
   722                              <1> parse_u16:
   723 000004F9 53                  <1>     push bx
   724 000004FA 56                  <1>     push si
   725 000004FB 89D6                <1>     mov si, dx
   726 000004FD 31C0                <1>     xor ax, ax
   727                              <1>     .pu_loop:
   728 000004FF AC                  <1>     lodsb
   729 00000500 84C0                <1>     test al, al
   730 00000502 741B                <1>     jz  .ok
   731 00000504 3C30                <1>     cmp al, '0'
   732 00000506 721B                <1>     jb  .err
   733 00000508 3C39                <1>     cmp al, '9'
   734 0000050A 7717                <1>     ja  .err
   735 0000050C 2C30                <1>     sub al, '0'         ; digit in AL
   736 0000050E 89C3                <1>     mov bx, ax          ; BX = acc
   737 00000510 D1E0                <1>     shl ax, 1           ; acc*2
   738 00000512 89C2                <1>     mov dx, ax
   739 00000514 C1E002              <1>     shl ax, 2           ; acc*8
   740 00000517 01D0                <1>     add ax, dx          ; acc*10
   741 00000519 01D8                <1>     add ax, bx          ; +digit
   742 0000051B 7206                <1>     jc  .err
   743 0000051D EBE0                <1>     jmp .pu_loop
   744                              <1>     .ok:
   745 0000051F F8                  <1>     clc
   746 00000520 5E                  <1>     pop si
   747 00000521 5B                  <1>     pop bx
   748 00000522 C3                  <1>     ret
   749                              <1>     .err:
   750 00000523 F9                  <1>     stc
   751 00000524 5E                  <1>     pop si
   752 00000525 5B                  <1>     pop bx
   753 00000526 C3                  <1>     ret
   754                              <1> 
   755                              <1> ; upper_inplace_dx: DX->zstr upper-case
   756                              <1> upper_inplace_dx:
   757 00000527 50                  <1>     push ax
   758 00000528 52                  <1>     push dx
   759 00000529 89D6                <1>     mov si, dx
   760                              <1>     .upl:
   761 0000052B AC                  <1>     lodsb
   762 0000052C 84C0                <1>     test al, al
   763 0000052E 7408                <1>     jz  .done
   764 00000530 E80800              <1>     call to_upper
   765 00000533 8844FF              <1>     mov [si-1], al
   766 00000536 EBF3                <1>     jmp .upl
   767                              <1>     .done:
   768 00000538 5A                  <1>     pop dx
   769 00000539 58                  <1>     pop ax
   770 0000053A C3                  <1>     ret
   771                              <1> 
   772                              <1> ; to_upper helpers
   773                              <1> to_upper:
   774 0000053B 3C61                <1>     cmp al, 'a'
   775 0000053D 7206                <1>     jb  .ret
   776 0000053F 3C7A                <1>     cmp al, 'z'
   777 00000541 7702                <1>     ja  .ret
   778 00000543 2C20                <1>     sub al, 32
   779                              <1>     .ret:
   780 00000545 C3                  <1>     ret
   781                              <1> to_upper_al:
   782 00000546 E8F2FF              <1>     call to_upper
   783 00000549 C3                  <1>     ret
   784                              <1> to_upper_ah:
   785 0000054A 86E0                <1>     xchg al, ah
   786 0000054C E8ECFF              <1>     call to_upper
   787 0000054F 86E0                <1>     xchg al, ah
   788 00000551 C3                  <1>     ret
   789                              <1> 
   790                              <1> ; map_fieldtype: AL=CLI(C/I/F/B/D/T)-> DBF Typ in [g_ftype_mapped]
   791                              <1> ; out: AL=dbfType, BL=fixedLen(0/const), BH=only4(1=T), CF=1 on error
   792                              <1> map_fieldtype:
   793 00000552 50                  <1>     push ax
   794 00000553 E8F0FF              <1>     call to_upper_al
   795 00000556 3C43                <1>     cmp al, 'C'
   796 00000558 7417                <1>     je .C
   797 0000055A 3C49                <1>     cmp al, 'I'
   798 0000055C 741B                <1>     je .I
   799 0000055E 3C46                <1>     cmp al, 'F'
   800 00000560 741F                <1>     je .F
   801 00000562 3C42                <1>     cmp al, 'B'
   802 00000564 7423                <1>     je .B
   803 00000566 3C44                <1>     cmp al, 'D'
   804 00000568 7427                <1>     je .D
   805 0000056A 3C54                <1>     cmp al, 'T'
   806 0000056C 742B                <1>     je .T
   807 0000056E F9                  <1>     stc
   808 0000056F EB34                <1>     jmp .out
   809 00000571 B043                <1>     .C: mov al, 'C'   ; 1..254
   810 00000573 30DB                <1>     xor bl, bl
   811 00000575 30FF                <1>     xor bh, bh
   812 00000577 EB28                <1>     jmp .ok
   813 00000579 B04E                <1>     .I: mov al, 'N'   ; 1..20
   814 0000057B 30DB                <1>     xor bl, bl
   815 0000057D 30FF                <1>     xor bh, bh
   816 0000057F EB20                <1>     jmp .ok
   817 00000581 B046                <1>     .F: mov al, 'F'   ; 1..20
   818 00000583 30DB                <1>     xor bl, bl
   819 00000585 30FF                <1>     xor bh, bh
   820 00000587 EB18                <1>     jmp .ok
   821 00000589 B04C                <1>     .B: mov al, 'L'   ; exakt 1
   822 0000058B B301                <1>     mov bl, 1
   823 0000058D 30FF                <1>     xor bh, bh
   824 0000058F EB10                <1>     jmp .ok
   825 00000591 B044                <1>     .D: mov al, 'D'   ; exakt 8
   826 00000593 B308                <1>     mov bl, 8
   827 00000595 30FF                <1>     xor bh, bh
   828 00000597 EB08                <1>     jmp .ok
   829 00000599 B054                <1>     .T: mov al, 'T'   ; exakt 8, nur Typ 4
   830 0000059B B308                <1>     mov bl, 8
   831 0000059D B701                <1>     mov bh, 1
   832 0000059F EB00                <1>     jmp .ok
   833                              <1>     .ok:
   834 000005A1 A2(F31E)            <1>     mov [PTR16(g_ftype_mapped)], al
   835 000005A4 F8                  <1>     clc
   836                              <1>     .out:
   837 000005A5 58                  <1>     pop ax
   838 000005A6 C3                  <1>     ret
   839                              <1> 
   840                              <1> map_fieldtype_char_only:
   841 000005A7 53                  <1>     push bx
   842 000005A8 E8A7FF              <1>     call map_fieldtype
   843 000005AB A0(F31E)            <1>     mov al, [PTR16(g_ftype_mapped)]
   844 000005AE 5B                  <1>     pop bx
   845 000005AF C3                  <1>     ret
   846                              <1> 
   847                              <1> ; validate_length: AX=len, DL=CLI type (upper), CF=1 invalid
   848                              <1> validate_length:
   849 000005B0 50                  <1>     push ax
   850 000005B1 52                  <1>     push dx
   851 000005B2 E85F00              <1>     call to_upper_dl
   852 000005B5 80FA42              <1>     cmp dl, 'B'       ; 1
   853 000005B8 7507                <1>     jne .nB
   854 000005BA 83F801              <1>         cmp ax, 1
   855 000005BD 7551                <1>         jne .bad
   856 000005BF EB4B                <1>         jmp .ok
   857                              <1>     .nB:
   858 000005C1 80FA44              <1>     cmp dl, 'D'       ; 8
   859 000005C4 7507                <1>     jne .nD
   860 000005C6 83F808              <1>         cmp ax, 8
   861 000005C9 7545                <1>         jne .bad
   862 000005CB EB3F                <1>         jmp .ok
   863                              <1>     .nD:
   864 000005CD 80FA54              <1>     cmp dl, 'T'       ; 8
   865 000005D0 7507                <1>     jne .nT
   866 000005D2 83F808              <1>         cmp ax, 8
   867 000005D5 7539                <1>         jne .bad
   868 000005D7 EB33                <1>         jmp .ok
   869                              <1>     .nT:
   870 000005D9 80FA43              <1>     cmp dl, 'C'       ; 1..254
   871 000005DC 750C                <1>     jne .nC
   872 000005DE 83F801              <1>         cmp ax, 1
   873 000005E1 722D                <1>         jb .bad
   874 000005E3 3DFE00              <1>         cmp ax, 254
   875 000005E6 7728                <1>         ja .bad
   876 000005E8 EB22                <1>         jmp .ok
   877                              <1>     .nC:
   878 000005EA 80FA49              <1>     cmp dl, 'I'       ; 1..20
   879 000005ED 750C                <1>     jne .nI
   880 000005EF 83F801              <1>         cmp ax, 1
   881 000005F2 721C                <1>         jb .bad
   882 000005F4 83F814              <1>         cmp ax, 20
   883 000005F7 7717                <1>         ja .bad
   884 000005F9 EB11                <1>         jmp .ok
   885                              <1>     .nI:
   886 000005FB 80FA46              <1>     cmp dl, 'F'       ; 1..20 (konservativ)
   887 000005FE 7510                <1>     jne .bad
   888 00000600 83F801              <1>         cmp ax, 1
   889 00000603 720B                <1>         jb .bad
   890 00000605 83F814              <1>         cmp ax, 20
   891 00000608 7706                <1>         ja .bad
   892 0000060A EB00                <1>         jmp .ok
   893                              <1>     .ok:
   894 0000060C F8                  <1>     clc
   895 0000060D 5A                  <1>     pop dx
   896 0000060E 58                  <1>     pop ax
   897 0000060F C3                  <1>     ret
   898                              <1>     .bad:
   899 00000610 F9                  <1>     stc
   900 00000611 5A                  <1>     pop dx
   901 00000612 58                  <1>     pop ax
   902 00000613 C3                  <1>     ret
   903                              <1> 
   904                              <1> to_upper_dl:
   905 00000614 86D0                <1>     xchg al, dl
   906 00000616 E822FF              <1>     call to_upper
   907 00000619 86D0                <1>     xchg al, dl
   908 0000061B C3                  <1>     ret
   909                              <1> 
   910                              <1> ; --------- Ausgabe & Exit ---------
   911                              <1> print_$:
   912 0000061C B409                <1>     mov ah, 09h
   913 0000061E CD21                <1>     int 21h
   914 00000620 C3                  <1>     ret
   915                              <1> 
   916                              <1> field_already:
   917                              <1>     ; Datei schließen und Hinweis ausgeben
   918 00000621 8B1E[F31D]          <1>     mov bx, [hFile]
   919 00000625 B43E                <1>     mov ah, 3Eh
   920 00000627 CD21                <1>     int 21h
   921 00000629 BA(2505)            <1>     mov dx, PTR16(msg_fieldexists)
   922 0000062C E8EDFF              <1>     call print_$
   923                              <1>     DOS_crlf
  1454 0000062F E8C007              <2>  call DOSrncrlf
   924 00000632 EB60                <1>     jmp exit0
   925                              <1> 
   926                              <1> usage:
   927                              <1>     PUTS_COLOR msg_usage, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000634 B302                <2>  mov bl, %2
  1390 00000636 B8(5A03)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000639 89C6                <2>  mov si, ax
  1392 0000063B E8F607              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   928 0000063E EB59                <1>     jmp exit1
   929                              <1> 
   930                              <1> badargs:
   931                              <1>     PUTS_COLOR msg_badargs, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000640 B302                <2>  mov bl, %2
  1390 00000642 B8(AA03)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000645 89C6                <2>  mov si, ax
  1392 00000647 E8EA07              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   932                              <1>     ;DOS_crlf
   933 0000064A EB4D                <1>     jmp exit1
   934                              <1> 
   935                              <1> open_fail:
   936                              <1>     PUTS_COLOR msg_openfail, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 0000064C B302                <2>  mov bl, %2
  1390 0000064E B8(C703)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000651 89C6                <2>  mov si, ax
  1392 00000653 E8DE07              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   937 00000656 EB41                <1>     jmp exit1
   938                              <1> 
   939                              <1> ver_mismatch:
   940                              <1>     PUTS_COLOR msg_ver_mismatch, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000658 B302                <2>  mov bl, %2
  1390 0000065A B8(FB03)            <2>  mov ax, PTR16(_cA_%1)
  1391 0000065D 89C6                <2>  mov si, ax
  1392 0000065F E8D207              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   941 00000662 EB35                <1>     jmp exit1
   942                              <1> 
   943                              <1> append_with_records_not_supported:
   944                              <1>     PUTS_COLOR msg_append_recs, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000664 B302                <2>  mov bl, %2
  1390 00000666 B8(2204)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000669 89C6                <2>  mov si, ax
  1392 0000066B E8C607              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   945 0000066E EB29                <1>     jmp exit1
   946                              <1> 
   947                              <1> not_supported:
   948                              <1>     PUTS_COLOR msg_not_supported, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000670 B302                <2>  mov bl, %2
  1390 00000672 B8(9C04)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000675 89C6                <2>  mov si, ax
  1392 00000677 E8BA07              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   949 0000067A EB1D                <1>     jmp exit1
   950                              <1> 
   951                              <1> io_error:
   952                              <1>     PUTS_COLOR msg_ioerr, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 0000067C B302                <2>  mov bl, %2
  1390 0000067E B8(6504)            <2>  mov ax, PTR16(_cA_%1)
  1391 00000681 89C6                <2>  mov si, ax
  1392 00000683 E8AE07              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   953 00000686 EB11                <1>     jmp exit1
   954                              <1> 
   955                              <1> bad_header:
   956                              <1>     PUTS_COLOR msg_badheader, 0x02
  1350                              <2> %if DOS_SHELL == 1
  1351                              <2> 
  1352                              <2>  %ifstr %1
  1353                              <2>  section .data
  1354                              <2>  %%msg: db %1, 0
  1355                              <2>  section .text
  1356                              <2>  xor bx, bx
  1357                              <2>  mov bl, %2
  1358                              <2>  mov si, PTR16(%%msg)
  1359                              <2>  call PutStrColor
  1360                              <2>  %elifidni %1, SI
  1361                              <2>  section .text
  1362                              <2>  mov bl, %2
  1363                              <2>  call PutStrColor
  1364                              <2>  %elifidni %1, DI
  1365                              <2>  section .text
  1366                              <2>  mov bl, %2
  1367                              <2>  call PutStrColor
  1368                              <2>  %else
  1369                              <2>  %assign __count 0
  1370                              <2>  %assign __varg 0
  1371                              <2>  %assign __stop 0
  1372                              <2>  %rep MAX_ARGV
  1373                              <2>  %if __stop == 0
  1374                              <2>  %assign __count (__count + 1)
  1375                              <2>  %ifidni %1, ARGV_%+__count
  1376                              <2>  %assign __varg __count
  1377                              <2>  %assign __stop 1
  1378                              <2>  %endif
  1379                              <2>  %endif
  1380                              <2>  %endrep
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1381                              <2>  %if __varg > 0
  1382                              <2>  section .text
  1383                              <2>  mov si, PTR16(_cA_cmd_buf)
  1384                              <2>  mov bl, __varg
  1385                              <2>  call getCommandLine_Arg
  1386                              <2>  call PutStrColor
  1387                              <2>  %else
  1388                              <2>  section .text
  1389 00000688 B302                <2>  mov bl, %2
  1390 0000068A B8(7104)            <2>  mov ax, PTR16(_cA_%1)
  1391 0000068D 89C6                <2>  mov si, ax
  1392 0000068F E8A207              <2>  call PutStrColor
  1393                              <2>  %endif
  1394                              <2>  %undef __varg
  1395                              <2>  %endif
  1396                              <2> %else
  1397                              <2>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <2> %endif
   957 00000692 EB05                <1>     jmp exit1
   958                              <1> 
   959                              <1> exit0:
   960                              <1>     DOS_Exit 0
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 00000694 B8004C              <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000697 CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
   961                              <1> exit1:
   962                              <1>     DOS_Exit 1
  1424                              <2> %if DOS_SHELL == 1
  1425                              <2>  %ifidni %1, ax
  1426                              <2>  EMIT_ERROR 'AX not allowed here.'
  1427                              <2>  %elifidni %1, bx
  1428                              <2>  mov ax, 0x4C00
  1429                              <2>  or ax, bx
  1430                              <2>  SysCall
  1431                              <2>  %elifidni %1, CX
  1432                              <2>  mov ax, 0x4C00
  1433                              <2>  or ax, cx
  1434                              <2>  SysCall
  1435                              <2>  %elifidni %1, dx
  1436                              <2>  mov ax, 0x4C00
  1437                              <2>  or ax, dx
  1438                              <2>  SysCall
  1439                              <2>  %elifnum %1
  1440 00000699 B8014C              <2>  mov ax, 0x4C00 | %1
  1441                              <2>  SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 0000069C CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
  1442                              <2>  %else
  1443                              <2>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <2>  %endif
  1445                              <2> %endif
   963                              <1> 
   964                              <1> ;------------------------------------------------------------------------------
   965                              <1> ; dbfhead.asm - dBASE IV DBF-Header anzeigen (DOS .COM)
   966                              <1> ; Assemble: nasm -f bin dbfhead.asm -o DBFHEAD.COM
   967                              <1> ; Lauf:      DBFHEAD TEST.DBF
   968                              <1> ; -----------------------------------------------------------------------------
   969                              <1>     ; Kommandozeile aus PSP:80h holen -> Dateiname parsen
   970 0000069E BE8000              <1>     mov si, 80h            ; PSP:80h = Längenbyte gefolgt vom Tail
   971 000006A1 AC                  <1>     lodsb                  ; AL = Länge
   972 000006A2 88C3                <1>     mov bl, al             ; BL = verbleibende Zeichen
   973 000006A4 0F84AC01            <1>     jz  .usage
   974 000006A8 BF(6316)            <1>     mov di, PTR16(filename)
   975 000006AB E83D02              <1>     call skip_spaces_2
   976 000006AE 0F82A201            <1>     jc  .usage
   977 000006B2 E85202              <1>     call copy_token_to_di_2  ; kopiert bis Space/CR
   978 000006B5 C60500              <1>     mov byte [di], 0       ; 0-terminiert
   979                              <1> 
   980                              <1>     ; Datei öffnen (INT 21h, 3Dh)
   981 000006B8 BA(6316)            <1>     mov dx, PTR16(filename)
   982 000006BB B8003D              <1>     mov ax, 3D00h          ; AH=3Dh open, AL=0 read-only
   983 000006BE CD21                <1>     int 21h
   984 000006C0 0F829801            <1>     jc  .open_fail
   985 000006C4 A3(F31E)            <1>     mov [PTR16(hFile)], ax
   986                              <1> 
   987                              <1>     ; 32 Bytes Header lesen
   988 000006C7 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
   989 000006CB BA(3F1F)            <1>     mov dx, PTR16(header)
   990 000006CE B92000              <1>     mov cx, 32
   991 000006D1 B43F                <1>     mov ah, 3Fh
   992 000006D3 CD21                <1>     int 21h
   993 000006D5 0F828B01            <1>     jc  .read_fail
   994 000006D9 83F820              <1>     cmp ax, 32
   995 000006DC 0F858401            <1>     jne .read_fail
   996                              <1> 
   997                              <1>     ; Headerfelder auswerten
   998                              <1>     ; Version
   999 000006E0 A0(3F1F)            <1>     mov al, [PTR16(header) + 0]
  1000 000006E3 A2(F31E)            <1>     mov [PTR16(verByte)], al
  1001                              <1> 
  1002                              <1>     ; Datum: YY, MM, DD (Bytes 1..3)
  1003 000006E6 A0(401F)            <1>     mov al, [PTR16(header) + 1]
  1004 000006E9 A2(F31E)            <1>     mov [PTR16(yy)], al
  1005 000006EC A0(411F)            <1>     mov al, [PTR16(header) + 2]
  1006 000006EF A2(F31E)            <1>     mov [PTR16(mm)], al
  1007 000006F2 A0(421F)            <1>     mov al, [PTR16(header) + 3]
  1008 000006F5 A2(F31E)            <1>     mov [PTR16(dd)], al
  1009                              <1> 
  1010                              <1>     ; Anzahl Datensätze (4..7) -> 32-bit LE in regs: DX:AX
  1011 000006F8 A1(431F)            <1>     mov ax, [PTR16(header) + 4]
  1012 000006FB 8B16(451F)          <1>     mov dx, [PTR16(header) + 6]
  1013 000006FF A3(F31E)            <1>     mov [PTR16(rec32) + 0], ax
  1014 00000702 8916(F51E)          <1>     mov [PTR16(rec32) + 2], dx
  1015                              <1> 
  1016                              <1>     ; Headerlänge (8..9), Satzlänge (10..11)
  1017 00000706 A1(471F)            <1>     mov ax, [PTR16(header) +  8]
  1018 00000709 A3(E308)            <1>     mov [PTR16(hdr_len)], ax
  1019 0000070C A1(491F)            <1>     mov ax, [PTR16(header) + 10]
  1020 0000070F A3(E508)            <1>     mov [PTR16(rec_len)], ax
  1021                              <1> 
  1022                              <1>     ; MDX-Flag (28), Languagedriver (29)
  1023 00000712 A0(5B1F)            <1>     mov al, [PTR16(header)+28]
  1024 00000715 A2(F31E)            <1>     mov [PTR16(mdx)], al
  1025 00000718 A0(5C1F)            <1>     mov al, [PTR16(header)+29]
  1026 0000071B A2(F31E)            <1>     mov [PTR16(lang)], al
  1027                              <1> 
  1028                              <1>     ; Ausgabe Header-Info
  1029 0000071E BA(0E02)            <1>     mov dx, PTR16(msgTitle)
  1030 00000721 E8F8FE              <1>     call print_$
  1031                              <1> 
  1032 00000724 BA(8E02)            <1>     mov dx, PTR16(msgVer)
  1033 00000727 E8F2FE              <1>     call print_$
  1034 0000072A A0(F31E)            <1>     mov al, [PTR16(verByte)]
  1035 0000072D E84E01              <1>     call print_hex8
  1036                              <1>     DOS_crlf
  1454 00000730 E8BF06              <2>  call DOSrncrlf
  1037                              <1> 
  1038 00000733 BA(9E02)            <1>     mov dx, PTR16(msgDate)
  1039 00000736 E8E3FE              <1>     call print_$
  1040 00000739 A0(F31E)            <1>     mov al, [PTR16(yy)]
  1041 0000073C E87301              <1>     call print_dec8
  1042 0000073F B02D                <1>     mov al, '-'
  1043 00000741 E8A506              <1>     call putc
  1044 00000744 A0(F31E)            <1>     mov al, [PTR16(mm)]
  1045 00000747 E86801              <1>     call print_dec8
  1046 0000074A B02D                <1>     mov al, '-'
  1047 0000074C E89A06              <1>     call putc
  1048 0000074F A0(F31E)            <1>     mov al, [PTR16(dd)]
  1049 00000752 E85D01              <1>     call print_dec8
  1050                              <1>     DOS_crlf
  1454 00000755 E89A06              <2>  call DOSrncrlf
  1051                              <1> 
  1052 00000758 BA(B102)            <1>     mov dx, PTR16(msgRecs)
  1053 0000075B E8BEFE              <1>     call print_$
  1054                              <1>     ; 32-bit hex ausgeben: DX:AX aus rec32
  1055 0000075E A1(F31E)            <1>     mov ax, [PTR16(rec32) + 0]
  1056 00000761 8B16(F51E)          <1>     mov dx, [PTR16(rec32) + 2]
  1057 00000765 E83D01              <1>     call print_hex32
  1058                              <1>     DOS_crlf
  1454 00000768 E88706              <2>  call DOSrncrlf
  1059                              <1> 
  1060 0000076B BA(CC02)            <1>     mov dx, PTR16(msgHdr)
  1061 0000076E E8ABFE              <1>     call print_$
  1062 00000771 A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
  1063 00000774 E84301              <1>     call print_dec16
  1064                              <1>     DOS_crlf
  1454 00000777 E87806              <2>  call DOSrncrlf
  1065                              <1> 
  1066 0000077A BA(E302)            <1>     mov dx, PTR16(msgRec)
  1067 0000077D E89CFE              <1>     call print_$
  1068 00000780 A1(E508)            <1>     mov ax, [PTR16(rec_len)]
  1069 00000783 E83401              <1>     call print_dec16
  1070                              <1>     DOS_crlf
  1454 00000786 E86906              <2>  call DOSrncrlf
  1071                              <1> 
  1072 00000789 BA(F802)            <1>     mov dx, PTR16(msgMDX)
  1073 0000078C E88DFE              <1>     call print_$
  1074 0000078F A0(F31E)            <1>     mov al, [PTR16(mdx)]
  1075 00000792 E8E900              <1>     call print_hex8
  1076                              <1>     DOS_crlf
  1454 00000795 E85A06              <2>  call DOSrncrlf
  1077                              <1> 
  1078 00000798 BA(0903)            <1>     mov dx, PTR16(msgLang)
  1079 0000079B E87EFE              <1>     call print_$
  1080 0000079E A0(F31E)            <1>     mov al, [PTR16(lang)]
  1081 000007A1 E8DA00              <1>     call print_hex8
  1082                              <1>     DOS_crlf
  1454 000007A4 E84B06              <2>  call DOSrncrlf
  1083                              <1>     DOS_crlf
  1454 000007A7 E84806              <2>  call DOSrncrlf
  1084                              <1> 
  1085                              <1>     ; Feld-Deskriptoren lesen:
  1086                              <1>     ; Anzahl Bytes bis Terminator = hdr_len - 32
  1087 000007AA A1(E308)            <1>     mov ax, [PTR16(hdr_len)]
  1088 000007AD 83E820              <1>     sub ax, 32
  1089 000007B0 0F869500            <1>     jbe .no_fields
  1090 000007B4 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
  1091 000007B8 BA(E316)            <1>     mov dx,  PTR16(fdbuf)
  1092 000007BB 89C1                <1>     mov cx, ax
  1093 000007BD B43F                <1>     mov ah, 3Fh
  1094 000007BF CD21                <1>     int 21h
  1095 000007C1 0F829F00            <1>     jc  .read_fail
  1096                              <1>     ; AX = tatsächlich gelesene Bytes
  1097                              <1> 
  1098 000007C5 BA(2403)            <1>     mov dx, PTR16(msgFields)
  1099 000007C8 E851FE              <1>     call print_$
  1100                              <1>     DOS_crlf
  1454 000007CB E82406              <2>  call DOSrncrlf
  1101                              <1> 
  1102                              <1>     ; Durch fdbuf iterieren: 32-Byte Blöcke bis 0Dh
  1103 000007CE BE(E316)            <1>     mov si, PTR16(fdbuf)
  1104 000007D1 89C1                <1>     mov cx, ax           ; CX = bytes available
  1105 000007D3 31ED                <1>     xor bp, bp           ; BP = Feldindex
  1106                              <1> 
  1107                              <1>     .next_field:
  1108 000007D5 83F900              <1>     cmp cx, 0
  1109 000007D8 766D                <1>     jbe .done_fields
  1110                              <1>     ; Terminator?
  1111 000007DA 803C0D              <1>     cmp byte [si], 0Dh
  1112 000007DD 7468                <1>     je  .done_fields
  1113                              <1> 
  1114                              <1>     ; Feldnummer ausgeben
  1115 000007DF 45                  <1>     inc bp
  1116 000007E0 BA(4703)            <1>     mov dx, PTR16(msgFieldN)
  1117 000007E3 E836FE              <1>     call print_$
  1118 000007E6 89E8                <1>     mov ax, bp
  1119 000007E8 E8CF00              <1>     call print_dec16
  1120 000007EB BA(5003)            <1>     mov dx, PTR16(msgColonSp)
  1121 000007EE E82BFE              <1>     call print_$
  1122                              <1> 
  1123                              <1>     ; Feldname (11 Byte, 0-terminiert)
  1124                              <1>     ; Wir kopieren/normalisieren in namebuf
  1125 000007F1 56                  <1>     push si
  1126 000007F2 BF(E31E)            <1>     mov di, PTR16(_cA_namebuf)
  1127 000007F5 BB0B00              <1>     mov bx, 11
  1128                              <1>     .copy_name:
  1129 000007F8 8A04                <1>     mov al, [si]
  1130 000007FA 3C00                <1>     cmp al, 0
  1131 000007FC 7409                <1>     je  .pad_zero
  1132                              <1>     ; Nur druckbare? Einfach übernehmen
  1133 000007FE 8805                <1>     mov [di], al
  1134 00000800 47                  <1>     inc di
  1135 00000801 46                  <1>     inc si
  1136 00000802 4B                  <1>     dec bx
  1137 00000803 75F3                <1>     jnz .copy_name
  1138 00000805 EB02                <1>     jmp short .name_done
  1139                              <1>     .pad_zero:
  1140 00000807 8805                <1>     mov [di], al
  1141                              <1>     .name_done:
  1142 00000809 C60500              <1>     mov byte [di], 0
  1143                              <1>     ; Ausgabe Name
  1144                              <1>     DOS_Write namebuf
  1463 0000080C 8D16(E31E)          <2>  lea dx, [PTR16(_cA_%1)]
  1464 00000810 E80D06              <2>  call DOS_ConsoleWrite
  1145 00000813 BA(5303)            <1>     mov dx, PTR16(msgCommaSp)
  1146 00000816 E803FE              <1>     call print_$
  1147                              <1> 
  1148                              <1>     ; Feldtyp (Byte 11)
  1149 00000819 5E                  <1>     pop si               ; si zurück auf Start des FD
  1150 0000081A 8A440B              <1>     mov al, [si+11]
  1151 0000081D E8C905              <1>     call putc
  1152 00000820 BA(5303)            <1>     mov dx, PTR16(msgCommaSp)
  1153 00000823 E8F6FD              <1>     call print_$
  1154                              <1> 
  1155                              <1>     ; Länge (Byte 16), Dezimal (Byte 17)
  1156 00000826 8A4410              <1>     mov al, [si+16]
  1157 00000829 B400                <1>     mov ah, 0
  1158 0000082B E88C00              <1>     call print_dec16
  1159 0000082E BA(5603)            <1>     mov dx, PTR16(msgSlash)
  1160 00000831 E8E8FD              <1>     call print_$
  1161 00000834 8A4411              <1>     mov al, [si+17]
  1162 00000837 B400                <1>     mov ah, 0
  1163 00000839 E87E00              <1>     call print_dec16
  1164                              <1>     DOS_crlf
  1454 0000083C E8B305              <2>  call DOSrncrlf
  1165                              <1> 
  1166                              <1>     ; Nächster Descriptor
  1167 0000083F 83C620              <1>     add si, 32
  1168 00000842 83E920              <1>     sub cx, 32
  1169 00000845 EB8E                <1>     jmp .next_field
  1170                              <1> 
  1171                              <1>     .done_fields:
  1172 00000847 EB23                <1>     jmp .close_and_exit
  1173                              <1> 
  1174                              <1>     .no_fields:
  1175 00000849 BA(2E03)            <1>     mov dx, PTR16(msgNoFields)
  1176 0000084C E8CDFD              <1>     call print_$
  1177                              <1>     DOS_crlf
  1454 0000084F E8A005              <2>  call DOSrncrlf
  1178 00000852 EB18                <1>     jmp .close_and_exit
  1179                              <1> 
  1180                              <1> ; ----- Fehlerpfade & Exit -----
  1181                              <1>     .usage:
  1182 00000854 BA(2402)            <1>     mov dx, PTR16(msgUsage)
  1183 00000857 E8C2FD              <1>     call print_$
  1184 0000085A EB18                <1>     jmp .exit
  1185                              <1> 
  1186                              <1>     .open_fail:
  1187 0000085C BA(4102)            <1>     mov dx, PTR16(msgOpenErr)
  1188 0000085F E8BAFD              <1>     call print_$
  1189 00000862 EB10                <1>     jmp .exit
  1190                              <1> 
  1191                              <1>     .read_fail:
  1192 00000864 BA(6E02)            <1>     mov dx, PTR16(msgReadErr)
  1193 00000867 E8B2FD              <1>     call print_$
  1194 0000086A EB00                <1>     jmp .close_and_exit
  1195                              <1> 
  1196                              <1>     .close_and_exit:
  1197 0000086C 8B1E(F31E)          <1>     mov bx, [PTR16(hFile)]
  1198 00000870 B43E                <1>     mov ah, 3Eh
  1199 00000872 CD21                <1>     int 21h
  1200                              <1>     .exit:
  1201 00000874 B8004C              <1>     mov ax, 4C00h
  1202 00000877 CD21                <1>     int 21h
  1203                              <1> 
  1204                              <1> ; ======== Hilfsroutinen ========
  1205                              <1> ; print_$: DX -> '$'-terminierte Zeichenkette
  1206                              <1> print_$_2:
  1207 00000879 B409                <1>     mov ah, 09h
  1208 0000087B CD21                <1>     int 21h
  1209 0000087D C3                  <1>     ret
  1210                              <1> 
  1211                              <1> ; print_hex8: AL -> 2 HEX
  1212                              <1> print_hex8:
  1213 0000087E 50                  <1>     push ax
  1214 0000087F 53                  <1>     push bx
  1215 00000880 88C3                <1>     mov bl, al
  1216 00000882 88C7                <1>     mov bh, al
  1217 00000884 C0EB04              <1>     shr bl, 4
  1218 00000887 80E70F              <1>     and bh, 0Fh
  1219 0000088A 88D8                <1>     mov al, bl
  1220 0000088C E80800              <1>     call hex_nibble
  1221 0000088F 88F8                <1>     mov al, bh
  1222 00000891 E80300              <1>     call hex_nibble
  1223 00000894 5B                  <1>     pop bx
  1224 00000895 58                  <1>     pop ax
  1225 00000896 C3                  <1>     ret
  1226                              <1> 
  1227                              <1> hex_nibble:
  1228 00000897 240F                <1>     and al, 0Fh
  1229 00000899 3C09                <1>     cmp al, 9
  1230 0000089B 7602                <1>     jbe .digit
  1231 0000089D 0407                <1>     add al, 7
  1232                              <1>     .digit:
  1233 0000089F 0430                <1>     add al, '0'
  1234 000008A1 E84505              <1>     call putc
  1235 000008A4 C3                  <1>     ret
  1236                              <1> 
  1237                              <1> ; print_hex32: DX:AX -> 8 HEX
  1238                              <1> print_hex32:
  1239 000008A5 50                  <1>     push ax
  1240 000008A6 52                  <1>     push dx
  1241 000008A7 89D0                <1>     mov ax, dx
  1242 000008A9 E8D0F8              <1>     call print_hex16
  1243 000008AC 5A                  <1>     pop dx
  1244 000008AD 58                  <1>     pop ax
  1245 000008AE E8CBF8              <1>     call print_hex16
  1246 000008B1 C3                  <1>     ret
  1247                              <1> 
  1248                              <1> ; print_dec8: AL (0..255) ohne führende Nullen
  1249                              <1> print_dec8:
  1250 000008B2 50                  <1>     push ax
  1251 000008B3 30E4                <1>     xor ah, ah
  1252 000008B5 E80200              <1>     call print_dec16
  1253 000008B8 58                  <1>     pop ax
  1254 000008B9 C3                  <1>     ret
  1255                              <1> 
  1256                              <1> ; print_dec16: AX -> dezimal ohne führende Nullen
  1257                              <1> ; einfache Division durch 10
  1258                              <1> print_dec16:
  1259 000008BA 50                  <1>     push ax
  1260 000008BB 53                  <1>     push bx
  1261 000008BC 52                  <1>     push dx
  1262 000008BD 51                  <1>     push cx
  1263 000008BE B90000              <1>     mov cx, 0          ; Zähler Ziffern im Stack
  1264 000008C1 83F800              <1>     cmp ax, 0
  1265 000008C4 7507                <1>     jne .pd_loop
  1266 000008C6 B030                <1>     mov al, '0'
  1267 000008C8 E81E05              <1>     call putc
  1268 000008CB EB19                <1>     jmp .pd_done
  1269                              <1>     .pd_loop:
  1270 000008CD 31D2                <1>     xor dx, dx
  1271 000008CF BB0A00              <1>     mov bx, 10
  1272 000008D2 F7F3                <1>     div bx            ; AX = AX/10, DX = Rest
  1273 000008D4 52                  <1>     push dx           ; Rest (Ziffer)
  1274 000008D5 41                  <1>     inc cx
  1275 000008D6 83F800              <1>     cmp ax, 0
  1276 000008D9 75F2                <1>     jne .pd_loop
  1277                              <1>     .pd_out:
  1278 000008DB 5A                  <1>     pop dx
  1279 000008DC 80C230              <1>     add dl, '0'
  1280 000008DF 88D0                <1>     mov al, dl
  1281 000008E1 E80505              <1>     call putc
  1282 000008E4 E2F5                <1>     loop .pd_out
  1283                              <1>     .pd_done:
  1284 000008E6 59                  <1>     pop cx
  1285 000008E7 5A                  <1>     pop dx
  1286 000008E8 5B                  <1>     pop bx
  1287 000008E9 58                  <1>     pop ax
  1288 000008EA C3                  <1>     ret
  1289                              <1> 
  1290                              <1> ; --- Kommandozeilen-Parsing ---
  1291                              <1> ; skip_spaces: SI->Tail, BL=Restlänge. Setzt ZF=1 wenn nichts übrig.
  1292                              <1> skip_spaces_2:
  1293 000008EB 50                  <1>     push ax
  1294                              <1>     .ss_loop:
  1295 000008EC 80FB00              <1>     cmp bl, 0
  1296 000008EF 7413                <1>     jz  .ss_empty
  1297 000008F1 8A04                <1>     mov al, [si]
  1298 000008F3 46                  <1>     inc si
  1299 000008F4 FECB                <1>     dec bl
  1300 000008F6 3C20                <1>     cmp al, ' '
  1301 000008F8 74F2                <1>     jz  .ss_loop
  1302 000008FA 3C09                <1>     cmp al, 9
  1303 000008FC 74EE                <1>     jz  .ss_loop
  1304                              <1>     ; ein Nicht-Leerzeichen gesehen -> SI eine Position zurück
  1305 000008FE 4E                  <1>     dec si
  1306 000008FF FEC3                <1>     inc bl
  1307 00000901 F8                  <1>     clc
  1308 00000902 58                  <1>     pop ax
  1309 00000903 C3                  <1>     ret
  1310                              <1>     .ss_empty:
  1311 00000904 F9                  <1>     stc
  1312 00000905 58                  <1>     pop ax
  1313 00000906 C3                  <1>     ret
  1314                              <1> 
  1315                              <1> ; copy_token_to_di: kopiert ab SI bis Space/CR nach DI, aktualisiert SI/BL
  1316                              <1> copy_token_to_di_2:
  1317 00000907 50                  <1>     push ax
  1318                              <1>     .ct_loop:
  1319 00000908 80FB00              <1>     cmp bl, 0
  1320 0000090B 7412                <1>     jz  .ct_done
  1321 0000090D 8A04                <1>     mov al, [si]
  1322 0000090F 3C0D                <1>     cmp al, 13         ; CR
  1323 00000911 740C                <1>     je  .ct_done
  1324 00000913 3C20                <1>     cmp al, ' '
  1325 00000915 7408                <1>     je  .ct_done
  1326 00000917 8805                <1>     mov [di], al
  1327 00000919 47                  <1>     inc di
  1328 0000091A 46                  <1>     inc si
  1329 0000091B FECB                <1>     dec bl
  1330 0000091D EBE9                <1>     jmp .ct_loop
  1331                              <1>     .ct_done:
  1332 0000091F 58                  <1>     pop ax
  1333 00000920 C3                  <1>     ret
  1334                              <1>     
  1335                              <1> ; ---- Hilfen ---------------------------------------------------
  1336                              <1> MAXLEN equ 63
  1337                              <1> 
  1338                              <1> ; Zeigt "Open error AX=xxxx" (bx enthält Fehlercode)
  1339                              <1> print_err_ax_bx:
  1340 00000921 50                  <1>     push ax
  1341 00000922 51                  <1>     push cx
  1342 00000923 52                  <1>     push dx
  1343 00000924 BA(9301)            <1>     mov  dx, PTR16(msgErr)
  1344 00000927 B409                <1>     mov  ah, 0x09
  1345 00000929 CD21                <1>     int  0x21
  1346 0000092B 89D8                <1>     mov  ax, bx
  1347 0000092D E80B00              <1>     call print_ax_hex
  1348 00000930 BA(BD01)            <1>     mov  dx, PTR16(crlf)
  1349 00000933 B409                <1>     mov  ah, 0x09
  1350 00000935 CD21                <1>     int  0x21
  1351 00000937 5A                  <1>     pop  dx
  1352 00000938 59                  <1>     pop  cx
  1353 00000939 58                  <1>     pop  ax
  1354 0000093A C3                  <1>     ret
  1355                              <1> 
  1356                              <1> ; AX als 4 hex-Zeichen ausgeben
  1357                              <1> print_ax_hex:
  1358 0000093B 50                  <1>     push ax
  1359 0000093C 53                  <1>     push bx
  1360 0000093D 51                  <1>     push cx
  1361 0000093E 52                  <1>     push dx
  1362 0000093F 89C3                <1>     mov  bx, ax
  1363 00000941 B90400              <1>     mov  cx, 4
  1364                              <1>     .hexloop:
  1365 00000944 C1C304              <1>     rol  bx, 4
  1366 00000947 88D8                <1>     mov  al, bl
  1367 00000949 240F                <1>     and  al, 0x0F
  1368 0000094B 0430                <1>     add  al, '0'
  1369 0000094D 3C39                <1>     cmp  al, '9'
  1370 0000094F 7602                <1>     jbe  .put
  1371 00000951 0407                <1>     add  al, 7
  1372                              <1>     .put:
  1373 00000953 88C2                <1>     mov  dl, al
  1374 00000955 B402                <1>     mov  ah, 0x02
  1375 00000957 CD21                <1>     int  0x21
  1376 00000959 E2E9                <1>     loop .hexloop
  1377 0000095B 5A                  <1>     pop  dx
  1378 0000095C 59                  <1>     pop  cx
  1379 0000095D 5B                  <1>     pop  bx
  1380 0000095E 58                  <1>     pop  ax
  1381 0000095F C3                  <1>     ret
  1382                              <1> 
  1383                              <1> ; ------------------------------------------------------------
  1384                              <1> ; Hilfsroutine: ein Zeichen an aktuelles arg_str anhängen,
  1385                              <1> ;               maximal 63 Nutzzeichen. Bei Overflow werden
  1386                              <1> ;               zusätzliche Zeichen bis zum nächsten Separator
  1387                              <1> ;               verworfen (wir schreiben einfach nicht mehr).
  1388                              <1> ; IN:
  1389                              <1> ;   AL = Zeichen
  1390                              <1> ;   DI = Schreibzeiger (zeigt immer auf nächste freie Stelle)
  1391                              <1> ;   CX = aktuelle Länge (0..63)
  1392                              <1> ; OUT:
  1393                              <1> ;   DI/CX aktualisiert
  1394                              <1> ; Zerstört: nichts weiter (AX benutzt)
  1395                              <1> ; ------------------------------------------------------------
  1396                              <1> put_char_maybe:
  1397 00000960 83F93F              <1>     cmp     cx, 63
  1398 00000963 7303                <1>     jae     .skip_write
  1399 00000965 AA                  <1>     stosb                   ; [DI] = AL, DI++
  1400 00000966 41                  <1>     inc     cx
  1401 00000967 C3                  <1>     ret
  1402                              <1> .skip_write:
  1403                              <1>     ; Zeichen verwerfen (nichts schreiben)
  1404 00000968 C3                  <1>     ret
  1405                              <1> 
  1406                              <1> ; DS:SI -> ASCIIZ
  1407                              <1> print_z0:
  1408                              <1>     .loop:
  1409 00000969 AC                  <1>     lodsb
  1410 0000096A 84C0                <1>     test    al, al
  1411 0000096C 7408                <1>     jz      .done
  1412 0000096E 88C2                <1>     mov     dl, al
  1413 00000970 B402                <1>     mov     ah, 02h
  1414                              <1>     SysCall
   133                              <2> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000972 CD21                <2>  int 0x21
   135                              <2> %else
   136                              <2>  EMIT_ERROR 'todo: windows'
   137                              <2> %endif
  1415 00000974 EBF3                <1>     jmp     .loop
  1416                              <1>     .done:
  1417 00000976 C3                  <1>     ret
  1418                              <1> 
  1419                              <1> ; -----------------------------------------------------------------------------
  1420                              <1> ; \brief include DOS 16-bit stdlib function's ...
  1421                              <1> ; -----------------------------------------------------------------------------
  1422                              <1> %include 'CommandLineArg.asm'       ; get command line arguments
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  CommandLineArg.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief  Sucht den n-ten (1-basiert) Token im ASCIIZ-String bei DS:SI,
    11                              <2> ;         ersetzt das erste Leerzeichen NACH dem Token durch 0 und
    12                              <2> ;         liefert SI auf den Tokenstart (C-String).
    13                              <2> ; \param  Eingabe:
    14                              <2> ;         DS:SI -> 0-terminierter String (muss schreibbar sein!)
    15                              <2> ;         BL    = n (1 = erster Token)
    16                              <2> ; \return Ausgabe bei Erfolg (CF=0):
    17                              <2> ;         SI    = Startadresse des Tokens (in DS)
    18                              <2> ;         CX    = Länge des Tokens
    19                              <2> ; \error  Bei Misserfolg (CF=1): CX=0, SI undefiniert
    20                              <2> ; \note   Verändert: AX, CX, DX, SI, DI, FLAGS
    21                              <2> ; -----------------------------------------------------------------------------
    22                              <2> getCommandLine_Arg:
    23                              <2>     ;push di
    24 00000977 84DB                <2>     test bl, bl
    25 00000979 7503                <2>     jnz .start
    26 0000097B F9                  <2>     stc
    27 0000097C EB4E                <2>     jmp .ret
    28                              <2> 
    29                              <2>     .start:
    30                              <2>     ; führende Leerzeichen überspringen
    31                              <2>     .skip_spaces_lead:
    32 0000097E AC                  <2>     lodsb                      ; AL=[SI], SI++
    33 0000097F 3C20                <2>     cmp  al, ' '
    34 00000981 74FB                <2>     je   .skip_spaces_lead
    35 00000983 3C00                <2>     cmp  al, 0
    36 00000985 7442                <2>     je   .not_found
    37                              <2> 
    38                              <2>     ; AL ist erstes Zeichen eines Tokens
    39 00000987 89F2                <2>     mov  dx, si
    40 00000989 4A                  <2>     dec  dx                    ; DX = Start dieses Tokens
    41 0000098A BF0100              <2>     mov  di, 1                 ; di = aktueller Tokenindex (1-basiert)
    42                              <2> 
    43 0000098D 39DF                <2>     cmp  di, bx
    44 0000098F 741C                <2>     je   .measure_this
    45                              <2> 
    46                              <2>     ; aktuellen Token bis zum Leerzeichen/0 überspringen
    47                              <2>     .skip_this_token:
    48 00000991 AC                  <2>     lodsb
    49 00000992 3C00                <2>     cmp  al, 0
    50 00000994 7433                <2>     je   .not_found
    51 00000996 3C20                <2>     cmp  al, ' '
    52 00000998 75F7                <2>     jne  .skip_this_token
    53                              <2> 
    54                              <2>     ; Folge-Leerzeichen überspringen
    55                              <2>     .skip_spaces_mid:
    56 0000099A AC                  <2>     lodsb
    57 0000099B 3C00                <2>     cmp  al, 0
    58 0000099D 742A                <2>     je   .not_found
    59 0000099F 3C20                <2>     cmp  al, ' '
    60 000009A1 74F7                <2>     je   .skip_spaces_mid
    61                              <2> 
    62                              <2>     ; Beginn des nächsten Tokens
    63 000009A3 47                  <2>     inc  di
    64 000009A4 89F2                <2>     mov  dx, si
    65 000009A6 4A                  <2>     dec  dx
    66 000009A7 39DF                <2>     cmp  di, bx
    67 000009A9 7402                <2>     je   .measure_this
    68 000009AB EBE4                <2>     jmp  .skip_this_token
    69                              <2> 
    70                              <2>     .measure_this:
    71                              <2>     ; SI steht bereits auf 2. Zeichen des Tokens (erstes war in AL)
    72 000009AD B90100              <2>     mov  cx, 1                 ; bisher 1 Zeichen gezählt
    73                              <2>     .len_loop:
    74 000009B0 AC                  <2>     lodsb
    75 000009B1 3C00                <2>     cmp  al, 0
    76 000009B3 7407                <2>     je   .done_len             ; Token endet am Stringende (bereits 0-terminiert)
    77 000009B5 3C20                <2>     cmp  al, ' '
    78 000009B7 7403                <2>     je   .done_len             ; Token endet am Leerzeichen
    79 000009B9 41                  <2>     inc  cx
    80 000009BA EBF4                <2>     jmp  .len_loop
    81                              <2> 
    82                              <2>     .done_len:
    83                              <2>     ; Wenn das Ende durch Leerzeichen kam, dieses in 0 verwandeln.
    84 000009BC 3C20                <2>     cmp  al, ' '
    85 000009BE 7504                <2>     jne  .keep_zt              ; AL==0 -> bereits 0-terminiert
    86 000009C0 C644FF00            <2>     mov  byte [si-1], 0        ; letztes gelesenes Zeichen (Leerzeichen) überschreiben
    87                              <2>     .keep_zt:
    88 000009C4 89D6                <2>     mov  si, dx                ; SI = Start des Tokens
    89 000009C6 F8                  <2>     clc
    90 000009C7 EB03                <2>     jmp  .ret
    91                              <2> 
    92                              <2>     .not_found:
    93 000009C9 31C9                <2>     xor  cx, cx
    94 000009CB F9                  <2>     stc
    95                              <2> 
    96                              <2>     .ret:
    97                              <2>     ;pop  di
    98 000009CC C3                  <2>     ret
  1423                              <1> %include 'ConsoleCursor.asm'        ; set the teletype video text cursor
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ConsoleCursor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> dos_set_cursor:
    11 000009CD 8816(0202)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    12 000009D1 8836(0302)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    13                              <2>     ;---
    14 000009D5 B700                <2>     mov  bh, 0                   ; todo
    15 000009D7 883E(0402)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    16                              <2>     ;---
    17 000009DB B402                <2>     mov  ah, 02h
    18                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000009DD CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    19 000009DF C3                  <2>     ret
    20                              <2> 
    21                              <2> dos_get_cursor:
    22 000009E0 57                  <2>     push di
    23 000009E1 56                  <2>     push si
    24 000009E2 53                  <2>     push bx
    25 000009E3 52                  <2>     push dx
    26                              <2>     
    27 000009E4 B700                <2>     mov  bh, 0                   ; todo
    28 000009E6 B403                <2>     mov  ah, 0x03
    29                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 000009E8 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    30 000009EA 8816(0202)          <2>     mov  [PTR16(dos_xpos)], dl   ; column
    31 000009EE 8836(0302)          <2>     mov  [PTR16(dos_ypos)], dh   ; row
    32 000009F2 883E(0402)          <2>     mov  [PTR16(dos_page)], bh   ; video page
    33                              <2>     
    34 000009F6 5A                  <2>     pop  dx
    35 000009F7 5B                  <2>     pop  bx
    36 000009F8 5E                  <2>     pop  si
    37 000009F9 5F                  <2>     pop  di
    38 000009FA C3                  <2>     ret
  1424                              <1> %include 'ErrorCodes.asm'           ; get last error
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ErrorCodes.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief dispatch: search the handler and jump to it ...
    11                              <2> ; -----------------------------------------------------------------------------
    12                              <2> DOS_handle_error_code:
    13                              <2>     ; AX enthält den DOS-Fehlercode
    14 000009FB 89C3                <2>     mov   bx, ax             ; bx = gesuchter Code
    15 000009FD BE[6107]            <2>     mov   si, _cA_error_dispatch
    16                              <2>     .next:
    17 00000A00 AD                  <2>     lodsw                    ; ax = Tabellencode, si zeigt nun auf Handler-Wort
    18 00000A01 85C0                <2>     test  ax, ax
    19 00000A03 740B                <2>     jz    .default           ; 0 -> Ende: Default
    20 00000A05 39D8                <2>     cmp   ax, bx
    21 00000A07 7405                <2>     je    .match
    22 00000A09 83C602              <2>     add   si, 2              ; Handlerwort überspringen
    23 00000A0C EBF2                <2>     jmp   .next
    24                              <2>     .match:
    25 00000A0E FF24                <2>     jmp   word [si]          ; indirekter Sprung zum Handler
    26                              <2>     .default:
    27 00000A10 E9(AA04)            <2>     jmp   _cA_open_error_nd
    28                              <2>     
    29                              <2>     ; ----------------------------------------
    30                              <2>     ; Handler minimal & einheitlich per Makro
    31                              <2>     ; ----------------------------------------
    32                              <2>     DEF_ERROR 01h, open_error_01    ; ungültige Funktiob
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A13 B31E                <4>  mov bl, %2
  1390 00000A15 B8(B905)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A18 89C6                <4>  mov si, ax
  1392 00000A1A E81704              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A1D B90100              <3>  mov cx, %1
  1631 00000A20 E91703              <3>  jmp _open_exit
    33                              <2>     DEF_ERROR 02h, open_error_02
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A23 B31E                <4>  mov bl, %2
  1390 00000A25 B8(DB05)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A28 89C6                <4>  mov si, ax
  1392 00000A2A E80704              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A2D B90200              <3>  mov cx, %1
  1631 00000A30 E90703              <3>  jmp _open_exit
    34                              <2>     DEF_ERROR 03h, open_error_03
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A33 B31E                <4>  mov bl, %2
  1390 00000A35 B8(EB05)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A38 89C6                <4>  mov si, ax
  1392 00000A3A E8F703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A3D B90300              <3>  mov cx, %1
  1631 00000A40 E9F702              <3>  jmp _open_exit
    35                              <2>     DEF_ERROR 04h, open_error_04
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A43 B31E                <4>  mov bl, %2
  1390 00000A45 B8(FB05)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A48 89C6                <4>  mov si, ax
  1392 00000A4A E8E703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A4D B90400              <3>  mov cx, %1
  1631 00000A50 E9E702              <3>  jmp _open_exit
    36                              <2>     DEF_ERROR 05h, open_error_05
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A53 B31E                <4>  mov bl, %2
  1390 00000A55 B8(1006)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A58 89C6                <4>  mov si, ax
  1392 00000A5A E8D703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A5D B90500              <3>  mov cx, %1
  1631 00000A60 E9D702              <3>  jmp _open_exit
    37                              <2>     DEF_ERROR 06h, open_error_06    ; ungültiger Handle
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A63 B31E                <4>  mov bl, %2
  1390 00000A65 B8(1F06)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A68 89C6                <4>  mov si, ax
  1392 00000A6A E8C703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A6D B90600              <3>  mov cx, %1
  1631 00000A70 E9C702              <3>  jmp _open_exit
    38                              <2>     DEF_ERROR 07h, open_error_07    ; korrupte Speicherverwaltung
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A73 B31E                <4>  mov bl, %2
  1390 00000A75 B8(3306)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A78 89C6                <4>  mov si, ax
  1392 00000A7A E8B703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A7D B90700              <3>  mov cx, %1
  1631 00000A80 E9B702              <3>  jmp _open_exit
    39                              <2>     DEF_ERROR 08h, open_error_08    ; nicht genügend Speicher
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A83 B31E                <4>  mov bl, %2
  1390 00000A85 B8(4806)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A88 89C6                <4>  mov si, ax
  1392 00000A8A E8A703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A8D B90800              <3>  mov cx, %1
  1631 00000A90 E9A702              <3>  jmp _open_exit
    40                              <2>     DEF_ERROR 09h, open_error_09
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000A93 B31E                <4>  mov bl, %2
  1390 00000A95 B8(5806)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000A98 89C6                <4>  mov si, ax
  1392 00000A9A E89703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000A9D B90900              <3>  mov cx, %1
  1631 00000AA0 E99702              <3>  jmp _open_exit
    41                              <2>     DEF_ERROR 0Ah, open_error_0A
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AA3 B31E                <4>  mov bl, %2
  1390 00000AA5 B8(7006)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AA8 89C6                <4>  mov si, ax
  1392 00000AAA E88703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000AAD B90A00              <3>  mov cx, %1
  1631 00000AB0 E98702              <3>  jmp _open_exit
    42                              <2>     DEF_ERROR 0Bh, open_error_0B
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AB3 B31E                <4>  mov bl, %2
  1390 00000AB5 B8(8506)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AB8 89C6                <4>  mov si, ax
  1392 00000ABA E87703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000ABD B90B00              <3>  mov cx, %1
  1631 00000AC0 E97702              <3>  jmp _open_exit
    43                              <2>     DEF_ERROR 0Ch, open_error_0C
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AC3 B31E                <4>  mov bl, %2
  1390 00000AC5 B8(9C06)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AC8 89C6                <4>  mov si, ax
  1392 00000ACA E86703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000ACD B90C00              <3>  mov cx, %1
  1631 00000AD0 E96702              <3>  jmp _open_exit
    44                              <2>     DEF_ERROR 0Dh, open_error_0D
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AD3 B31E                <4>  mov bl, %2
  1390 00000AD5 B8(B206)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AD8 89C6                <4>  mov si, ax
  1392 00000ADA E85703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000ADD B90D00              <3>  mov cx, %1
  1631 00000AE0 E95702              <3>  jmp _open_exit
    45                              <2>     DEF_ERROR 0Eh, open_error_0E
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AE3 B31E                <4>  mov bl, %2
  1390 00000AE5 B8(D106)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AE8 89C6                <4>  mov si, ax
  1392 00000AEA E84703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000AED B90E00              <3>  mov cx, %1
  1631 00000AF0 E94702              <3>  jmp _open_exit
    46                              <2>     DEF_ERROR 0Fh, open_error_0F
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000AF3 B31E                <4>  mov bl, %2
  1390 00000AF5 B8(E706)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000AF8 89C6                <4>  mov si, ax
  1392 00000AFA E83703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000AFD B90F00              <3>  mov cx, %1
  1631 00000B00 E93702              <3>  jmp _open_exit
    47                              <2>     DEF_ERROR 10h, open_error_10
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B03 B31E                <4>  mov bl, %2
  1390 00000B05 B8(F606)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B08 89C6                <4>  mov si, ax
  1392 00000B0A E82703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B0D B91000              <3>  mov cx, %1
  1631 00000B10 E92702              <3>  jmp _open_exit
    48                              <2>     DEF_ERROR 11h, open_error_11
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B13 B31E                <4>  mov bl, %2
  1390 00000B15 B8(1907)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B18 89C6                <4>  mov si, ax
  1392 00000B1A E81703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B1D B91100              <3>  mov cx, %1
  1631 00000B20 E91702              <3>  jmp _open_exit
    49                              <2>     DEF_ERROR 12h, open_error_12
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B23 B31E                <4>  mov bl, %2
  1390 00000B25 B8(2E07)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B28 89C6                <4>  mov si, ax
  1392 00000B2A E80703              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B2D B91200              <3>  mov cx, %1
  1631 00000B30 E90702              <3>  jmp _open_exit
    50                              <2>     DEF_ERROR 15h, open_error_15
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B33 B31E                <4>  mov bl, %2
  1390 00000B35 B8(5107)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B38 89C6                <4>  mov si, ax
  1392 00000B3A E8F702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B3D B91500              <3>  mov cx, %1
  1631 00000B40 E9F701              <3>  jmp _open_exit
    51                              <2>     DEF_ERROR 1Dh, open_error_1D    ; Seek-Fehler
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B43 B31E                <4>  mov bl, %2
  1390 00000B45 B8(6207)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B48 89C6                <4>  mov si, ax
  1392 00000B4A E8E702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B4D B91D00              <3>  mov cx, %1
  1631 00000B50 E9E701              <3>  jmp _open_exit
    52                              <2>     DEF_ERROR 1Eh, open_error_1E    ; kein DOS-Datenträger
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B53 B31E                <4>  mov bl, %2
  1390 00000B55 B8(7F07)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B58 89C6                <4>  mov si, ax
  1392 00000B5A E8D702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B5D B91E00              <3>  mov cx, %1
  1631 00000B60 E9D701              <3>  jmp _open_exit
    53                              <2>     DEF_ERROR 1Fh, open_error_1F
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B63 B31E                <4>  mov bl, %2
  1390 00000B65 B8(8B07)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B68 89C6                <4>  mov si, ax
  1392 00000B6A E8C702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B6D B91F00              <3>  mov cx, %1
  1631 00000B70 E9C701              <3>  jmp _open_exit
    54                              <2>     DEF_ERROR 20h, open_error_20
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B73 B31E                <4>  mov bl, %2
  1390 00000B75 B8(A007)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B78 89C6                <4>  mov si, ax
  1392 00000B7A E8B702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B7D B92000              <3>  mov cx, %1
  1631 00000B80 E9B701              <3>  jmp _open_exit
    55                              <2>     DEF_ERROR 21h, open_error_21
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B83 B31E                <4>  mov bl, %2
  1390 00000B85 B8(B807)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B88 89C6                <4>  mov si, ax
  1392 00000B8A E8A702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B8D B92100              <3>  mov cx, %1
  1631 00000B90 E9A701              <3>  jmp _open_exit
    56                              <2>     DEF_ERROR 27h, open_error_27
  1628                              <3> _h%1:
  1629                              <3>  PUTS_COLOR %2, ATTR_DOS_ERROR
  1350                              <4> %if DOS_SHELL == 1
  1351                              <4> 
  1352                              <4>  %ifstr %1
  1353                              <4>  section .data
  1354                              <4>  %%msg: db %1, 0
  1355                              <4>  section .text
  1356                              <4>  xor bx, bx
  1357                              <4>  mov bl, %2
  1358                              <4>  mov si, PTR16(%%msg)
  1359                              <4>  call PutStrColor
  1360                              <4>  %elifidni %1, SI
  1361                              <4>  section .text
  1362                              <4>  mov bl, %2
  1363                              <4>  call PutStrColor
  1364                              <4>  %elifidni %1, DI
  1365                              <4>  section .text
  1366                              <4>  mov bl, %2
  1367                              <4>  call PutStrColor
  1368                              <4>  %else
  1369                              <4>  %assign __count 0
  1370                              <4>  %assign __varg 0
  1371                              <4>  %assign __stop 0
  1372                              <4>  %rep MAX_ARGV
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1380                              <4>  %endrep
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1381                              <4>  %if __varg > 0
  1382                              <4>  section .text
  1383                              <4>  mov si, PTR16(_cA_cmd_buf)
  1384                              <4>  mov bl, __varg
  1385                              <4>  call getCommandLine_Arg
  1386                              <4>  call PutStrColor
  1387                              <4>  %else
  1388                              <4>  section .text
  1389 00000B93 B31E                <4>  mov bl, %2
  1390 00000B95 B8(C907)            <4>  mov ax, PTR16(_cA_%1)
  1391 00000B98 89C6                <4>  mov si, ax
  1392 00000B9A E89702              <4>  call PutStrColor
  1393                              <4>  %endif
  1394                              <4>  %undef __varg
  1395                              <4>  %endif
  1396                              <4> %else
  1397                              <4>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <4> %endif
  1630 00000B9D B92700              <3>  mov cx, %1
  1631 00000BA0 E99701              <3>  jmp _open_exit
    57                              <2> 
    58                              <2>     ERR_HANDLER 0x01, 0x02, 0x03, 0x04
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BA3 B31E                <5>  mov bl, %2
  1390 00000BA5 B8(B905)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BA8 89C6                <5>  mov si, ax
  1392 00000BAA E88702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BAD B90100              <4>  mov cx, %1
  1741 00000BB0 E98701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BB3 B31E                <5>  mov bl, %2
  1390 00000BB5 B8(DB05)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BB8 89C6                <5>  mov si, ax
  1392 00000BBA E87702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BBD B90200              <4>  mov cx, %1
  1741 00000BC0 E97701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BC3 B31E                <5>  mov bl, %2
  1390 00000BC5 B8(EB05)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BC8 89C6                <5>  mov si, ax
  1392 00000BCA E86702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BCD B90300              <4>  mov cx, %1
  1741 00000BD0 E96701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BD3 B31E                <5>  mov bl, %2
  1390 00000BD5 B8(FB05)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BD8 89C6                <5>  mov si, ax
  1392 00000BDA E85702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BDD B90400              <4>  mov cx, %1
  1741 00000BE0 E95701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    59                              <2>     ERR_HANDLER 0x05, 0x06, 0x07, 0x08
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BE3 B31E                <5>  mov bl, %2
  1390 00000BE5 B8(1006)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BE8 89C6                <5>  mov si, ax
  1392 00000BEA E84702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BED B90500              <4>  mov cx, %1
  1741 00000BF0 E94701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000BF3 B31E                <5>  mov bl, %2
  1390 00000BF5 B8(1F06)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000BF8 89C6                <5>  mov si, ax
  1392 00000BFA E83702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000BFD B90600              <4>  mov cx, %1
  1741 00000C00 E93701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C03 B31E                <5>  mov bl, %2
  1390 00000C05 B8(3306)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C08 89C6                <5>  mov si, ax
  1392 00000C0A E82702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C0D B90700              <4>  mov cx, %1
  1741 00000C10 E92701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C13 B31E                <5>  mov bl, %2
  1390 00000C15 B8(4806)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C18 89C6                <5>  mov si, ax
  1392 00000C1A E81702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C1D B90800              <4>  mov cx, %1
  1741 00000C20 E91701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    60                              <2>     ERR_HANDLER 0x09, 0x0A, 0x0B, 0x0C
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C23 B31E                <5>  mov bl, %2
  1390 00000C25 B8(5806)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C28 89C6                <5>  mov si, ax
  1392 00000C2A E80702              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C2D B90900              <4>  mov cx, %1
  1741 00000C30 E90701              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C33 B31E                <5>  mov bl, %2
  1390 00000C35 B8(7006)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C38 89C6                <5>  mov si, ax
  1392 00000C3A E8F701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C3D B90A00              <4>  mov cx, %1
  1741 00000C40 E9F700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C43 B31E                <5>  mov bl, %2
  1390 00000C45 B8(8506)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C48 89C6                <5>  mov si, ax
  1392 00000C4A E8E701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C4D B90B00              <4>  mov cx, %1
  1741 00000C50 E9E700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C53 B31E                <5>  mov bl, %2
  1390 00000C55 B8(9C06)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C58 89C6                <5>  mov si, ax
  1392 00000C5A E8D701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C5D B90C00              <4>  mov cx, %1
  1741 00000C60 E9D700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    61                              <2>     ERR_HANDLER 0x0D, 0x0E, 0x0F, 0x10
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C63 B31E                <5>  mov bl, %2
  1390 00000C65 B8(B206)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C68 89C6                <5>  mov si, ax
  1392 00000C6A E8C701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C6D B90D00              <4>  mov cx, %1
  1741 00000C70 E9C700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C73 B31E                <5>  mov bl, %2
  1390 00000C75 B8(D106)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C78 89C6                <5>  mov si, ax
  1392 00000C7A E8B701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C7D B90E00              <4>  mov cx, %1
  1741 00000C80 E9B700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C83 B31E                <5>  mov bl, %2
  1390 00000C85 B8(E706)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C88 89C6                <5>  mov si, ax
  1392 00000C8A E8A701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C8D B90F00              <4>  mov cx, %1
  1741 00000C90 E9A700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000C93 B31E                <5>  mov bl, %2
  1390 00000C95 B8(F606)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000C98 89C6                <5>  mov si, ax
  1392 00000C9A E89701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000C9D B91000              <4>  mov cx, %1
  1741 00000CA0 E99700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    62                              <2>     ERR_HANDLER 0x11, 0x12, 0x15
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CA3 B31E                <5>  mov bl, %2
  1390 00000CA5 B8(1907)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CA8 89C6                <5>  mov si, ax
  1392 00000CAA E88701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CAD B91100              <4>  mov cx, %1
  1741 00000CB0 E98700              <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CB3 B31E                <5>  mov bl, %2
  1390 00000CB5 B8(2E07)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CB8 89C6                <5>  mov si, ax
  1392 00000CBA E87701              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CBD B91200              <4>  mov cx, %1
  1741 00000CC0 EB78                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CC2 B31E                <5>  mov bl, %2
  1390 00000CC4 B8(5107)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CC7 89C6                <5>  mov si, ax
  1392 00000CC9 E86801              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CCC B91500              <4>  mov cx, %1
  1741 00000CCF EB69                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    63                              <2>     ERR_HANDLER 0x1D, 0x1E, 0x1F, 0x20
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CD1 B31E                <5>  mov bl, %2
  1390 00000CD3 B8(6207)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CD6 89C6                <5>  mov si, ax
  1392 00000CD8 E85901              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CDB B91D00              <4>  mov cx, %1
  1741 00000CDE EB5A                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CE0 B31E                <5>  mov bl, %2
  1390 00000CE2 B8(7F07)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CE5 89C6                <5>  mov si, ax
  1392 00000CE7 E84A01              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CEA B91E00              <4>  mov cx, %1
  1741 00000CED EB4B                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CEF B31E                <5>  mov bl, %2
  1390 00000CF1 B8(8B07)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000CF4 89C6                <5>  mov si, ax
  1392 00000CF6 E83B01              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000CF9 B91F00              <4>  mov cx, %1
  1741 00000CFC EB3C                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000CFE B31E                <5>  mov bl, %2
  1390 00000D00 B8(A007)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000D03 89C6                <5>  mov si, ax
  1392 00000D05 E82C01              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000D08 B92000              <4>  mov cx, %1
  1741 00000D0B EB2D                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    64                              <2>     ERR_HANDLER 0x21
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000D0D B31E                <5>  mov bl, %2
  1390 00000D0F B8(B807)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000D12 89C6                <5>  mov si, ax
  1392 00000D14 E81D01              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000D17 B92100              <4>  mov cx, %1
  1741 00000D1A EB1E                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    65                              <2>     ERR_HANDLER 0x27
  1727                              <3> %rep %0
  1728                              <3> 
  1729                              <3>  %assign __v %1
  1730                              <3>  %assign __v __v & 0FFh
  1731                              <3> 
  1732                              <3> 
  1733                              <3>  %assign __hi (__v >> 4) & 0Fh
  1734                              <3>  %assign __lo __v & 0Fh
  1735                              <3>  _HEXDIG __hi, __H
  1736                              <3>  _HEXDIG __lo, __L
  1737                              <3> 
  1738                              <3> _cA_errh%+__H%+__L:
  1739                              <3>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1740                              <3>  mov cx, %1
  1741                              <3>  jmp _open_exit
  1742                              <3> 
  1743                              <3> 
  1744                              <3>  %undef __H
  1745                              <3>  %undef __L
  1746                              <3>  %undef __hi
  1747                              <3>  %undef __lo
  1748                              <3>  %undef __v
  1749                              <3> 
  1750                              <3>  %rotate 1
  1751                              <3> %endrep
  1728                              <4> 
  1729                              <4>  %assign __v %1
  1730                              <4>  %assign __v __v & 0FFh
  1731                              <4> 
  1732                              <4> 
  1733                              <4>  %assign __hi (__v >> 4) & 0Fh
  1734                              <4>  %assign __lo __v & 0Fh
  1735                              <4>  _HEXDIG __hi, __H
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1736                              <4>  _HEXDIG __lo, __L
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1737                              <4> 
  1738                              <4> _cA_errh%+__H%+__L:
  1739                              <4>  PUTS_COLOR open_error_%+__H%+__L, ATTR_DOS_ERROR
  1350                              <5> %if DOS_SHELL == 1
  1351                              <5> 
  1352                              <5>  %ifstr %1
  1353                              <5>  section .data
  1354                              <5>  %%msg: db %1, 0
  1355                              <5>  section .text
  1356                              <5>  xor bx, bx
  1357                              <5>  mov bl, %2
  1358                              <5>  mov si, PTR16(%%msg)
  1359                              <5>  call PutStrColor
  1360                              <5>  %elifidni %1, SI
  1361                              <5>  section .text
  1362                              <5>  mov bl, %2
  1363                              <5>  call PutStrColor
  1364                              <5>  %elifidni %1, DI
  1365                              <5>  section .text
  1366                              <5>  mov bl, %2
  1367                              <5>  call PutStrColor
  1368                              <5>  %else
  1369                              <5>  %assign __count 0
  1370                              <5>  %assign __varg 0
  1371                              <5>  %assign __stop 0
  1372                              <5>  %rep MAX_ARGV
  1373                              <5>  %if __stop == 0
  1374                              <5>  %assign __count (__count + 1)
  1375                              <5>  %ifidni %1, ARGV_%+__count
  1376                              <5>  %assign __varg __count
  1377                              <5>  %assign __stop 1
  1378                              <5>  %endif
  1379                              <5>  %endif
  1380                              <5>  %endrep
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1373                              <6>  %if __stop == 0
  1374                              <6>  %assign __count (__count + 1)
  1375                              <6>  %ifidni %1, ARGV_%+__count
  1376                              <6>  %assign __varg __count
  1377                              <6>  %assign __stop 1
  1378                              <6>  %endif
  1379                              <6>  %endif
  1381                              <5>  %if __varg > 0
  1382                              <5>  section .text
  1383                              <5>  mov si, PTR16(_cA_cmd_buf)
  1384                              <5>  mov bl, __varg
  1385                              <5>  call getCommandLine_Arg
  1386                              <5>  call PutStrColor
  1387                              <5>  %else
  1388                              <5>  section .text
  1389 00000D1C B31E                <5>  mov bl, %2
  1390 00000D1E B8(C907)            <5>  mov ax, PTR16(_cA_%1)
  1391 00000D21 89C6                <5>  mov si, ax
  1392 00000D23 E80E01              <5>  call PutStrColor
  1393                              <5>  %endif
  1394                              <5>  %undef __varg
  1395                              <5>  %endif
  1396                              <5> %else
  1397                              <5>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <5> %endif
  1740 00000D26 B92700              <4>  mov cx, %1
  1741 00000D29 EB0F                <4>  jmp _open_exit
  1742                              <4> 
  1743                              <4> 
  1744                              <4>  %undef __H
  1745                              <4>  %undef __L
  1746                              <4>  %undef __hi
  1747                              <4>  %undef __lo
  1748                              <4>  %undef __v
  1749                              <4> 
  1750                              <4>  %rotate 1
    66                              <2> 
    67                              <2> _cA_errhnd:
    68                              <2>     PUTS_COLOR open_error_nd, ATTR_DOS_ERROR
  1350                              <3> %if DOS_SHELL == 1
  1351                              <3> 
  1352                              <3>  %ifstr %1
  1353                              <3>  section .data
  1354                              <3>  %%msg: db %1, 0
  1355                              <3>  section .text
  1356                              <3>  xor bx, bx
  1357                              <3>  mov bl, %2
  1358                              <3>  mov si, PTR16(%%msg)
  1359                              <3>  call PutStrColor
  1360                              <3>  %elifidni %1, SI
  1361                              <3>  section .text
  1362                              <3>  mov bl, %2
  1363                              <3>  call PutStrColor
  1364                              <3>  %elifidni %1, DI
  1365                              <3>  section .text
  1366                              <3>  mov bl, %2
  1367                              <3>  call PutStrColor
  1368                              <3>  %else
  1369                              <3>  %assign __count 0
  1370                              <3>  %assign __varg 0
  1371                              <3>  %assign __stop 0
  1372                              <3>  %rep MAX_ARGV
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1380                              <3>  %endrep
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1381                              <3>  %if __varg > 0
  1382                              <3>  section .text
  1383                              <3>  mov si, PTR16(_cA_cmd_buf)
  1384                              <3>  mov bl, __varg
  1385                              <3>  call getCommandLine_Arg
  1386                              <3>  call PutStrColor
  1387                              <3>  %else
  1388                              <3>  section .text
  1389 00000D2B B31E                <3>  mov bl, %2
  1390 00000D2D B8(AA05)            <3>  mov ax, PTR16(_cA_%1)
  1391 00000D30 89C6                <3>  mov si, ax
  1392 00000D32 E8FF00              <3>  call PutStrColor
  1393                              <3>  %endif
  1394                              <3>  %undef __varg
  1395                              <3>  %endif
  1396                              <3> %else
  1397                              <3>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <3> %endif
    69 00000D35 B92000              <2>     mov   cx, 32
    70 00000D38 EB00                <2>     jmp _open_exit
    71                              <2> 
    72                              <2> _open_exit:
    73                              <2>     DOS_Exit cx
  1424                              <3> %if DOS_SHELL == 1
  1425                              <3>  %ifidni %1, ax
  1426                              <3>  EMIT_ERROR 'AX not allowed here.'
  1427                              <3>  %elifidni %1, bx
  1428                              <3>  mov ax, 0x4C00
  1429                              <3>  or ax, bx
  1430                              <3>  SysCall
  1431                              <3>  %elifidni %1, CX
  1432 00000D3A B8004C              <3>  mov ax, 0x4C00
  1433 00000D3D 09C8                <3>  or ax, cx
  1434                              <3>  SysCall
   133                              <4> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000D3F CD21                <4>  int 0x21
   135                              <4> %else
   136                              <4>  EMIT_ERROR 'todo: windows'
   137                              <4> %endif
  1435                              <3>  %elifidni %1, dx
  1436                              <3>  mov ax, 0x4C00
  1437                              <3>  or ax, dx
  1438                              <3>  SysCall
  1439                              <3>  %elifnum %1
  1440                              <3>  mov ax, 0x4C00 | %1
  1441                              <3>  SysCall
  1442                              <3>  %else
  1443                              <3>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <3>  %endif
  1445                              <3> %endif
  1425                              <1> %include 'InitConsole.asm'          ; initialize the DOS console
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  InitConsole.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> dos_init_console:
    10 00000D41 E80A00              <2>     call dos_get_cols               ; get DOS screen columns
    11 00000D44 E80E00              <2>     call dos_get_rows               ; get DOS screen rows
    12                              <2>     
    13                              <2>     SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 00000D47 E85101              <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
    14                              <2>     
    15 00000D4A E81600              <2>     call dos_get_command_line
    16 00000D4D C3                  <2>     ret
    17                              <2> 
    18                              <2> ; -----------------------------------------------------------------------------
    19                              <2> ; \brief get DOS screen columns
    20                              <2> ; -----------------------------------------------------------------------------
    21                              <2> dos_get_cols:
    22 00000D4E B40F                <2>     mov  ah, 0Fh
    23                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000D50 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    24                              <2>     ; AL = aktueller Videomodus
    25                              <2>     ; AH = Spaltenzahl
    26                              <2>     ; BH = aktive Seite
    27 00000D52 88E3                <2>     mov  bl, ah           ; BL = Spalten
    28 00000D54 C3                  <2>     ret
    29                              <2> 
    30                              <2> ; -----------------------------------------------------------------------------
    31                              <2> ; \brief get DOS screen rows
    32                              <2> ; -----------------------------------------------------------------------------
    33                              <2> dos_get_rows:
    34 00000D55 B83011              <2>     mov  ax, 1130h
    35 00000D58 B700                <2>     mov  bh, 00h          ; aktuelle Font/Block
    36                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000D5A CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    37 00000D5C 88D2                <2>     mov  dl, dl           ; DL = Zeilen-1
    38 00000D5E FEC2                <2>     inc  dl               ; DL = Zeilen
    39 00000D60 88D7                <2>     mov  bh, dl           ; BH = Zeilen
    40 00000D62 C3                  <2>     ret
    41                              <2> 
    42                              <2> ; -----------------------------------------------------------------------------
    43                              <2> ; \brief DOS - get command line arguments from PSP ...
    44                              <2> ; -----------------------------------------------------------------------------
    45                              <2> dos_get_command_line:
    46 00000D63 31C0                <2>     xor  ax, ax
    47 00000D65 BE8100              <2>     mov  si, 81h          ; SI -> Beginn der Kommandozeile im PSP
    48 00000D68 8A0E8000            <2>     mov  cl, [80h]        ; CL = Länge
    49 00000D6C 30ED                <2>     xor  ch, ch           ; CX = Länge
    50                              <2> 
    51 00000D6E E320                <2>     jcxz .no_args       ; nichts übergeben?
    52                              <2>     ; Zielpuffer vorbereiten
    53 00000D70 BF(C204)            <2>     mov  di, PTR16(_cA_cmd_buf) ; DI -> Ziel
    54                              <2>     .copy:
    55 00000D73 AC                  <2>     lodsb                 ; AL = [DS:SI], SI++
    56 00000D74 3C0D                <2>     cmp   al, 0x0D        ; CR markiert das Ende (Sicherheit)
    57 00000D76 7403                <2>     je   .done_copy
    58 00000D78 AA                  <2>     stosb                 ; [ES:DI]=AL (ES=DS in .COM), DI++
    59 00000D79 E2F8                <2>     loop .copy
    60                              <2> 
    61                              <2>     .done_copy:
    62 00000D7B B000                <2>     mov  al, 0
    63 00000D7D AA                  <2>     stosb
    64                              <2>     
    65                              <2>     ; Trim: nachlaufende Spaces entfernen
    66                              <2>     .trim:
    67 00000D7E 81FF(C204)          <2>     cmp  di, PTR16(_cA_cmd_buf)
    68 00000D82 7607                <2>     jbe  .make_dos_str
    69 00000D84 4F                  <2>     dec  di
    70 00000D85 803D20              <2>     cmp  byte [di], ' '
    71 00000D88 74F4                <2>     je   .trim
    72 00000D8A 47                  <2>     inc  di
    73                              <2> 
    74                              <2>     .make_dos_str:
    75 00000D8B C60500              <2>     mov  byte [di], 0     ; für DOS-Funktion 09h Stringabschluss
    76 00000D8E EB20                <2>     jmp  .next
    77                              <2>     
    78                              <2>     .no_args:
    79                              <2>     SCREEN_CLEAR
  1281                              <3> %if DOS_SHELL == 1
  1282 00000D90 E80801              <3>  call dos_screen_clear
  1283                              <3> %else
  1284                              <3>  GET_CON_O_HANDLE r12
  1285                              <3>  STRCPY_ANSI buffer_B, consoleColor_3, empty
  1286                              <3>  WRITE_CON_A buffer_B
  1287                              <3> %endif
    80                              <2>     SET_CURSOR 0, 1
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000D93 B200                <3>  mov dl, %1
  1301 00000D95 B601                <3>  mov dh, %2
  1302 00000D97 E833FC              <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    81                              <2>     PUTS_COLOR noargs_msg, 0x02 | 0x10
  1350                              <3> %if DOS_SHELL == 1
  1351                              <3> 
  1352                              <3>  %ifstr %1
  1353                              <3>  section .data
  1354                              <3>  %%msg: db %1, 0
  1355                              <3>  section .text
  1356                              <3>  xor bx, bx
  1357                              <3>  mov bl, %2
  1358                              <3>  mov si, PTR16(%%msg)
  1359                              <3>  call PutStrColor
  1360                              <3>  %elifidni %1, SI
  1361                              <3>  section .text
  1362                              <3>  mov bl, %2
  1363                              <3>  call PutStrColor
  1364                              <3>  %elifidni %1, DI
  1365                              <3>  section .text
  1366                              <3>  mov bl, %2
  1367                              <3>  call PutStrColor
  1368                              <3>  %else
  1369                              <3>  %assign __count 0
  1370                              <3>  %assign __varg 0
  1371                              <3>  %assign __stop 0
  1372                              <3>  %rep MAX_ARGV
  1373                              <3>  %if __stop == 0
  1374                              <3>  %assign __count (__count + 1)
  1375                              <3>  %ifidni %1, ARGV_%+__count
  1376                              <3>  %assign __varg __count
  1377                              <3>  %assign __stop 1
  1378                              <3>  %endif
  1379                              <3>  %endif
  1380                              <3>  %endrep
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1373                              <4>  %if __stop == 0
  1374                              <4>  %assign __count (__count + 1)
  1375                              <4>  %ifidni %1, ARGV_%+__count
  1376                              <4>  %assign __varg __count
  1377                              <4>  %assign __stop 1
  1378                              <4>  %endif
  1379                              <4>  %endif
  1381                              <3>  %if __varg > 0
  1382                              <3>  section .text
  1383                              <3>  mov si, PTR16(_cA_cmd_buf)
  1384                              <3>  mov bl, __varg
  1385                              <3>  call getCommandLine_Arg
  1386                              <3>  call PutStrColor
  1387                              <3>  %else
  1388                              <3>  section .text
  1389 00000D9A B312                <3>  mov bl, %2
  1390 00000D9C B8(7105)            <3>  mov ax, PTR16(_cA_%1)
  1391 00000D9F 89C6                <3>  mov si, ax
  1392 00000DA1 E89000              <3>  call PutStrColor
  1393                              <3>  %endif
  1394                              <3>  %undef __varg
  1395                              <3>  %endif
  1396                              <3> %else
  1397                              <3>  EMIT_ERROR 'this macro is only for DOS programming.'
  1398                              <3> %endif
    82                              <2>     SET_CURSOR 0, 2
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000DA4 B200                <3>  mov dl, %1
  1301 00000DA6 B602                <3>  mov dh, %2
  1302 00000DA8 E822FC              <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    83                              <2>     DOS_Exit   0          ; exit - no args.
  1424                              <3> %if DOS_SHELL == 1
  1425                              <3>  %ifidni %1, ax
  1426                              <3>  EMIT_ERROR 'AX not allowed here.'
  1427                              <3>  %elifidni %1, bx
  1428                              <3>  mov ax, 0x4C00
  1429                              <3>  or ax, bx
  1430                              <3>  SysCall
  1431                              <3>  %elifidni %1, CX
  1432                              <3>  mov ax, 0x4C00
  1433                              <3>  or ax, cx
  1434                              <3>  SysCall
  1435                              <3>  %elifidni %1, dx
  1436                              <3>  mov ax, 0x4C00
  1437                              <3>  or ax, dx
  1438                              <3>  SysCall
  1439                              <3>  %elifnum %1
  1440 00000DAB B8004C              <3>  mov ax, 0x4C00 | %1
  1441                              <3>  SysCall
   133                              <4> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000DAE CD21                <4>  int 0x21
   135                              <4> %else
   136                              <4>  EMIT_ERROR 'todo: windows'
   137                              <4> %endif
  1442                              <3>  %else
  1443                              <3>  EMIT_ERROR 'BX, CX, DX or <NUM> expected.'
  1444                              <3>  %endif
  1445                              <3> %endif
    84                              <2>     
    85                              <2>     .next:
    86                              <2>     SET_CURSOR 0, 0
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000DB0 B200                <3>  mov dl, %1
  1301 00000DB2 B600                <3>  mov dh, %2
  1302 00000DB4 E816FC              <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    87 00000DB7 C3                  <2>     ret
  1426                              <1> %include 'Int16ToStr.asm'           ; convert integer number to string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Int16ToStr.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; ----------------------------------------------------------------------------
    11                              <2> ; \brief  convert number from AX register to a string.
    12                              <2> ; \param  AX: 16-Bit value
    13                              <2> ; \param  DI: destination buffer
    14                              <2> ; \return ASCII-decimal without trailing zeros.
    15                              <2> ;         (min. onr digit, and '0' at end.
    16                              <2> ;
    17                              <2> ; \note   destroy's: AX,BX,CX,DX (internal saved)
    18                              <2> ; \note   buffer: max. 5 digits + '$' => min. 6 bytes
    19                              <2> ; ----------------------------------------------------------------------------
    20                              <2> DOSIntToStr:
    21 00000DB8 50                  <2>     push ax
    22 00000DB9 53                  <2>     push bx
    23 00000DBA 51                  <2>     push cx
    24 00000DBB 52                  <2>     push dx
    25 00000DBC 57                  <2>     push di
    26                              <2> 
    27 00000DBD BB0A00              <2>     mov bx, 10
    28 00000DC0 31C9                <2>     xor cx, cx                 ; Zähler für gepushte Reste
    29                              <2> 
    30 00000DC2 83F800              <2>     cmp ax, 0
    31 00000DC5 7506                <2>     jne .div_loop
    32 00000DC7 C60530              <2>     mov byte [di], '0'
    33 00000DCA 47                  <2>     inc di
    34 00000DCB EB13                <2>     jmp short .finish
    35                              <2> 
    36                              <2>     .div_loop:
    37 00000DCD 31D2                <2>     xor dx, dx                 ; DX:AX / 10
    38 00000DCF F7F3                <2>     div bx                     ; AX = Quotient, DX = Rest (0..9)
    39 00000DD1 52                  <2>     push dx
    40 00000DD2 41                  <2>     inc cx
    41 00000DD3 85C0                <2>     test ax, ax
    42 00000DD5 75F6                <2>     jne .div_loop
    43                              <2> 
    44                              <2>     .write_loop:
    45 00000DD7 5A                  <2>     pop dx
    46 00000DD8 80C230              <2>     add dl, '0'
    47 00000DDB 8815                <2>     mov [di], dl
    48 00000DDD 47                  <2>     inc di
    49 00000DDE E2F7                <2>     loop .write_loop
    50                              <2> 
    51                              <2>     .finish:
    52 00000DE0 C60500              <2>     mov byte [di], 0x00
    53                              <2> 
    54 00000DE3 5F                  <2>     pop di
    55 00000DE4 5A                  <2>     pop dx
    56 00000DE5 59                  <2>     pop cx
    57 00000DE6 5B                  <2>     pop bx
    58 00000DE7 58                  <2>     pop ax
    59 00000DE8 C3                  <2>     ret
  1427                              <1> %include 'PutStrColor.asm'          ; put colored text onto the DOS screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  PutStrColor.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; --- String per BIOS-Teletype (AH=0Eh) ausgeben ---
    11                              <2> ; putc: AL -> Zeichen ausgeben
    12                              <2> putc:
    13 00000DE9 52                  <2>     push dx
    14 00000DEA 88C2                <2>     mov dl, al
    15 00000DEC B402                <2>     mov ah, 02h
    16                              <2>     SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000DEE CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
    17 00000DF0 5A                  <2>     pop dx
    18 00000DF1 C3                  <2>     ret
    19                              <2> 
    20                              <2> ; crlf: \r\n
    21                              <2> DOSrncrlf:
    22 00000DF2 B00D                <2>     mov al, 13
    23 00000DF4 E8F2FF              <2>     call putc
    24 00000DF7 B00A                <2>     mov al, 10
    25 00000DF9 E8EDFF              <2>     call putc
    26 00000DFC C3                  <2>     ret
    27                              <2> 
    28                              <2> DOSPutStrColor:
    29 00000DFD B409                <2>     mov  ah, 09h
    30                              <2>     SysCall
   133                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   134 00000DFF CD21                <3>  int 0x21
   135                              <3> %else
   136                              <3>  EMIT_ERROR 'todo: windows'
   137                              <3> %endif
    31 00000E01 C3                  <2>     ret
    32                              <2> 
    33                              <2> print_z:
    34 00000E02 52                  <2>     push dx             ; save DX
    35 00000E03 89D6                <2>     mov si, dx
    36                              <2>     .find_end:
    37 00000E05 AC                  <2>     lodsb               ; AL = [SI], SI++
    38 00000E06 3C00                <2>     cmp  al, 0
    39 00000E08 75FB                <2>     jne .find_end       ; repeat, till 0x00 is found
    40 00000E0A 4E                  <2>     dec si              ; SI points to 0x00
    41                              <2>     
    42 00000E0B B024                <2>     mov al, '$'         ; set DOS String end mark
    43 00000E0D 8804                <2>     mov [si], al        ; append AL
    44 00000E0F 46                  <2>     inc si
    45 00000E10 C60400              <2>     mov byte [si], 0    ; end of C-String
    46                              <2>     
    47 00000E13 8936(E316)          <2>     mov [PTR16(fdbuf)], si
    48                              <2>     DOS_Write fdbuf
  1463 00000E17 8D16(E316)          <3>  lea dx, [PTR16(_cA_%1)]
  1464 00000E1B E80200              <3>  call DOS_ConsoleWrite
    49 00000E1E 5A                  <2>     pop dx              ; restore DX
    50 00000E1F C3                  <2>     ret
    51                              <2> 
    52                              <2> ; DX -> 0-terminierte Zeichenkette
    53                              <2> DOS_ConsoleWrite:
    54 00000E20 50                  <2>     push ax
    55 00000E21 52                  <2>     push dx
    56 00000E22 56                  <2>     push si
    57 00000E23 89D6                <2>     mov si, dx
    58                              <2>     .print_z_loop:
    59 00000E25 AC                  <2>     lodsb
    60 00000E26 3C24                <2>     cmp al, '$'
    61 00000E28 7406                <2>     je .pe_done
    62 00000E2A E8BCFF              <2>     call putc
    63 00000E2D 46                  <2>     inc si
    64 00000E2E EBF5                <2>     jmp .print_z_loop
    65                              <2>     .pe_done:
    66 00000E30 5E                  <2>     pop si
    67 00000E31 5A                  <2>     pop dx
    68 00000E32 58                  <2>     pop ax
    69 00000E33 C3                  <2>     ret
    70                              <2> 
    71                              <2> PutStrColor:
    72 00000E34 53                  <2>     push bx
    73                              <2>     
    74 00000E35 8A3E(0102)          <2>     mov  bh, [PTR16(dos_readln_flag)]
    75 00000E39 80FF00              <2>     cmp  bh, 0
    76 00000E3C 7409                <2>     je   .no_length
    77 00000E3E 83C602              <2>     add  si, 2
    78 00000E41 B700                <2>     mov  bh, 0
    79 00000E43 883E(0102)          <2>     mov  [PTR16(dos_readln_flag)], bh
    80                              <2>     .no_length:
    81 00000E47 5B                  <2>     pop  bx
    82                              <2>     
    83 00000E48 8B16(0202)          <2>     mov  dx, [PTR16(dos_xpos)]
    84                              <2>     ; -------------------
    85                              <2>     .print_loop:
    86 00000E4C AC                  <2>     lodsb                ; AL := [SI], SI++
    87                              <2>     
    88                              <2>     COMPARE al, 0x00, .printed  ; reach end  ?
  1540 00000E4D 3C00                <3>  cmp %1, %2
  1541 00000E4F 741E                <3>  je %3
    89                              <2>     COMPARE al, 0x0d, .printed
  1540 00000E51 3C0D                <3>  cmp %1, %2
  1541 00000E53 741A                <3>  je %3
    90                              <2>     COMPARE al, 0x0a, .printed
  1540 00000E55 3C0A                <3>  cmp %1, %2
  1541 00000E57 7416                <3>  je %3
    91                              <2>     
    92 00000E59 84C0                <2>     test al, al
    93 00000E5B 7412                <2>     jz   .printed
    94 00000E5D B409                <2>     mov  ah, 09h         ; Teletype-Ausgabe
    95 00000E5F B700                <2>     mov  bh, 0           ; page 0 todo
    96 00000E61 B90100              <2>     mov  cx, 1           ; mim
    97                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000E64 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
    98                              <2>     
    99 00000E66 B402                <2>     mov ah, 0x02
   100 00000E68 B700                <2>     mov bh, 0
   101 00000E6A 42                  <2>     inc dx
   102                              <2>     VideoCall
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000E6B CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
   103                              <2>     
   104 00000E6D EBDD                <2>     jmp  .print_loop
   105                              <2> 
   106                              <2>     .printed:
   107                              <2>     ;call  DOS_getCursor
   108 00000E6F C3                  <2>     ret
   109                              <2>     
   110                              <2> ; --- Cursorposition lesen (AH=03h) ---
   111                              <2> DOS_getCursor:
   112 00000E70 52                  <2>     push dx
   113 00000E71 57                  <2>     push di
   114 00000E72 56                  <2>     push si
   115                              <2>     
   116 00000E73 B403                <2>     mov  ah, 03h         ; Read Cursor Position
   117 00000E75 B700                <2>     mov  bh, 0           ; Videoseite 0
   118                              <2>     VideoCall            ; Rückgabe: DH=Zeile, DL=Spalte (0-basiert)
   144                              <3> %if ((DOS_SHELL == 1) && (__pre_stop == 0))
   145 00000E77 CD10                <3>  int 0x10
   146                              <3> %else
   147                              <3>  EMIT_ERROR 'only DOS supports interrupts.'
   148                              <3> %endif
   119                              <2>     
   120 00000E79 8836(0302)          <2>     mov  [PTR16(dos_ypos)], dh
   121 00000E7D 8816(0202)          <2>     mov  [PTR16(dos_xpos)], dl
   122                              <2>     
   123 00000E81 5E                  <2>     pop  si
   124 00000E82 5F                  <2>     pop  di
   125 00000E83 5A                  <2>     pop  dx
   126 00000E84 C3                  <2>     ret
  1428                              <1> %include 'ReadLn16.asm'             ; read a line of text
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ReadLn16.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief Eingabe holen (DOS Zeileneingabe, mit eigenem Editor/Echo)
    12                              <2> ; \param DX - buffer
    13                              <2> ; -----------------------------------------------------------------------------
    14                              <2> DOSReadLn:
    15 00000E85 B40A                <2>     mov ah, 0Ah
    16 00000E87 CD21                <2>     int 21h              ; Rückkehr nach ENTER; [buf+1]=len, [buf+2..]=Text, [buf+2+len]=0Dh
    17                              <2> 
    18                              <2>     ; SI = &Textanfang, BL = len
    19 00000E89 89D3                <2>     mov bx, dx
    20 00000E8B 8D7702              <2>     lea si, [bx + 2]
    21 00000E8E 8A5F01              <2>     mov bl, [bx + 1]
    22                              <2> 
    23                              <2>     ; CR hinter dem Text durch 0x00 ersetzen -> sauber terminierter String
    24 00000E91 C60000              <2>     mov byte [si + bx], 0x00
    25                              <2>     
    26                              <2>     ; set flag for puts_color
    27 00000E94 B701                <2>     mov bh, 1
    28 00000E96 883E(0102)          <2>     mov [PTR16(dos_readln_flag)], bh
    29                              <2> 
    30                              <2>     ; neue Zeile
    31                              <2>     ;mov dx, PTR16(crlf)
    32                              <2>     ;mov ah, 09h
    33                              <2>     ;int 21h
    34                              <2>     
    35 00000E9A C3                  <2>     ret
    36                              <2>  
  1429                              <1> %include 'ScreenClear.asm'          ; clear the screen
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  ScreenClear.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define TEXT_VRAM 0B800h
     9                              <2> 
    10                              <2> dos_screen_clear:
    11 00000E9B 1E                  <2>     push ds
    12 00000E9C B800B8              <2>     mov  ax, TEXT_VRAM
    13 00000E9F 8EC0                <2>     mov  es, ax
    14                              <2> 
    15 00000EA1 31FF                <2>     xor  di, di         ; Offset 0
    16                              <2>     
    17                              <2>     ; default size is:  80x25
    18 00000EA3 88D8                <2>     mov  al, bl         ; AL = 25
    19 00000EA5 F6E7                <2>     mul  bh             ; AX = AL * BH = 25 * 80 = 2000 (0x07D0)
    20 00000EA7 89C1                <2>     mov  cx, ax         ; 2000 chars
    21                              <2>     
    22                              <2>     ; color
    23 00000EA9 B82007              <2>     mov  ax, 0x0720     ; AL=' ' (20h), AH=07h (hellgrau auf schwarz)
    24                              <2> 
    25                              <2>     .fill:
    26 00000EAC AB                  <2>     stosw               ; schreibt AX -> ES:[DI], DI+=2
    27 00000EAD E2FD                <2>     loop .fill
    28                              <2> 
    29 00000EAF 1F                  <2>     pop  ds
    30                              <2> 
    31                              <2>     SET_CURSOR 0, 0
  1296                              <3> %if %0 == 0
  1297                              <3>  EMIT_ERROR 2 argument missing
  1298                              <3> %endif
  1299                              <3> %if DOS_SHELL == 1
  1300 00000EB0 B200                <3>  mov dl, %1
  1301 00000EB2 B600                <3>  mov dh, %2
  1302 00000EB4 E816FB              <3>  call dos_set_cursor
  1303                              <3> %else
  1304                              <3> %endif
    32                              <2>     
    33 00000EB7 C3                  <2>     ret
    34                              <2>  
  1430                              <1> %include 'Str16Len.asm'             ; get the length of a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  Str16Len.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> %define DOS_SHELL 1
     9                              <2> 
    10                              <2> ; -----------------------------------------------------------------------------
    11                              <2> ; \brief  get the 16 bit length of a 0-terminated string
    12                              <2> ; \param  Input:  ES:SI -> "0"-terminierter String
    13                              <2> ; \return Output: AX = Länge (ohne '0')
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> DOSStrLen:
    16 00000EB8 57                  <2>     push di             ; save DI
    17 00000EB9 89F7                <2>     mov  di, si         ; DI = SI
    18 00000EBB B80000              <2>     mov  ax, 0          ; reset counter
    19                              <2>     
    20                              <2>     next:
    21 00000EBE 8A04                <2>     mov  al, [si]       ; get character
    22 00000EC0 3C00                <2>     cmp  al, 0          ; found 0-terminator ?
    23 00000EC2 7404                <2>     je   done           ; yes -> .done
    24                              <2>     
    25 00000EC4 46                  <2>     inc  si
    26 00000EC5 40                  <2>     inc  ax
    27 00000EC6 EBF6                <2>     jmp  next
    28                              <2>     
    29                              <2>     done:
    30 00000EC8 5F                  <2>     pop     di
    31 00000EC9 C3                  <2>     ret
  1431                              <1> %include 'StrCompare.asm'           ; string compare
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCompare.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; \brief strcmp - compares two 0-terminated strings: DS:SI vs. ES:DI.
    11                              <2> ; \param 1. dst > DI
    12                              <2> ; \param 2. src > SI
    13                              <2> ; \return AL = 1 (found/same)
    14                              <2> ;         AL = 0 (not same)
    15                              <2> ; -----------------------------------------------------------------------------
    16                              <2> string_compare:
    17 00000ECA 56                  <2>     push si             ; save src > si
    18                              <2>     
    19                              <2>     .next:
    20 00000ECB 8A04                <2>     mov  al, [si]       ; get src byte
    21 00000ECD 8A1D                <2>     mov  bl, [di]       ; get dst byte
    22                              <2>     
    23 00000ECF 3A05                <2>     cmp  al, [di]       ; dst == src ?
    24 00000ED1 750A                <2>     jne  .not_equal     ; no ?
    25                              <2> 
    26 00000ED3 46                  <2>     inc  si             ; next src pos.
    27 00000ED4 47                  <2>     inc  di             ; next dst pos.
    28                              <2>     
    29 00000ED5 84C0                <2>     test al, al
    30 00000ED7 75F2                <2>     jnz  .next          ; check
    31                              <2>     
    32                              <2>     .term:
    33 00000ED9 B000                <2>     mov  al, 0          ; found/same, ret
    34 00000EDB 5E                  <2>     pop  si             ; restore si
    35 00000EDC C3                  <2>     ret                 ; return to caller
    36                              <2>     
    37                              <2>     .not_equal:
    38 00000EDD B001                <2>     mov  al, 1          ; not found, ret
    39 00000EDF 5E                  <2>     pop  si             ; restore < si
    40 00000EE0 C3                  <2>     ret                 ; return to caller
  1432                              <1> %include 'StrCopy.asm'              ; copy a string
     1                              <2> ; -----------------------------------------------------------------------------
     2                              <2> ; \file  StrCopy.asm
     3                              <2> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <2> ;        all rights reserved.
     5                              <2> ;
     6                              <2> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <2> ; -----------------------------------------------------------------------------
     8                              <2> 
     9                              <2> ; -----------------------------------------------------------------------------
    10                              <2> ; Quelle: DS:SI (ASCIIZ)
    11                              <2> ; Ziel:   ES:DI   (hier setzen wir ES=DS für Daten im selben Segment)
    12                              <2> ; Rückgabe: SI = Zielstart (damit PUTS_COLOR direkt funktioniert)
    13                              <2> ; Clobbers: AX, CX, DI, ES, BX, FLAGS
    14                              <2> ; -----------------------------------------------------------------------------
    15                              <2> string_copy:
    16 00000EE1 53                  <2>     push    bx
    17 00000EE2 56                  <2>     push    si
    18                              <2> 
    19                              <2>     ; ES = DS (falls Ziel im selben Segment)
    20 00000EE3 1E                  <2>     push    ds
    21 00000EE4 07                  <2>     pop     es
    22                              <2> 
    23 00000EE5 89FB                <2>     mov     bx, di          ; Zielstart merken
    24 00000EE7 B93F00              <2>     mov     cx, 63          ; (optional) max. 63 Zeichen + 0
    25                              <2> 
    26                              <2>     .copy:
    27 00000EEA AC                  <2>     lodsb
    28 00000EEB AA                  <2>     stosb
    29 00000EEC 84C0                <2>     test    al, al
    30 00000EEE 7406                <2>     jz      .done
    31 00000EF0 E2F8                <2>     loop    .copy
    32 00000EF2 26C60500            <2>     mov     byte [es:di], 0
    33                              <2> 
    34                              <2>     .done:
    35 00000EF6 89DE                <2>     mov     si, bx          ; <- WICHTIG: SI auf Zielstart setzen
    36 00000EF8 5B                  <2>     pop     bx              ; ursprüngliches SI verwerfen (gewollt)
    37 00000EF9 5B                  <2>     pop     bx              ; wiederherstellen von BX
    38 00000EFA C3                  <2>     ret
  1433                              <1> 
  1434                              <1> code16_end:
    15                                  
    16                                  section .data
    17                                  %include 'data16.inc'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  data16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> data16_start:
     9                              <1> 
    10 0000006F 546869732070726F67- <1> msg:            db "This program requieres MS-Windows.$",0
    10 00000078 72616D207265717569- <1>
    10 00000081 65726573204D532D57- <1>
    10 0000008A 696E646F77732E2400  <1>
    11 00000093 4F70656E206572726F- <1> msgErr:         db 'Open error AX=', '$'
    11 0000009C 722041583D24        <1>
    12                              <1> 
    13                              <1> 
    14                              <1> ASTR dos_cap2A,  "ein Text", 0
   512                              <2> %if __pre_stop == 0
   513 000000A2 65696E205465787400- <2>  _cA_%1: db %2, 0
   513 000000AB 00                  <2>
   514                              <2>  _cA_%1_end:
   515                              <2>  _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <2> %endif
    15                              <1> ASTR dos_prompt, "Eingabe:       ", 0
   512                              <2> %if __pre_stop == 0
   513 000000AC 45696E676162653A20- <2>  _cA_%1: db %2, 0
   513 000000B5 2020202020200000    <2>
   514                              <2>  _cA_%1_end:
   515                              <2>  _cA_%1_length equ (_cA_%1_end - _cA_%1 - 1)
   516                              <2> %endif
    16                              <1> 
    17 000000BD 0D0A24              <1> crlf:            db 13,10,'$'
    18 000000C0 07                  <1> dos_color:       db 0x07
    19                              <1> 
    20                              <1> ; -----------------------------------------------------------------------------
    21                              <1> ; Buffer-Struktur für AH=0Ah:
    22                              <1> ; [0] = maxlen, [1] = len(out), [2..] = Text, danach CR
    23                              <1> ; -----------------------------------------------------------------------------
    24                              <1> BUFSZ            equ 64
    25 000000C1 3E                  <1> _cA_dos_buffer:  db BUFSZ-2       ; Max. Eingabezeichen (ohne die 2 Verwaltungsbytes)
    26 000000C2 00                  <1>                  db 0             ; tatsächliche Länge (OUT)
    27 000000C3 00<rep 3Eh>         <1>                  times BUFSZ-2 db 0
    28 00000101 00                  <1> dos_readln_flag: db 0
    29                              <1> 
    30                              <1> ; -----------------------------------------------------------------------------
    31                              <1> ; \brief DOS console settings ...
    32                              <1> ; -----------------------------------------------------------------------------
    33 00000102 00                  <1> dos_xpos:           db 0      ; current text cursor column
    34 00000103 00                  <1> dos_ypos:           db 0      ; current text cursor row
    35 00000104 00                  <1> dos_page:           db 0      ; current video page
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; dBASE data ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 00000105 444154412E44424600  <1> _cA_DBFNAME:        db 'DATA.DBF',0
    41                              <1> 
    42 0000010E 644241534520495620- <1> msgTitle:           db 'dBASE IV DBF Header',13,10,'$'
    42 00000117 444246204865616465- <1>
    42 00000120 720D0A24            <1>
    43 00000124 55736167653A204442- <1> msgUsage:           db 'Usage: DBFHEAD <datei.dbf>',13,10,'$'
    43 0000012D 4648454144203C6461- <1>
    43 00000136 7465692E6462663E0D- <1>
    43 0000013F 0A24                <1>
    44 00000141 4665686C65723A2044- <1> msgOpenErr:         db 'Fehler: Datei kann nicht geoeffnet werden.',13,10,'$'
    44 0000014A 61746569206B616E6E- <1>
    44 00000153 206E69636874206765- <1>
    44 0000015C 6F6566666E65742077- <1>
    44 00000165 657264656E2E0D0A24  <1>
    45 0000016E 4665686C65723A204C- <1> msgReadErr:         db 'Fehler: Lesen fehlgeschlagen.',13,10,'$'
    45 00000177 6573656E206665686C- <1>
    45 00000180 67657363686C616765- <1>
    45 00000189 6E2E0D0A24          <1>
    46 0000018E 56657273696F6E2028- <1> msgVer:             db 'Version (hex): $'
    46 00000197 686578293A2024      <1>
    47 0000019E 446174756D20285959- <1> msgDate:            db 'Datum (YY-MM-DD): $'
    47 000001A7 2D4D4D2D4444293A20- <1>
    47 000001B0 24                  <1>
    48 000001B1 416E7A61686C204461- <1> msgRecs:            db 'Anzahl Datensaetze (hex): $'
    48 000001BA 74656E736165747A65- <1>
    48 000001C3 2028686578293A2024  <1>
    49 000001CC 4865616465726C6165- <1> msgHdr:             db 'Headerlaenge (bytes): $'
    49 000001D5 6E6765202862797465- <1>
    49 000001DE 73293A2024          <1>
    50 000001E3 5361747A6C61656E67- <1> msgRec:             db 'Satzlaenge (bytes): $'
    50 000001EC 652028627974657329- <1>
    50 000001F5 3A2024              <1>
    51 000001F8 4D44582D466C616720- <1> msgMDX:             db 'MDX-Flag (hex): $'
    51 00000201 28686578293A2024    <1>
    52 00000209 4C616E677561676520- <1> msgLang:            db 'Language Driver ID (hex): $'
    52 00000212 447269766572204944- <1>
    52 0000021B 2028686578293A2024  <1>
    53 00000224 46656C6465723A0D0A- <1> msgFields:          db 'Felder:',13,10,'$'
    53 0000022D 24                  <1>
    54 0000022E 4B65696E652046656C- <1> msgNoFields:        db 'Keine Felder gefunden.',13,10,'$'
    54 00000237 64657220676566756E- <1>
    54 00000240 64656E2E0D0A24      <1>
    55 00000247 202046656C64202324  <1> msgFieldN:          db '  Feld #$'
    56 00000250 3A2024              <1> msgColonSp:         db ': $'
    57 00000253 2C2024              <1> msgCommaSp:         db ', $'
    58 00000256 202F2024            <1> msgSlash:           db ' / $'
    59                              <1> 
    60 0000025A 55736167653A204442- <1> _cA_msg_usage:          db 'Usage: DBFMAKE <type:3|4> <CREATE|APPEND> <C|I|F|B|D|T> <feldname> <feldlaenge>', 0
    60 00000263 464D414B45203C7479- <1>
    60 0000026C 70653A337C343E203C- <1>
    60 00000275 4352454154457C4150- <1>
    60 0000027E 50454E443E203C437C- <1>
    60 00000287 497C467C427C447C54- <1>
    60 00000290 3E203C66656C646E61- <1>
    60 00000299 6D653E203C66656C64- <1>
    60 000002A2 6C61656E67653E00    <1>
    61 000002AA 4665686C65723A2041- <1> _cA_msg_badargs:        db 'Fehler: Argumente ungueltig.',0
    61 000002B3 7267756D656E746520- <1>
    61 000002BC 756E6775656C746967- <1>
    61 000002C5 2E00                <1>
    62 000002C7 4665686C65723A2044- <1> _cA_msg_openfail:       db 'Fehler: Datei kann nicht geoeffnet/erstellt werden.',0
    62 000002D0 61746569206B616E6E- <1>
    62 000002D9 206E69636874206765- <1>
    62 000002E2 6F6566666E65742F65- <1>
    62 000002EB 727374656C6C742077- <1>
    62 000002F4 657264656E2E00      <1>
    63 000002FB 4665686C65723A2044- <1> _cA_msg_ver_mismatch:   db 'Fehler: DBF-Typ passt nicht zur Datei.',0
    63 00000304 42462D547970207061- <1>
    63 0000030D 737374206E69636874- <1>
    63 00000316 207A75722044617465- <1>
    63 0000031F 692E00              <1>
    64 00000322 415050454E44206162- <1> _cA_msg_append_recs:    db 'APPEND abgelehnt: Datei enthaelt Datensaetze (nicht unterstuetzt).',0
    64 0000032B 67656C65686E743A20- <1>
    64 00000334 446174656920656E74- <1>
    64 0000033D 6861656C7420446174- <1>
    64 00000346 656E736165747A6520- <1>
    64 0000034F 286E6963687420756E- <1>
    64 00000358 74657273747565747A- <1>
    64 00000361 74292E00            <1>
    65 00000365 492F4F2D4665686C65- <1> _cA_msg_ioerr:          db 'I/O-Fehler.',0
    65 0000036E 722E00              <1>
    66 00000371 4665686C65723A2075- <1> _cA_msg_badheader:      db 'Fehler: ungueltiger Header/Felddeskriptor.',0
    66 0000037A 6E6775656C74696765- <1>
    66 00000383 72204865616465722F- <1>
    66 0000038C 46656C646465736B72- <1>
    66 00000395 6970746F722E00      <1>
    67 0000039C 4E6963687420756E74- <1> _cA_msg_not_supported:  db 'Nicht unterstuetzt: Feldtyp nur mit Typ 4.',0
    67 000003A5 657273747565747A74- <1>
    67 000003AE 3A2046656C64747970- <1>
    67 000003B7 206E7572206D697420- <1>
    67 000003C0 54797020342E00      <1>
    68 000003C7 4F4B3A204E65756520- <1> _cA_msg_ok_create:      db 'OK: Neue DBF mit einem Feld erstellt (DATA.DBF).',0
    68 000003D0 444246206D69742065- <1>
    68 000003D9 696E656D2046656C64- <1>
    68 000003E2 2065727374656C6C74- <1>
    68 000003EB 2028444154412E4442- <1>
    68 000003F4 46292E00            <1>
    69 000003F8 4F4B3A2046656C6420- <1> msg_ok_append:      db 'OK: Feld an bestehende leere DBF angehaengt.',0
    69 00000401 616E20626573746568- <1>
    69 0000040A 656E6465206C656572- <1>
    69 00000413 652044424620616E67- <1>
    69 0000041C 656861656E67742E00  <1>
    70 00000425 48696E776569733A20- <1> msg_fieldexists:    db 'Hinweis: Feld bereits vorhanden; keine Aenderung vorgenommen.',0
    70 0000042E 46656C642062657265- <1>
    70 00000437 69747320766F726861- <1>
    70 00000440 6E64656E3B206B6569- <1>
    70 00000449 6E652041656E646572- <1>
    70 00000452 756E6720766F726765- <1>
    70 0000045B 6E6F6D6D656E2E00    <1>
    71                              <1> 
    72 00000463 43524541544500      <1> str_CREATE:         db 'CREATE',0
    73 0000046A 415050454E4400      <1> str_APPEND:         db 'APPEND',0
    74                              <1> 
    75                              <1> ; ---- Daten ----
    76 00000471 6E6F20617267732E00  <1> _cA_noargs_msg:     db 'no args.', 0
    77 0000047A 475A2E45584500      <1> _cA_GzipAppName:    db 'GZ.EXE', 0
    78 00000481 65786563206F662067- <1> _cA_GzipErrorMsg:   db 'exec of gzip.exe failed.', 0
    78 0000048A 7A69702E6578652066- <1>
    78 00000493 61696C65642E00      <1>
    79                              <1> 
    80                              <1> ; Kommandozeile im PSP-Format:
    81                              <1> ; Byte 0: Länge (Anzahl Zeichen)
    82                              <1> ; Danach die Zeichen, abgeschlossen mit 0Dh (CR).
    83                              <1> ; Üblicherweise beginnt die Tail mit einem Leerzeichen vor dem ersten Argument.
    84                              <1> 
    85                              <1> GzipCmdTail:
    86 0000049A 0E                  <1>     db GzipCmdTextEnd - GzipCmdText          ; Länge
    87                              <1> GzipCmdText:
    88 0000049B 202D64206D6F64756C- <1>     db ' -d modul1.biz'
    88 000004A4 312E62697A          <1>
    89                              <1> GzipCmdTextEnd:
    90 000004A9 0D                  <1>     db 13
    91                              <1> 
    92                              <1> ; -----------------------------------------------------------------------------
    93                              <1> ; \brief DOS error code messages for int 0x21 function 0x3D (open file)
    94                              <1> ; -----------------------------------------------------------------------------
    95 000004AA 756E6B6E6F776E2065- <1> _cA_open_error_nd:  db 'unknown error.',0
    95 000004B3 72726F722E00        <1>
    96 000004B9 696E76616C69642066- <1> _cA_open_error_01:  db 'invalid function / wrong AH code.', 0
    96 000004C2 756E6374696F6E202F- <1>
    96 000004CB 2077726F6E67204148- <1>
    96 000004D4 20636F64652E00      <1>
    97 000004DB 66696C65206E6F7420- <1> _cA_open_error_02:  db 'file not found.', 0
    97 000004E4 666F756E642E00      <1>
    98 000004EB 70617468206E6F7420- <1> _cA_open_error_03:  db 'path not found.', 0
    98 000004F4 666F756E642E00      <1>
    99 000004FB 746F6F206D616E7920- <1> _cA_open_error_04:  db 'too many open files.', 0
    99 00000504 6F70656E2066696C65- <1>
    99 0000050D 732E00              <1>
   100 00000510 616363657373206465- <1> _cA_open_error_05:  db 'access denied.', 0
   100 00000519 6E6965642E00        <1>
   101 0000051F 696E76616C69642066- <1> _cA_open_error_06:  db 'invalid file handle', 0
   101 00000528 696C652068616E646C- <1>
   101 00000531 6500                <1>
   102 00000533 6D63622F6172656E61- <1> _cA_open_error_07:  db 'mcb/arena corrupted.', 0
   102 0000053C 20636F727275707465- <1>
   102 00000545 642E00              <1>
   103 00000548 6E6F206D6F7265206D- <1> _cA_open_error_08:  db 'no more memory.', 0
   103 00000551 656D6F72792E00      <1>
   104 00000558 696E76616C6964206D- <1> _cA_open_error_09:  db 'invalid memory address.', 0
   104 00000561 656D6F727920616464- <1>
   104 0000056A 726573732E00        <1>
   105 00000570 696E76616C69642065- <1> _cA_open_error_0A:  db 'invalid environment.', 0
   105 00000579 6E7669726F6E6D656E- <1>
   105 00000582 742E00              <1>
   106 00000585 6578652F636F6D2066- <1> _cA_open_error_0B:  db 'exe/com format error..', 0
   106 0000058E 6F726D617420657272- <1>
   106 00000597 6F722E2E00          <1>
   107 0000059C 696E76616C69642061- <1> _cA_open_error_0C:  db 'invalid access token.', 0
   107 000005A5 636365737320746F6B- <1>
   107 000005AE 656E2E00            <1>
   108 000005B2 6461746120696E666F- <1> _cA_open_error_0D:  db 'data informations are invalid.', 0
   108 000005BB 726D6174696F6E7320- <1>
   108 000005C4 61726520696E76616C- <1>
   108 000005CD 69642E00            <1>
   109 000005D1 696E76616C6964206D- <1> _cA_open_error_0E:  db 'invalid memory block.', 0
   109 000005DA 656D6F727920626C6F- <1>
   109 000005E3 636B2E00            <1>
   110 000005E7 696E76616C69642064- <1> _cA_open_error_0F:  db 'invalid drive.', 0
   110 000005F0 726976652E00        <1>
   111 000005F6 747269656420746F20- <1> _cA_open_error_10:  db 'tried to delete current directory.', 0
   111 000005FF 64656C657465206375- <1>
   111 00000608 7272656E7420646972- <1>
   111 00000611 6563746F72792E00    <1>
   112 00000619 66696C65206F6E206F- <1> _cA_open_error_11:  db 'file on other drive.', 0
   112 00000622 746865722064726976- <1>
   112 0000062B 652E00              <1>
   113 0000062E 6E6F206D6F72652066- <1> _cA_open_error_12:  db 'no more files/file already exists.', 0
   113 00000637 696C65732F66696C65- <1>
   113 00000640 20616C726561647920- <1>
   113 00000649 6578697374732E00    <1>
   114 00000651 6472697665206E6F74- <1> _cA_open_error_15:  db 'drive not ready.', 0
   114 0000065A 2072656164792E00    <1>
   115 00000662 6D6564696120646F65- <1> _cA_open_error_1D:  db 'media does not support seek.', 0
   115 0000066B 73206E6F7420737570- <1>
   115 00000674 706F7274207365656B- <1>
   115 0000067D 2E00                <1>
   116 0000067F 7365656B206572726F- <1> _cA_open_error_1E:  db 'seek error.', 0
   116 00000688 722E00              <1>
   117 0000068B 6472697665206E6F74- <1> _cA_open_error_1F:  db 'drive not available.', 0
   117 00000694 20617661696C61626C- <1>
   117 0000069D 652E00              <1>
   118 000006A0 66696C652063616E20- <1> _cA_open_error_20:  db 'file can not overwrite.', 0
   118 000006A9 6E6F74206F76657277- <1>
   118 000006B2 726974652E00        <1>
   119 000006B8 6472697665206E6F74- <1> _cA_open_error_21:  db 'drive not ready.', 0
   119 000006C1 2072656164792E00    <1>
   120 000006C9 6E6F20646973632063- <1> _cA_open_error_27:  db 'no disc capacities.', 0
   120 000006D2 617061636974696573- <1>
   120 000006DB 2E00                <1>
   121                              <1> 
   122                              <1> ; --- Daten ---
   123 000006DD 4D4F44554C312E4249- <1> _cA_mod_filename:       db 'MODUL1.BIN',0
   123 000006E6 4E00                <1>
   124                              <1> 
   125 000006E8 6D6F64756C65206669- <1> _cA_mod_read_error:     db 'module file not found.',0
   125 000006F1 6C65206E6F7420666F- <1>
   125 000006FA 756E642E00          <1>
   126 000006FF 6F70656E2066696C65- <1> _cA_mod_file_error:     db 'open file error.',0
   126 00000708 206572726F722E00    <1>
   127 00000710 66726565206572726F- <1> _cA_mod_free_error:     db 'free error.',0
   127 00000719 722E00              <1>
   128 0000071C 6D656D6F7279206E6F- <1> _cA_mod_free_error_no:  db 'memory not freed.',0
   128 00000725 742066726565642E00  <1>
   129 0000072E 636C6F736520657272- <1> _cA_mod_clos_error:     db 'close error.',0
   129 00000737 6F722E00            <1>
   130 0000073B 66696C65206E6F7420- <1> _cA_mod_clos_error_no:  db 'file not close error.',0
   130 00000744 636C6F736520657272- <1>
   130 0000074D 6F722E00            <1>
   131 00000751 6E6F206572726F7220- <1> _cA_mod_have_error_no:  db 'no error found.',0
   131 0000075A 666F756E642E00      <1>
   132                              <1> 
   133                              <1> ; -----------------------------------------------------------------------------
   134                              <1> ; --- Tabelle: [Fehlercode, Handler] ... 0 = Ende ---
   135                              <1> ; -----------------------------------------------------------------------------
   136                              <1> ERR_ITEMS   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,             0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,                   0x10, 0x11, 0x12, 0x15, 0x1D, 0x1E, 0x1F,                   0x20, 0x21, 0x27
  1764                              <2> _cA_error_dispatch:
  1765                              <2>  %rep %0
  1766                              <2>  _HEX2 %1, __H, __L
  1767                              <2>  dw %1, _cA_errh%+__H%+__L
  1768                              <2>  %undef __H
  1769                              <2>  %undef __L
  1770                              <2>  %rotate 1
  1771                              <2>  %endrep
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000761 0100[A30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000765 0200[B30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000769 0300[C30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000076D 0400[D30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000771 0500[E30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000775 0600[F30B]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000779 0700[030C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000077D 0800[130C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000781 0900[230C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000785 0A00[330C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000789 0B00[430C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000078D 0C00[530C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000791 0D00[630C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000795 0E00[730C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 00000799 0F00[830C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 0000079D 1000[930C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007A1 1100[A30C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007A5 1200[B30C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007A9 1500[C20C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007AD 1D00[D10C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007B1 1E00[E00C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007B5 1F00[EF0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007B9 2000[FE0C]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007BD 2100[0D0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1766                              <3>  _HEX2 %1, __H, __L
  1712                              <4>  %assign __v %1
  1713                              <4>  %assign __v __v & 0FFh
  1714                              <4>  %assign __hi (__v >> 4) & 0Fh
  1715                              <4>  %assign __lo __v & 0Fh
  1716                              <4>  _HEXDIG __hi, %2
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1717                              <4>  _HEXDIG __lo, %3
  1690                              <5>  %if %1 < 10
  1691                              <5>  %define %2 %1
  1692                              <5>  %elif %1 = 10
  1693                              <5>  %define %2 A
  1694                              <5>  %elif %1 = 11
  1695                              <5>  %define %2 B
  1696                              <5>  %elif %1 = 12
  1697                              <5>  %define %2 C
  1698                              <5>  %elif %1 = 13
  1699                              <5>  %define %2 D
  1700                              <5>  %elif %1 = 14
  1701                              <5>  %define %2 E
  1702                              <5>  %elif %1 = 15
  1703                              <5>  %define %2 F
  1704                              <5>  %else
  1705                              <5>  EMIT_ERROR "_HEXDIG: Nibble ausserhalb 0..15"
  1706                              <5>  %endif
  1718                              <4>  %undef __v
  1719                              <4>  %undef __hi
  1720                              <4>  %undef __lo
  1767 000007C1 2700[1C0D]          <3>  dw %1, _cA_errh%+__H%+__L
  1768                              <3>  %undef __H
  1769                              <3>  %undef __L
  1770                              <3>  %rotate 1
  1772 000007C5 0000[2B0D]          <2>  dw 00h, _cA_errhnd
   140                              <1> 
   141 000007C9 0000                <1> _cA_mod_hFile:   dw 0
   142 000007CB 0000                <1> mod_seg_ovl:     dw 0
   143 000007CD 0000                <1> mod_fsize_lo:    dw 0
   144 000007CF 0000                <1> mod_fsize_hi:    dw 0
   145                              <1> 
   146 000007D1 48616C6C6F20766F6D- <1> mod_msg:         db 'Hallo vom Loader!$'
   146 000007DA 204C6F616465722124  <1>
   147                              <1> mod_msg_len:     equ ($ - msg)
   148                              <1> 
   149 000007E3 0000                <1> hdr_len:            dw 0
   150 000007E5 0000                <1> rec_len:            dw 0
   151                              <1> 
   152 000007E7 343200              <1> _cA_ARGV1: db '42', 0
   153 000007EA 203300              <1> _cA_cmd_num: db ' 3',0
   154                              <1> 
   155                              <1> 
   156                              <1> data16_end:
    18                                  
    19                                  section .bss
    20                                  %include 'bss16.asm'
     1                              <1> ; -----------------------------------------------------------------------------
     2                              <1> ; \file  bss16.asm
     3                              <1> ; \note  (c) 2025 by Jens Kallup - paule32
     4                              <1> ;        all rights reserved.
     5                              <1> ;
     6                              <1> ; \desc  Create a dBASE MS-Windows 11 64-bit Pro EXE.
     7                              <1> ; -----------------------------------------------------------------------------
     8                              <1> 
     9                              <1> bss16_start:
    10                              <1> 
    11                              <1> ; -----------------------------------------------------------------------------
    12                              <1> ; \brief hold DOS command line argument information's ...
    13                              <1> ; -----------------------------------------------------------------------------
    14                              <1> %define MAX_ARGS    7
    15                              <1> struc _cA_COMMAND_LINE
    16 00000000 ??                  <1>     .arg_count      resb 1            ; max. 255 arguments
    17 00000001 <res 40h>           <1>     .arg_str        resb 64           ; max. length = 64 bytes
    18                              <1> endstruc
    19 00000000 <res 1C0h>          <1> _cA_command_args:   resb 64 * MAX_ARGS
    20 000001C0 <res 40h>           <1> _cA_command_arglen: resb 64
    21 00000200 ????                <1> arg_total:          resw 1
    22                              <1> 
    23 00000202 <res 40h>           <1> _cA_cmd_arg_1:      resb 64
    24 00000242 <res 40h>           <1> _cA_cmd_arg_2:      resb 64
    25 00000282 <res 40h>           <1> _cA_cmd_arg_3:      resb 64
    26 000002C2 <res 40h>           <1> _cA_cmd_arg_4:      resb 64
    27 00000302 <res 40h>           <1> _cA_cmd_arg_5:      resb 64
    28 00000342 <res 40h>           <1> _cA_cmd_arg_6:      resb 64
    29 00000382 <res 40h>           <1> _cA_cmd_arg_7:      resb 64
    30                              <1> 
    31 000003C2 <res 100h>          <1> _cA_cmd_buf:        resb 256          ; CMD string
    32 000004C2 <res 82h>           <1> _cA_cmd_buffer:     resb 130
    33                              <1> 
    34                              <1> ; EXEC-Parameterblock (14 Bytes)
    35 00000544 <res Eh>            <1> _cA_ExecBlk:        resb 14
    36                              <1> 
    37                              <1> ; -----------------------------------------------------------------------------
    38                              <1> ; command line holders ...
    39                              <1> ; -----------------------------------------------------------------------------
    40 00000552 ??                  <1> _cA_db_version:     resb 1   ; 3 -> dBase3, 4 -> dBase4
    41 00000553 ??                  <1> _cA_db_op:          resb 1   ; 0 -> CREATE, 1 -> APPEND
    42 00000554 ??                  <1> _cA_db_type:        resb 1   ; C|I|F|B|D
    43 00000555 ??                  <1> _cA_db_have_token:  resb 1
    44                              <1> 
    45 00000556 <res 1000h>         <1> fdescbuf:           resb 4096
    46                              <1> 
    47 00001556 ????????????        <1> buf_hex:            resb 6            ; 4 Hex-Zeichen + '$' + Reserve
    48 0000155C ??????????????      <1> buf_dec:            resb 7            ; 5 Dezimal-Zeichen + '$' + Reserve
    49                              <1> 
    50 00001563 <res 80h>           <1> filename:           resb 128
    51                              <1> _cA_fdbuf:
    52 000015E3 <res 800h>          <1> fdbuf:              resb 2048
    53 00001DE3 <res 10h>           <1> _cA_namebuf:        resb 16
    54                              <1> 
    55                              <1> hFile:              resw 0
    56                              <1> ; -----------------------------------------------------------------------------
    57                              <1> g_type:             resw 0
    58                              <1> g_cmd:              resb 0
    59                              <1> g_ftype:            resb 0
    60                              <1> g_ftype_mapped:     resb 0
    61                              <1> g_flen:             resw 0
    62                              <1> g_year:             resw 0
    63                              <1> g_month:            resb 0
    64                              <1> g_day:              resb 0
    65                              <1> ; -----------------------------------------------------------------------------
    66                              <1> verByte:            resb 0
    67                              <1> yy:                 resb 0
    68                              <1> mm:                 resb 0
    69                              <1> dd:                 resb 0
    70                              <1> mdx:                resb 0
    71                              <1> lang:               resb 0
    72                              <1> rec32:              resd 0
    73                              <1> 
    74 00001DF3 <res 40h>           <1> tokbuf:             resb 64
    75 00001E33 <res Ch>            <1> fldname:            resb 12
    76                              <1> 
    77 00001E3F <res 20h>           <1> header:             resb 32
    78                              <1> fdbuf_size:         resw 0
    79 00001E5F <res 20h>           <1> tempdesc:           resb 32
    80                              <1> 
    81                              <1> ; -----------------------------------------------------------------------------
    82                              <1> 
    83                              <1> buf_seg:            resw 0
    84                              <1> size_lo:            resw 0
    85                              <1> size_hi:            resw 0
    86                              <1> 
    87                              <1> bss16_end:
    21                                  kernel_end:
